var DeathByChoice=function(exports){"use strict";var Loading=window;function getAugmentedNamespace(n){if(n.__esModule)return n;var a=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(n).forEach(function(k){var d=Object.getOwnPropertyDescriptor(n,k);Object.defineProperty(a,k,d.get?d:{enumerable:!0,get:function(){return n[k]}})}),a}function IsPlainObject_1(obj){if("object"!=typeof obj||obj.nodeType||obj===obj.window)return!1;try{if(obj.constructor&&!{}.hasOwnProperty.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0}var BlendModes$8={SKIP_CHECK:-1,NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,ERASE:17,SOURCE_IN:18,SOURCE_OUT:19,SOURCE_ATOP:20,DESTINATION_OVER:21,DESTINATION_IN:22,DESTINATION_OUT:23,DESTINATION_ATOP:24,LIGHTER:25,COPY:26,XOR:27},ScaleModes_1={DEFAULT:0,LINEAR:0,NEAREST:1},Extend={VERSION:"3.55.2",BlendModes:BlendModes$8,ScaleModes:ScaleModes_1,AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,FOREVER:-1,NONE:4,UP:5,DOWN:6,LEFT:7,RIGHT:8},IsPlainObject$x=IsPlainObject_1,Extend$m=function(){var options,name,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[1]||{},i=2),length===i&&(target=this,--i);i<length;i++)if(null!=(options=arguments[i]))for(name in options)clone=target[name],target!==(copy=options[name])&&(deep&&copy&&(IsPlainObject$x(copy)||(copyIsArray=Array.isArray(copy)))?(clone=copyIsArray?(copyIsArray=!1,clone&&Array.isArray(clone)?clone:[]):clone&&IsPlainObject$x(clone)?clone:{},target[name]=Extend$m(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},Extend_1$1=Extend$m,_const$d={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12},Parse2DArray_1=function(gameObject){return gameObject.y+gameObject.height-gameObject.height*gameObject.originY},Centroid_1=function(gameObject){return gameObject.x-gameObject.width*gameObject.originX+.5*gameObject.width},HTML5AudioSoundManager_1=function(gameObject,x){var offsetX=gameObject.width*gameObject.originX;return gameObject.x=x+offsetX-.5*gameObject.width,gameObject},NoAudioSound_1=function(gameObject,value){return gameObject.y=value+gameObject.height*gameObject.originY,gameObject},GetBottom$8=Parse2DArray_1,GetCenterX$4=Centroid_1,SetCenterX$4=HTML5AudioSoundManager_1,SetTop$7=NoAudioSound_1,Merge_1=function(gameObject,alignTo,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetCenterX$4(gameObject,GetCenterX$4(alignTo)+offsetX),SetTop$7(gameObject,GetBottom$8(alignTo)+offsetY),gameObject},BaseSoundManager_1=function(gameObject){return gameObject.x-gameObject.width*gameObject.originX},GetTextSize_1=function(gameObject,value){return gameObject.x=value+gameObject.width*gameObject.originX,gameObject},GetBottom$7=Parse2DArray_1,GetLeft$8=BaseSoundManager_1,SetLeft$7=GetTextSize_1,SetTop$6=NoAudioSound_1,ParseTileLayers_1=function(gameObject,alignTo,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetLeft$7(gameObject,GetLeft$8(alignTo)-offsetX),SetTop$6(gameObject,GetBottom$7(alignTo)+offsetY),gameObject},DynamicBitmapText_1=function(gameObject){return gameObject.x+gameObject.width-gameObject.width*gameObject.originX},Composites_1=function(gameObject,value){return gameObject.x=value-gameObject.width+gameObject.width*gameObject.originX,gameObject},GetBottom$6=Parse2DArray_1,GetRight$8=DynamicBitmapText_1,SetRight$7=Composites_1,SetTop$5=NoAudioSound_1,ParseJSONTiled_1=function(gameObject,alignTo,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetRight$7(gameObject,GetRight$8(alignTo)+offsetX),SetTop$5(gameObject,GetBottom$6(alignTo)+offsetY),gameObject},HTML5AudioSound_1=function(gameObject,value){return gameObject.y=value-gameObject.height+gameObject.height*gameObject.originY,gameObject},GetBottom$5=Parse2DArray_1,GetLeft$7=BaseSoundManager_1,SetBottom$7=HTML5AudioSound_1,SetRight$6=Composites_1,Scene_1=function(gameObject,alignTo,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetRight$6(gameObject,GetLeft$7(alignTo)-offsetX),SetBottom$7(gameObject,GetBottom$5(alignTo)+offsetY),gameObject},DOMElement_1=function(gameObject){return gameObject.y-gameObject.height*gameObject.originY+.5*gameObject.height},Extern_1=function(gameObject,y){var offsetY=gameObject.height*gameObject.originY;return gameObject.y=y+offsetY-.5*gameObject.height,gameObject},GetCenterY$4=DOMElement_1,GetLeft$6=BaseSoundManager_1,SetCenterY$4=Extern_1,SetRight$5=Composites_1,FromOrientationString_1=function(gameObject,alignTo,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetRight$5(gameObject,GetLeft$6(alignTo)-offsetX),SetCenterY$4(gameObject,GetCenterY$4(alignTo)+offsetY),gameObject},BaseSound_1=function(gameObject){return gameObject.y-gameObject.height*gameObject.originY},GetLeft$5=BaseSoundManager_1,GetTop$8=BaseSound_1,SetRight$4=Composites_1,SetTop$4=NoAudioSound_1,ParseWeltmeister_1=function(gameObject,alignTo,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetRight$4(gameObject,GetLeft$5(alignTo)-offsetX),SetTop$4(gameObject,GetTop$8(alignTo)-offsetY),gameObject},GetBottom$4=Parse2DArray_1,GetRight$7=DynamicBitmapText_1,SetBottom$6=HTML5AudioSound_1,SetLeft$6=GetTextSize_1,HexagonalWorldToTileY_1=function(gameObject,alignTo,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetLeft$6(gameObject,GetRight$7(alignTo)+offsetX),SetBottom$6(gameObject,GetBottom$4(alignTo)+offsetY),gameObject},GetCenterY$3=DOMElement_1,GetRight$6=DynamicBitmapText_1,SetCenterY$3=Extern_1,SetLeft$5=GetTextSize_1,ParseTileLayers_1$1=function(gameObject,alignTo,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetLeft$5(gameObject,GetRight$6(alignTo)+offsetX),SetCenterY$3(gameObject,GetCenterY$3(alignTo)+offsetY),gameObject},GetRight$5=DynamicBitmapText_1,GetTop$7=BaseSound_1,SetLeft$4=GetTextSize_1,SetTop$3=NoAudioSound_1,GetWorldToTileXYFunction_1=function(gameObject,alignTo,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetLeft$4(gameObject,GetRight$5(alignTo)+offsetX),SetTop$3(gameObject,GetTop$7(alignTo)-offsetY),gameObject},GetCenterX$3=Centroid_1,GetTop$6=BaseSound_1,SetBottom$5=HTML5AudioSound_1,SetCenterX$3=HTML5AudioSoundManager_1,IsInLayerBounds_1=function(gameObject,alignTo,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetCenterX$3(gameObject,GetCenterX$3(alignTo)+offsetX),SetBottom$5(gameObject,GetTop$6(alignTo)-offsetY),gameObject},GetLeft$4=BaseSoundManager_1,GetTop$5=BaseSound_1,SetBottom$4=HTML5AudioSound_1,SetLeft$3=GetTextSize_1,NumberTweenBuilder_1=function(gameObject,alignTo,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetLeft$3(gameObject,GetLeft$4(alignTo)-offsetX),SetBottom$4(gameObject,GetTop$5(alignTo)-offsetY),gameObject},GetRight$4=DynamicBitmapText_1,GetTop$4=BaseSound_1,SetBottom$3=HTML5AudioSound_1,SetRight$3=Composites_1,events$6=function(gameObject,alignTo,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetRight$3(gameObject,GetRight$4(alignTo)+offsetX),SetBottom$3(gameObject,GetTop$4(alignTo)-offsetY),gameObject},components$1=_const$d,AlignToMap=[];AlignToMap[components$1.BOTTOM_CENTER]=Merge_1,AlignToMap[components$1.BOTTOM_LEFT]=ParseTileLayers_1,AlignToMap[components$1.BOTTOM_RIGHT]=ParseJSONTiled_1,AlignToMap[components$1.LEFT_BOTTOM]=Scene_1,AlignToMap[components$1.LEFT_CENTER]=FromOrientationString_1,AlignToMap[components$1.LEFT_TOP]=ParseWeltmeister_1,AlignToMap[components$1.RIGHT_BOTTOM]=HexagonalWorldToTileY_1,AlignToMap[components$1.RIGHT_CENTER]=ParseTileLayers_1$1,AlignToMap[components$1.RIGHT_TOP]=GetWorldToTileXYFunction_1,AlignToMap[components$1.TOP_CENTER]=IsInLayerBounds_1,AlignToMap[components$1.TOP_LEFT]=NumberTweenBuilder_1,AlignToMap[components$1.TOP_RIGHT]=events$6;var GetWorldToTileYFunction_1=function(child,alignTo,position,offsetX,offsetY){return AlignToMap[position](child,alignTo,offsetX,offsetY)},QuickSet$1=GetWorldToTileYFunction_1,BitmapFontFile_1=function(items,position,offsetX,offsetY){for(var target=items[0],i=1;i<items.length;i++){var item=items[i];QuickSet$1(item,target,position,offsetX,offsetY),target=item}return items},scene=function(items,key,value,step,index,direction){var i;void 0===step&&(step=0),void 0===index&&(index=0);var t=0,end=items.length;if(1===(direction=void 0===direction?1:direction))for(i=index;i<end;i++)items[i][key]+=value+t*step,t++;else for(i=index;0<=i;i--)items[i][key]+=value+t*step,t++;return items},PropertyValueInc$8=scene,CullTiles_1=function(items,value,step,index,direction){return PropertyValueInc$8(items,"angle",value,step,index,direction)},textures=function(items,callback,context){for(var i=0;i<items.length;i++){var item=items[i];callback.call(context,item)}return items},dom=function(items,compare,index){for(var i=index=void 0===index?0:index;i<items.length;i++){var property,item=items[i],match=!0;for(property in compare)item[property]!==compare[property]&&(match=!1);if(match)return item}return null},MatterWrap_1=function(items,compare,index){for(var i=index=void 0===index?0:index;i<items.length;i++){var property,item=items[i],match=!0;for(property in compare)item[property]!==compare[property]&&(match=!1);if(match)return item}return null},GetBottom$3=Parse2DArray_1,GetCenterX$2=Centroid_1,SetBottom$2=HTML5AudioSound_1,SetCenterX$2=HTML5AudioSoundManager_1,GetTilesWithinShape_1=function(gameObject,alignIn,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetCenterX$2(gameObject,GetCenterX$2(alignIn)+offsetX),SetBottom$2(gameObject,GetBottom$3(alignIn)+offsetY),gameObject},GetBottom$2=Parse2DArray_1,GetLeft$3=BaseSoundManager_1,SetBottom$1=HTML5AudioSound_1,SetLeft$2=GetTextSize_1,GetTweens_1=function(gameObject,alignIn,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetLeft$2(gameObject,GetLeft$3(alignIn)-offsetX),SetBottom$1(gameObject,GetBottom$2(alignIn)+offsetY),gameObject},GetBottom$1=Parse2DArray_1,GetRight$3=DynamicBitmapText_1,SetBottom=HTML5AudioSound_1,SetRight$2=Composites_1,RenderTexture_1=function(gameObject,alignIn,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetRight$2(gameObject,GetRight$3(alignIn)+offsetX),SetBottom(gameObject,GetBottom$1(alignIn)+offsetY),gameObject},SetCenterX$1=HTML5AudioSoundManager_1,SetCenterY$2=Extern_1,BinaryFile_1=function(gameObject,x,y){return SetCenterX$1(gameObject,x),SetCenterY$2(gameObject,y)},CenterOn$5=BinaryFile_1,GetCenterX$1=Centroid_1,GetCenterY$2=DOMElement_1,ParseObject_1=function(gameObject,alignIn,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),CenterOn$5(gameObject,GetCenterX$1(alignIn)+offsetX,GetCenterY$2(alignIn)+offsetY),gameObject},GetCenterY$1=DOMElement_1,GetLeft$2=BaseSoundManager_1,SetCenterY$1=Extern_1,SetLeft$1=GetTextSize_1,GetTileToWorldXYFunction_1=function(gameObject,alignIn,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetLeft$1(gameObject,GetLeft$2(alignIn)-offsetX),SetCenterY$1(gameObject,GetCenterY$1(alignIn)+offsetY),gameObject},GetCenterY=DOMElement_1,GetRight$2=DynamicBitmapText_1,SetCenterY=Extern_1,SetRight$1=Composites_1,UppercaseFirst_1=function(gameObject,alignIn,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetRight$1(gameObject,GetRight$2(alignIn)+offsetX),SetCenterY(gameObject,GetCenterY(alignIn)+offsetY),gameObject},GetCenterX=Centroid_1,GetTop$3=BaseSound_1,SetCenterX=HTML5AudioSoundManager_1,SetTop$2=NoAudioSound_1,GetTileToWorldXFunction_1=function(gameObject,alignIn,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetCenterX(gameObject,GetCenterX(alignIn)+offsetX),SetTop$2(gameObject,GetTop$3(alignIn)-offsetY),gameObject},GetLeft$1=BaseSoundManager_1,GetTop$2=BaseSound_1,SetLeft=GetTextSize_1,SetTop$1=NoAudioSound_1,HexagonalTileToWorldXY_1=function(gameObject,alignIn,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetLeft(gameObject,GetLeft$1(alignIn)-offsetX),SetTop$1(gameObject,GetTop$2(alignIn)-offsetY),gameObject},GetRight$1=DynamicBitmapText_1,GetTop$1=BaseSound_1,SetRight=Composites_1,SetTop=NoAudioSound_1,Clone_1$7=function(gameObject,alignIn,offsetX,offsetY){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),SetRight(gameObject,GetRight$1(alignIn)+offsetX),SetTop(gameObject,GetTop$1(alignIn)-offsetY),gameObject},curves=_const$d,AlignInMap=[];AlignInMap[curves.BOTTOM_CENTER]=GetTilesWithinShape_1,AlignInMap[curves.BOTTOM_LEFT]=GetTweens_1,AlignInMap[curves.BOTTOM_RIGHT]=RenderTexture_1,AlignInMap[curves.CENTER]=ParseObject_1,AlignInMap[curves.LEFT_CENTER]=GetTileToWorldXYFunction_1,AlignInMap[curves.RIGHT_CENTER]=UppercaseFirst_1,AlignInMap[curves.TOP_CENTER]=GetTileToWorldXFunction_1,AlignInMap[curves.TOP_LEFT]=HexagonalTileToWorldXY_1,AlignInMap[curves.TOP_RIGHT]=Clone_1$7,AlignInMap[curves.LEFT_BOTTOM]=AlignInMap[curves.BOTTOM_LEFT],AlignInMap[curves.LEFT_TOP]=AlignInMap[curves.TOP_LEFT],AlignInMap[curves.RIGHT_BOTTOM]=AlignInMap[curves.BOTTOM_RIGHT],AlignInMap[curves.RIGHT_TOP]=AlignInMap[curves.TOP_RIGHT];function GetFastValue_1(source,key,defaultValue){var t=typeof source;return source&&"number"!=t&&"string"!=t&&source.hasOwnProperty(key)&&void 0!==source[key]?source[key]:defaultValue}var Pairs_1=function(child,alignIn,position,offsetX,offsetY){return AlignInMap[position](child,alignIn,offsetX,offsetY)},gameConfig=function(){};function extend$1(ctor,definition,isClassDescriptor,extend){for(var k in definition)if(definition.hasOwnProperty(k)){var def=function(definition,def,isClassDescriptor){return def=isClassDescriptor?definition[def]:Object.getOwnPropertyDescriptor(definition,def),!(!(def=!isClassDescriptor&&def.value&&"object"==typeof def.value?def.value:def)||!function(def){return def.get&&"function"==typeof def.get||def.set&&"function"==typeof def.set}(def))&&(void 0===def.enumerable&&(def.enumerable=!0),void 0===def.configurable&&(def.configurable=!0),def)}(definition,k,isClassDescriptor);if(!1!==def){if(obj=(extend||ctor).prototype,prop=k,(prop=Object.getOwnPropertyDescriptor(obj,prop))&&!1===(prop=prop.value&&"object"==typeof prop.value?prop.value:prop).configurable){if(Class$3z.ignoreFinals)continue;throw new Error("cannot override final property '"+k+"', set Class.ignoreFinals = true to skip")}Object.defineProperty(ctor.prototype,k,def)}else ctor.prototype[k]=definition[k]}var obj,prop}function mixin(myClass,mixins){if(mixins){Array.isArray(mixins)||(mixins=[mixins]);for(var i=0;i<mixins.length;i++)extend$1(myClass,mixins[i].prototype||mixins[i])}}function Class$3z(definition){var Extends,base,initialize;if((definition=definition||{}).initialize){if("function"!=typeof definition.initialize)throw new Error("initialize must be a function");initialize=definition.initialize,delete definition.initialize}else initialize=definition.Extends?(base=definition.Extends,function(){base.apply(this,arguments)}):function(){};definition.Extends?(initialize.prototype=Object.create(definition.Extends.prototype),initialize.prototype.constructor=initialize,Extends=definition.Extends,delete definition.Extends):initialize.prototype.constructor=initialize;var mixins=null;return definition.Mixins&&(mixins=definition.Mixins,delete definition.Mixins),mixin(initialize,mixins),extend$1(initialize,definition,!0,Extends),initialize}Class$3z.extend=extend$1,Class$3z.mixin=mixin,Class$3z.ignoreFinals=!1;function GetPoint_1$3(rectangle,position,out){if(void 0===out&&(out=new Point$z),position<=0||1<=position)return out.x=rectangle.x,out.y=rectangle.y,out;var p=Perimeter$5(rectangle)*position;return.5<position?(p-=rectangle.width+rectangle.height)<=rectangle.width?(out.x=rectangle.right-p,out.y=rectangle.bottom):(out.x=rectangle.x,out.y=rectangle.bottom-(p-rectangle.width)):p<=rectangle.width?(out.x=rectangle.x+p,out.y=rectangle.y):(out.x=rectangle.right,out.y=rectangle.y+(p-rectangle.width)),out}function GetPoints_1$4(rectangle,quantity,stepRate,out){void 0===out&&(out=[]),!quantity&&0<stepRate&&(quantity=Perimeter$4(rectangle)/stepRate);for(var i=0;i<quantity;i++)out.push(GetPoint$7(rectangle,i/quantity));return out}var Class_1=Class$3z,Bounds_1=function(circle,x,y){return 0<circle.radius&&x>=circle.left&&x<=circle.right&&y>=circle.top&&y<=circle.bottom&&(circle.x-x)*(circle.x-x)+(circle.y-y)*(circle.y-y)<=circle.radius*circle.radius},loader={CIRCLE:0,ELLIPSE:1,LINE:2,POINT:3,POLYGON:4,RECTANGLE:5,TRIANGLE:6},GEOM_CONST$7=loader,JSONFile_1=new Class_1({initialize:function(x,y){void 0===x&&(x=0),void 0===y&&(y=x),this.type=GEOM_CONST$7.POINT,this.x=x,this.y=y},setTo:function(x,y){return void 0===x&&(x=0),void 0===y&&(y=x),this.x=x,this.y=y,this}}),Point$C=JSONFile_1,GetMidPoint_1=function(circle,angle,out){return(out=void 0===out?new Point$C:out).x=circle.x+circle.radius*Math.cos(angle),out.y=circle.y+circle.radius*Math.sin(angle),out},Character=function(value,min,max){return Math.max(min,Math.min(max,value))},Clamp$k=Character,Rope_1=function(percent,min,max){return(max-min)*(percent=Clamp$k(percent,0,1))+min},Tweens={PI2:2*Math.PI,TAU:.5*Math.PI,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,RND:null,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991},CircumferencePoint$4=GetMidPoint_1,FromPercent$3=Rope_1,MATH_CONST$j=Tweens,Point$B=JSONFile_1,CeilAll_1=function(circle,angle,out){void 0===out&&(out=new Point$B);angle=FromPercent$3(angle,0,MATH_CONST$j.PI2);return CircumferencePoint$4(circle,angle,out)},Query_1=function(circle){return Math.PI*circle.radius*2},Circumference$2=Query_1,CircumferencePoint$3=GetMidPoint_1,FromPercent$2=Rope_1,MATH_CONST$i=Tweens,ContainsPoint_1$1=function(circle,quantity,stepRate,out){void 0===out&&(out=[]),!quantity&&0<stepRate&&(quantity=Circumference$2(circle)/stepRate);for(var i=0;i<quantity;i++){var angle=FromPercent$2(i/quantity,0,MATH_CONST$i.PI2);out.push(CircumferencePoint$3(circle,angle))}return out},Point$A=JSONFile_1,GetTilesWithin_1=function(circle,out){void 0===out&&(out=new Point$A);var y=2*Math.PI*Math.random(),x=Math.random()+Math.random(),r=1<x?2-x:x,x=r*Math.cos(y),y=r*Math.sin(y);return out.x=circle.x+x*circle.radius,out.y=circle.y+y*circle.radius,out},Contains$i=Bounds_1,GetPoint$9=CeilAll_1,GetPoints$b=ContainsPoint_1$1,GEOM_CONST$6=loader,Random$e=GetTilesWithin_1,Svg_1=new Class_1({initialize:function(x,y,radius){void 0===x&&(x=0),void 0===y&&(y=0),void 0===radius&&(radius=0),this.type=GEOM_CONST$6.CIRCLE,this.x=x,this.y=y,this._radius=radius,this._diameter=2*radius},contains:function(x,y){return Contains$i(this,x,y)},getPoint:function(position,point){return GetPoint$9(this,position,point)},getPoints:function(quantity,stepRate,output){return GetPoints$b(this,quantity,stepRate,output)},getRandomPoint:function(point){return Random$e(this,point)},setTo:function(x,y,radius){return this.x=x,this.y=y,this._radius=radius,this._diameter=2*radius,this},setEmpty:function(){return this._radius=0,this._diameter=0,this},setPosition:function(x,y){return void 0===y&&(y=x),this.x=x,this.y=y,this},isEmpty:function(){return this._radius<=0},radius:{get:function(){return this._radius},set:function(value){this._radius=value,this._diameter=2*value}},diameter:{get:function(){return this._diameter},set:function(value){this._diameter=value,this._radius=.5*value}},left:{get:function(){return this.x-this._radius},set:function(value){this.x=value+this._radius}},right:{get:function(){return this.x+this._radius},set:function(value){this.x=value-this._radius}},top:{get:function(){return this.y-this._radius},set:function(value){this.y=value+this._radius}},bottom:{get:function(){return this.y+this._radius},set:function(value){this.y=value-this._radius}}}),Clamp$j=Character,Common_1={_alpha:1,_alphaTL:1,_alphaTR:1,_alphaBL:1,_alphaBR:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(topLeft,topRight,bottomLeft,bottomRight){return void 0===topLeft&&(topLeft=1),void 0===topRight?this.alpha=topLeft:(this._alphaTL=Clamp$j(topLeft,0,1),this._alphaTR=Clamp$j(topRight,0,1),this._alphaBL=Clamp$j(bottomLeft,0,1),this._alphaBR=Clamp$j(bottomRight,0,1)),this},alpha:{get:function(){return this._alpha},set:function(v){v=Clamp$j(v,0,1);this._alpha=v,this._alphaTL=v,this._alphaTR=v,this._alphaBL=v,0===(this._alphaBR=v)?this.renderFlags&=-3:this.renderFlags|=2}},alphaTopLeft:{get:function(){return this._alphaTL},set:function(v){v=Clamp$j(v,0,1);0!==(this._alphaTL=v)&&(this.renderFlags|=2)}},alphaTopRight:{get:function(){return this._alphaTR},set:function(v){v=Clamp$j(v,0,1);0!==(this._alphaTR=v)&&(this.renderFlags|=2)}},alphaBottomLeft:{get:function(){return this._alphaBL},set:function(v){v=Clamp$j(v,0,1);0!==(this._alphaBL=v)&&(this.renderFlags|=2)}},alphaBottomRight:{get:function(){return this._alphaBR},set:function(v){v=Clamp$j(v,0,1);0!==(this._alphaBR=v)&&(this.renderFlags|=2)}}},Clamp$i=Character,physics={_alpha:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(value){return this.alpha=value=void 0===value?1:value,this},alpha:{get:function(){return this._alpha},set:function(v){v=Clamp$i(v,0,1);0===(this._alpha=v)?this.renderFlags&=-3:this.renderFlags|=2}}},BlendModes$7=BlendModes$8,MeasureText_1={_blendMode:BlendModes$7.NORMAL,blendMode:{get:function(){return this._blendMode},set:function(value){"string"==typeof value&&(value=BlendModes$7[value]),-1<=(value|=0)&&(this._blendMode=value)}},setBlendMode:function(value){return this.blendMode=value,this}},PathFollower_1={width:0,height:0,displayWidth:{get:function(){return this.scaleX*this.width},set:function(value){this.scaleX=value/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(value){this.scaleY=value/this.height}},setSize:function(width,height){return this.width=width,this.height=height,this},setDisplaySize:function(width,height){return this.displayWidth=width,this.displayHeight=height,this}},TweenManager={texture:null,frame:null,isCropped:!1,setCrop:function(x,y,width,height){return void 0===x?this.isCropped=!1:this.frame&&("number"==typeof x?this.frame.setCropUVs(this._crop,x,y,width,height,this.flipX,this.flipY):this.frame.setCropUVs(this._crop,x.x,x.y,x.width,x.height,this.flipX,this.flipY),this.isCropped=!0),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}},TextStyle_1={_depth:0,depth:{get:function(){return this._depth},set:function(value){this.displayList&&this.displayList.queueDepthSort(),this._depth=value}},setDepth:function(value){return this.depth=value=void 0===value?0:value,this}},data={flipX:!1,flipY:!1,toggleFlipX:function(){return this.flipX=!this.flipX,this},toggleFlipY:function(){return this.flipY=!this.flipY,this},setFlipX:function(value){return this.flipX=value,this},setFlipY:function(value){return this.flipY=value,this},setFlip:function(x,y){return this.flipX=x,this.flipY=y,this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this}},arcade=function(rect,x,y){return!(rect.width<=0||rect.height<=0)&&(rect.x<=x&&rect.x+rect.width>=x&&rect.y<=y&&rect.y+rect.height>=y)},geom=function(rect){return 2*(rect.width+rect.height)},Perimeter$5=geom,Point$z=JSONFile_1,GetPoint$7=GetPoint_1$3,Perimeter$4=geom,Point$y=JSONFile_1,GetSize_1=function(line,position,out){return(out=void 0===out?new Point$y:out).x=line.x1+(line.x2-line.x1)*position,out.y=line.y1+(line.y2-line.y1)*position,out},Grid_1=function(line){return Math.sqrt((line.x2-line.x1)*(line.x2-line.x1)+(line.y2-line.y1)*(line.y2-line.y1))},Length$6=Grid_1,Point$x=JSONFile_1,AudioFile_1=function(line,quantity,stepRate,out){void 0===out&&(out=[]),!quantity&&0<stepRate&&(quantity=Length$6(line)/stepRate);for(var x1=line.x1,y1=line.y1,x2=line.x2,y2=line.y2,i=0;i<quantity;i++){var position=i/quantity;out.push(new Point$x(x1+(x2-x1)*position,y1+(y2-y1)*position))}return out},Point$w=JSONFile_1,Clone_1$1=function(line,out){void 0===out&&(out=new Point$w);var t=Math.random();return out.x=line.x1+t*(line.x2-line.x1),out.y=line.y1+t*(line.y2-line.y1),out},Detector_1=function(a,b,epsilon){return void 0===epsilon&&(epsilon=1e-4),Math.abs(a-b)<epsilon},FuzzyEqual$2=Detector_1,Vector2$U=new Class_1({initialize:function(x,y){this.x=0,this.y=0,"object"==typeof x?(this.x=x.x||0,this.y=x.y||0):(void 0===y&&(y=x),this.x=x||0,this.y=y||0)},clone:function(){return new Vector2$U(this.x,this.y)},copy:function(src){return this.x=src.x||0,this.y=src.y||0,this},setFromObject:function(obj){return this.x=obj.x||0,this.y=obj.y||0,this},set:function(x,y){return void 0===y&&(y=x),this.x=x,this.y=y,this},setTo:function(x,y){return this.set(x,y)},setToPolar:function(azimuth,radius){return null==radius&&(radius=1),this.x=Math.cos(azimuth)*radius,this.y=Math.sin(azimuth)*radius,this},equals:function(v){return this.x===v.x&&this.y===v.y},fuzzyEquals:function(v,epsilon){return FuzzyEqual$2(this.x,v.x,epsilon)&&FuzzyEqual$2(this.y,v.y,epsilon)},angle:function(){var angle=Math.atan2(this.y,this.x);return angle<0&&(angle+=2*Math.PI),angle},setAngle:function(angle){return this.setToPolar(angle,this.length())},add:function(src){return this.x+=src.x,this.y+=src.y,this},subtract:function(src){return this.x-=src.x,this.y-=src.y,this},multiply:function(src){return this.x*=src.x,this.y*=src.y,this},scale:function(value){return isFinite(value)?(this.x*=value,this.y*=value):(this.x=0,this.y=0),this},divide:function(src){return this.x/=src.x,this.y/=src.y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this},distance:function(dy){var dx=dy.x-this.x,dy=dy.y-this.y;return Math.sqrt(dx*dx+dy*dy)},distanceSq:function(dy){var dx=dy.x-this.x,dy=dy.y-this.y;return dx*dx+dy*dy},length:function(){var x=this.x,y=this.y;return Math.sqrt(x*x+y*y)},setLength:function(length){return this.normalize().scale(length)},lengthSq:function(){var x=this.x,y=this.y;return x*x+y*y},normalize:function(){var x=this.x,y=this.y,len=x*x+y*y;return 0<len&&(len=1/Math.sqrt(len),this.x=x*len,this.y=y*len),this},normalizeRightHand:function(){var x=this.x;return this.x=-1*this.y,this.y=x,this},normalizeLeftHand:function(){var x=this.x;return this.x=this.y,this.y=-1*x,this},dot:function(src){return this.x*src.x+this.y*src.y},cross:function(src){return this.x*src.y-this.y*src.x},lerp:function(src,t){var ax=this.x,ay=this.y;return this.x=ax+(t=void 0===t?0:t)*(src.x-ax),this.y=ay+t*(src.y-ay),this},transformMat3:function(m){var x=this.x,y=this.y,m=m.val;return this.x=m[0]*x+m[3]*y+m[6],this.y=m[1]*x+m[4]*y+m[7],this},transformMat4:function(m){var x=this.x,y=this.y,m=m.val;return this.x=m[0]*x+m[4]*y+m[12],this.y=m[1]*x+m[5]*y+m[13],this},reset:function(){return this.x=0,this.y=0,this},limit:function(max){var len=this.length();return len&&max<len&&this.scale(max/len),this},reflect:function(normal){return normal=normal.clone().normalize(),this.subtract(normal.scale(2*this.dot(normal)))},mirror:function(axis){return this.reflect(axis).negate()},rotate:function(sin){var cos=Math.cos(sin),sin=Math.sin(sin);return this.set(cos*this.x-sin*this.y,sin*this.x+cos*this.y)}});Vector2$U.ZERO=new Vector2$U,Vector2$U.RIGHT=new Vector2$U(1,0),Vector2$U.LEFT=new Vector2$U(-1,0),Vector2$U.UP=new Vector2$U(0,-1),Vector2$U.DOWN=new Vector2$U(0,1),Vector2$U.ONE=new Vector2$U(1,1);function DegToRad_1(degrees){return degrees*CONST$1f.DEG_TO_RAD}function GetBoolean_1(source,key,defaultValue){return source&&source.hasOwnProperty(key)?source[key]:defaultValue}function GetValue_1(source,key,defaultValue){if(source&&"number"!=typeof source){if(source.hasOwnProperty(key))return source[key];if(-1===key.indexOf("."))return defaultValue;for(var keys=key.split("."),parent=source,value=defaultValue,i=0;i<keys.length;i++){if(!parent.hasOwnProperty(keys[i])){value=defaultValue;break}value=parent[keys[i]],parent=parent[keys[i]]}return value}return defaultValue}function SpliceOne_1(array,index){if(!(index>=array.length)){for(var len=array.length-1,item=array[index],i=index;i<len;i++)array[i]=array[i+1];return array.length=len,item}}var BuildTilesetIndex_1=Vector2$U,GetPoint$5=GetSize_1,GetPoints$8=AudioFile_1,GEOM_CONST$5=loader,Random$c=Clone_1$1,Vector2$T=BuildTilesetIndex_1,Floor_1=new Class_1({initialize:function(x1,y1,x2,y2){void 0===x1&&(x1=0),void 0===y1&&(y1=0),void 0===x2&&(x2=0),void 0===y2&&(y2=0),this.type=GEOM_CONST$5.LINE,this.x1=x1,this.y1=y1,this.x2=x2,this.y2=y2},getPoint:function(position,output){return GetPoint$5(this,position,output)},getPoints:function(quantity,stepRate,output){return GetPoints$8(this,quantity,stepRate,output)},getRandomPoint:function(point){return Random$c(this,point)},setTo:function(x1,y1,x2,y2){return void 0===y1&&(y1=0),void 0===x2&&(x2=0),void 0===y2&&(y2=0),this.x1=x1=void 0===x1?0:x1,this.y1=y1,this.x2=x2,this.y2=y2,this},getPointA:function(vec2){return(vec2=void 0===vec2?new Vector2$T:vec2).set(this.x1,this.y1),vec2},getPointB:function(vec2){return(vec2=void 0===vec2?new Vector2$T:vec2).set(this.x2,this.y2),vec2},left:{get:function(){return Math.min(this.x1,this.x2)},set:function(value){this.x1<=this.x2?this.x1=value:this.x2=value}},right:{get:function(){return Math.max(this.x1,this.x2)},set:function(value){this.x1>this.x2?this.x1=value:this.x2=value}},top:{get:function(){return Math.min(this.y1,this.y2)},set:function(value){this.y1<=this.y2?this.y1=value:this.y2=value}},bottom:{get:function(){return Math.max(this.y1,this.y2)},set:function(value){this.y1>this.y2?this.y1=value:this.y2=value}}}),Point$v=JSONFile_1,Axes_1=function(rect,out){return(out=void 0===out?new Point$v:out).x=rect.x+Math.random()*rect.width,out.y=rect.y+Math.random()*rect.height,out},Contains$g=arcade,GetPoint$4=GetPoint_1$3,GetPoints$7=GetPoints_1$4,GEOM_CONST$4=loader,Line$a=Floor_1,Random$a=Axes_1,HasTileAtWorldXY_1=new Class_1({initialize:function(x,y,width,height){void 0===x&&(x=0),void 0===y&&(y=0),void 0===width&&(width=0),void 0===height&&(height=0),this.type=GEOM_CONST$4.RECTANGLE,this.x=x,this.y=y,this.width=width,this.height=height},contains:function(x,y){return Contains$g(this,x,y)},getPoint:function(position,output){return GetPoint$4(this,position,output)},getPoints:function(quantity,stepRate,output){return GetPoints$7(this,quantity,stepRate,output)},getRandomPoint:function(point){return Random$a(this,point)},setTo:function(x,y,width,height){return this.x=x,this.y=y,this.width=width,this.height=height,this},setEmpty:function(){return this.setTo(0,0,0,0)},setPosition:function(x,y){return void 0===y&&(y=x),this.x=x,this.y=y,this},setSize:function(width,height){return void 0===height&&(height=width),this.width=width,this.height=height,this},isEmpty:function(){return this.width<=0||this.height<=0},getLineA:function(line){return(line=void 0===line?new Line$a:line).setTo(this.x,this.y,this.right,this.y),line},getLineB:function(line){return(line=void 0===line?new Line$a:line).setTo(this.right,this.y,this.right,this.bottom),line},getLineC:function(line){return(line=void 0===line?new Line$a:line).setTo(this.right,this.bottom,this.x,this.bottom),line},getLineD:function(line){return(line=void 0===line?new Line$a:line).setTo(this.x,this.bottom,this.x,this.y),line},left:{get:function(){return this.x},set:function(value){value>=this.right?this.width=0:this.width=this.right-value,this.x=value}},right:{get:function(){return this.x+this.width},set:function(value){value<=this.x?this.width=0:this.width=value-this.x}},top:{get:function(){return this.y},set:function(value){value>=this.bottom?this.height=0:this.height=this.bottom-value,this.y=value}},bottom:{get:function(){return this.y+this.height},set:function(value){value<=this.y?this.height=0:this.height=value-this.y}},centerX:{get:function(){return this.x+this.width/2},set:function(value){this.x=value-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(value){this.y=value-this.height/2}}}),ParseTilesets_1=function(point,x,y,ty){var c=Math.cos(ty),s=Math.sin(ty),tx=point.x-x,ty=point.y-y;return point.x=tx*c-ty*s+x,point.y=tx*s+ty*c+y,point},Rectangle$u=HasTileAtWorldXY_1,RotateAround$1=ParseTilesets_1,Vector2$S=BuildTilesetIndex_1,Rotate_1$2={prepareBoundsOutput:function(output,includeParent){return void 0===includeParent&&(includeParent=!1),0!==this.rotation&&RotateAround$1(output,this.x,this.y,this.rotation),includeParent&&this.parentContainer&&this.parentContainer.getBoundsTransformMatrix().transformPoint(output.x,output.y,output),output},getCenter:function(output){return(output=void 0===output?new Vector2$S:output).x=this.x-this.displayWidth*this.originX+this.displayWidth/2,output.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,output},getTopLeft:function(output,includeParent){return(output=output||new Vector2$S).x=this.x-this.displayWidth*this.originX,output.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(output,includeParent)},getTopCenter:function(output,includeParent){return(output=output||new Vector2$S).x=this.x-this.displayWidth*this.originX+this.displayWidth/2,output.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(output,includeParent)},getTopRight:function(output,includeParent){return(output=output||new Vector2$S).x=this.x-this.displayWidth*this.originX+this.displayWidth,output.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(output,includeParent)},getLeftCenter:function(output,includeParent){return(output=output||new Vector2$S).x=this.x-this.displayWidth*this.originX,output.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(output,includeParent)},getRightCenter:function(output,includeParent){return(output=output||new Vector2$S).x=this.x-this.displayWidth*this.originX+this.displayWidth,output.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(output,includeParent)},getBottomLeft:function(output,includeParent){return(output=output||new Vector2$S).x=this.x-this.displayWidth*this.originX,output.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(output,includeParent)},getBottomCenter:function(output,includeParent){return(output=output||new Vector2$S).x=this.x-this.displayWidth*this.originX+this.displayWidth/2,output.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(output,includeParent)},getBottomRight:function(output,includeParent){return(output=output||new Vector2$S).x=this.x-this.displayWidth*this.originX+this.displayWidth,output.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(output,includeParent)},getBounds:function(output){var TLx,TLy,TRx,TRy,BLx,BLy,BRx,BRy;return void 0===output&&(output=new Rectangle$u),BRy=(BRx=(this.parentContainer?(BRy=this.parentContainer.getBoundsTransformMatrix(),this.getTopLeft(output),BRy.transformPoint(output.x,output.y,output),TLx=output.x,TLy=output.y,this.getTopRight(output),BRy.transformPoint(output.x,output.y,output),TRx=output.x,TRy=output.y,this.getBottomLeft(output),BRy.transformPoint(output.x,output.y,output),BLx=output.x,BLy=output.y,this.getBottomRight(output),BRy.transformPoint(output.x,output.y,output)):(this.getTopLeft(output),TLx=output.x,TLy=output.y,this.getTopRight(output),TRx=output.x,TRy=output.y,this.getBottomLeft(output),BLx=output.x,BLy=output.y,this.getBottomRight(output)),output.x),output.y),output.x=Math.min(TLx,TRx,BLx,BRx),output.y=Math.min(TLy,TRy,BLy,BRy),output.width=Math.max(TLx,TRx,BLx,BRx)-output.x,output.height=Math.max(TLy,TRy,BLy,BRy)-output.y,output}},ImageFile_1={BLUR:"blur",BOOT:"boot",CONTEXT_LOST:"contextlost",CONTEXT_RESTORED:"contextrestored",DESTROY:"destroy",FOCUS:"focus",HIDDEN:"hidden",PAUSE:"pause",POST_RENDER:"postrender",POST_STEP:"poststep",PRE_RENDER:"prerender",PRE_STEP:"prestep",READY:"ready",RESUME:"resume",STEP:"step",VISIBLE:"visible"},events={POST_RENDER:"postrender",PRE_RENDER:"prerender",RENDER:"render",RESIZE:"resize"},GameEvents$f=ImageFile_1,RenderEvents=events,HexagonalTileToWorldY_1=new Class_1({initialize:function(scene,renderable){var renderer=scene.sys.renderer;this.renderer=renderer,this.bitmapMask=renderable,this.maskTexture=null,this.mainTexture=null,this.dirty=!0,this.mainFramebuffer=null,this.maskFramebuffer=null,this.invertAlpha=!1,this.isStencil=!1,this.createMask(),scene.sys.game.events.on(GameEvents$f.CONTEXT_RESTORED,this.createMask,this),renderer&&renderer.on(RenderEvents.RESIZE,this.createMask,this)},createMask:function(){var width,height,gl,wrap,filter,renderer=this.renderer;renderer&&renderer.gl&&(this.mainTexture&&this.clearMask(),width=renderer.width,height=renderer.height,gl=renderer.gl,wrap=0==(width&width-1)&&0==(height&height-1)?gl.REPEAT:gl.CLAMP_TO_EDGE,filter=gl.LINEAR,this.mainTexture=renderer.createTexture2D(0,filter,filter,wrap,wrap,gl.RGBA,null,width,height),this.maskTexture=renderer.createTexture2D(0,filter,filter,wrap,wrap,gl.RGBA,null,width,height),this.mainFramebuffer=renderer.createFramebuffer(width,height,this.mainTexture,!0),this.maskFramebuffer=renderer.createFramebuffer(width,height,this.maskTexture,!0))},clearMask:function(){var renderer=this.renderer;renderer&&renderer.gl&&this.mainTexture&&(renderer.deleteTexture(this.mainTexture),renderer.deleteTexture(this.maskTexture),renderer.deleteFramebuffer(this.mainFramebuffer),renderer.deleteFramebuffer(this.maskFramebuffer),this.mainTexture=null,this.maskTexture=null,this.mainFramebuffer=null,this.maskFramebuffer=null)},setBitmap:function(renderable){this.bitmapMask=renderable},preRenderWebGL:function(renderer,maskedObject,camera){renderer.pipelines.BITMAPMASK_PIPELINE.beginMask(this,maskedObject,camera)},postRenderWebGL:function(renderer,camera){renderer.pipelines.BITMAPMASK_PIPELINE.endMask(this,camera)},preRenderCanvas:function(){},postRenderCanvas:function(){},destroy:function(){this.clearMask(),this.renderer&&this.renderer.off(RenderEvents.RESIZE,this.createMask,this),this.bitmapMask=null,this.prevFramebuffer=null,this.renderer=null}}),AnimationJSONFile_1=new Class_1({initialize:function(scene,graphicsGeometry){this.geometryMask=graphicsGeometry,this.invertAlpha=!1,this.isStencil=!0,this.level=0},setShape:function(graphicsGeometry){return this.geometryMask=graphicsGeometry,this},setInvertAlpha:function(value){return this.invertAlpha=value=void 0===value?!0:value,this},preRenderWebGL:function(renderer,child,camera){var gl=renderer.gl;renderer.flush(),0===renderer.maskStack.length&&(gl.enable(gl.STENCIL_TEST),gl.clear(gl.STENCIL_BUFFER_BIT),renderer.maskCount=0),renderer.currentCameraMask.mask!==this&&(renderer.currentMask.mask=this),renderer.maskStack.push({mask:this,camera:camera}),this.applyStencil(renderer,camera,!0),renderer.maskCount++},applyStencil:function(renderer,camera,inc){var gl=renderer.gl,geometryMask=this.geometryMask,level=renderer.maskCount;gl.colorMask(!1,!1,!1,!1),inc?(gl.stencilFunc(gl.EQUAL,level,255),gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR)):(gl.stencilFunc(gl.EQUAL,level+1,255),gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR)),geometryMask.renderWebGL(renderer,geometryMask,camera),renderer.flush(),gl.colorMask(!0,!0,!0,!0),gl.stencilOp(gl.KEEP,gl.KEEP,gl.KEEP),inc?this.invertAlpha?gl.stencilFunc(gl.NOTEQUAL,level+1,255):gl.stencilFunc(gl.EQUAL,level+1,255):this.invertAlpha?gl.stencilFunc(gl.NOTEQUAL,level,255):gl.stencilFunc(gl.EQUAL,level,255)},postRenderWebGL:function(renderer){var prev=renderer.gl;renderer.maskStack.pop(),renderer.maskCount--,renderer.flush();var current=renderer.currentMask;0===renderer.maskStack.length?(current.mask=null,prev.disable(prev.STENCIL_TEST)):((prev=renderer.maskStack[renderer.maskStack.length-1]).mask.applyStencil(renderer,prev.camera,!1),renderer.currentCameraMask.mask!==prev.mask?(current.mask=prev.mask,current.camera=prev.camera):current.mask=null)},preRenderCanvas:function(renderer,mask,camera){var geometryMask=this.geometryMask;renderer.currentContext.save(),geometryMask.renderCanvas(renderer,geometryMask,camera,null,null,!0),renderer.currentContext.clip()},postRenderCanvas:function(renderer){renderer.currentContext.restore()},destroy:function(){this.geometryMask=null}}),BitmapMask=HexagonalTileToWorldY_1,GeometryMask=AnimationJSONFile_1,Text_1={mask:null,setMask:function(mask){return this.mask=mask,this},clearMask:function(destroyMask){return(destroyMask=void 0===destroyMask?!1:destroyMask)&&this.mask&&this.mask.destroy(),this.mask=null,this},createBitmapMask:function(renderable){return void 0===renderable&&(this.texture||this.shader)&&(renderable=this),new BitmapMask(this.scene,renderable)},createGeometryMask:function(graphics){return void 0===graphics&&"Graphics"===this.type&&(graphics=this),new GeometryMask(this.scene,graphics)}},GetTileAtWorldXY_1={_originComponent:!0,originX:.5,originY:.5,_displayOriginX:0,_displayOriginY:0,displayOriginX:{get:function(){return this._displayOriginX},set:function(value){this._displayOriginX=value,this.originX=value/this.width}},displayOriginY:{get:function(){return this._displayOriginY},set:function(value){this._displayOriginY=value,this.originY=value/this.height}},setOrigin:function(x,y){return void 0===x&&(x=.5),void 0===y&&(y=x),this.originX=x,this.originY=y,this.updateDisplayOrigin()},setOriginFromFrame:function(){return this.frame&&this.frame.customPivot?(this.originX=this.frame.pivotX,this.originY=this.frame.pivotY,this.updateDisplayOrigin()):this.setOrigin()},setDisplayOrigin:function(x,y){return void 0===x&&(x=0),void 0===y&&(y=x),this.displayOriginX=x,this.displayOriginY=y,this},updateDisplayOrigin:function(){return this._displayOriginX=this.originX*this.width,this._displayOriginY=this.originY*this.height,this}},CONST$1f=Tweens,_const$a={CREATED:0,INIT:1,DELAY:2,OFFSET_DELAY:3,PENDING_RENDER:4,PLAYING_FORWARD:5,PLAYING_BACKWARD:6,HOLD_DELAY:7,REPEAT_DELAY:8,COMPLETE:9,PENDING_ADD:20,PAUSED:21,LOOP_DELAY:22,ACTIVE:23,COMPLETE_DELAY:24,PENDING_REMOVE:25,REMOVED:26},DegToRad$9=DegToRad_1,GetBoolean$3=GetBoolean_1,GetValue$z=GetValue_1,TWEEN_CONST$3=_const$a,Vector2$R=BuildTilesetIndex_1,Resolver_1={path:null,rotateToPath:!1,pathRotationOffset:0,pathOffset:null,pathVector:null,pathDelta:null,pathTween:null,pathConfig:null,_prevDirection:TWEEN_CONST$3.PLAYING_FORWARD,setPath:function(path,config){void 0===config&&(config=this.pathConfig);var tween=this.pathTween;return tween&&tween.isPlaying()&&tween.stop(),this.path=path,config&&this.startFollow(config),this},setRotateToPath:function(value,offset){return void 0===offset&&(offset=0),this.rotateToPath=value,this.pathRotationOffset=offset,this},isFollowing:function(){var tween=this.pathTween;return tween&&tween.isPlaying()},startFollow:function(config,startAt){void 0===config&&(config={}),void 0===startAt&&(startAt=0);var nextPoint=this.pathTween;nextPoint&&nextPoint.isPlaying()&&nextPoint.stop(),(config="number"==typeof config?{duration:config}:config).from=GetValue$z(config,"from",0),config.to=GetValue$z(config,"to",1);nextPoint=GetBoolean$3(config,"positionOnPath",!1);this.rotateToPath=GetBoolean$3(config,"rotateToPath",!1),this.pathRotationOffset=GetValue$z(config,"rotationOffset",0);var seek=GetValue$z(config,"startAt",startAt);return seek&&(config.onStart=function(v){var tweenData=v.data[0];tweenData.progress=seek,tweenData.elapsed=tweenData.duration*seek;v=tweenData.ease(tweenData.progress);tweenData.current=tweenData.start+(tweenData.end-tweenData.start)*v,tweenData.target[tweenData.key]=tweenData.current}),this.pathOffset||(this.pathOffset=new Vector2$R(this.x,this.y)),this.pathVector||(this.pathVector=new Vector2$R),this.pathDelta||(this.pathDelta=new Vector2$R),this.pathDelta.reset(),this.pathTween=this.scene.sys.tweens.addCounter(config),this.path.getStartPoint(this.pathOffset),nextPoint&&(this.x=this.pathOffset.x,this.y=this.pathOffset.y),this.pathOffset.x=this.x-this.pathOffset.x,this.pathOffset.y=this.y-this.pathOffset.y,this._prevDirection=TWEEN_CONST$3.PLAYING_FORWARD,this.rotateToPath&&(nextPoint=this.path.getPoint(.1),this.rotation=Math.atan2(nextPoint.y-this.y,nextPoint.x-this.x)+DegToRad$9(this.pathRotationOffset)),this.pathConfig=config,this},pauseFollow:function(){var tween=this.pathTween;return tween&&tween.isPlaying()&&tween.pause(),this},resumeFollow:function(){var tween=this.pathTween;return tween&&tween.isPaused()&&tween.resume(),this},stopFollow:function(){var tween=this.pathTween;return tween&&tween.isPlaying()&&tween.stop(),this},pathUpdate:function(){var speedX=this.pathTween;if(speedX){var tweenData=speedX.data[0],speedY=this.pathDelta,pathVector=this.pathVector;if(speedY.copy(pathVector).negate(),tweenData.state===TWEEN_CONST$3.COMPLETE)return this.path.getPoint(1,pathVector),speedY.add(pathVector),pathVector.add(this.pathOffset),void this.setPosition(pathVector.x,pathVector.y);tweenData.state!==TWEEN_CONST$3.PLAYING_FORWARD&&tweenData.state!==TWEEN_CONST$3.PLAYING_BACKWARD||(this.path.getPoint(speedX.getValue(),pathVector),speedY.add(pathVector),pathVector.add(this.pathOffset),speedX=this.x,speedY=this.y,this.setPosition(pathVector.x,pathVector.y),speedX=this.x-speedX,speedY=this.y-speedY,0==speedX&&0==speedY||(tweenData.state===this._prevDirection?this.rotateToPath&&(this.rotation=Math.atan2(speedY,speedX)+DegToRad$9(this.pathRotationOffset)):this._prevDirection=tweenData.state))}}},DeepCopy$2=function(inObject){var outObject,value,key;if("object"!=typeof inObject||null===inObject)return inObject;for(key in outObject=Array.isArray(inObject)?[]:{},inObject)value=inObject[key],outObject[key]=DeepCopy$2(value);return outObject},DeepCopy_1=DeepCopy$2,ParseGID_1={BITMAPMASK_PIPELINE:"BitmapMaskPipeline",LIGHT_PIPELINE:"Light2D",POINTLIGHT_PIPELINE:"PointLightPipeline",SINGLE_PIPELINE:"SinglePipeline",MULTI_PIPELINE:"MultiPipeline",ROPE_PIPELINE:"RopePipeline",GRAPHICS_PIPELINE:"GraphicsPipeline",POSTFX_PIPELINE:"PostFXPipeline",UTILITY_PIPELINE:"UtilityPipeline"},DeepCopy$1=DeepCopy_1,PIPELINE_CONST$2=ParseGID_1,SpliceOne$5=SpliceOne_1,MatterCollisionEvents_1={defaultPipeline:null,pipeline:null,hasPostPipeline:!1,postPipelines:null,pipelineData:null,initPipeline:function(instance){void 0===instance&&(instance=PIPELINE_CONST$2.MULTI_PIPELINE);var pipelines=this.scene.sys.renderer;if(!pipelines)return!1;pipelines=pipelines.pipelines;if(this.postPipelines=[],this.pipelineData={},pipelines){instance=pipelines.get(instance);if(instance)return this.defaultPipeline=instance,this.pipeline=instance,!0}return!1},setPipeline:function(instance,pipelineData,copyData){var pipelines=this.scene.sys.renderer;if(!pipelines)return this;pipelines=pipelines.pipelines;return pipelines&&((instance=pipelines.get(instance))&&(this.pipeline=instance),pipelineData&&(this.pipelineData=copyData?DeepCopy$1(pipelineData):pipelineData)),this},setPostPipeline:function(pipelines,pipelineData,copyData){var renderer=this.scene.sys.renderer;if(!renderer)return this;var pipelineManager=renderer.pipelines;if(pipelineManager){Array.isArray(pipelines)||(pipelines=[pipelines]);for(var i=0;i<pipelines.length;i++){var instance=pipelineManager.getPostPipeline(pipelines[i],this);instance&&this.postPipelines.push(instance)}pipelineData&&(this.pipelineData=copyData?DeepCopy$1(pipelineData):pipelineData)}return this.hasPostPipeline=0<this.postPipelines.length,this},setPipelineData:function(key,value){var data=this.pipelineData;return void 0===value?delete data[key]:data[key]=value,this},getPostPipeline:function(pipeline){for(var pipelines=this.postPipelines,results=[],i=0;i<pipelines.length;i++){var instance=pipelines[i];("string"==typeof pipeline&&instance.name===pipeline||instance instanceof pipeline)&&results.push(instance)}return 1===results.length?results[0]:results},resetPipeline:function(resetPostPipelines,resetData){return void 0===resetPostPipelines&&(resetPostPipelines=!1),void 0===resetData&&(resetData=!1),this.pipeline=this.defaultPipeline,resetPostPipelines&&(this.postPipelines=[],this.hasPostPipeline=!1),resetData&&(this.pipelineData={}),null!==this.pipeline},resetPostPipeline:function(resetData){void 0===resetData&&(resetData=!1);for(var pipelines=this.postPipelines,i=0;i<pipelines.length;i++)pipelines[i].destroy();this.postPipelines=[],this.hasPostPipeline=!1,resetData&&(this.pipelineData={})},removePostPipeline:function(pipeline){for(var pipelines=this.postPipelines,i=pipelines.length-1;0<=i;i--){var instance=pipelines[i];("string"==typeof pipeline&&instance.name===pipeline||"string"!=typeof pipeline&&instance instanceof pipeline)&&(instance.destroy(),SpliceOne$5(pipelines,i))}return this.hasPostPipeline=0<this.postPipelines.length,this},getPipelineName:function(){return this.pipeline.name}},AtlasXMLFile_1={scrollFactorX:1,scrollFactorY:1,setScrollFactor:function(x,y){return void 0===y&&(y=x),this.scrollFactorX=x,this.scrollFactorY=y,this}},Inflate_1={_sizeComponent:!0,width:0,height:0,displayWidth:{get:function(){return Math.abs(this.scaleX*this.frame.realWidth)},set:function(value){this.scaleX=value/this.frame.realWidth}},displayHeight:{get:function(){return Math.abs(this.scaleY*this.frame.realHeight)},set:function(value){this.scaleY=value/this.frame.realHeight}},setSizeToFrame:function(frame){return void 0===frame&&(frame=this.frame),this.width=frame.realWidth,this.height=frame.realHeight,this},setSize:function(width,height){return this.width=width,this.height=height,this},setDisplaySize:function(width,height){return this.displayWidth=width,this.displayHeight=height,this}},Base64ToArrayBuffer_1={texture:null,frame:null,isCropped:!1,setTexture:function(key,frame){return this.texture=this.scene.sys.textures.get(key),this.setFrame(frame)},setFrame:function(frame,updateSize,updateOrigin){return void 0===updateSize&&(updateSize=!0),void 0===updateOrigin&&(updateOrigin=!0),this.frame=this.texture.get(frame),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&updateSize&&this.setSizeToFrame(),this._originComponent&&updateOrigin&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this}},HTMLTextureFile_1={texture:null,frame:null,isCropped:!1,setCrop:function(x,y,width,height){return void 0===x?this.isCropped=!1:this.frame&&("number"==typeof x?this.frame.setCropUVs(this._crop,x,y,width,height,this.flipX,this.flipY):this.frame.setCropUVs(this._crop,x.x,x.y,x.width,x.height,this.flipX,this.flipY),this.isCropped=!0),this},setTexture:function(key,frame){return this.texture=this.scene.sys.textures.get(key),this.setFrame(frame)},setFrame:function(frame,updateSize,updateOrigin){return void 0===updateSize&&(updateSize=!0),void 0===updateOrigin&&(updateOrigin=!0),this.frame=this.texture.get(frame),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&updateSize&&this.setSizeToFrame(),this._originComponent&&updateOrigin&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this.isCropped&&this.frame.updateCropUVs(this._crop,this.flipX,this.flipY),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}},Game_1={tintTopLeft:16777215,tintTopRight:16777215,tintBottomLeft:16777215,tintBottomRight:16777215,tintFill:!1,clearTint:function(){return this.setTint(16777215),this},setTint:function(topLeft,topRight,bottomLeft,bottomRight){return void 0===topLeft&&(topLeft=16777215),void 0===topRight&&(bottomRight=bottomLeft=topRight=topLeft),this.tintTopLeft=topLeft,this.tintTopRight=topRight,this.tintBottomLeft=bottomLeft,this.tintBottomRight=bottomRight,this.tintFill=!1,this},setTintFill:function(topLeft,topRight,bottomLeft,bottomRight){return this.setTint(topLeft,topRight,bottomLeft,bottomRight),this.tintFill=!0,this},tint:{set:function(value){this.setTint(value,value,value,value)}},isTinted:{get:function(){return this.tintFill||16777215!==this.tintTopLeft||16777215!==this.tintTopRight||16777215!==this.tintBottomLeft||16777215!==this.tintBottomRight}}},Body_1=function(gameObject){var out={name:gameObject.name,type:gameObject.type,x:gameObject.x,y:gameObject.y,depth:gameObject.depth,scale:{x:gameObject.scaleX,y:gameObject.scaleY},origin:{x:gameObject.originX,y:gameObject.originY},flipX:gameObject.flipX,flipY:gameObject.flipY,rotation:gameObject.rotation,alpha:gameObject.alpha,visible:gameObject.visible,blendMode:gameObject.blendMode,textureKey:"",frameKey:"",data:{}};return gameObject.texture&&(out.textureKey=gameObject.texture.key,out.frameKey=gameObject.frame.name),out},MATH_CONST$h=Tweens,Vector2$Q=BuildTilesetIndex_1,TransformMatrix=new Class_1({initialize:function(a,b,c,d,tx,ty){void 0===a&&(a=1),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=1),void 0===tx&&(tx=0),void 0===ty&&(ty=0),this.matrix=new Float32Array([a,b,c,d,tx,ty,0,0,1]),this.decomposedMatrix={translateX:0,translateY:0,scaleX:1,scaleY:1,rotation:0}},a:{get:function(){return this.matrix[0]},set:function(value){this.matrix[0]=value}},b:{get:function(){return this.matrix[1]},set:function(value){this.matrix[1]=value}},c:{get:function(){return this.matrix[2]},set:function(value){this.matrix[2]=value}},d:{get:function(){return this.matrix[3]},set:function(value){this.matrix[3]=value}},e:{get:function(){return this.matrix[4]},set:function(value){this.matrix[4]=value}},f:{get:function(){return this.matrix[5]},set:function(value){this.matrix[5]=value}},tx:{get:function(){return this.matrix[4]},set:function(value){this.matrix[4]=value}},ty:{get:function(){return this.matrix[5]},set:function(value){this.matrix[5]=value}},rotation:{get:function(){return Math.acos(this.a/this.scaleX)*(Math.atan(-this.c/this.a)<0?-1:1)}},rotationNormalized:{get:function(){var d=this.matrix,a=d[0],b=d[1],c=d[2],d=d[3];return a||b?0<b?Math.acos(a/this.scaleX):-Math.acos(a/this.scaleX):c||d?MATH_CONST$h.TAU-(0<d?Math.acos(-c/this.scaleY):-Math.acos(c/this.scaleY)):0}},scaleX:{get:function(){return Math.sqrt(this.a*this.a+this.b*this.b)}},scaleY:{get:function(){return Math.sqrt(this.c*this.c+this.d*this.d)}},loadIdentity:function(){var matrix=this.matrix;return matrix[0]=1,matrix[1]=0,matrix[2]=0,matrix[3]=1,matrix[4]=0,matrix[5]=0,this},translate:function(x,y){var matrix=this.matrix;return matrix[4]=matrix[0]*x+matrix[2]*y+matrix[4],matrix[5]=matrix[1]*x+matrix[3]*y+matrix[5],this},scale:function(x,y){var matrix=this.matrix;return matrix[0]*=x,matrix[1]*=x,matrix[2]*=y,matrix[3]*=y,this},rotate:function(d){var sin=Math.sin(d),cos=Math.cos(d),matrix=this.matrix,a=matrix[0],b=matrix[1],c=matrix[2],d=matrix[3];return matrix[0]=a*cos+c*sin,matrix[1]=b*cos+d*sin,matrix[2]=a*-sin+c*cos,matrix[3]=b*-sin+d*cos,this},multiply:function(sourceD,destinationMatrix){var sourceE=this.matrix,sourceF=sourceD.matrix,localA=sourceE[0],localB=sourceE[1],localC=sourceE[2],localD=sourceE[3],localE=sourceE[4],localF=sourceE[5],sourceA=sourceF[0],sourceB=sourceF[1],sourceC=sourceF[2],sourceD=sourceF[3],sourceE=sourceF[4],sourceF=sourceF[5],destinationMatrix=void 0===destinationMatrix?this:destinationMatrix;return destinationMatrix.a=sourceA*localA+sourceB*localC,destinationMatrix.b=sourceA*localB+sourceB*localD,destinationMatrix.c=sourceC*localA+sourceD*localC,destinationMatrix.d=sourceC*localB+sourceD*localD,destinationMatrix.e=sourceE*localA+sourceF*localC+localE,destinationMatrix.f=sourceE*localB+sourceF*localD+localF,destinationMatrix},multiplyWithOffset:function(c1,d1,tx1){var matrix=this.matrix,ty1=c1.matrix,a0=matrix[0],b0=matrix[1],c0=matrix[2],d0=matrix[3],pse=d1*a0+tx1*c0+matrix[4],psf=d1*b0+tx1*d0+matrix[5],a1=ty1[0],b1=ty1[1],c1=ty1[2],d1=ty1[3],tx1=ty1[4],ty1=ty1[5];return matrix[0]=a1*a0+b1*c0,matrix[1]=a1*b0+b1*d0,matrix[2]=c1*a0+d1*c0,matrix[3]=c1*b0+d1*d0,matrix[4]=tx1*a0+ty1*c0+pse,matrix[5]=tx1*b0+ty1*d0+psf,this},transform:function(a,b,c,d,tx,ty){var matrix=this.matrix,a0=matrix[0],b0=matrix[1],c0=matrix[2],d0=matrix[3],tx0=matrix[4],ty0=matrix[5];return matrix[0]=a*a0+b*c0,matrix[1]=a*b0+b*d0,matrix[2]=c*a0+d*c0,matrix[3]=c*b0+d*d0,matrix[4]=tx*a0+ty*c0+tx0,matrix[5]=tx*b0+ty*d0+ty0,this},transformPoint:function(x,y,point){var ty=this.matrix,a=ty[0],b=ty[1],c=ty[2],d=ty[3],tx=ty[4],ty=ty[5];return(point=void 0===point?{x:0,y:0}:point).x=x*a+y*c+tx,point.y=x*b+y*d+ty,point},invert:function(){var matrix=this.matrix,a=matrix[0],b=matrix[1],c=matrix[2],d=matrix[3],tx=matrix[4],ty=matrix[5],n=a*d-b*c;return matrix[0]=d/n,matrix[1]=-b/n,matrix[2]=-c/n,matrix[3]=a/n,matrix[4]=(c*ty-d*tx)/n,matrix[5]=-(a*ty-b*tx)/n,this},copyFrom:function(src){var matrix=this.matrix;return matrix[0]=src.a,matrix[1]=src.b,matrix[2]=src.c,matrix[3]=src.d,matrix[4]=src.e,matrix[5]=src.f,this},copyFromArray:function(src){var matrix=this.matrix;return matrix[0]=src[0],matrix[1]=src[1],matrix[2]=src[2],matrix[3]=src[3],matrix[4]=src[4],matrix[5]=src[5],this},copyToContext:function(ctx){var matrix=this.matrix;return ctx.transform(matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5]),ctx},setToContext:function(ctx){var matrix=this.matrix;return ctx.setTransform(matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5]),ctx},copyToArray:function(out){var matrix=this.matrix;return void 0===out?out=[matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5]]:(out[0]=matrix[0],out[1]=matrix[1],out[2]=matrix[2],out[3]=matrix[3],out[4]=matrix[4],out[5]=matrix[5]),out},setTransform:function(a,b,c,d,tx,ty){var matrix=this.matrix;return matrix[0]=a,matrix[1]=b,matrix[2]=c,matrix[3]=d,matrix[4]=tx,matrix[5]=ty,this},decomposeMatrix:function(){var s,decomposedMatrix=this.decomposedMatrix,matrix=this.matrix,a=matrix[0],b=matrix[1],c=matrix[2],d=matrix[3],determ=a*d-b*c;return decomposedMatrix.translateX=matrix[4],decomposedMatrix.translateY=matrix[5],a||b?(s=Math.sqrt(a*a+b*b),decomposedMatrix.rotation=0<b?Math.acos(a/s):-Math.acos(a/s),decomposedMatrix.scaleX=s,decomposedMatrix.scaleY=determ/s):c||d?(s=Math.sqrt(c*c+d*d),decomposedMatrix.rotation=.5*Math.PI-(0<d?Math.acos(-c/s):-Math.acos(c/s)),decomposedMatrix.scaleX=determ/s,decomposedMatrix.scaleY=s):(decomposedMatrix.rotation=0,decomposedMatrix.scaleX=0,decomposedMatrix.scaleY=0),decomposedMatrix},applyITRS:function(x,y,radianCos,scaleX,scaleY){var matrix=this.matrix,radianSin=Math.sin(radianCos),radianCos=Math.cos(radianCos);return matrix[4]=x,matrix[5]=y,matrix[0]=radianCos*scaleX,matrix[1]=radianSin*scaleX,matrix[2]=-radianSin*scaleY,matrix[3]=radianCos*scaleY,this},applyInverse:function(x,y,output){void 0===output&&(output=new Vector2$Q);var id=this.matrix,a=id[0],b=id[1],c=id[2],d=id[3],tx=id[4],ty=id[5],id=1/(a*d+c*-b);return output.x=d*id*x+-c*id*y+(ty*c-tx*d)*id,output.y=a*id*y+-b*id*x+(-ty*a+tx*b)*id,output},getX:function(x,y){return x*this.a+y*this.c+this.e},getY:function(x,y){return x*this.b+y*this.d+this.f},getXRound:function(x,v,round){v=this.getX(x,v);return v=round?Math.round(v):v},getYRound:function(x,v,round){v=this.getY(x,v);return v=round?Math.round(v):v},getCSSMatrix:function(){var m=this.matrix;return"matrix("+m[0]+","+m[1]+","+m[2]+","+m[3]+","+m[4]+","+m[5]+")"},destroy:function(){this.matrix=null,this.decomposedMatrix=null}}),Vector2$P=BuildTilesetIndex_1,Equals_1$1=function(x,y,positionX,positionY,a,b,id,output){void 0===output&&(output=new Vector2$P);var c=Math.sin(a),d=Math.cos(a),a=d*b,b=c*b,c=-c*id,d=d*id,id=1/(a*d+c*-b);return output.x=d*id*x+-c*id*y+(positionY*c-positionX*d)*id,output.y=a*id*y+-b*id*x+(-positionY*a+positionX*b)*id,output},Vector_1=function(value,min,range){range-=min;return min+((value-min)%range+range)%range},MathWrap=Vector_1,HasTileAt_1=function(angle){return MathWrap(angle,-Math.PI,Math.PI)},Wrap$5=Vector_1,Factory_1=function(angle){return Wrap$5(angle,-180,180)},MATH_CONST$g=Tweens,TransformMatrix$f=TransformMatrix,TransformXY$1=Equals_1$1,WrapAngle$1=HasTileAt_1,WrapAngleDegrees$1=Factory_1,Vector2$O=BuildTilesetIndex_1,Pair_1={_scaleX:1,_scaleY:1,_rotation:0,x:0,y:0,z:0,w:0,scale:{get:function(){return(this._scaleX+this._scaleY)/2},set:function(value){this._scaleX=value,0===(this._scaleY=value)?this.renderFlags&=-5:this.renderFlags|=4}},scaleX:{get:function(){return this._scaleX},set:function(value){0===(this._scaleX=value)?this.renderFlags&=-5:this.renderFlags|=4}},scaleY:{get:function(){return this._scaleY},set:function(value){0===(this._scaleY=value)?this.renderFlags&=-5:this.renderFlags|=4}},angle:{get:function(){return WrapAngleDegrees$1(this._rotation*MATH_CONST$g.RAD_TO_DEG)},set:function(value){this.rotation=WrapAngleDegrees$1(value)*MATH_CONST$g.DEG_TO_RAD}},rotation:{get:function(){return this._rotation},set:function(value){this._rotation=WrapAngle$1(value)}},setPosition:function(x,y,z,w){return void 0===x&&(x=0),void 0===y&&(y=x),void 0===z&&(z=0),void 0===w&&(w=0),this.x=x,this.y=y,this.z=z,this.w=w,this},copyPosition:function(source){return void 0!==source.x&&(this.x=source.x),void 0!==source.y&&(this.y=source.y),void 0!==source.z&&(this.z=source.z),void 0!==source.w&&(this.w=source.w),this},setRandomPosition:function(x,y,width,height){return void 0===y&&(y=0),void 0===width&&(width=this.scene.sys.scale.width),void 0===height&&(height=this.scene.sys.scale.height),this.x=(x=void 0===x?0:x)+Math.random()*width,this.y=y+Math.random()*height,this},setRotation:function(radians){return this.rotation=radians=void 0===radians?0:radians,this},setAngle:function(degrees){return this.angle=degrees=void 0===degrees?0:degrees,this},setScale:function(x,y){return void 0===x&&(x=1),void 0===y&&(y=x),this.scaleX=x,this.scaleY=y,this},setX:function(value){return this.x=value=void 0===value?0:value,this},setY:function(value){return this.y=value=void 0===value?0:value,this},setZ:function(value){return this.z=value=void 0===value?0:value,this},setW:function(value){return this.w=value=void 0===value?0:value,this},getLocalTransformMatrix:function(tempMatrix){return(tempMatrix=void 0===tempMatrix?new TransformMatrix$f:tempMatrix).applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY)},getWorldTransformMatrix:function(tempMatrix,parentMatrix){void 0===tempMatrix&&(tempMatrix=new TransformMatrix$f),void 0===parentMatrix&&(parentMatrix=new TransformMatrix$f);var parent=this.parentContainer;if(!parent)return this.getLocalTransformMatrix(tempMatrix);for(tempMatrix.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY);parent;)parentMatrix.applyITRS(parent.x,parent.y,parent._rotation,parent._scaleX,parent._scaleY),parentMatrix.multiply(tempMatrix,tempMatrix),parent=parent.parentContainer;return tempMatrix},getLocalPoint:function(x,y,point,py){point=point||new Vector2$O;var px=(py=py||this.scene.sys.cameras.main).scrollX,py=py.scrollY,px=x+px*this.scrollFactorX-px,py=y+py*this.scrollFactorY-py;return this.parentContainer?this.getWorldTransformMatrix().applyInverse(px,py,point):TransformXY$1(px,py,this.x,this.y,this.rotation,this.scaleX,this.scaleY,point),this._originComponent&&(point.x+=this._displayOriginX,point.y+=this._displayOriginY),point},getParentRotation:function(){for(var rotation=0,parent=this.parentContainer;parent;)rotation+=parent.rotation,parent=parent.parentContainer;return rotation}},Ceil_1={_visible:!0,visible:{get:function(){return this._visible},set:function(value){value?(this._visible=!0,this.renderFlags|=1):(this._visible=!1,this.renderFlags&=-2)}},setVisible:function(value){return this.visible=value,this}},components$3={Alpha:Common_1,AlphaSingle:physics,BlendMode:MeasureText_1,ComputedSize:PathFollower_1,Crop:TweenManager,Depth:TextStyle_1,Flip:data,GetBounds:Rotate_1$2,Mask:Text_1,Origin:GetTileAtWorldXY_1,PathFollower:Resolver_1,Pipeline:MatterCollisionEvents_1,ScrollFactor:AtlasXMLFile_1,Size:Inflate_1,Texture:Base64ToArrayBuffer_1,TextureCrop:HTMLTextureFile_1,Tint:Game_1,ToJSON:Body_1,Transform:Pair_1,TransformMatrix:TransformMatrix,Visible:Ceil_1},BitmapText_1={CHANGE_DATA:"changedata",CHANGE_DATA_KEY:"changedata-",DESTROY:"destroy",REMOVE_DATA:"removedata",SET_DATA:"setdata"},Events$T=BitmapText_1,CustomMain=new Class_1({initialize:function(parent,eventEmitter){this.parent=parent,(this.events=eventEmitter)||(this.events=parent.events||parent),this.list={},this.values={},this._frozen=!1,!parent.hasOwnProperty("sys")&&this.events&&this.events.once(Events$T.DESTROY,this.destroy,this)},get:function(key){var list=this.list;if(Array.isArray(key)){for(var output=[],i=0;i<key.length;i++)output.push(list[key[i]]);return output}return list[key]},getAll:function(){var key,results={};for(key in this.list)this.list.hasOwnProperty(key)&&(results[key]=this.list[key]);return results},query:function(search){var key,results={};for(key in this.list)this.list.hasOwnProperty(key)&&key.match(search)&&(results[key]=this.list[key]);return results},set:function(key,data){if(this._frozen)return this;if("string"==typeof key)return this.setValue(key,data);for(var entry in key)this.setValue(entry,key[entry]);return this},inc:function(key,data){if(this._frozen)return this;void 0===data&&(data=1);var value=this.get(key);return this.set(key,(value=void 0===value?0:value)+data),this},toggle:function(key){return this._frozen||this.set(key,!this.get(key)),this},setValue:function(key,data){return this._frozen||(this.has(key)?this.values[key]=data:(list=(_this=this).list,events=this.events,parent=this.parent,Object.defineProperty(this.values,key,{enumerable:!0,configurable:!0,get:function(){return list[key]},set:function(value){var previousValue;_this._frozen||(previousValue=list[key],list[key]=value,events.emit(Events$T.CHANGE_DATA,parent,key,value,previousValue),events.emit(Events$T.CHANGE_DATA_KEY+key,parent,value,previousValue))}}),list[key]=data,events.emit(Events$T.SET_DATA,parent,key,data))),this;var _this,list,events,parent},each:function(callback,context){for(var key,args=[this.parent,null,void 0],i=1;i<arguments.length;i++)args.push(arguments[i]);for(key in this.list)args[1]=key,args[2]=this.list[key],callback.apply(context,args);return this},merge:function(data,overwrite){for(var key in void 0===overwrite&&(overwrite=!0),data)data.hasOwnProperty(key)&&(overwrite||!overwrite&&!this.has(key))&&this.setValue(key,data[key]);return this},remove:function(key){if(this._frozen)return this;if(!Array.isArray(key))return this.removeValue(key);for(var i=0;i<key.length;i++)this.removeValue(key[i]);return this},removeValue:function(key){var data;return this.has(key)&&(data=this.list[key],delete this.list[key],delete this.values[key],this.events.emit(Events$T.REMOVE_DATA,this.parent,key,data)),this},pop:function(key){var data=void 0;return!this._frozen&&this.has(key)&&(data=this.list[key],delete this.list[key],delete this.values[key],this.events.emit(Events$T.REMOVE_DATA,this.parent,key,data)),data},has:function(key){return this.list.hasOwnProperty(key)},setFreeze:function(value){return this._frozen=value,this},reset:function(){for(var key in this.list)delete this.list[key],delete this.values[key];return this._frozen=!1,this},destroy:function(){this.reset(),this.events.off(Events$T.CHANGE_DATA),this.events.off(Events$T.SET_DATA),this.events.off(Events$T.REMOVE_DATA),this.parent=null},freeze:{get:function(){return this._frozen},set:function(value){this._frozen=!!value}},count:{get:function(){var key,i=0;for(key in this.list)void 0!==this.list[key]&&i++;return i}}}),eventemitter3={exports:{}};!function(module){var has=Object.prototype.hasOwnProperty,prefix="~";function Events(){}function EE(fn,context,once){this.fn=fn,this.context=context,this.once=once||!1}function addListener(emitter,evt,fn,context,listener){if("function"!=typeof fn)throw new TypeError("The listener must be a function");listener=new EE(fn,context||emitter,listener),evt=prefix?prefix+evt:evt;return emitter._events[evt]?emitter._events[evt].fn?emitter._events[evt]=[emitter._events[evt],listener]:emitter._events[evt].push(listener):(emitter._events[evt]=listener,emitter._eventsCount++),emitter}function clearEvent(emitter,evt){0==--emitter._eventsCount?emitter._events=new Events:delete emitter._events[evt]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(prefix=!1)),EventEmitter.prototype.eventNames=function(){var events,name,names=[];if(0===this._eventsCount)return names;for(name in events=this._events)has.call(events,name)&&names.push(prefix?name.slice(1):name);return Object.getOwnPropertySymbols?names.concat(Object.getOwnPropertySymbols(events)):names},EventEmitter.prototype.listeners=function(evt){var evt=prefix?prefix+evt:evt,handlers=this._events[evt];if(!handlers)return[];if(handlers.fn)return[handlers.fn];for(var i=0,l=handlers.length,ee=new Array(l);i<l;i++)ee[i]=handlers[i].fn;return ee},EventEmitter.prototype.listenerCount=function(listeners){listeners=prefix?prefix+listeners:listeners,listeners=this._events[listeners];return listeners?listeners.fn?1:listeners.length:0},EventEmitter.prototype.emit=function(event,a1,a2,a3,a4,a5){var evt=prefix?prefix+event:event;if(!this._events[evt])return!1;var args,listeners=this._events[evt],len=arguments.length;if(listeners.fn){switch(listeners.once&&this.removeListener(event,listeners.fn,void 0,!0),len){case 1:return listeners.fn.call(listeners.context),!0;case 2:return listeners.fn.call(listeners.context,a1),!0;case 3:return listeners.fn.call(listeners.context,a1,a2),!0;case 4:return listeners.fn.call(listeners.context,a1,a2,a3),!0;case 5:return listeners.fn.call(listeners.context,a1,a2,a3,a4),!0;case 6:return listeners.fn.call(listeners.context,a1,a2,a3,a4,a5),!0}for(i=1,args=new Array(len-1);i<len;i++)args[i-1]=arguments[i];listeners.fn.apply(listeners.context,args)}else for(var j,length=listeners.length,i=0;i<length;i++)switch(listeners[i].once&&this.removeListener(event,listeners[i].fn,void 0,!0),len){case 1:listeners[i].fn.call(listeners[i].context);break;case 2:listeners[i].fn.call(listeners[i].context,a1);break;case 3:listeners[i].fn.call(listeners[i].context,a1,a2);break;case 4:listeners[i].fn.call(listeners[i].context,a1,a2,a3);break;default:if(!args)for(j=1,args=new Array(len-1);j<len;j++)args[j-1]=arguments[j];listeners[i].fn.apply(listeners[i].context,args)}return!0},EventEmitter.prototype.on=function(event,fn,context){return addListener(this,event,fn,context,!1)},EventEmitter.prototype.once=function(event,fn,context){return addListener(this,event,fn,context,!0)},EventEmitter.prototype.removeListener=function(evt,fn,context,once){evt=prefix?prefix+evt:evt;if(!this._events[evt])return this;if(!fn)return clearEvent(this,evt),this;var listeners=this._events[evt];if(listeners.fn)listeners.fn!==fn||once&&!listeners.once||context&&listeners.context!==context||clearEvent(this,evt);else{for(var i=0,events=[],length=listeners.length;i<length;i++)(listeners[i].fn!==fn||once&&!listeners[i].once||context&&listeners[i].context!==context)&&events.push(listeners[i]);events.length?this._events[evt]=1===events.length?events[0]:events:clearEvent(this,evt)}return this},EventEmitter.prototype.removeAllListeners=function(evt){return evt?(evt=prefix?prefix+evt:evt,this._events[evt]&&clearEvent(this,evt)):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=prefix,module.exports=EventEmitter.EventEmitter=EventEmitter}(eventemitter3);var events$h={ADDED_TO_SCENE:"addedtoscene",DESTROY:"destroy",REMOVED_FROM_SCENE:"removedfromscene",VIDEO_COMPLETE:"complete",VIDEO_CREATED:"created",VIDEO_ERROR:"error",VIDEO_LOOP:"loop",VIDEO_PLAY:"play",VIDEO_SEEKED:"seeked",VIDEO_SEEKING:"seeking",VIDEO_STOP:"stop",VIDEO_TIMEOUT:"timeout",VIDEO_UNLOCKED:"unlocked"},events$g={ADDED_TO_SCENE:"addedtoscene",BOOT:"boot",CREATE:"create",DESTROY:"destroy",PAUSE:"pause",POST_UPDATE:"postupdate",PRE_RENDER:"prerender",PRE_UPDATE:"preupdate",READY:"ready",REMOVED_FROM_SCENE:"removedfromscene",RENDER:"render",RESUME:"resume",SHUTDOWN:"shutdown",SLEEP:"sleep",START:"start",TRANSITION_COMPLETE:"transitioncomplete",TRANSITION_INIT:"transitioninit",TRANSITION_OUT:"transitionout",TRANSITION_START:"transitionstart",TRANSITION_WAKE:"transitionwake",UPDATE:"update",WAKE:"wake"},GetEasedPoints_1=Class_1,ComponentsToJSON$1=Body_1,DataManager$3=CustomMain,EventEmitter$u=eventemitter3.exports,Events$S=events$h,SceneEvents$g=events$g,GameObject$n=new GetEasedPoints_1({Extends:EventEmitter$u,initialize:function(scene,type){EventEmitter$u.call(this),this.scene=scene,this.displayList=null,this.type=type,this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.on(Events$S.ADDED_TO_SCENE,this.addedToScene,this),this.on(Events$S.REMOVED_FROM_SCENE,this.removedFromScene,this),scene.sys.queueDepthSort()},setActive:function(value){return this.active=value,this},setName:function(value){return this.name=value,this},setState:function(value){return this.state=value,this},setDataEnabled:function(){return this.data||(this.data=new DataManager$3(this)),this},setData:function(key,value){return this.data||(this.data=new DataManager$3(this)),this.data.set(key,value),this},incData:function(key,value){return this.data||(this.data=new DataManager$3(this)),this.data.inc(key,value),this},toggleData:function(key){return this.data||(this.data=new DataManager$3(this)),this.data.toggle(key),this},getData:function(key){return this.data||(this.data=new DataManager$3(this)),this.data.get(key)},setInteractive:function(hitArea,hitAreaCallback,dropZone){return this.scene.sys.input.enable(this,hitArea,hitAreaCallback,dropZone),this},disableInteractive:function(){return this.input&&(this.input.enabled=!1),this},removeInteractive:function(){return this.scene.sys.input.clear(this),this.input=void 0,this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return ComponentsToJSON$1(this)},willRender:function(camera){return!(GameObject$n.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&camera.id)},getIndexList:function(){for(var child=this,parent=this.parentContainer,indexes=[];parent&&(indexes.unshift(parent.getIndex(child)),(child=parent).parentContainer);)parent=parent.parentContainer;return this.displayList?indexes.unshift(this.displayList.getIndex(child)):indexes.unshift(this.scene.sys.displayList.getIndex(child)),indexes},addToDisplayList:function(displayList){return void 0===displayList&&(displayList=this.scene.sys.displayList),this.displayList&&this.displayList!==displayList&&this.removeFromDisplayList(),displayList.exists(this)||((this.displayList=displayList).add(this,!0),displayList.queueDepthSort(),this.emit(Events$S.ADDED_TO_SCENE,this,this.scene),displayList.events.emit(SceneEvents$g.ADDED_TO_SCENE,this,this.scene)),this},addToUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.add(this),this},removeFromDisplayList:function(){var displayList=this.displayList||this.scene.sys.displayList;return displayList.exists(this)&&(displayList.remove(this,!0),displayList.queueDepthSort(),this.displayList=null,this.emit(Events$S.REMOVED_FROM_SCENE,this,this.scene),displayList.events.emit(SceneEvents$g.REMOVED_FROM_SCENE,this,this.scene)),this},removeFromUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.remove(this),this},destroy:function(fromScene){this.scene&&!this.ignoreDestroy&&(void 0===fromScene&&(fromScene=!1),this.preDestroy&&this.preDestroy.call(this),this.emit(Events$S.DESTROY,this,fromScene),this.removeAllListeners(),this.postPipelines&&this.resetPostPipeline(!0),this.removeFromDisplayList(),this.removeFromUpdateList(),this.input&&(this.scene.sys.input.clear(this),this.input=void 0),this.data&&(this.data.destroy(),this.data=void 0),this.body&&(this.body.destroy(),this.body=void 0),this.active=!1,this.visible=!1,this.scene=void 0,this.parentContainer=void 0)}});GameObject$n.RENDER_MASK=15;function BresenhamPoints_1(line,stepRate,results){void 0===stepRate&&(stepRate=1),void 0===results&&(results=[]);var x1=Math.round(line.x1),y1=Math.round(line.y1),x2=Math.round(line.x2),y2=Math.round(line.y2),dx=Math.abs(x2-x1),dy=Math.abs(y2-y1),sx=x1<x2?1:-1,sy=y1<y2?1:-1,err=dx-dy;results.push({x:x1,y:y1});for(var i=1;x1!==x2||y1!==y2;){var e2=err<<1;-dy<e2&&(err-=dy,x1+=sx),e2<dx&&(err+=dx,y1+=sy),i%stepRate==0&&results.push({x:x1,y:y1}),i++}return results}function DistanceBetween_1(x1,y1,dx,dy){return dx=x1-dx,dy=y1-dy,Math.sqrt(dx*dx+dy*dy)}function Shuffle_1$2(array){for(var i=array.length-1;0<i;i--){var j=Math.floor(Math.random()*(i+1)),temp=array[i];array[i]=array[j],array[j]=temp}return array}function Pad_1(str,len,pad,dir){var padlen;if(void 0===pad&&(pad=" "),void 0===dir&&(dir=3),(len=void 0===len?0:len)+1>=(str=str.toString()).length)switch(dir){case 1:str=new Array(len+1-str.length).join(pad)+str;break;case 3:var right=Math.ceil((padlen=len-str.length)/2);str=new Array(1+(padlen-right)).join(pad)+str+new Array(right+1).join(pad);break;default:str+=new Array(len+1-str.length).join(pad)}return str}var GameObject_1=GameObject$n,BlendModes$6=BlendModes$8,Circle$6=Svg_1,CircleContains$2=Bounds_1,GameObject$m=GameObject_1,Rectangle$t=HasTileAtWorldXY_1,RectangleContains$4=arcade,gameobjects=new Class_1({Extends:GameObject$m,Mixins:[components$3.Depth,components$3.GetBounds,components$3.Origin,components$3.Transform,components$3.ScrollFactor,components$3.Visible],initialize:function(scene,x,y,width,height){void 0===width&&(width=1),void 0===height&&(height=width),GameObject$m.call(this,scene,"Zone"),this.setPosition(x,y),this.width=width,this.height=height,this.blendMode=BlendModes$6.NORMAL,this.updateDisplayOrigin()},displayWidth:{get:function(){return this.scaleX*this.width},set:function(value){this.scaleX=value/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(value){this.scaleY=value/this.height}},setSize:function(width,height,resizeInput){void 0===resizeInput&&(resizeInput=!0),this.width=width,this.height=height,this.updateDisplayOrigin();var input=this.input;return resizeInput&&input&&!input.customHitArea&&(input.hitArea.width=width,input.hitArea.height=height),this},setDisplaySize:function(width,height){return this.displayWidth=width,this.displayHeight=height,this},setCircleDropZone:function(radius){return this.setDropZone(new Circle$6(0,0,radius),CircleContains$2)},setRectangleDropZone:function(width,height){return this.setDropZone(new Rectangle$t(0,0,width,height),RectangleContains$4)},setDropZone:function(hitArea,hitAreaCallback){return void 0===hitArea?this.setRectangleDropZone(this.width,this.height):this.input||this.setInteractive(hitArea,hitAreaCallback,!0),this},setAlpha:function(){},setBlendMode:function(){},renderCanvas:function(renderer,src,camera){camera.addToRenderList(src)},renderWebGL:function(renderer,src,camera){camera.addToRenderList(src)}}),AlignIn=Pairs_1,CONST$1e=_const$d,GetFastValue$1j=GetFastValue_1,tempZone=new gameobjects({sys:{queueDepthSort:gameConfig,events:{once:gameConfig}}},0,0,1,1),PropertyValueInc$7=scene,PropertyValueInc$6=scene,PropertyValueInc$5=scene,PropertyValueInc$4=scene,GetPoints$6=AudioFile_1,Perimeter$3=geom,Point$u=JSONFile_1,BuildEquilateral_1=function(rect,step,quantity,out){if(void 0===out&&(out=[]),!step&&!quantity)return out;step?quantity=Math.round(Perimeter$3(rect)/step):step=Perimeter$3(rect)/quantity;for(var x=rect.x,y=rect.y,face=0,i=0;i<quantity;i++)switch(out.push(new Point$u(x,y)),face){case 0:(x+=step)>=rect.right&&(face=1,y+=x-rect.right,x=rect.right);break;case 1:(y+=step)>=rect.bottom&&(face=2,x-=y-rect.bottom,y=rect.bottom);break;case 2:(x-=step)<=rect.left&&(face=3,y-=rect.left-x,x=rect.left);break;case 3:(y-=step)<=rect.top&&(face=0,y=rect.top)}return out},AsepriteFile_1=function(array,total){void 0===total&&(total=1);for(var element=null,i=0;i<total;i++)element=array.shift(),array.push(element);return element},GetAspectRatio_1=function(array,total){void 0===total&&(total=1);for(var element=null,i=0;i<total;i++)element=array.pop(),array.unshift(element);return element},MarchingAnts=BuildEquilateral_1,RotateLeft$2=AsepriteFile_1,RotateRight$2=GetAspectRatio_1,BresenhamPoints=BresenhamPoints_1,GetTileAt_1=function(items,key,value,step,index,direction){var i;void 0===step&&(step=0),void 0===index&&(index=0);var t=0,end=items.length;if(1===(direction=void 0===direction?1:direction))for(i=index;i<end;i++)items[i][key]=value+t*step,t++;else for(i=index;0<=i;i--)items[i][key]=value+t*step,t++;return items},Random$9=GetTilesWithin_1,Point$t=JSONFile_1,Equals_1$3=function(ellipse,out){void 0===out&&(out=new Point$t);var p=Math.random()*Math.PI*2,s=Math.sqrt(Math.random());return out.x=ellipse.x+s*Math.cos(p)*ellipse.width/2,out.y=ellipse.y+s*Math.sin(p)*ellipse.height/2,out},Random$7=Equals_1$3,Random$6=Clone_1$1,Random$5=Axes_1,Point$s=JSONFile_1,MatterImage_1=function(triangle,out){void 0===out&&(out=new Point$s);var ux=triangle.x2-triangle.x1,uy=triangle.y2-triangle.y1,vx=triangle.x3-triangle.x1,vy=triangle.y3-triangle.y1,r=Math.random(),s=Math.random();return 1<=r+s&&(r=1-r,s=1-s),out.x=triangle.x1+(ux*r+vx*s),out.y=triangle.y1+(uy*r+vy*s),out},Random$3=MatterImage_1,PropertyValueInc$3=scene,GetWorldToTileXFunction_1=function(point,x,y,t,distance){t+=Math.atan2(point.y-y,point.x-x);return point.x=x+distance*Math.cos(t),point.y=y+distance*Math.sin(t),point},RotateAroundDistance$1=GetWorldToTileXFunction_1,DistanceBetween$7=DistanceBetween_1,MathRotateAroundDistance=GetWorldToTileXFunction_1,PropertyValueInc$2=scene,PropertyValueInc$1=scene,PropertyValueInc=scene,PropertyValueSet$e=GetTileAt_1,PropertyValueSet$d=GetTileAt_1,PropertyValueSet$c=GetTileAt_1,PropertyValueSet$b=GetTileAt_1,PropertyValueSet$a=GetTileAt_1,PropertyValueSet$9=GetTileAt_1,PropertyValueSet$8=GetTileAt_1,PropertyValueSet$7=GetTileAt_1,PropertyValueSet$6=GetTileAt_1,PropertyValueSet$5=GetTileAt_1,PropertyValueSet$4=GetTileAt_1,PropertyValueSet$3=GetTileAt_1,PropertyValueSet$2=GetTileAt_1,PropertyValueSet$1=GetTileAt_1,PropertyValueSet=GetTileAt_1,Vector2$N=BuildTilesetIndex_1,ArrayShuffle=Shuffle_1$2,WebAudioSound_1=function(x,min,max){return(x=Math.max(0,Math.min(1,(x-min)/(max-min))))*x*x*(x*(6*x-15)+10)},MathSmootherStep=WebAudioSound_1,WebAudioSoundManager_1=function(x,min,max){return x<=min?0:max<=x?1:(x=(x-min)/(max-min))*x*(3-2*x)},MathSmoothStep=WebAudioSoundManager_1,Wrap$4=Vector_1,actions={AlignTo:BitmapFontFile_1,Angle:CullTiles_1,Call:textures,GetFirst:dom,GetLast:MatterWrap_1,GridAlign:function(items,options){var widthSet=(options=void 0===options?{}:options).hasOwnProperty("width"),heightSet=options.hasOwnProperty("height"),width=GetFastValue$1j(options,"width",-1),height=GetFastValue$1j(options,"height",-1),cellWidth=GetFastValue$1j(options,"cellWidth",1),cellHeight=GetFastValue$1j(options,"cellHeight",cellWidth),position=GetFastValue$1j(options,"position",CONST$1e.TOP_LEFT),x=GetFastValue$1j(options,"x",0),y=GetFastValue$1j(options,"y",0),cx=0,cy=0,w=width*cellWidth,h=height*cellHeight;tempZone.setPosition(x,y),tempZone.setSize(cellWidth,cellHeight);for(var i=0;i<items.length;i++)if(AlignIn(items[i],tempZone,position),widthSet&&-1===width)tempZone.x+=cellWidth;else if(heightSet&&-1===height)tempZone.y+=cellHeight;else if(heightSet&&!widthSet){if(cy+=cellHeight,tempZone.y+=cellHeight,cy===h&&(cy=0,cx+=cellWidth,tempZone.y=y,tempZone.x+=cellWidth,cx===w))break}else if(cx+=cellWidth,tempZone.x+=cellWidth,cx===w&&(cx=0,cy+=cellHeight,tempZone.x=x,tempZone.y+=cellHeight,cy===h))break;return items},IncAlpha:function(items,value,step,index,direction){return PropertyValueInc$7(items,"alpha",value,step,index,direction)},IncX:function(items,value,step,index,direction){return PropertyValueInc$6(items,"x",value,step,index,direction)},IncXY:function(items,x,y,stepX,stepY,index,direction){return null==y&&(y=x),PropertyValueInc$5(items,"x",x,stepX,index,direction),PropertyValueInc$5(items,"y",y,stepY,index,direction)},IncY:function(items,value,step,index,direction){return PropertyValueInc$4(items,"y",value,step,index,direction)},PlaceOnCircle:function(items,circle,startAngle,endAngle){for(var angle=startAngle=void 0===startAngle?0:startAngle,angleStep=((endAngle=void 0===endAngle?6.28:endAngle)-startAngle)/items.length,i=0;i<items.length;i++)items[i].x=circle.x+circle.radius*Math.cos(angle),items[i].y=circle.y+circle.radius*Math.sin(angle),angle+=angleStep;return items},PlaceOnEllipse:function(items,ellipse,startAngle,endAngle){for(var angle=startAngle=void 0===startAngle?0:startAngle,angleStep=((endAngle=void 0===endAngle?6.28:endAngle)-startAngle)/items.length,a=ellipse.width/2,b=ellipse.height/2,i=0;i<items.length;i++)items[i].x=ellipse.x+a*Math.cos(angle),items[i].y=ellipse.y+b*Math.sin(angle),angle+=angleStep;return items},PlaceOnLine:function(items,line){for(var points=GetPoints$6(line,items.length),i=0;i<items.length;i++){var item=items[i],point=points[i];item.x=point.x,item.y=point.y}return items},PlaceOnRectangle:function(items,rect,shift){void 0===shift&&(shift=0);var points=MarchingAnts(rect,!1,items.length);0<shift?RotateLeft$2(points,shift):shift<0&&RotateRight$2(points,Math.abs(shift));for(var i=0;i<items.length;i++)items[i].x=points[i].x,items[i].y=points[i].y;return items},PlaceOnTriangle:function(items,triangle,p3){var p1=BresenhamPoints({x1:triangle.x1,y1:triangle.y1,x2:triangle.x2,y2:triangle.y2},p3),p2=BresenhamPoints({x1:triangle.x2,y1:triangle.y2,x2:triangle.x3,y2:triangle.y3},p3),p3=BresenhamPoints({x1:triangle.x3,y1:triangle.y3,x2:triangle.x1,y2:triangle.y1},p3);p1.pop(),p2.pop(),p3.pop();for(var step=(p1=p1.concat(p2,p3)).length/items.length,p=0,i=0;i<items.length;i++){var item=items[i],point=p1[Math.floor(p)];item.x=point.x,item.y=point.y,p+=step}return items},PlayAnimation:function(items,key,ignoreIfPlaying){for(var i=0;i<items.length;i++){var gameObject=items[i];gameObject.anims&&gameObject.anims.play(key,ignoreIfPlaying)}return items},PropertyValueInc:scene,PropertyValueSet:GetTileAt_1,RandomCircle:function(items,circle){for(var i=0;i<items.length;i++)Random$9(circle,items[i]);return items},RandomEllipse:function(items,ellipse){for(var i=0;i<items.length;i++)Random$7(ellipse,items[i]);return items},RandomLine:function(items,line){for(var i=0;i<items.length;i++)Random$6(line,items[i]);return items},RandomRectangle:function(items,rect){for(var i=0;i<items.length;i++)Random$5(rect,items[i]);return items},RandomTriangle:function(items,triangle){for(var i=0;i<items.length;i++)Random$3(triangle,items[i]);return items},Rotate:function(items,value,step,index,direction){return PropertyValueInc$3(items,"rotation",value,step,index,direction)},RotateAround:function(items,point,angle){for(var x=point.x,y=point.y,i=0;i<items.length;i++){var item=items[i];RotateAroundDistance$1(item,x,y,angle,Math.max(1,DistanceBetween$7(item.x,item.y,x,y)))}return items},RotateAroundDistance:function(items,point,angle,distance){var x=point.x,y=point.y;if(0===distance)return items;for(var i=0;i<items.length;i++)MathRotateAroundDistance(items[i],x,y,angle,distance);return items},ScaleX:function(items,value,step,index,direction){return PropertyValueInc$2(items,"scaleX",value,step,index,direction)},ScaleXY:function(items,scaleX,scaleY,stepX,stepY,index,direction){return null==scaleY&&(scaleY=scaleX),PropertyValueInc$1(items,"scaleX",scaleX,stepX,index,direction),PropertyValueInc$1(items,"scaleY",scaleY,stepY,index,direction)},ScaleY:function(items,value,step,index,direction){return PropertyValueInc(items,"scaleY",value,step,index,direction)},SetAlpha:function(items,value,step,index,direction){return PropertyValueSet$e(items,"alpha",value,step,index,direction)},SetBlendMode:function(items,value,index,direction){return PropertyValueSet$d(items,"blendMode",value,0,index,direction)},SetDepth:function(items,value,step,index,direction){return PropertyValueSet$c(items,"depth",value,step,index,direction)},SetHitArea:function(items,hitArea,hitAreaCallback){for(var i=0;i<items.length;i++)items[i].setInteractive(hitArea,hitAreaCallback);return items},SetOrigin:function(items,originX,originY,stepX,stepY,index,direction){return null==originY&&(originY=originX),PropertyValueSet$b(items,"originX",originX,stepX,index,direction),PropertyValueSet$b(items,"originY",originY,stepY,index,direction),items.forEach(function(item){item.updateDisplayOrigin()}),items},SetRotation:function(items,value,step,index,direction){return PropertyValueSet$a(items,"rotation",value,step,index,direction)},SetScale:function(items,scaleX,scaleY,stepX,stepY,index,direction){return null==scaleY&&(scaleY=scaleX),PropertyValueSet$9(items,"scaleX",scaleX,stepX,index,direction),PropertyValueSet$9(items,"scaleY",scaleY,stepY,index,direction)},SetScaleX:function(items,value,step,index,direction){return PropertyValueSet$8(items,"scaleX",value,step,index,direction)},SetScaleY:function(items,value,step,index,direction){return PropertyValueSet$7(items,"scaleY",value,step,index,direction)},SetScrollFactor:function(items,scrollFactorX,scrollFactorY,stepX,stepY,index,direction){return null==scrollFactorY&&(scrollFactorY=scrollFactorX),PropertyValueSet$6(items,"scrollFactorX",scrollFactorX,stepX,index,direction),PropertyValueSet$6(items,"scrollFactorY",scrollFactorY,stepY,index,direction)},SetScrollFactorX:function(items,value,step,index,direction){return PropertyValueSet$5(items,"scrollFactorX",value,step,index,direction)},SetScrollFactorY:function(items,value,step,index,direction){return PropertyValueSet$4(items,"scrollFactorY",value,step,index,direction)},SetTint:function(items,topLeft,topRight,bottomLeft,bottomRight){for(var i=0;i<items.length;i++)items[i].setTint(topLeft,topRight,bottomLeft,bottomRight);return items},SetVisible:function(items,value,index,direction){return PropertyValueSet$3(items,"visible",value,0,index,direction)},SetX:function(items,value,step,index,direction){return PropertyValueSet$2(items,"x",value,step,index,direction)},SetXY:function(items,x,y,stepX,stepY,index,direction){return null==y&&(y=x),PropertyValueSet$1(items,"x",x,stepX,index,direction),PropertyValueSet$1(items,"y",y,stepY,index,direction)},SetY:function(items,value,step,index,direction){return PropertyValueSet(items,"y",value,step,index,direction)},ShiftPosition:function(items,x,y,len,output){var cx,cy,cur;if(void 0===len&&(len=0),void 0===output&&(output=new Vector2$N),1<items.length)if(0===len){for(var len=items.length-1,px=items[len].x,py=items[len].y,i=len-1;0<=i;i--)cx=(cur=items[i]).x,cy=cur.y,cur.x=px,cur.y=py,px=cx,py=cy;items[len].x=x,items[len].y=y}else{for(px=items[0].x,py=items[0].y,i=1;i<items.length;i++)cx=(cur=items[i]).x,cy=cur.y,cur.x=px,cur.y=py,px=cx,py=cy;items[0].x=x,items[0].y=y}else px=items[0].x,py=items[0].y,items[0].x=x,items[0].y=y;return output.x=px,output.y=py,output},Shuffle:function(items){return ArrayShuffle(items)},SmootherStep:function(items,property,min,max,inc){void 0===inc&&(inc=!1);var i,step=Math.abs(max-min)/items.length;if(inc)for(i=0;i<items.length;i++)items[i][property]+=MathSmootherStep(i*step,min,max);else for(i=0;i<items.length;i++)items[i][property]=MathSmootherStep(i*step,min,max);return items},SmoothStep:function(items,property,min,max,inc){void 0===inc&&(inc=!1);var i,step=Math.abs(max-min)/items.length;if(inc)for(i=0;i<items.length;i++)items[i][property]+=MathSmoothStep(i*step,min,max);else for(i=0;i<items.length;i++)items[i][property]=MathSmoothStep(i*step,min,max);return items},Spread:function(items,property,min,max,inc){void 0===inc&&(inc=!1);var i,step=Math.abs(max-min)/items.length;if(inc)for(i=0;i<items.length;i++)items[i][property]+=i*step+min;else for(i=0;i<items.length;i++)items[i][property]=i*step+min;return items},ToggleVisible:function(items){for(var i=0;i<items.length;i++)items[i].visible=!items[i].visible;return items},WrapInRectangle:function(items,rect,padding){void 0===padding&&(padding=0);for(var i=0;i<items.length;i++){var item=items[i];item.x=Wrap$4(item.x,rect.left-padding,rect.right+padding),item.y=Wrap$4(item.y,rect.top-padding,rect.bottom+padding)}return items}},CopyFrom_1$1={ADD_ANIMATION:"add",ANIMATION_COMPLETE:"animationcomplete",ANIMATION_COMPLETE_KEY:"animationcomplete-",ANIMATION_REPEAT:"animationrepeat",ANIMATION_RESTART:"animationrestart",ANIMATION_START:"animationstart",ANIMATION_STOP:"animationstop",ANIMATION_UPDATE:"animationupdate",PAUSE_ALL:"pauseall",REMOVE_ANIMATION:"remove",RESUME_ALL:"resumeall"},GetEaseFunction_1=function(value,array,key){if(!array.length)return NaN;if(1===array.length)return array[0];var low,high,i=1;if(key){if(value<array[0][key])return array[0];for(;array[i][key]<value;)i++}else for(;array[i]<value;)i++;return i>array.length&&(i=array.length),key?(low=array[i-1][key],(high=array[i][key])-value<=value-low?array[i]:array[i-1]):(low=array[i-1],(high=array[i])-value<=value-low?high:low)},CenterOn_1$1=new Class_1({initialize:function(textureKey,textureFrame,index,frame,isKeyFrame){void 0===isKeyFrame&&(isKeyFrame=!1),this.textureKey=textureKey,this.textureFrame=textureFrame,this.index=index,this.frame=frame,this.isFirst=!1,this.isLast=!1,this.prevFrame=null,this.nextFrame=null,this.duration=0,this.progress=0,this.isKeyFrame=isKeyFrame},toJSON:function(){return{key:this.textureKey,frame:this.textureFrame,duration:this.duration,keyframe:this.isKeyFrame}},destroy:function(){this.frame=void 0}}),HasAny_1=function(array){var re=/\D/g;return array.sort(function(a,b){return parseInt(a.replace(re,""),10)-parseInt(b.replace(re,""),10)}),array},Clamp$h=Character,Events$R=CopyFrom_1$1,FindClosestInSorted=GetEaseFunction_1,Frame$5=CenterOn_1$1,GetValue$y=GetValue_1,SortByDigits=HasAny_1,ParseCSV_1=new Class_1({initialize:function(manager,key,config){this.manager=manager,this.key=key,this.type="frame",this.frames=this.getFrames(manager.textureManager,GetValue$y(config,"frames",[]),GetValue$y(config,"defaultTextureKey",null),GetValue$y(config,"sortFrames",!0)),this.frameRate=GetValue$y(config,"frameRate",null),this.duration=GetValue$y(config,"duration",null),this.msPerFrame,this.skipMissedFrames=GetValue$y(config,"skipMissedFrames",!0),this.delay=GetValue$y(config,"delay",0),this.repeat=GetValue$y(config,"repeat",0),this.repeatDelay=GetValue$y(config,"repeatDelay",0),this.yoyo=GetValue$y(config,"yoyo",!1),this.showOnStart=GetValue$y(config,"showOnStart",!1),this.hideOnComplete=GetValue$y(config,"hideOnComplete",!1),this.paused=!1,this.calculateDuration(this,this.getTotalFrames(),this.duration,this.frameRate),this.manager.on&&(this.manager.on(Events$R.PAUSE_ALL,this.pause,this),this.manager.on(Events$R.RESUME_ALL,this.resume,this))},getTotalFrames:function(){return this.frames.length},calculateDuration:function(target,totalFrames,duration,frameRate){null===duration&&null===frameRate?(target.frameRate=24,target.duration=24/totalFrames*1e3):duration&&null===frameRate?(target.duration=duration,target.frameRate=totalFrames/(duration/1e3)):(target.frameRate=frameRate,target.duration=totalFrames/frameRate*1e3),target.msPerFrame=1e3/target.frameRate},addFrame:function(config){return this.addFrameAt(this.frames.length,config)},addFrameAt:function(post,pre){var newFrames=this.getFrames(this.manager.textureManager,pre);return 0<newFrames.length&&(0===post?this.frames=newFrames.concat(this.frames):post===this.frames.length?this.frames=this.frames.concat(newFrames):(pre=this.frames.slice(0,post),post=this.frames.slice(post),this.frames=pre.concat(newFrames,post)),this.updateFrameSequence()),this},checkFrame:function(index){return 0<=index&&index<this.frames.length},getFirstTick:function(state){state.accumulator=0,state.nextTick=state.msPerFrame+state.currentFrame.duration},getFrameAt:function(index){return this.frames[index]},getFrames:function(textureManager,frames,defaultTextureKey,sortFrames){void 0===sortFrames&&(sortFrames=!0);var prev,textureKey,frameKeys,out=[],index=1;if("string"==typeof frames&&(textureKey=frames,frameKeys=textureManager.get(textureKey).getFrameNames(),sortFrames&&SortByDigits(frameKeys),frames=[],frameKeys.forEach(function(value){frames.push({key:textureKey,frame:value})})),!Array.isArray(frames)||0===frames.length)return out;for(i=0;i<frames.length;i++){var frame,textureFrame,animationFrame,item=frames[i],key=GetValue$y(item,"key",defaultTextureKey);key&&(frame=GetValue$y(item,"frame",0),textureFrame=textureManager.getFrame(key,frame),(animationFrame=new Frame$5(key,frame,index,textureFrame)).duration=GetValue$y(item,"duration",0),animationFrame.isFirst=!prev,prev&&((prev.nextFrame=animationFrame).prevFrame=prev),out.push(animationFrame),prev=animationFrame,index++)}if(0<out.length){animationFrame.isLast=!0,animationFrame.nextFrame=out[0],out[0].prevFrame=animationFrame;for(var slice=1/(out.length-1),i=0;i<out.length;i++)out[i].progress=i*slice}return out},getNextTick:function(state){state.accumulator-=state.nextTick,state.nextTick=state.msPerFrame+state.currentFrame.duration},getFrameByProgress:function(value){return value=Clamp$h(value,0,1),FindClosestInSorted(value,this.frames,"progress")},nextFrame:function(state){var frame=state.currentFrame;frame.isLast?state.yoyo?this.handleYoyoFrame(state,!1):0<state.repeatCounter?state.inReverse&&state.forward?state.forward=!1:this.repeatAnimation(state):state.complete():this.updateAndGetNextTick(state,frame.nextFrame)},handleYoyoFrame:function(state,frame){if(state.inReverse===!(frame=frame||!1)&&0<state.repeatCounter)return 0!==state.repeatDelay&&!state.pendingRepeat||(state.forward=frame),void this.repeatAnimation(state);state.inReverse===frame||0!==state.repeatCounter?(frame=(state.forward=frame)?state.currentFrame.nextFrame:state.currentFrame.prevFrame,this.updateAndGetNextTick(state,frame)):state.complete()},getLastFrame:function(){return this.frames[this.frames.length-1]},previousFrame:function(state){var frame=state.currentFrame;frame.isFirst?state.yoyo?this.handleYoyoFrame(state,!0):0<state.repeatCounter?(state.inReverse&&!state.forward||(state.forward=!0),this.repeatAnimation(state)):state.complete():this.updateAndGetNextTick(state,frame.prevFrame)},updateAndGetNextTick:function(state,frame){state.setCurrentFrame(frame),this.getNextTick(state)},removeFrame:function(index){index=this.frames.indexOf(index);return-1!==index&&this.removeFrameAt(index),this},removeFrameAt:function(index){return this.frames.splice(index,1),this.updateFrameSequence(),this},repeatAnimation:function(state){if(2===state._pendingStop){if(0===state._pendingStopValue)return state.stop();state._pendingStopValue--}0<state.repeatDelay&&!state.pendingRepeat?(state.pendingRepeat=!0,state.accumulator-=state.nextTick,state.nextTick+=state.repeatDelay):(state.repeatCounter--,state.forward?state.setCurrentFrame(state.currentFrame.nextFrame):state.setCurrentFrame(state.currentFrame.prevFrame),state.isPlaying&&(this.getNextTick(state),state.handleRepeat()))},toJSON:function(){var output={key:this.key,type:this.type,frames:[],frameRate:this.frameRate,duration:this.duration,skipMissedFrames:this.skipMissedFrames,delay:this.delay,repeat:this.repeat,repeatDelay:this.repeatDelay,yoyo:this.yoyo,showOnStart:this.showOnStart,hideOnComplete:this.hideOnComplete};return this.frames.forEach(function(frame){output.frames.push(frame.toJSON())}),output},updateFrameSequence:function(){for(var frame,len=this.frames.length,slice=1/(len-1),i=0;i<len;i++)(frame=this.frames[i]).index=i+1,frame.isFirst=!1,frame.isLast=!1,frame.progress=i*slice,0===i?(frame.isFirst=!0,1===len?(frame.isLast=!0,(frame.nextFrame=frame).prevFrame=frame):(frame.isLast=!1,frame.prevFrame=this.frames[len-1],frame.nextFrame=this.frames[i+1])):i===len-1&&1<len?(frame.isLast=!0,frame.prevFrame=this.frames[len-2],frame.nextFrame=this.frames[0]):1<len&&(frame.prevFrame=this.frames[i-1],frame.nextFrame=this.frames[i+1]);return this},pause:function(){return this.paused=!0,this},resume:function(){return this.paused=!1,this},destroy:function(){this.manager.off&&(this.manager.off(Events$R.PAUSE_ALL,this.pause,this),this.manager.off(Events$R.RESUME_ALL,this.resume,this)),this.manager.remove(this.key);for(var i=0;i<this.frames.length;i++)this.frames[i].destroy();this.frames=[],this.manager=null}}),GetTileToWorldYFunction_1=new Class_1({initialize:function(elements){if(this.entries={},this.size=0,Array.isArray(elements))for(var i=0;i<elements.length;i++)this.set(elements[i][0],elements[i][1])},set:function(key,value){return this.has(key)||this.size++,this.entries[key]=value,this},get:function(key){if(this.has(key))return this.entries[key]},getArray:function(){var key,output=[],entries=this.entries;for(key in entries)output.push(entries[key]);return output},has:function(key){return this.entries.hasOwnProperty(key)},delete:function(key){return this.has(key)&&(delete this.entries[key],this.size--),this},clear:function(){return Object.keys(this.entries).forEach(function(prop){delete this.entries[prop]},this),this.size=0,this},keys:function(){return Object.keys(this.entries)},values:function(){var key,output=[],entries=this.entries;for(key in entries)output.push(entries[key]);return output},dump:function(){var key,entries=this.entries;for(key in console.group("Map"),entries)console.log(key,entries[key]);console.groupEnd()},each:function(callback){var key,entries=this.entries;for(key in entries)if(!1===callback(key,entries[key]))break;return this},contains:function(value){var key,entries=this.entries;for(key in entries)if(entries[key]===value)return!0;return!1},merge:function(map,override){void 0===override&&(override=!1);var key,local=this.entries,source=map.entries;for(key in source)local.hasOwnProperty(key)&&override?local[key]=source[key]:this.set(key,source[key]);return this}}),GetCenter_1=function(start,end,prefix,suffix){var i,result=[],asString=!1;if((prefix||suffix)&&(asString=!0,prefix=prefix||"",suffix=suffix||""),end<start)for(i=start;end<=i;i--)asString?result.push(prefix+i.toString()+suffix):result.push(i);else for(i=start;i<=end;i++)asString?result.push(prefix+i.toString()+suffix):result.push(i);return result},Animation$1=ParseCSV_1,math=Class_1,CustomMap$3=GetTileToWorldYFunction_1,EventEmitter$t=eventemitter3.exports,Events$Q=CopyFrom_1$1,GameEvents$e=ImageFile_1,GetFastValue$1i=GetFastValue_1,GetValue$x=GetValue_1,Pad$1=Pad_1,NumberArray=GetCenter_1,Angle_1=new math({Extends:EventEmitter$t,initialize:function(game){EventEmitter$t.call(this),this.game=game,this.textureManager=null,this.globalTimeScale=1,this.anims=new CustomMap$3,this.mixes=new CustomMap$3,this.paused=!1,this.name="AnimationManager",game.events.once(GameEvents$e.BOOT,this.boot,this)},boot:function(){this.textureManager=this.game.textures,this.game.events.once(GameEvents$e.DESTROY,this.destroy,this)},addMix:function(keyA,keyB,delay){var mixObj=this.anims,mixes=this.mixes,keyA="string"==typeof keyA?keyA:keyA.key,keyB="string"==typeof keyB?keyB:keyB.key;return mixObj.has(keyA)&&mixObj.has(keyB)&&((mixObj=(mixObj=mixes.get(keyA))||{})[keyB]=delay,mixes.set(keyA,mixObj)),this},removeMix:function(mixObj,keyB){var mixes=this.mixes,keyA="string"==typeof mixObj?mixObj:mixObj.key,mixObj=mixes.get(keyA);return mixObj&&(keyB?(keyB="string"==typeof keyB?keyB:keyB.key,mixObj.hasOwnProperty(keyB)&&delete mixObj[keyB]):mixes.delete(keyA)),this},getMix:function(mixObj,keyB){var mixes=this.mixes,mixObj="string"==typeof mixObj?mixObj:mixObj.key,keyB="string"==typeof keyB?keyB:keyB.key,mixObj=mixes.get(mixObj);return mixObj&&mixObj.hasOwnProperty(keyB)?mixObj[keyB]:0},add:function(key,animation){return this.anims.has(key)?console.warn("Animation key exists: "+key):(animation.key=key,this.anims.set(key,animation),this.emit(Events$Q.ADD_ANIMATION,key,animation)),this},exists:function(key){return this.anims.has(key)},createFromAseprite:function(key,tags){var output=[],data=this.game.cache.json.get(key);if(!data)return output;var _this=this,meta=GetValue$x(data,"meta",null),frames=GetValue$x(data,"frames",null);return meta&&frames&&GetValue$x(meta,"frameTags",[]).forEach(function(result){var animFrames=[],name=GetFastValue$1i(result,"name",null),totalDuration=GetFastValue$1i(result,"from",0),to=GetFastValue$1i(result,"to",0),result=GetFastValue$1i(result,"direction","forward");if(name&&(!tags||tags&&-1<tags.indexOf(name))){for(var tempFrames=[],minDuration=Number.MAX_SAFE_INTEGER,i=totalDuration;i<=to;i++){var frameKey=i.toString(),frameDuration=frames[frameKey];frameDuration&&((frameDuration=GetFastValue$1i(frameDuration,"duration",Number.MAX_SAFE_INTEGER))<minDuration&&(minDuration=frameDuration),tempFrames.push({frame:frameKey,duration:frameDuration}))}tempFrames.forEach(function(entry){animFrames.push({key:key,frame:entry.frame,duration:minDuration-entry.duration})});totalDuration=minDuration*animFrames.length,result={key:name,frames:animFrames="reverse"===result?animFrames.reverse():animFrames,duration:totalDuration,yoyo:"pingpong"===result},result=_this.create(result);result&&output.push(result)}}),output},create:function(config){var key=config.key,anim=!1;return key&&((anim=this.get(key))||(anim=new Animation$1(this,key,config),this.anims.set(key,anim),this.emit(Events$Q.ADD_ANIMATION,key,anim))),anim},fromJSON:function(data,clearCurrentAnimations){(clearCurrentAnimations=void 0===clearCurrentAnimations?!1:clearCurrentAnimations)&&this.anims.clear();var output=[];if((data="string"==typeof data?JSON.parse(data):data).hasOwnProperty("anims")&&Array.isArray(data.anims)){for(var i=0;i<data.anims.length;i++)output.push(this.create(data.anims[i]));data.hasOwnProperty("globalTimeScale")&&(this.globalTimeScale=data.globalTimeScale)}else data.hasOwnProperty("key")&&"frame"===data.type&&output.push(this.create(data));return output},generateFrameNames:function(key,config){var i,prefix=GetValue$x(config,"prefix",""),start=GetValue$x(config,"start",0),end=GetValue$x(config,"end",0),suffix=GetValue$x(config,"suffix",""),zeroPad=GetValue$x(config,"zeroPad",0),out=GetValue$x(config,"outputArray",[]),frames=GetValue$x(config,"frames",!1),texture=this.textureManager.get(key);if(!texture)return out;if(config)for(frames=frames||NumberArray(start,end),i=0;i<frames.length;i++){var frame=prefix+Pad$1(frames[i],zeroPad,"0",1)+suffix;texture.has(frame)?out.push({key:key,frame:frame}):console.warn("generateFrameNames: Frame missing: "+frame+" from texture: "+key)}else for(frames=texture.getFrameNames(),i=0;i<frames.length;i++)out.push({key:key,frame:frames[i]});return out},generateFrameNumbers:function(key,config){var start=GetValue$x(config,"start",0),end=GetValue$x(config,"end",-1),first=GetValue$x(config,"first",!1),out=GetValue$x(config,"outputArray",[]),frames=GetValue$x(config,"frames",!1),texture=this.textureManager.get(key);if(!texture)return out;first&&texture.has(first)&&out.push({key:key,frame:first}),frames||(-1===end&&(end=texture.frameTotal-2),frames=NumberArray(start,end));for(var i=0;i<frames.length;i++)texture.has(frames[i])?out.push({key:key,frame:frames[i]}):console.warn("generateFrameNumbers: Frame "+i+" missing from texture: "+key);return out},get:function(key){return this.anims.get(key)},pauseAll:function(){return this.paused||(this.paused=!0,this.emit(Events$Q.PAUSE_ALL)),this},play:function(key,children){Array.isArray(children)||(children=[children]);for(var i=0;i<children.length;i++)children[i].anims.play(key);return this},staggerPlay:function(key,children,stagger,staggerFirst){void 0===stagger&&(stagger=0),void 0===staggerFirst&&(staggerFirst=!0);var len=(children=!Array.isArray(children)?[children]:children).length;staggerFirst||len--;for(var i=0;i<children.length;i++){var time=stagger<0?Math.abs(stagger)*(len-i):stagger*i;children[i].anims.playAfterDelay(key,time)}return this},remove:function(key){var anim=this.get(key);return anim&&(this.emit(Events$Q.REMOVE_ANIMATION,key,anim),this.anims.delete(key),this.removeMix(key)),anim},resumeAll:function(){return this.paused&&(this.paused=!1,this.emit(Events$Q.RESUME_ALL)),this},toJSON:function(key){var output={anims:[],globalTimeScale:this.globalTimeScale};return void 0!==key&&""!==key?output.anims.push(this.anims.get(key).toJSON()):this.anims.each(function(animationKey,animation){output.anims.push(animation.toJSON())}),output},destroy:function(){this.anims.clear(),this.mixes.clear(),this.textureManager=null,this.game=null}}),CustomMap$2=GetTileToWorldYFunction_1,GetFastValue$1h=GetFastValue_1,Events$P=CopyFrom_1$1,Animation=ParseCSV_1,MatterAttractors_1=new Class_1({initialize:function(parent){this.parent=parent,this.animationManager=parent.scene.sys.anims,this.animationManager.on(Events$P.REMOVE_ANIMATION,this.globalRemove,this),this.textureManager=this.animationManager.textureManager,this.anims=null,this.isPlaying=!1,this.hasStarted=!1,this.currentAnim=null,this.currentFrame=null,this.nextAnim=null,this.nextAnimsQueue=[],this.timeScale=1,this.frameRate=0,this.duration=0,this.msPerFrame=0,this.skipMissedFrames=!0,this.delay=0,this.repeat=0,this.repeatDelay=0,this.yoyo=!1,this.showOnStart=!1,this.hideOnComplete=!1,this.forward=!0,this.inReverse=!1,this.accumulator=0,this.nextTick=0,this.delayCounter=0,this.repeatCounter=0,this.pendingRepeat=!1,this._paused=!1,this._wasPlaying=!1,this._pendingStop=0,this._pendingStopValue},chain:function(key){var parent=this.parent;if(void 0===key)return this.nextAnimsQueue.length=0,this.nextAnim=null,parent;Array.isArray(key)||(key=[key]);for(var i=0;i<key.length;i++){var anim=key[i];null===this.nextAnim?this.nextAnim=anim:this.nextAnimsQueue.push(anim)}return this.parent},getName:function(){return this.currentAnim?this.currentAnim.key:""},getFrameName:function(){return this.currentFrame?this.currentFrame.textureFrame:""},load:function(frame){this.isPlaying&&this.stop();var totalFrames,startFrame,duration=this.animationManager,animKey="string"==typeof frame?frame:GetFastValue$1h(frame,"key",null),anim=(this.exists(animKey)?this:duration).get(animKey);return anim?(totalFrames=(this.currentAnim=anim).getTotalFrames(),startFrame=GetFastValue$1h(frame,"frameRate",anim.frameRate),duration=GetFastValue$1h(frame,"duration",anim.duration),anim.calculateDuration(this,totalFrames,duration,startFrame),this.delay=GetFastValue$1h(frame,"delay",anim.delay),this.repeat=GetFastValue$1h(frame,"repeat",anim.repeat),this.repeatDelay=GetFastValue$1h(frame,"repeatDelay",anim.repeatDelay),this.yoyo=GetFastValue$1h(frame,"yoyo",anim.yoyo),this.showOnStart=GetFastValue$1h(frame,"showOnStart",anim.showOnStart),this.hideOnComplete=GetFastValue$1h(frame,"hideOnComplete",anim.hideOnComplete),this.skipMissedFrames=GetFastValue$1h(frame,"skipMissedFrames",anim.skipMissedFrames),this.timeScale=GetFastValue$1h(frame,"timeScale",this.timeScale),(startFrame=GetFastValue$1h(frame,"startFrame",0))>anim.getTotalFrames()&&(startFrame=0),frame=anim.frames[startFrame],0!==startFrame||this.forward||(frame=anim.getLastFrame()),this.currentFrame=frame):console.warn("Missing animation: "+animKey),this.parent},pause:function(atFrame){return this._paused||(this._paused=!0,this._wasPlaying=this.isPlaying,this.isPlaying=!1),void 0!==atFrame&&this.setCurrentFrame(atFrame),this.parent},resume:function(fromFrame){return this._paused&&(this._paused=!1,this.isPlaying=this._wasPlaying),void 0!==fromFrame&&this.setCurrentFrame(fromFrame),this.parent},playAfterDelay:function(key,delay){var nextAnim,queue;return this.isPlaying?(nextAnim=this.nextAnim,queue=this.nextAnimsQueue,nextAnim&&queue.unshift(nextAnim),this.nextAnim=key,this._pendingStop=1,this._pendingStopValue=delay):(this.delayCounter=delay,this.play(key,!0)),this.parent},playAfterRepeat:function(key,repeatCount){var nextAnim,queue;return void 0===repeatCount&&(repeatCount=1),this.isPlaying?(nextAnim=this.nextAnim,queue=this.nextAnimsQueue,nextAnim&&queue.unshift(nextAnim),-1!==this.repeatCounter&&repeatCount>this.repeatCounter&&(repeatCount=this.repeatCounter),this.nextAnim=key,this._pendingStop=2,this._pendingStopValue=repeatCount):this.play(key),this.parent},play:function(key,ignoreIfPlaying){var mix=this.currentAnim,parent=this.parent,animKey="string"==typeof key?key:key.key;if((ignoreIfPlaying=void 0===ignoreIfPlaying?!1:ignoreIfPlaying)&&this.isPlaying&&mix.key===animKey)return parent;if(mix&&this.isPlaying){mix=this.animationManager.getMix(mix.key,key);if(0<mix)return this.playAfterDelay(key,mix)}return this.forward=!0,this.inReverse=!1,this._paused=!1,this._wasPlaying=!0,this.startAnimation(key)},playReverse:function(key,ignoreIfPlaying){var animKey="string"==typeof key?key:key.key;return(ignoreIfPlaying=void 0===ignoreIfPlaying?!1:ignoreIfPlaying)&&this.isPlaying&&this.currentAnim.key===animKey?this.parent:(this.forward=!1,this.inReverse=!0,this._paused=!1,this._wasPlaying=!0,this.startAnimation(key))},startAnimation:function(gameObject){this.load(gameObject);var anim=this.currentAnim,gameObject=this.parent;return anim&&(this.repeatCounter=-1===this.repeat?Number.MAX_VALUE:this.repeat,anim.getFirstTick(this),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!1,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.delayCounter+=this.delay,0===this.delayCounter&&this.handleStart()),gameObject},handleStart:function(){this.showOnStart&&this.parent.setVisible(!0),this.setCurrentFrame(this.currentFrame),this.hasStarted=!0,this.emitEvents(Events$P.ANIMATION_START)},handleRepeat:function(){this.pendingRepeat=!1,this.emitEvents(Events$P.ANIMATION_REPEAT)},handleStop:function(){this._pendingStop=0,this.isPlaying=!1,this.emitEvents(Events$P.ANIMATION_STOP)},handleComplete:function(){this._pendingStop=0,this.isPlaying=!1,this.hideOnComplete&&this.parent.setVisible(!1),this.emitEvents(Events$P.ANIMATION_COMPLETE,Events$P.ANIMATION_COMPLETE_KEY)},emitEvents:function(event,keyEvent){var anim=this.currentAnim,frame=this.currentFrame,gameObject=this.parent,frameKey=frame.textureFrame;gameObject.emit(event,anim,frame,gameObject,frameKey),keyEvent&&gameObject.emit(keyEvent+anim.key,anim,frame,gameObject,frameKey)},reverse:function(){return this.isPlaying&&(this.inReverse=!this.inReverse,this.forward=!this.forward),this.parent},getProgress:function(){var p=this.currentFrame;if(!p)return 0;p=p.progress;return this.inReverse&&(p*=-1),p},setProgress:function(value){return this.forward||(value=1-value),this.setCurrentFrame(this.currentAnim.getFrameByProgress(value)),this.parent},setRepeat:function(value){return this.repeatCounter=-1===value?Number.MAX_VALUE:value,this.parent},globalRemove:function(key,animation){void 0===animation&&(animation=this.currentAnim),this.isPlaying&&animation.key===this.currentAnim.key&&(this.stop(),this.setCurrentFrame(this.currentAnim.frames[0]))},restart:function(includeDelay,resetRepeats){void 0===includeDelay&&(includeDelay=!1);var anim=this.currentAnim,gameObject=this.parent;return anim?((resetRepeats=void 0===resetRepeats?!1:resetRepeats)&&(this.repeatCounter=-1===this.repeat?Number.MAX_VALUE:this.repeat),anim.getFirstTick(this),this.emitEvents(Events$P.ANIMATION_RESTART),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!includeDelay,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.setCurrentFrame(anim.frames[0]),this.parent):gameObject},complete:function(){var key;return this._pendingStop=0,this.isPlaying=!1,this.currentAnim&&this.handleComplete(),this.nextAnim&&(key=this.nextAnim,this.nextAnim=0<this.nextAnimsQueue.length?this.nextAnimsQueue.shift():null,this.play(key)),this.parent},stop:function(){var key;return this._pendingStop=0,this.isPlaying=!1,this.currentAnim&&this.handleStop(),this.nextAnim&&(key=this.nextAnim,this.nextAnim=this.nextAnimsQueue.shift(),this.play(key)),this.parent},stopAfterDelay:function(delay){return this._pendingStop=1,this._pendingStopValue=delay,this.parent},stopAfterRepeat:function(repeatCount){return void 0===repeatCount&&(repeatCount=1),-1!==this.repeatCounter&&repeatCount>this.repeatCounter&&(repeatCount=this.repeatCounter),this._pendingStop=2,this._pendingStopValue=repeatCount,this.parent},stopOnFrame:function(frame){return this._pendingStop=3,this._pendingStopValue=frame,this.parent},getTotalFrames:function(){return this.currentAnim?this.currentAnim.getTotalFrames():0},update:function(time,delta){var anim=this.currentAnim;if(this.isPlaying&&anim&&!anim.paused){if(this.accumulator+=delta*this.timeScale,1===this._pendingStop&&(this._pendingStopValue-=delta,this._pendingStopValue<=0))return this.stop();if(this.hasStarted){if(this.accumulator>=this.nextTick&&(this.forward?anim.nextFrame(this):anim.previousFrame(this),this.isPlaying&&0===this._pendingStop&&this.skipMissedFrames&&this.accumulator>this.nextTick))for(var safetyNet=0;this.forward?anim.nextFrame(this):anim.previousFrame(this),safetyNet++,this.isPlaying&&this.accumulator>this.nextTick&&safetyNet<60;);}else this.accumulator>=this.delayCounter&&(this.accumulator-=this.delayCounter,this.handleStart())}},setCurrentFrame:function(animationFrame){var gameObject=this.parent;return this.currentFrame=animationFrame,gameObject.texture=animationFrame.frame.texture,gameObject.frame=animationFrame.frame,gameObject.isCropped&&gameObject.frame.updateCropUVs(gameObject._crop,gameObject.flipX,gameObject.flipY),animationFrame.setAlpha&&(gameObject.alpha=animationFrame.alpha),gameObject.setSizeToFrame(),gameObject._originComponent&&(animationFrame.frame.customPivot?gameObject.setOrigin(animationFrame.frame.pivotX,animationFrame.frame.pivotY):gameObject.updateDisplayOrigin()),this.isPlaying&&this.hasStarted&&(this.emitEvents(Events$P.ANIMATION_UPDATE),3===this._pendingStop&&this._pendingStopValue===animationFrame&&this.stop()),gameObject},nextFrame:function(){return this.currentAnim&&this.currentAnim.nextFrame(this),this.parent},previousFrame:function(){return this.currentAnim&&this.currentAnim.previousFrame(this),this.parent},get:function(key){return this.anims?this.anims.get(key):null},exists:function(key){return!!this.anims&&this.anims.has(key)},create:function(config){var key=config.key,anim=!1;return key&&((anim=this.get(key))||(anim=new Animation(this,key,config),this.anims||(this.anims=new CustomMap$2),this.anims.set(key,anim))),anim},generateFrameNames:function(key,config){return this.animationManager.generateFrameNames(key,config)},generateFrameNumbers:function(key,config){return this.animationManager.generateFrameNumbers(key,config)},remove:function(key){var anim=this.get(key);return anim&&(this.currentAnim===anim&&this.stop(),this.anims.delete(key)),anim},destroy:function(){this.animationManager.off(Events$P.REMOVE_ANIMATION,this.globalRemove,this),this.anims&&this.anims.clear(),this.animationManager=null,this.parent=null,this.nextAnim=null,this.nextAnimsQueue.length=0,this.currentAnim=null,this.currentFrame=null},isPaused:{get:function(){return this._paused}}}),animations={Animation:ParseCSV_1,AnimationFrame:CenterOn_1$1,AnimationManager:Angle_1,AnimationState:MatterAttractors_1,Events:CopyFrom_1$1},TweenData_1={ADD:"add",REMOVE:"remove"},ParseObjectLayers_1=Class_1,CustomMap$1=GetTileToWorldYFunction_1,EventEmitter$s=eventemitter3.exports,Events$O=TweenData_1,scale=new ParseObjectLayers_1({initialize:function(){this.entries=new CustomMap$1,this.events=new EventEmitter$s},add:function(key,data){return this.entries.set(key,data),this.events.emit(Events$O.ADD,this,key,data),this},has:function(key){return this.entries.has(key)},exists:function(key){return this.entries.has(key)},get:function(key){return this.entries.get(key)},remove:function(key){var entry=this.get(key);return entry&&(this.entries.delete(key),this.events.emit(Events$O.REMOVE,this,key,entry.data)),this},getKeys:function(){return this.entries.keys()},destroy:function(){this.entries.clear(),this.events.removeAllListeners(),this.entries=null,this.events=null}}),BaseCache=scale,GameEvents$d=ImageFile_1,ContainsRect_1=new Class_1({initialize:function(game){this.game=game,this.binary=new BaseCache,this.bitmapFont=new BaseCache,this.json=new BaseCache,this.physics=new BaseCache,this.shader=new BaseCache,this.audio=new BaseCache,this.video=new BaseCache,this.text=new BaseCache,this.html=new BaseCache,this.obj=new BaseCache,this.tilemap=new BaseCache,this.xml=new BaseCache,this.custom={},this.game.events.once(GameEvents$d.DESTROY,this.destroy,this)},addCustom:function(key){return this.custom.hasOwnProperty(key)||(this.custom[key]=new BaseCache),this.custom[key]},destroy:function(){for(var key,keys=["binary","bitmapFont","json","physics","shader","audio","video","text","html","obj","tilemap","xml"],i=0;i<keys.length;i++)this[keys[i]].destroy(),this[keys[i]]=null;for(key in this.custom)this.custom[key].destroy();this.custom=null,this.game=null}}),cache={BaseCache:scale,CacheManager:ContainsRect_1,Events:TweenData_1},GetValue$w=GetValue_1,HasValue_1=new Class_1({initialize:function(config){this.camera=GetValue$w(config,"camera",null),this.left=GetValue$w(config,"left",null),this.right=GetValue$w(config,"right",null),this.up=GetValue$w(config,"up",null),this.down=GetValue$w(config,"down",null),this.zoomIn=GetValue$w(config,"zoomIn",null),this.zoomOut=GetValue$w(config,"zoomOut",null),this.zoomSpeed=GetValue$w(config,"zoomSpeed",.01),this.minZoom=GetValue$w(config,"minZoom",.001),this.maxZoom=GetValue$w(config,"maxZoom",1e3),this.speedX=0,this.speedY=0;var speed=GetValue$w(config,"speed",null);"number"==typeof speed?(this.speedX=speed,this.speedY=speed):(this.speedX=GetValue$w(config,"speed.x",0),this.speedY=GetValue$w(config,"speed.y",0)),this._zoom=0,this.active=null!==this.camera},start:function(){return this.active=null!==this.camera,this},stop:function(){return this.active=!1,this},setCamera:function(camera){return this.camera=camera,this},update:function(delta){var cam;this.active&&(void 0===delta&&(delta=1),cam=this.camera,this.up&&this.up.isDown?cam.scrollY-=this.speedY*delta|0:this.down&&this.down.isDown&&(cam.scrollY+=this.speedY*delta|0),this.left&&this.left.isDown?cam.scrollX-=this.speedX*delta|0:this.right&&this.right.isDown&&(cam.scrollX+=this.speedX*delta|0),this.zoomIn&&this.zoomIn.isDown?(cam.zoom-=this.zoomSpeed,cam.zoom<this.minZoom&&(cam.zoom=this.minZoom)):this.zoomOut&&this.zoomOut.isDown&&(cam.zoom+=this.zoomSpeed,cam.zoom>this.maxZoom&&(cam.zoom=this.maxZoom)))},destroy:function(){this.camera=null,this.left=null,this.right=null,this.up=null,this.down=null,this.zoomIn=null,this.zoomOut=null}}),GetValue$v=GetValue_1,DisplayList_1={FixedKeyControl:HasValue_1,SmoothedKeyControl:new Class_1({initialize:function(config){this.camera=GetValue$v(config,"camera",null),this.left=GetValue$v(config,"left",null),this.right=GetValue$v(config,"right",null),this.up=GetValue$v(config,"up",null),this.down=GetValue$v(config,"down",null),this.zoomIn=GetValue$v(config,"zoomIn",null),this.zoomOut=GetValue$v(config,"zoomOut",null),this.zoomSpeed=GetValue$v(config,"zoomSpeed",.01),this.minZoom=GetValue$v(config,"minZoom",.001),this.maxZoom=GetValue$v(config,"maxZoom",1e3),this.accelX=0,this.accelY=0;var maxSpeed=GetValue$v(config,"acceleration",null);"number"==typeof maxSpeed?(this.accelX=maxSpeed,this.accelY=maxSpeed):(this.accelX=GetValue$v(config,"acceleration.x",0),this.accelY=GetValue$v(config,"acceleration.y",0)),this.dragX=0,this.dragY=0;maxSpeed=GetValue$v(config,"drag",null);"number"==typeof maxSpeed?(this.dragX=maxSpeed,this.dragY=maxSpeed):(this.dragX=GetValue$v(config,"drag.x",0),this.dragY=GetValue$v(config,"drag.y",0)),this.maxSpeedX=0,this.maxSpeedY=0;maxSpeed=GetValue$v(config,"maxSpeed",null);"number"==typeof maxSpeed?(this.maxSpeedX=maxSpeed,this.maxSpeedY=maxSpeed):(this.maxSpeedX=GetValue$v(config,"maxSpeed.x",0),this.maxSpeedY=GetValue$v(config,"maxSpeed.y",0)),this._speedX=0,this._speedY=0,this._zoom=0,this.active=null!==this.camera},start:function(){return this.active=null!==this.camera,this},stop:function(){return this.active=!1,this},setCamera:function(camera){return this.camera=camera,this},update:function(delta){var cam;this.active&&(void 0===delta&&(delta=1),cam=this.camera,0<this._speedX?(this._speedX-=this.dragX*delta,this._speedX<0&&(this._speedX=0)):this._speedX<0&&(this._speedX+=this.dragX*delta,0<this._speedX&&(this._speedX=0)),0<this._speedY?(this._speedY-=this.dragY*delta,this._speedY<0&&(this._speedY=0)):this._speedY<0&&(this._speedY+=this.dragY*delta,0<this._speedY&&(this._speedY=0)),this.up&&this.up.isDown?(this._speedY+=this.accelY,this._speedY>this.maxSpeedY&&(this._speedY=this.maxSpeedY)):this.down&&this.down.isDown&&(this._speedY-=this.accelY,this._speedY<-this.maxSpeedY&&(this._speedY=-this.maxSpeedY)),this.left&&this.left.isDown?(this._speedX+=this.accelX,this._speedX>this.maxSpeedX&&(this._speedX=this.maxSpeedX)):this.right&&this.right.isDown&&(this._speedX-=this.accelX,this._speedX<-this.maxSpeedX&&(this._speedX=-this.maxSpeedX)),this.zoomIn&&this.zoomIn.isDown?this._zoom=-this.zoomSpeed:this.zoomOut&&this.zoomOut.isDown?this._zoom=this.zoomSpeed:this._zoom=0,0!==this._speedX&&(cam.scrollX-=this._speedX*delta|0),0!==this._speedY&&(cam.scrollY-=this._speedY*delta|0),0!==this._zoom&&(cam.zoom+=this._zoom,cam.zoom<this.minZoom?cam.zoom=this.minZoom:cam.zoom>this.maxZoom&&(cam.zoom=this.maxZoom)))},destroy:function(){this.camera=null,this.left=null,this.right=null,this.up=null,this.down=null,this.zoomIn=null,this.zoomOut=null}})},GetCalcMatrix_1={DESTROY:"cameradestroy",FADE_IN_COMPLETE:"camerafadeincomplete",FADE_IN_START:"camerafadeinstart",FADE_OUT_COMPLETE:"camerafadeoutcomplete",FADE_OUT_START:"camerafadeoutstart",FLASH_COMPLETE:"cameraflashcomplete",FLASH_START:"cameraflashstart",FOLLOW_UPDATE:"followupdate",PAN_COMPLETE:"camerapancomplete",PAN_START:"camerapanstart",POST_RENDER:"postrender",PRE_RENDER:"prerender",ROTATE_COMPLETE:"camerarotatecomplete",ROTATE_START:"camerarotatestart",SHAKE_COMPLETE:"camerashakecomplete",SHAKE_START:"camerashakestart",ZOOM_COMPLETE:"camerazoomcomplete",ZOOM_START:"camerazoomstart"},AssignTileProperties_1=function(red,green,blue){return red<<16|green<<8|blue},SoundManagerCreator_1=function(red,green,blue,alpha){return alpha<<24|red<<16|green<<8|blue},GetColor$3=AssignTileProperties_1;function ConvertValue(n,min,s,v){min=(n+6*min)%6,min=Math.min(min,4-min,1);return Math.round(255*(v-v*s*Math.max(0,min)))}function CenterOn_1$2(rect,x,y){return rect.x=x-rect.width/2,rect.y=y-rect.height/2,rect}var Layer_1=function(h,s,b,out){var r=ConvertValue(5,h,s=void 0===s?1:s,b=void 0===b?1:b),g=ConvertValue(3,h,s,b),b=ConvertValue(1,h,s,b);return out?out.setTo?out.setTo(r,g,b,out.alpha,!1):(out.r=r,out.g=g,out.b=b,out.color=GetColor$3(r,g,b),out):{r:r,g:g,b:b,color:GetColor$3(r,g,b)}},Base64Decode_1=function(r,g,b,out){void 0===out&&(out={h:0,s:0,v:0}),r/=255,g/=255,b/=255;var min=Math.min(r,g,b),max=Math.max(r,g,b),d=max-min,h=0,s=0===max?0:d/max,v=max;return max!==min&&(max===r?h=(g-b)/d+(g<b?6:0):max===g?h=(b-r)/d+2:max===b&&(h=(r-g)/d+4),h/=6),out.hasOwnProperty("_h")?(out._h=h,out._s=s,out._v=v):(out.h=h,out.s=s,out.v=v),out},GetColor$2=AssignTileProperties_1,GetColor32=SoundManagerCreator_1,HSVToRGB$1=Layer_1,RGBToHSV=Base64Decode_1,Color$c=new Class_1({initialize:function(red,green,blue,alpha){void 0===red&&(red=0),void 0===green&&(green=0),void 0===blue&&(blue=0),void 0===alpha&&(alpha=255),this.r=0,this.g=0,this.b=0,this.a=255,this._h=0,this._s=0,this._v=0,this._locked=!1,this.gl=[0,0,0,1],this._color=0,this._color32=0,this._rgba="",this.setTo(red,green,blue,alpha)},transparent:function(){return this._locked=!0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this._locked=!1,this.update(!0)},setTo:function(red,green,blue,alpha,updateHSV){return void 0===alpha&&(alpha=255),void 0===updateHSV&&(updateHSV=!0),this._locked=!0,this.red=red,this.green=green,this.blue=blue,this.alpha=alpha,this._locked=!1,this.update(updateHSV)},setGLTo:function(red,green,blue,alpha){return void 0===alpha&&(alpha=1),this._locked=!0,this.redGL=red,this.greenGL=green,this.blueGL=blue,this.alphaGL=alpha,this._locked=!1,this.update(!0)},setFromRGB:function(color){return this._locked=!0,this.red=color.r,this.green=color.g,this.blue=color.b,color.hasOwnProperty("a")&&(this.alpha=color.a),this._locked=!1,this.update(!0)},setFromHSV:function(h,s,v){return HSVToRGB$1(h,s,v,this)},update:function(updateHSV){if(void 0===updateHSV&&(updateHSV=!1),this._locked)return this;var r=this.r,g=this.g,b=this.b,a=this.a;return this._color=GetColor$2(r,g,b),this._color32=GetColor32(r,g,b,a),this._rgba="rgba("+r+","+g+","+b+","+a/255+")",updateHSV&&RGBToHSV(r,g,b,this),this},updateHSV:function(){var r=this.r,g=this.g,b=this.b;return RGBToHSV(r,g,b,this),this},clone:function(){return new Color$c(this.r,this.g,this.b,this.a)},gray:function(shade){return this.setTo(shade,shade,shade)},random:function(b,max){void 0===b&&(b=0),void 0===max&&(max=255);var r=Math.floor(b+Math.random()*(max-b)),g=Math.floor(b+Math.random()*(max-b)),b=Math.floor(b+Math.random()*(max-b));return this.setTo(r,g,b)},randomGray:function(s,max){void 0===s&&(s=0),void 0===max&&(max=255);s=Math.floor(s+Math.random()*(max-s));return this.setTo(s,s,s)},saturate:function(amount){return this.s+=amount/100,this},desaturate:function(amount){return this.s-=amount/100,this},lighten:function(amount){return this.v+=amount/100,this},darken:function(amount){return this.v-=amount/100,this},brighten:function(amount){var r=this.r,g=this.g,b=this.b,r=Math.max(0,Math.min(255,r-Math.round(-amount/100*255))),g=Math.max(0,Math.min(255,g-Math.round(-amount/100*255))),b=Math.max(0,Math.min(255,b-Math.round(-amount/100*255)));return this.setTo(r,g,b)},color:{get:function(){return this._color}},color32:{get:function(){return this._color32}},rgba:{get:function(){return this._rgba}},redGL:{get:function(){return this.gl[0]},set:function(value){this.gl[0]=Math.min(Math.abs(value),1),this.r=Math.floor(255*this.gl[0]),this.update(!0)}},greenGL:{get:function(){return this.gl[1]},set:function(value){this.gl[1]=Math.min(Math.abs(value),1),this.g=Math.floor(255*this.gl[1]),this.update(!0)}},blueGL:{get:function(){return this.gl[2]},set:function(value){this.gl[2]=Math.min(Math.abs(value),1),this.b=Math.floor(255*this.gl[2]),this.update(!0)}},alphaGL:{get:function(){return this.gl[3]},set:function(value){this.gl[3]=Math.min(Math.abs(value),1),this.a=Math.floor(255*this.gl[3]),this.update()}},red:{get:function(){return this.r},set:function(value){value=Math.floor(Math.abs(value)),this.r=Math.min(value,255),this.gl[0]=value/255,this.update(!0)}},green:{get:function(){return this.g},set:function(value){value=Math.floor(Math.abs(value)),this.g=Math.min(value,255),this.gl[1]=value/255,this.update(!0)}},blue:{get:function(){return this.b},set:function(value){value=Math.floor(Math.abs(value)),this.b=Math.min(value,255),this.gl[2]=value/255,this.update(!0)}},alpha:{get:function(){return this.a},set:function(value){value=Math.floor(Math.abs(value)),this.a=Math.min(value,255),this.gl[3]=value/255,this.update()}},h:{get:function(){return this._h},set:function(value){this._h=value,HSVToRGB$1(value,this._s,this._v,this)}},s:{get:function(){return this._s},set:function(value){this._s=value,HSVToRGB$1(this._h,value,this._v,this)}},v:{get:function(){return this._v},set:function(value){this._v=value,HSVToRGB$1(this._h,this._s,value,this)}}}),Container_1=Color$c,Color$b=Container_1,events$1=function(g){var color=new Color$b;g=g.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(m,r,g,b){return r+r+g+g+b+b});var r,b=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(g);return b&&(r=parseInt(b[1],16),g=parseInt(b[2],16),b=parseInt(b[3],16),color.setTo(r,g,b)),color},GetNewValue_1=function(color){return 16777215<color?{a:color>>>24,r:color>>16&255,g:color>>8&255,b:255&color}:{a:255,r:color>>16&255,g:color>>8&255,b:255&color}},Color$a=Container_1,IntegerToRGB=GetNewValue_1,CopyFrom_1$3=function(rgb){rgb=IntegerToRGB(rgb);return new Color$a(rgb.r,rgb.g,rgb.b,rgb.a)},Color$9=Container_1,CenterOn_1=function(input){return new Color$9(input.r,input.g,input.b,input.a)},Color$8=Container_1,array=function(b){var r,g,color=new Color$8,a=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(b.toLowerCase());return a&&(r=parseInt(a[1],10),g=parseInt(a[2],10),b=parseInt(a[3],10),a=void 0!==a[4]?parseFloat(a[4]):1,color.setTo(r,g,b,255*a)),color},HexStringToColor=events$1,IntegerToColor$1=CopyFrom_1$3,ObjectToColor=CenterOn_1,RGBStringToColor=array,HTMLFile_1=function(input){switch(typeof input){case"string":return("rgb"===input.substr(0,3).toLowerCase()?RGBStringToColor:HexStringToColor)(input);case"number":return IntegerToColor$1(input);case"object":return ObjectToColor(input)}},Remove_1=Class_1,DegToRad$8=DegToRad_1,EventEmitter$r=eventemitter3.exports,Events$N=GetCalcMatrix_1,Rectangle$s=HasTileAtWorldXY_1,TransformMatrix$e=TransformMatrix,ValueToColor$1=HTMLFile_1,Vector2$M=BuildTilesetIndex_1,Composite_1=new Remove_1({Extends:EventEmitter$r,Mixins:[components$3.Alpha,components$3.Visible],initialize:function(x,y,width,height){void 0===x&&(x=0),void 0===y&&(y=0),void 0===width&&(width=0),void 0===height&&(height=0),EventEmitter$r.call(this),this.scene,this.sceneManager,this.scaleManager,this.cameraManager,this.id=0,this.name="",this.roundPixels=!1,this.useBounds=!1,this.worldView=new Rectangle$s,this.dirty=!0,this._x=x,this._y=y,this._width=width,this._height=height,this._bounds=new Rectangle$s,this._scrollX=0,this._scrollY=0,this._zoomX=1,this._zoomY=1,this._rotation=0,this.matrix=new TransformMatrix$e,this.transparent=!0,this.backgroundColor=ValueToColor$1("rgba(0,0,0,0)"),this.disableCull=!1,this.culledObjects=[],this.midPoint=new Vector2$M(width/2,height/2),this.originX=.5,this.originY=.5,this._customViewport=!1,this.mask=null,this._maskCamera=null,this.renderList=[]},addToRenderList:function(child){this.renderList.push(child)},setOrigin:function(x,y){return void 0===x&&(x=.5),void 0===y&&(y=x),this.originX=x,this.originY=y,this},getScroll:function(x,y,out){void 0===out&&(out=new Vector2$M);var originX=.5*this.width,originY=.5*this.height;return out.x=x-originX,out.y=y-originY,this.useBounds&&(out.x=this.clampX(out.x),out.y=this.clampY(out.y)),out},centerOnX:function(x){var originX=.5*this.width;return this.midPoint.x=x,this.scrollX=x-originX,this.useBounds&&(this.scrollX=this.clampX(this.scrollX)),this},centerOnY:function(y){var originY=.5*this.height;return this.midPoint.y=y,this.scrollY=y-originY,this.useBounds&&(this.scrollY=this.clampY(this.scrollY)),this},centerOn:function(x,y){return this.centerOnX(x),this.centerOnY(y),this},centerToBounds:function(){var bounds,originX,originY;return this.useBounds&&(bounds=this._bounds,originX=.5*this.width,originY=.5*this.height,this.midPoint.set(bounds.centerX,bounds.centerY),this.scrollX=bounds.centerX-originX,this.scrollY=bounds.centerY-originY),this},centerToSize:function(){return this.scrollX=.5*this.width,this.scrollY=.5*this.height,this},cull:function(renderableObjects){if(this.disableCull)return renderableObjects;var cameraH=this.matrix.matrix,mva=cameraH[0],mvb=cameraH[1],mvc=cameraH[2],mvd=cameraH[3];if(!(mva*mvd-mvb*mvc))return renderableObjects;for(var mve=cameraH[4],mvf=cameraH[5],scrollX=this.scrollX,scrollY=this.scrollY,cameraW=this.width,cameraH=this.height,cullTop=this.y,cullBottom=cullTop+cameraH,cullLeft=this.x,cullRight=cullLeft+cameraW,culledObjects=this.culledObjects,length=renderableObjects.length,index=culledObjects.length=0;index<length;++index){var objectW,objectH,objectX,objectY,object=renderableObjects[index];object.hasOwnProperty("width")&&!object.parentContainer?(objectW=object.width,objectH=object.height,cullLeft<((objectX=object.x-scrollX*object.scrollFactorX-objectW*object.originX)+objectW)*mva+((objectY=object.y-scrollY*object.scrollFactorY-objectH*object.originY)+objectH)*mvc+mve&&objectX*mva+objectY*mvc+mve<cullRight&&cullTop<(objectX+objectW)*mvb+(objectY+objectH)*mvd+mvf&&objectX*mvb+objectY*mvd+mvf<cullBottom&&culledObjects.push(object)):culledObjects.push(object)}return culledObjects},getWorldPoint:function(x,y,output){void 0===output&&(output=new Vector2$M);var ime=this.matrix.matrix,sy=ime[0],s=ime[1],imf=ime[2],c=ime[3],sx=ime[4],scrollX=ime[5],scrollY=sy*c-s*imf;if(!scrollY)return output.x=x,output.y=y,output;var ima=c*(scrollY=1/scrollY),imb=-s*scrollY,imc=-imf*scrollY,imd=sy*scrollY,ime=(imf*scrollX-c*sx)*scrollY,imf=(s*sx-sy*scrollX)*scrollY,c=Math.cos(this.rotation),s=Math.sin(this.rotation),sx=this.zoomX,sy=this.zoomY,scrollX=this.scrollX,scrollY=this.scrollY,sx=x+(scrollX*c-scrollY*s)*sx,sy=y+(scrollX*s+scrollY*c)*sy;return output.x=sx*ima+sy*imc+ime,output.y=sx*imb+sy*imd+imf,output},ignore:function(entries){var id=this.id;Array.isArray(entries)||(entries=[entries]);for(var i=0;i<entries.length;i++){var entry=entries[i];Array.isArray(entry)?this.ignore(entry):entry.isParent?this.ignore(entry.getChildren()):entry.cameraFilter|=id}return this},preRender:function(){this.renderList.length=0;var displayWidth=this.width,displayHeight=this.height,midX=.5*displayWidth,midY=.5*displayHeight,zoomX=this.zoomX,zoomY=this.zoomY,matrix=this.matrix,originX=displayWidth*this.originX,originY=displayHeight*this.originY,sx=this.scrollX,sy=this.scrollY;this.useBounds&&(sx=this.clampX(sx),sy=this.clampY(sy)),this.roundPixels&&(originX=Math.round(originX),originY=Math.round(originY));midX=(this.scrollX=sx)+midX,midY=(this.scrollY=sy)+midY;this.midPoint.set(midX,midY);displayWidth/=zoomX,displayHeight/=zoomY;this.worldView.setTo(midX-displayWidth/2,midY-displayHeight/2,displayWidth,displayHeight),matrix.applyITRS(this.x+originX,this.y+originY,this.rotation,zoomX,zoomY),matrix.translate(-originX,-originY)},clampX:function(x){var bounds=this._bounds,bw=this.displayWidth,bx=bounds.x+(bw-this.width)/2,bw=Math.max(bx,bx+bounds.width-bw);return x<bx?x=bx:bw<x&&(x=bw),x},clampY:function(y){var bounds=this._bounds,bh=this.displayHeight,by=bounds.y+(bh-this.height)/2,bh=Math.max(by,by+bounds.height-bh);return y<by?y=by:bh<y&&(y=bh),y},removeBounds:function(){return this.useBounds=!1,this.dirty=!0,this._bounds.setEmpty(),this},setAngle:function(value){return this.rotation=DegToRad$8(value=void 0===value?0:value),this},setBackgroundColor:function(color){return this.backgroundColor=ValueToColor$1(color=void 0===color?"rgba(0,0,0,0)":color),this.transparent=0===this.backgroundColor.alpha,this},setBounds:function(x,y,width,height,centerOn){return void 0===centerOn&&(centerOn=!1),this._bounds.setTo(x,y,width,height),this.dirty=!0,this.useBounds=!0,centerOn?this.centerToBounds():(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},getBounds:function(out){void 0===out&&(out=new Rectangle$s);var source=this._bounds;return out.setTo(source.x,source.y,source.width,source.height),out},setName:function(value){return this.name=value=void 0===value?"":value,this},setPosition:function(x,y){return void 0===y&&(y=x),this.x=x,this.y=y,this},setRotation:function(value){return this.rotation=value=void 0===value?0:value,this},setRoundPixels:function(value){return this.roundPixels=value,this},setScene:function(sys){this.scene&&this._customViewport&&this.sceneManager.customViewports--;sys=(this.scene=sys).sys;return this.sceneManager=sys.game.scene,this.scaleManager=sys.scale,this.cameraManager=sys.cameras,this.updateSystem(),this},setScroll:function(x,y){return void 0===y&&(y=x),this.scrollX=x,this.scrollY=y,this},setSize:function(width,height){return void 0===height&&(height=width),this.width=width,this.height=height,this},setViewport:function(x,y,width,height){return this.x=x,this.y=y,this.width=width,this.height=height,this},setZoom:function(x,y){return void 0===x&&(x=1),0===(y=void 0===y?x:y)&&(y=.001),this.zoomX=x=0===x?.001:x,this.zoomY=y,this},setMask:function(mask,fixedPosition){return void 0===fixedPosition&&(fixedPosition=!0),this.mask=mask,this._maskCamera=fixedPosition?this.cameraManager.default:this,this},clearMask:function(destroyMask){return(destroyMask=void 0===destroyMask?!1:destroyMask)&&this.mask&&this.mask.destroy(),this.mask=null,this},toJSON:function(){var output={name:this.name,x:this.x,y:this.y,width:this.width,height:this.height,zoom:this.zoom,rotation:this.rotation,roundPixels:this.roundPixels,scrollX:this.scrollX,scrollY:this.scrollY,backgroundColor:this.backgroundColor.rgba};return this.useBounds&&(output.bounds={x:this._bounds.x,y:this._bounds.y,width:this._bounds.width,height:this._bounds.height}),output},update:function(){},updateSystem:function(){var custom,sceneManager;this.scaleManager&&(custom=0!==this._x||0!==this._y||this.scaleManager.width!==this._width||this.scaleManager.height!==this._height,sceneManager=this.sceneManager,custom&&!this._customViewport?sceneManager.customViewports++:!custom&&this._customViewport&&sceneManager.customViewports--,this.dirty=!0,this._customViewport=custom)},destroy:function(){this.emit(Events$N.DESTROY,this),this.removeAllListeners(),this.matrix.destroy(),this.culledObjects=[],this._customViewport&&this.sceneManager.customViewports--,this.renderList=[],this._bounds=null,this.scene=null,this.scaleManager=null,this.sceneManager=null,this.cameraManager=null},x:{get:function(){return this._x},set:function(value){this._x=value,this.updateSystem()}},y:{get:function(){return this._y},set:function(value){this._y=value,this.updateSystem()}},width:{get:function(){return this._width},set:function(value){this._width=value,this.updateSystem()}},height:{get:function(){return this._height},set:function(value){this._height=value,this.updateSystem()}},scrollX:{get:function(){return this._scrollX},set:function(value){this._scrollX=value,this.dirty=!0}},scrollY:{get:function(){return this._scrollY},set:function(value){this._scrollY=value,this.dirty=!0}},zoom:{get:function(){return(this._zoomX+this._zoomY)/2},set:function(value){this._zoomX=value,this._zoomY=value,this.dirty=!0}},zoomX:{get:function(){return this._zoomX},set:function(value){this._zoomX=value,this.dirty=!0}},zoomY:{get:function(){return this._zoomY},set:function(value){this._zoomY=value,this.dirty=!0}},rotation:{get:function(){return this._rotation},set:function(value){this._rotation=value,this.dirty=!0}},centerX:{get:function(){return this.x+.5*this.width}},centerY:{get:function(){return this.y+.5*this.height}},displayWidth:{get:function(){return this.width/this.zoomX}},displayHeight:{get:function(){return this.height/this.zoomY}}}),Clamp$g=Character,Events$M=GetCalcMatrix_1,Pick_1=new Class_1({initialize:function(camera){this.camera=camera,this.isRunning=!1,this.isComplete=!1,this.direction=!0,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(direction,duration,red,green,blue,force,callback,context){return void 0===direction&&(direction=!0),void 0===duration&&(duration=1e3),void 0===red&&(red=0),void 0===green&&(green=0),void 0===blue&&(blue=0),void 0===callback&&(callback=null),void 0===context&&(context=this.camera.scene),!(force=void 0===force?!1:force)&&this.isRunning||(this.isRunning=!0,this.isComplete=!1,this.duration=duration,this.direction=direction,this.progress=0,this.red=red,this.green=green,this.blue=blue,this.alpha=direction?Number.MIN_VALUE:1,this._elapsed=0,this._onUpdate=callback,this._onUpdateScope=context,this.camera.emit(direction?Events$M.FADE_OUT_START:Events$M.FADE_IN_START,this.camera,this,duration,red,green,blue)),this.camera},update:function(time,delta){this.isRunning&&(this._elapsed+=delta,this.progress=Clamp$g(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this.direction?this.progress:1-this.progress:(this.alpha=this.direction?1:0,this.effectComplete()))},postRenderCanvas:function(ctx){if(!this.isRunning&&!this.isComplete)return!1;var camera=this.camera;return ctx.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",ctx.fillRect(camera.x,camera.y,camera.width,camera.height),!0},postRenderWebGL:function(pipeline,getTintFunction){if(!this.isRunning&&!this.isComplete)return!1;var camera=this.camera,red=this.red/255,green=this.green/255,blue=this.blue/255;return pipeline.drawFillRect(camera.x,camera.y,camera.width,camera.height,getTintFunction(blue,green,red,1),this.alpha),!0},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.isComplete=!0;var eventName=this.direction?Events$M.FADE_OUT_COMPLETE:Events$M.FADE_IN_COMPLETE;this.camera.emit(eventName,this.camera,this)},reset:function(){this.isRunning=!1,this.isComplete=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}}),Clamp$f=Character,Events$L=GetCalcMatrix_1,UpdateList_1=new Class_1({initialize:function(camera){this.camera=camera,this.isRunning=!1,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(duration,red,green,blue,force,callback,context){return void 0===duration&&(duration=250),void 0===red&&(red=255),void 0===green&&(green=255),void 0===blue&&(blue=255),void 0===callback&&(callback=null),void 0===context&&(context=this.camera.scene),!(force=void 0===force?!1:force)&&this.isRunning||(this.isRunning=!0,this.duration=duration,this.progress=0,this.red=red,this.green=green,this.blue=blue,this.alpha=1,this._elapsed=0,this._onUpdate=callback,this._onUpdateScope=context,this.camera.emit(Events$L.FLASH_START,this.camera,this,duration,red,green,blue)),this.camera},update:function(time,delta){this.isRunning&&(this._elapsed+=delta,this.progress=Clamp$f(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=1-this.progress:this.effectComplete())},postRenderCanvas:function(ctx){if(!this.isRunning)return!1;var camera=this.camera;return ctx.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",ctx.fillRect(camera.x,camera.y,camera.width,camera.height),!0},postRenderWebGL:function(pipeline,getTintFunction){if(!this.isRunning)return!1;var camera=this.camera,red=this.red/255,green=this.green/255,blue=this.blue/255;return pipeline.drawFillRect(camera.x,camera.y,camera.width,camera.height,getTintFunction(blue,green,red,1),this.alpha),!0},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(Events$L.FLASH_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}}),CreateGroupLayer_1={In:function(v,overshoot){return v*v*(((overshoot=void 0===overshoot?1.70158:overshoot)+1)*v-overshoot)},Out:function(v,overshoot){return--v*v*(((overshoot=void 0===overshoot?1.70158:overshoot)+1)*v+overshoot)+1},InOut:function(v,s){s=1.525*(s=void 0===s?1.70158:s);return(v*=2)<1?v*v*((1+s)*v-s)*.5:.5*((v-=2)*v*((1+s)*v+s)+2)}},HexagonalCullBounds_1={In:function(v){return(v=1-v)<1/2.75?1-7.5625*v*v:v<2/2.75?1-(7.5625*(v-=1.5/2.75)*v+.75):v<2.5/2.75?1-(7.5625*(v-=2.25/2.75)*v+.9375):1-(7.5625*(v-=2.625/2.75)*v+.984375)},Out:function(v){return v<1/2.75?7.5625*v*v:v<2/2.75?7.5625*(v-=1.5/2.75)*v+.75:v<2.5/2.75?7.5625*(v-=2.25/2.75)*v+.9375:7.5625*(v-=2.625/2.75)*v+.984375},InOut:function(v){var reverse=!1;return v<.5?(v=1-2*v,reverse=!0):v=2*v-1,v<1/2.75?v*=7.5625*v:v=v<2/2.75?7.5625*(v-=1.5/2.75)*v+.75:v<2.5/2.75?7.5625*(v-=2.25/2.75)*v+.9375:7.5625*(v-=2.625/2.75)*v+.984375,reverse?.5*(1-v):.5*v+.5}},components={In:function(v){return 1-Math.sqrt(1-v*v)},Out:function(v){return Math.sqrt(1- --v*v)},InOut:function(v){return(v*=2)<1?-.5*(Math.sqrt(1-v*v)-1):.5*(Math.sqrt(1-(v-=2)*v)+1)}},Copy_1={In:function(v){return v*v*v},Out:function(v){return--v*v*v+1},InOut:function(v){return(v*=2)<1?.5*v*v*v:.5*((v-=2)*v*v+2)}},TimelineBuilder_1={In:function(v,amplitude,period){if(0===v)return 0;if(1===v)return 1;var s=(period=void 0===period?.1:period)/4;return(amplitude=void 0===amplitude?.1:amplitude)<1?amplitude=1:s=period*Math.asin(1/amplitude)/(2*Math.PI),-(amplitude*Math.pow(2,10*--v)*Math.sin((v-s)*(2*Math.PI)/period))},Out:function(v,amplitude,period){if(0===v)return 0;if(1===v)return 1;var s=(period=void 0===period?.1:period)/4;return(amplitude=void 0===amplitude?.1:amplitude)<1?amplitude=1:s=period*Math.asin(1/amplitude)/(2*Math.PI),amplitude*Math.pow(2,-10*v)*Math.sin((v-s)*(2*Math.PI)/period)+1},InOut:function(v,amplitude,period){if(0===v)return 0;if(1===v)return 1;var s=(period=void 0===period?.1:period)/4;return(amplitude=void 0===amplitude?.1:amplitude)<1?amplitude=1:s=period*Math.asin(1/amplitude)/(2*Math.PI),(v*=2)<1?amplitude*Math.pow(2,10*--v)*Math.sin((v-s)*(2*Math.PI)/period)*-.5:amplitude*Math.pow(2,-10*--v)*Math.sin((v-s)*(2*Math.PI)/period)*.5+1}},GetCullTilesFunction_1={In:function(v){return Math.pow(2,10*(v-1))-.001},Out:function(v){return 1-Math.pow(2,-10*v)},InOut:function(v){return(v*=2)<1?.5*Math.pow(2,10*(v-1)):.5*(2-Math.pow(2,-10*(v-1)))}},CreateFromTiles_1=function(v){return v},CullBounds_1={In:function(v){return v*v},Out:function(v){return v*(2-v)},InOut:function(v){return(v*=2)<1?.5*v*v:-.5*(--v*(v-2)-1)}},ForEachTile_1={In:function(v){return v*v*v*v},Out:function(v){return 1- --v*v*v*v},InOut:function(v){return(v*=2)<1?.5*v*v*v*v:-.5*((v-=2)*v*v*v-2)}},Blitter_1={In:function(v){return v*v*v*v*v},Out:function(v){return--v*v*v*v*v+1},InOut:function(v){return(v*=2)<1?.5*v*v*v*v*v:.5*((v-=2)*v*v*v*v+2)}},ParseImageLayers_1={In:function(v){return 0===v?0:1===v?1:1-Math.cos(v*Math.PI/2)},Out:function(v){return 0===v?0:1===v?1:Math.sin(v*Math.PI/2)},InOut:function(v){return 0===v?0:1===v?1:.5*(1-Math.cos(Math.PI*v))}},Bob_1=function(v,steps){return void 0===steps&&(steps=1),v<=0?0:1<=v?1:1/steps*(1+(steps*v|0))},Events_1={Power0:CreateFromTiles_1,Power1:CullBounds_1.Out,Power2:Copy_1.Out,Power3:ForEachTile_1.Out,Power4:Blitter_1.Out,Linear:CreateFromTiles_1,Quad:CullBounds_1.Out,Cubic:Copy_1.Out,Quart:ForEachTile_1.Out,Quint:Blitter_1.Out,Sine:ParseImageLayers_1.Out,Expo:GetCullTilesFunction_1.Out,Circ:components.Out,Elastic:TimelineBuilder_1.Out,Back:CreateGroupLayer_1.Out,Bounce:HexagonalCullBounds_1.Out,Stepped:Bob_1,"Quad.easeIn":CullBounds_1.In,"Cubic.easeIn":Copy_1.In,"Quart.easeIn":ForEachTile_1.In,"Quint.easeIn":Blitter_1.In,"Sine.easeIn":ParseImageLayers_1.In,"Expo.easeIn":GetCullTilesFunction_1.In,"Circ.easeIn":components.In,"Elastic.easeIn":TimelineBuilder_1.In,"Back.easeIn":CreateGroupLayer_1.In,"Bounce.easeIn":HexagonalCullBounds_1.In,"Quad.easeOut":CullBounds_1.Out,"Cubic.easeOut":Copy_1.Out,"Quart.easeOut":ForEachTile_1.Out,"Quint.easeOut":Blitter_1.Out,"Sine.easeOut":ParseImageLayers_1.Out,"Expo.easeOut":GetCullTilesFunction_1.Out,"Circ.easeOut":components.Out,"Elastic.easeOut":TimelineBuilder_1.Out,"Back.easeOut":CreateGroupLayer_1.Out,"Bounce.easeOut":HexagonalCullBounds_1.Out,"Quad.easeInOut":CullBounds_1.InOut,"Cubic.easeInOut":Copy_1.InOut,"Quart.easeInOut":ForEachTile_1.InOut,"Quint.easeInOut":Blitter_1.InOut,"Sine.easeInOut":ParseImageLayers_1.InOut,"Expo.easeInOut":GetCullTilesFunction_1.InOut,"Circ.easeInOut":components.InOut,"Elastic.easeInOut":TimelineBuilder_1.InOut,"Back.easeInOut":CreateGroupLayer_1.InOut,"Bounce.easeInOut":HexagonalCullBounds_1.InOut},Clamp$e=Character,EaseMap$3=Events_1,Events$K=GetCalcMatrix_1,Vector2$L=BuildTilesetIndex_1,FindTile_1=new Class_1({initialize:function(camera){this.camera=camera,this.isRunning=!1,this.duration=0,this.source=new Vector2$L,this.current=new Vector2$L,this.destination=new Vector2$L,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(x,y,duration,ease,force,callback,context){void 0===duration&&(duration=1e3),void 0===ease&&(ease=EaseMap$3.Linear),void 0===callback&&(callback=null),void 0===context&&(context=this.camera.scene);var cam=this.camera;return!(force=void 0===force?!1:force)&&this.isRunning||(this.isRunning=!0,this.duration=duration,this.progress=0,this.source.set(cam.scrollX,cam.scrollY),this.destination.set(x,y),cam.getScroll(x,y,this.current),"string"==typeof ease&&EaseMap$3.hasOwnProperty(ease)?this.ease=EaseMap$3[ease]:"function"==typeof ease&&(this.ease=ease),this._elapsed=0,this._onUpdate=callback,this._onUpdateScope=context,this.camera.emit(Events$K.PAN_START,this.camera,this,duration,x,y)),cam},update:function(time,x){var progress,cam,y;this.isRunning&&(this._elapsed+=x,progress=Clamp$e(this._elapsed/this.duration,0,1),this.progress=progress,cam=this.camera,this._elapsed<this.duration?(y=this.ease(progress),cam.getScroll(this.destination.x,this.destination.y,this.current),x=this.source.x+(this.current.x-this.source.x)*y,y=this.source.y+(this.current.y-this.source.y)*y,cam.setScroll(x,y),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,cam,progress,x,y)):(cam.centerOn(this.destination.x,this.destination.y),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,cam,progress,cam.scrollX,cam.scrollY),this.effectComplete()))},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(Events$K.PAN_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}}),Clamp$d=Character,Events$J=GetCalcMatrix_1,Vector2$K=BuildTilesetIndex_1,CalculateFacesWithin_1=new Class_1({initialize:function(camera){this.camera=camera,this.isRunning=!1,this.duration=0,this.intensity=new Vector2$K,this.progress=0,this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate,this._onUpdateScope},start:function(duration,intensity,force,callback,context){return void 0===duration&&(duration=100),void 0===intensity&&(intensity=.05),void 0===callback&&(callback=null),void 0===context&&(context=this.camera.scene),!(force=void 0===force?!1:force)&&this.isRunning||(this.isRunning=!0,this.duration=duration,this.progress=0,"number"==typeof intensity?this.intensity.set(intensity):this.intensity.set(intensity.x,intensity.y),this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate=callback,this._onUpdateScope=context,this.camera.emit(Events$J.SHAKE_START,this.camera,this,duration,intensity)),this.camera},preRender:function(){this.isRunning&&this.camera.matrix.translate(this._offsetX,this._offsetY)},update:function(time,zoom){var intensity,width,height;this.isRunning&&(this._elapsed+=zoom,this.progress=Clamp$d(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?(intensity=this.intensity,width=this.camera.width,height=this.camera.height,zoom=this.camera.zoom,this._offsetX=(Math.random()*intensity.x*width*2-intensity.x*width)*zoom,this._offsetY=(Math.random()*intensity.y*height*2-intensity.y*height)*zoom,this.camera.roundPixels&&(this._offsetX=Math.round(this._offsetX),this._offsetY=Math.round(this._offsetY))):this.effectComplete())},effectComplete:function(){this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(Events$J.SHAKE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.intensity=null}}),Clamp$c=Character,Events$I=GetCalcMatrix_1,EaseMap$2=Events_1,Fill_1=new Class_1({initialize:function(camera){this.camera=camera,this.isRunning=!1,this.duration=0,this.source=0,this.current=0,this.destination=0,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope,this.clockwise=!0,this.shortestPath=!1},start:function(cam,maxRad,duration,ease,force,cwDist,acwDist){void 0===duration&&(duration=1e3),void 0===ease&&(ease=EaseMap$2.Linear),void 0===force&&(force=!1),void 0===cwDist&&(cwDist=null),void 0===acwDist&&(acwDist=this.camera.scene),this.shortestPath=maxRad=void 0===maxRad?!1:maxRad;var tmpDestination=cam;cam<0?(tmpDestination=-1*cam,this.clockwise=!1):this.clockwise=!0;maxRad=360*Math.PI/180;tmpDestination-=Math.floor(tmpDestination/maxRad)*maxRad;cam=this.camera;return!force&&this.isRunning||(this.isRunning=!0,this.duration=duration,this.progress=0,this.source=cam.rotation,this.destination=tmpDestination,"string"==typeof ease&&EaseMap$2.hasOwnProperty(ease)?this.ease=EaseMap$2[ease]:"function"==typeof ease&&(this.ease=ease),this._elapsed=0,this._onUpdate=cwDist,this._onUpdateScope=acwDist,this.shortestPath&&(acwDist=cwDist=0,(cwDist=this.destination>this.source?Math.abs(this.destination-this.source):Math.abs(this.destination+maxRad)-this.source)<(acwDist=this.source>this.destination?Math.abs(this.source-this.destination):Math.abs(this.source+maxRad)-this.destination)?this.clockwise=!0:acwDist<cwDist&&(this.clockwise=!1)),this.camera.emit(Events$I.ROTATE_START,this.camera,this,duration,tmpDestination)),cam},update:function(time,r){var progress,cam,v,maxRad,target,distance;this.isRunning&&(this._elapsed+=r,progress=Clamp$c(this._elapsed/this.duration,0,1),this.progress=progress,cam=this.camera,this._elapsed<this.duration?(v=this.ease(progress),this.current=cam.rotation,distance=0,maxRad=360*Math.PI/180,target=this.destination,r=this.current,!1===this.clockwise&&(target=this.current,r=this.destination),distance=r<=target?Math.abs(target-r):Math.abs(target+maxRad)-r,r=0,r=this.clockwise?cam.rotation+distance*v:cam.rotation-distance*v,cam.rotation=r,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,cam,progress,r)):(cam.rotation=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,cam,progress,this.destination),this.effectComplete()))},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(Events$I.ROTATE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}}),Clamp$b=Character,EaseMap$1=Events_1,Events$H=GetCalcMatrix_1,AtlasJSONFile_1={Fade:Pick_1,Flash:UpdateList_1,Pan:FindTile_1,Shake:CalculateFacesWithin_1,RotateTo:Fill_1,Zoom:new Class_1({initialize:function(camera){this.camera=camera,this.isRunning=!1,this.duration=0,this.source=1,this.destination=1,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(zoom,duration,ease,force,callback,context){void 0===duration&&(duration=1e3),void 0===ease&&(ease=EaseMap$1.Linear),void 0===callback&&(callback=null),void 0===context&&(context=this.camera.scene);var cam=this.camera;return!(force=void 0===force?!1:force)&&this.isRunning||(this.isRunning=!0,this.duration=duration,this.progress=0,this.source=cam.zoom,this.destination=zoom,"string"==typeof ease&&EaseMap$1.hasOwnProperty(ease)?this.ease=EaseMap$1[ease]:"function"==typeof ease&&(this.ease=ease),this._elapsed=0,this._onUpdate=callback,this._onUpdateScope=context,this.camera.emit(Events$H.ZOOM_START,this.camera,this,duration,zoom)),cam},update:function(time,delta){this.isRunning&&(this._elapsed+=delta,this.progress=Clamp$b(this._elapsed/this.duration,0,1),this._elapsed<this.duration?(this.camera.zoom=this.source+(this.destination-this.source)*this.ease(this.progress),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.camera.zoom)):(this.camera.zoom=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.destination),this.effectComplete()))},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(Events$H.ZOOM_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}})},NoAudioSoundManager_1=function(p0,p1,t){return(p1-p0)*t+p0},BaseCamera$1=Composite_1,CenterOn$3=CenterOn_1$2,Clamp$a=Character,Effects=AtlasJSONFile_1,Events$G=GetCalcMatrix_1,Linear$2=NoAudioSoundManager_1,Rectangle$r=HasTileAtWorldXY_1,Vector2$J=BuildTilesetIndex_1,FilterTiles_1=new Class_1({Extends:BaseCamera$1,Mixins:[components$3.Flip,components$3.Tint,components$3.Pipeline],initialize:function(x,y,width,height){BaseCamera$1.call(this,x,y,width,height),this.postPipelines=[],this.pipelineData={},this.inputEnabled=!0,this.fadeEffect=new Effects.Fade(this),this.flashEffect=new Effects.Flash(this),this.shakeEffect=new Effects.Shake(this),this.panEffect=new Effects.Pan(this),this.rotateToEffect=new Effects.RotateTo(this),this.zoomEffect=new Effects.Zoom(this),this.lerp=new Vector2$J(1,1),this.followOffset=new Vector2$J,this.deadzone=null,this._follow=null},setDeadzone:function(fx,fy){var originX,originY;return void 0===fx?this.deadzone=null:(this.deadzone?(this.deadzone.width=fx,this.deadzone.height=fy):this.deadzone=new Rectangle$r(0,0,fx,fy),this._follow&&(originX=this.width/2,originY=this.height/2,fx=this._follow.x-this.followOffset.x,fy=this._follow.y-this.followOffset.y,this.midPoint.set(fx,fy),this.scrollX=fx-originX,this.scrollY=fy-originY),CenterOn$3(this.deadzone,this.midPoint.x,this.midPoint.y)),this},fadeIn:function(duration,red,green,blue,callback,context){return this.fadeEffect.start(!1,duration,red,green,blue,!0,callback,context)},fadeOut:function(duration,red,green,blue,callback,context){return this.fadeEffect.start(!0,duration,red,green,blue,!0,callback,context)},fadeFrom:function(duration,red,green,blue,force,callback,context){return this.fadeEffect.start(!1,duration,red,green,blue,force,callback,context)},fade:function(duration,red,green,blue,force,callback,context){return this.fadeEffect.start(!0,duration,red,green,blue,force,callback,context)},flash:function(duration,red,green,blue,force,callback,context){return this.flashEffect.start(duration,red,green,blue,force,callback,context)},shake:function(duration,intensity,force,callback,context){return this.shakeEffect.start(duration,intensity,force,callback,context)},pan:function(x,y,duration,ease,force,callback,context){return this.panEffect.start(x,y,duration,ease,force,callback,context)},rotateTo:function(radians,shortestPath,duration,ease,force,callback,context){return this.rotateToEffect.start(radians,shortestPath,duration,ease,force,callback,context)},zoomTo:function(zoom,duration,ease,force,callback,context){return this.zoomEffect.start(zoom,duration,ease,force,callback,context)},preRender:function(){this.renderList.length=0;var displayWidth=this.width,displayHeight=this.height,vwx=.5*displayWidth,vwy=.5*displayHeight,zoom=this.zoom,matrix=this.matrix,originX=displayWidth*this.originX,originY=displayHeight*this.originY,follow=this._follow,deadzone=this.deadzone,sx=this.scrollX,sy=this.scrollY;deadzone&&CenterOn$3(deadzone,this.midPoint.x,this.midPoint.y);var fx,fy,emitFollowEvent=!1;follow&&!this.panEffect.isRunning&&(fx=follow.x-this.followOffset.x,fy=follow.y-this.followOffset.y,deadzone?(fx<deadzone.x?sx=Linear$2(sx,sx-(deadzone.x-fx),this.lerp.x):fx>deadzone.right&&(sx=Linear$2(sx,sx+(fx-deadzone.right),this.lerp.x)),fy<deadzone.y?sy=Linear$2(sy,sy-(deadzone.y-fy),this.lerp.y):fy>deadzone.bottom&&(sy=Linear$2(sy,sy+(fy-deadzone.bottom),this.lerp.y))):(sx=Linear$2(sx,fx-originX,this.lerp.x),sy=Linear$2(sy,fy-originY,this.lerp.y)),emitFollowEvent=!0),this.useBounds&&(sx=this.clampX(sx),sy=this.clampY(sy)),this.roundPixels&&(originX=Math.round(originX),originY=Math.round(originY),sx=Math.round(sx),sy=Math.round(sy));vwx=(this.scrollX=sx)+vwx,vwy=(this.scrollY=sy)+vwy;this.midPoint.set(vwx,vwy);displayWidth/=zoom,displayHeight/=zoom,vwx-=displayWidth/2,vwy-=displayHeight/2;this.roundPixels&&(vwx=Math.round(vwx),vwy=Math.round(vwy)),this.worldView.setTo(vwx,vwy,displayWidth,displayHeight),matrix.applyITRS(this.x+originX,this.y+originY,this.rotation,zoom,zoom),matrix.translate(-originX,-originY),this.shakeEffect.preRender(),emitFollowEvent&&this.emit(Events$G.FOLLOW_UPDATE,this,follow)},setLerp:function(x,y){return void 0===x&&(x=1),void 0===y&&(y=x),this.lerp.set(x,y),this},setFollowOffset:function(x,y){return this.followOffset.set(x=void 0===x?0:x,y=void 0===y?0:y),this},startFollow:function(target,roundPixels,originX,originY,fx,fy){void 0===roundPixels&&(roundPixels=!1),void 0===originX&&(originX=1),void 0===originY&&(originY=originX),void 0===fx&&(fx=0),void 0===fy&&(fy=fx),this._follow=target,this.roundPixels=roundPixels,originX=Clamp$a(originX,0,1),originY=Clamp$a(originY,0,1),this.lerp.set(originX,originY),this.followOffset.set(fx,fy);originX=this.width/2,originY=this.height/2,fx=target.x-fx,fy=target.y-fy;return this.midPoint.set(fx,fy),this.scrollX=fx-originX,this.scrollY=fy-originY,this.useBounds&&(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},stopFollow:function(){return this._follow=null,this},resetFX:function(){return this.rotateToEffect.reset(),this.panEffect.reset(),this.shakeEffect.reset(),this.flashEffect.reset(),this.fadeEffect.reset(),this},update:function(time,delta){this.visible&&(this.rotateToEffect.update(time,delta),this.panEffect.update(time,delta),this.zoomEffect.update(time,delta),this.shakeEffect.update(time,delta),this.flashEffect.update(time,delta),this.fadeEffect.update(time,delta))},destroy:function(){this.resetFX(),BaseCamera$1.prototype.destroy.call(this),this._follow=null,this.deadzone=null}}),corePlugins={},customPlugins={},GetProps_1={register:function(key,plugin,mapping,custom){corePlugins[key]={plugin:plugin,mapping:mapping,custom:custom=void 0===custom?!1:custom}},registerCustom:function(key,plugin,mapping,data){customPlugins[key]={plugin:plugin,mapping:mapping,data:data}},hasCore:function(key){return corePlugins.hasOwnProperty(key)},hasCustom:function(key){return customPlugins.hasOwnProperty(key)},getCore:function(key){return corePlugins[key]},getCustom:function(key){return customPlugins[key]},getCustomClass:function(key){return customPlugins.hasOwnProperty(key)?customPlugins[key].plugin:null},remove:function(key){corePlugins.hasOwnProperty(key)&&delete corePlugins[key]},removeCustom:function(key){customPlugins.hasOwnProperty(key)&&delete customPlugins[key]},destroyCorePlugins:function(){for(var key in corePlugins)corePlugins.hasOwnProperty(key)&&delete corePlugins[key]},destroyCustomPlugins:function(){for(var key in customPlugins)customPlugins.hasOwnProperty(key)&&delete customPlugins[key]}},PluginCache=GetProps_1,HexagonalCullTiles_1={ENTER_FULLSCREEN:"enterfullscreen",FULLSCREEN_FAILED:"fullscreenfailed",FULLSCREEN_UNSUPPORTED:"fullscreenunsupported",LEAVE_FULLSCREEN:"leavefullscreen",ORIENTATION_CHANGE:"orientationchange",RESIZE:"resize"},Camera$1=FilterTiles_1,GetFastValue$1g=GetFastValue_1,FindByIndex_1=PluginCache,RectangleContains$3=arcade,ScaleEvents$2=HexagonalCullTiles_1,SceneEvents$f=events$g,CalculateFacesAt_1=new Class_1({initialize:function(scene){this.scene=scene,this.systems=scene.sys,this.roundPixels=scene.sys.game.config.roundPixels,this.cameras=[],this.main,this.default,scene.sys.events.once(SceneEvents$f.BOOT,this.boot,this),scene.sys.events.on(SceneEvents$f.START,this.start,this)},boot:function(){var sys=this.systems;sys.settings.cameras?this.fromJSON(sys.settings.cameras):this.add(),this.main=this.cameras[0],this.default=new Camera$1(0,0,sys.scale.width,sys.scale.height).setScene(this.scene),sys.game.scale.on(ScaleEvents$2.RESIZE,this.onResize,this),this.systems.events.once(SceneEvents$f.DESTROY,this.destroy,this)},start:function(){this.main||((eventEmitter=this.systems).settings.cameras?this.fromJSON(eventEmitter.settings.cameras):this.add(),this.main=this.cameras[0]);var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents$f.UPDATE,this.update,this),eventEmitter.once(SceneEvents$f.SHUTDOWN,this.shutdown,this)},add:function(x,y,width,camera,makeMain,name){void 0===width&&(width=this.scene.sys.scale.width),void 0===camera&&(camera=this.scene.sys.scale.height),void 0===makeMain&&(makeMain=!1),void 0===name&&(name="");camera=new Camera$1(x=void 0===x?0:x,y=void 0===y?0:y,width,camera);return camera.setName(name),camera.setScene(this.scene),camera.setRoundPixels(this.roundPixels),camera.id=this.getNextID(),this.cameras.push(camera),makeMain&&(this.main=camera),camera},addExisting:function(camera,makeMain){return void 0===makeMain&&(makeMain=!1),-1===this.cameras.indexOf(camera)?(camera.id=this.getNextID(),camera.setRoundPixels(this.roundPixels),this.cameras.push(camera),makeMain&&(this.main=camera),camera):null},getNextID:function(){for(var cameras=this.cameras,testID=1,t=0;t<32;t++){for(var found=!1,i=0;i<cameras.length;i++){var camera=cameras[i];camera&&camera.id===testID&&(found=!0)}if(!found)return testID;testID<<=1}return 0},getTotal:function(isVisible){void 0===isVisible&&(isVisible=!1);for(var total=0,cameras=this.cameras,i=0;i<cameras.length;i++){var camera=cameras[i];(!isVisible||isVisible&&camera.visible)&&total++}return total},fromJSON:function(config){Array.isArray(config)||(config=[config]);for(var gameWidth=this.scene.sys.scale.width,gameHeight=this.scene.sys.scale.height,i=0;i<config.length;i++){var bwidth=config[i],camera=GetFastValue$1g(bwidth,"x",0),by=GetFastValue$1g(bwidth,"y",0),bheight=GetFastValue$1g(bwidth,"width",gameWidth),bx=GetFastValue$1g(bwidth,"height",gameHeight),camera=this.add(camera,by,bheight,bx);camera.name=GetFastValue$1g(bwidth,"name",""),camera.zoom=GetFastValue$1g(bwidth,"zoom",1),camera.rotation=GetFastValue$1g(bwidth,"rotation",0),camera.scrollX=GetFastValue$1g(bwidth,"scrollX",0),camera.scrollY=GetFastValue$1g(bwidth,"scrollY",0),camera.roundPixels=GetFastValue$1g(bwidth,"roundPixels",!1),camera.visible=GetFastValue$1g(bwidth,"visible",!0);by=GetFastValue$1g(bwidth,"backgroundColor",!1);by&&camera.setBackgroundColor(by);bheight=GetFastValue$1g(bwidth,"bounds",null);bheight&&(bx=GetFastValue$1g(bheight,"x",0),by=GetFastValue$1g(bheight,"y",0),bwidth=GetFastValue$1g(bheight,"width",gameWidth),bheight=GetFastValue$1g(bheight,"height",gameHeight),camera.setBounds(bx,by,bwidth,bheight))}return this},getCamera:function(name){for(var cameras=this.cameras,i=0;i<cameras.length;i++)if(cameras[i].name===name)return cameras[i];return null},getCamerasBelowPointer:function(pointer){for(var cameras=this.cameras,x=pointer.x,y=pointer.y,output=[],i=0;i<cameras.length;i++){var camera=cameras[i];camera.visible&&camera.inputEnabled&&RectangleContains$3(camera,x,y)&&output.unshift(camera)}return output},remove:function(camera,runDestroy){void 0===runDestroy&&(runDestroy=!0),Array.isArray(camera)||(camera=[camera]);for(var total=0,cameras=this.cameras,i=0;i<camera.length;i++){var index=cameras.indexOf(camera[i]);-1!==index&&(runDestroy?cameras[index].destroy():cameras[index].renderList=[],cameras.splice(index,1),total++)}return!this.main&&cameras[0]&&(this.main=cameras[0]),total},render:function(renderer,displayList){for(var scene=this.scene,cameras=this.cameras,i=0;i<this.cameras.length;i++){var visibleChildren,camera=cameras[i];camera.visible&&0<camera.alpha&&(camera.preRender(),visibleChildren=this.getVisibleChildren(displayList.getChildren(),camera),renderer.render(scene,visibleChildren,camera))}},getVisibleChildren:function(children,camera){for(var visible=[],i=0;i<children.length;i++){var child=children[i];child.willRender(camera)&&visible.push(child)}return visible},resetAll:function(){for(var i=0;i<this.cameras.length;i++)this.cameras[i].destroy();return this.cameras=[],this.main=this.add(),this.main},update:function(time,delta){for(var i=0;i<this.cameras.length;i++)this.cameras[i].update(time,delta)},onResize:function(gameSize,baseSize,displaySize,previousWidth,previousHeight){for(var i=0;i<this.cameras.length;i++){var cam=this.cameras[i];0===cam._x&&0===cam._y&&cam._width===previousWidth&&cam._height===previousHeight&&cam.setSize(baseSize.width,baseSize.height)}},resize:function(width,height){for(var i=0;i<this.cameras.length;i++)this.cameras[i].setSize(width,height)},shutdown:function(){this.main=void 0;for(var i=0;i<this.cameras.length;i++)this.cameras[i].destroy();this.cameras=[];var eventEmitter=this.systems.events;eventEmitter.off(SceneEvents$f.UPDATE,this.update,this),eventEmitter.off(SceneEvents$f.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.default.destroy(),this.scene.sys.events.off(SceneEvents$f.START,this.start,this),this.scene=null,this.systems=null}});FindByIndex_1.register("CameraManager",CalculateFacesAt_1,"cameras");var cameras={Controls:DisplayList_1,Scene2D:{Camera:FilterTiles_1,BaseCamera:Composite_1,CameraManager:CalculateFacesAt_1,Effects:AtlasJSONFile_1,Events:GetCalcMatrix_1}},OS$4={android:!1,chromeOS:!1,cordova:!1,crosswalk:!1,desktop:!1,ejecta:!1,electron:!1,iOS:!1,iOSVersion:0,iPad:!1,iPhone:!1,kindle:!1,linux:!1,macOS:!1,node:!1,nodeWebkit:!1,pixelRatio:1,webApp:!1,windows:!1,windowsPhone:!1};var parsers=function(){if("function"==typeof importScripts)return OS$4;var ua=navigator.userAgent;/Windows/.test(ua)?OS$4.windows=!0:/Mac OS/.test(ua)&&!/like Mac OS/.test(ua)?navigator.maxTouchPoints&&2<navigator.maxTouchPoints?(OS$4.iOS=!0,OS$4.iPad=!0,navigator.appVersion.match(/Version\/(\d+)/),OS$4.iOSVersion=parseInt(RegExp.$1,10)):OS$4.macOS=!0:/Android/.test(ua)?OS$4.android=!0:/Linux/.test(ua)?OS$4.linux=!0:/iP[ao]d|iPhone/i.test(ua)?(OS$4.iOS=!0,navigator.appVersion.match(/OS (\d+)/),OS$4.iOSVersion=parseInt(RegExp.$1,10),OS$4.iPhone=-1!==ua.toLowerCase().indexOf("iphone"),OS$4.iPad=-1!==ua.toLowerCase().indexOf("ipad")):/Kindle/.test(ua)||/\bKF[A-Z][A-Z]+/.test(ua)||/Silk.*Mobile Safari/.test(ua)?OS$4.kindle=!0:/CrOS/.test(ua)&&(OS$4.chromeOS=!0),(/Windows Phone/i.test(ua)||/IEMobile/i.test(ua))&&(OS$4.android=!1,OS$4.iOS=!1,OS$4.macOS=!1,OS$4.windows=!0,OS$4.windowsPhone=!0);var silk=/Silk/.test(ua);return(OS$4.windows||OS$4.macOS||OS$4.linux&&!silk||OS$4.chromeOS)&&(OS$4.desktop=!0),(OS$4.windowsPhone||/Windows NT/i.test(ua)&&/Touch/i.test(ua))&&(OS$4.desktop=!1),navigator.standalone&&(OS$4.webApp=!0),"function"!=typeof importScripts&&(void 0!==window.cordova&&(OS$4.cordova=!0),void 0!==window.ejecta&&(OS$4.ejecta=!0)),"undefined"!=typeof process&&process.versions&&process.versions.node&&(OS$4.node=!0),OS$4.node&&"object"==typeof process.versions&&(OS$4.nodeWebkit=!!process.versions["node-webkit"],OS$4.electron=!!process.versions.electron),/Crosswalk/.test(ua)&&(OS$4.crosswalk=!0),OS$4.pixelRatio=window.devicePixelRatio||1,OS$4}(),OS$3=parsers,Browser$3={chrome:!1,chromeVersion:0,edge:!1,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,silk:!1,trident:!1,tridentVersion:0};var ua,PluginCache$7=(ua=navigator.userAgent,/Edge\/\d+/.test(ua)?Browser$3.edge=!0:/Chrome\/(\d+)/.test(ua)&&!OS$3.windowsPhone?(Browser$3.chrome=!0,Browser$3.chromeVersion=parseInt(RegExp.$1,10)):/Firefox\D+(\d+)/.test(ua)?(Browser$3.firefox=!0,Browser$3.firefoxVersion=parseInt(RegExp.$1,10)):/AppleWebKit/.test(ua)&&OS$3.iOS?Browser$3.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(ua)?(Browser$3.ie=!0,Browser$3.ieVersion=parseInt(RegExp.$1,10)):/Opera/.test(ua)?Browser$3.opera=!0:/Safari/.test(ua)&&!OS$3.windowsPhone?Browser$3.safari=!0:/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(ua)&&(Browser$3.ie=!0,Browser$3.trident=!0,Browser$3.tridentVersion=parseInt(RegExp.$1,10),Browser$3.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(ua)&&(Browser$3.silk=!0),Browser$3),prefix="",BuildRight_1={disable:function(context){return(prefix=""===prefix?getPrefix(context):prefix)&&(context[prefix]=!1),context},enable:function(context){return(prefix=""===prefix?getPrefix(context):prefix)&&(context[prefix]=!0),context},getPrefix:getPrefix,isEnabled:function(context){return null!==prefix?context[prefix]:null}};function getPrefix(context){for(var vendors=["i","webkitI","msI","mozI","oI"],i=0;i<vendors.length;i++){var s=vendors[i]+"mageSmoothingEnabled";if(s in context)return s}return null}var CONST$1d=Extend,Smoothing$1=BuildRight_1,pool=[],_disableContextSmoothing=!1,SetValue_1=function(){function create(canvas,width,height,canvasType,selfParent){void 0===width&&(width=1),void 0===height&&(height=1),void 0===selfParent&&(selfParent=!1);var container=first(canvasType=void 0===canvasType?CONST$1d.CANVAS:canvasType),canvas=(null===container?(container={parent:canvas,canvas:document.createElement("canvas"),type:canvasType},canvasType===CONST$1d.CANVAS&&pool.push(container)):container.parent=canvas,container.canvas);return selfParent&&(container.parent=canvas),canvas.width=width,canvas.height=height,_disableContextSmoothing&&canvasType===CONST$1d.CANVAS&&Smoothing$1.disable(canvas.getContext("2d")),canvas}function total(){var c=0;return pool.forEach(function(container){container.parent&&c++}),c}var first=function(canvasType){if((canvasType=void 0===canvasType?CONST$1d.CANVAS:canvasType)===CONST$1d.WEBGL)return null;for(var i=0;i<pool.length;i++){var container=pool[i];if(!container.parent&&container.type===canvasType)return container}return null};return{create2D:function(parent,width,height){return create(parent,width,height,CONST$1d.CANVAS)},create:create,createWebGL:function(parent,width,height){return create(parent,width,height,CONST$1d.WEBGL)},disableSmoothing:function(){_disableContextSmoothing=!0},enableSmoothing:function(){_disableContextSmoothing=!1},first:first,free:function(){return pool.length-total()},pool:pool,remove:function(parent){var isCanvas=parent instanceof HTMLCanvasElement;pool.forEach(function(container){(isCanvas&&container.canvas===parent||!isCanvas&&container.parent===parent)&&(container.parent=null,container.canvas.width=1,container.canvas.height=1)})},total:total}}(),OS$2=parsers,Browser$2=PluginCache$7,CanvasPool$c=SetValue_1,Features$2={canvas:!1,canvasBitBltShift:null,file:!1,fileSystem:!1,getUserMedia:!0,littleEndian:!1,localStorage:!1,pointerLock:!1,support32bit:!1,vibration:!1,webGL:!1,worker:!1};var BuildGameObjectAnimation_1=function(){if("function"==typeof importScripts)return Features$2;Features$2.canvas=!!window.CanvasRenderingContext2D;try{Features$2.localStorage=!!localStorage.getItem}catch(error){Features$2.localStorage=!1}Features$2.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),Features$2.fileSystem=!!window.requestFileSystem;var c,b,isUint8=!1;return Features$2.webGL=function(){if(window.WebGLRenderingContext)try{var canvas=CanvasPool$c.createWebGL(this),ctx=canvas.getContext("webgl")||canvas.getContext("experimental-webgl"),canvas2D=CanvasPool$c.create2D(this),image=canvas2D.getContext("2d").createImageData(1,1);return isUint8=image.data instanceof Uint8ClampedArray,CanvasPool$c.remove(canvas),CanvasPool$c.remove(canvas2D),!!ctx}catch(e){return!1}return!1}(),Features$2.worker=!!window.Worker,Features$2.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,Features$2.getUserMedia=Features$2.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,Browser$2.firefox&&Browser$2.firefoxVersion<21&&(Features$2.getUserMedia=!1),!OS$2.iOS&&(Browser$2.ie||Browser$2.firefox||Browser$2.chrome)&&(Features$2.canvasBitBltShift=!0),(Browser$2.safari||Browser$2.mobileSafari)&&(Features$2.canvasBitBltShift=!1),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(Features$2.vibration=!0),"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(Features$2.littleEndian=(c=new ArrayBuffer(4),b=new Uint8Array(c),c=new Uint32Array(c),b[0]=161,b[1]=178,b[2]=195,b[3]=212,3569595041===c[0]||2712847316!==c[0]&&null)),Features$2.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==Features$2.littleEndian&&isUint8,Features$2}(),Browser$1=PluginCache$7,Input$1={gamepads:!1,mspointer:!1,touch:!1,wheelEvent:null};var display=("function"==typeof importScripts||(("ontouchstart"in document.documentElement||navigator.maxTouchPoints&&1<=navigator.maxTouchPoints)&&(Input$1.touch=!0),(navigator.msPointerEnabled||navigator.pointerEnabled)&&(Input$1.mspointer=!0),navigator.getGamepads&&(Input$1.gamepads=!0),"onwheel"in window||Browser$1.ie&&"WheelEvent"in window?Input$1.wheelEvent="wheel":"onmousewheel"in window?Input$1.wheelEvent="mousewheel":Browser$1.firefox&&"MouseScrollEvent"in window&&(Input$1.wheelEvent="DOMMouseScroll")),Input$1),Browser=PluginCache$7,Audio$1={audioData:!1,dolby:!1,m4a:!1,mp3:!1,ogg:!1,opus:!1,wav:!1,webAudio:!1,webm:!1};var CheckIsoBounds_1=function(){if("function"==typeof importScripts)return Audio$1;Audio$1.audioData=!!window.Audio,Audio$1.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var major,minor,audioElement=document.createElement("audio"),result=!!audioElement.canPlayType;try{result&&(audioElement.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(Audio$1.ogg=!0),(audioElement.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||audioElement.canPlayType("audio/opus;").replace(/^no$/,""))&&(Audio$1.opus=!0),audioElement.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(Audio$1.mp3=!0),audioElement.canPlayType("audio/wav").replace(/^no$/,"")&&(Audio$1.wav=!0),(audioElement.canPlayType("audio/x-m4a;")||audioElement.canPlayType("audio/aac;").replace(/^no$/,""))&&(Audio$1.m4a=!0),audioElement.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(Audio$1.webm=!0),""!==audioElement.canPlayType('audio/mp4;codecs="ec-3"')&&(Browser.edge?Audio$1.dolby=!0:Browser.safari&&9<=Browser.safariVersion&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)&&(major=parseInt(RegExp.$1,10),minor=parseInt(RegExp.$2,10),(10===major&&11<=minor||10<major)&&(Audio$1.dolby=!0))))}catch(e){}return Audio$1}(),Video$3={h264:!1,hls:!1,mp4:!1,ogg:!1,vp9:!1,webm:!1};var UUID_1=function(){if("function"==typeof importScripts)return Video$3;var videoElement=document.createElement("video"),result=!!videoElement.canPlayType;try{result&&(videoElement.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(Video$3.ogg=!0),videoElement.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")&&(Video$3.h264=!0,Video$3.mp4=!0),videoElement.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(Video$3.webm=!0),videoElement.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,"")&&(Video$3.vp9=!0),videoElement.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(Video$3.hls=!0))}catch(e){}return Video$3}(),Fullscreen={available:!1,cancel:"",keyboard:!1,request:""};var Engine_1=function(){if("function"==typeof importScripts)return Fullscreen;for(var suffix1="Fullscreen",suffix2="FullScreen",fs=["request"+suffix1,"request"+suffix2,"webkitRequest"+suffix1,"webkitRequest"+suffix2,"msRequest"+suffix1,"msRequest"+suffix2,"mozRequest"+suffix2,"mozRequest"+suffix1],i=0;i<fs.length;i++)if(document.documentElement[fs[i]]){Fullscreen.available=!0,Fullscreen.request=fs[i];break}var cfs=["cancel"+suffix2,"exit"+suffix1,"webkitCancel"+suffix2,"webkitExit"+suffix1,"msCancel"+suffix2,"msExit"+suffix1,"mozCancel"+suffix2,"mozExit"+suffix1];if(Fullscreen.available)for(i=0;i<cfs.length;i++)if(document[cfs[i]]){Fullscreen.cancel=cfs[i];break}return window.Element&&Element.ALLOW_KEYBOARD_INPUT&&!/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)&&(Fullscreen.keyboard=!0),Object.defineProperty(Fullscreen,"active",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}}),Fullscreen}(),CanvasPool$b=SetValue_1,CanvasFeatures$1={supportInverseAlpha:!1,supportNewBlendModes:!1};var pngHead,pngEnd,magenta,Extend_1=("function"!=typeof importScripts&&void 0!==document&&(CanvasFeatures$1.supportNewBlendModes=(pngHead="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",pngEnd="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",(magenta=new Image).onload=function(){var yellow=new Image;yellow.onload=function(){var data=CanvasPool$b.create(yellow,6,1).getContext("2d");if(data.globalCompositeOperation="multiply",data.drawImage(magenta,0,0),data.drawImage(yellow,2,0),!data.getImageData(2,0,1,1))return!1;data=data.getImageData(2,0,1,1).data;CanvasPool$b.remove(yellow),CanvasFeatures$1.supportNewBlendModes=255===data[0]&&0===data[1]&&0===data[2]},yellow.src=pngHead+"/wCKxvRF"+pngEnd},magenta.src=pngHead+"AP804Oa6"+pngEnd,!1),CanvasFeatures$1.supportInverseAlpha=function(){var s2=CanvasPool$b.create(this,2,1).getContext("2d");s2.fillStyle="rgba(10, 20, 30, 0.5)",s2.fillRect(0,0,1,1);var s1=s2.getImageData(0,0,1,1);return null!==s1&&(s2.putImageData(s1,1,0),(s2=s2.getImageData(1,0,1,1)).data[0]===s1.data[0]&&s2.data[1]===s1.data[1]&&s2.data[2]===s1.data[2]&&s2.data[3]===s1.data[3])}()),CanvasFeatures$1),Graphics_1={os:parsers,browser:PluginCache$7,features:BuildGameObjectAnimation_1,input:display,audio:CheckIsoBounds_1,video:UUID_1,fullscreen:Engine_1,canvasFeatures:Extend_1},GetTargets_1=function(x1,y1,x2,y2){return Math.atan2(y2-y1,x2-x1)},BodyBounds_1=function(point1,point2){return Math.atan2(point2.y-point1.y,point2.x-point1.x)},CONST$1c=Tweens,HexagonalWorldToTileXY_1=function(angle){return 0<=(angle%=2*Math.PI)?angle:angle+2*Math.PI},Decompose_1$1=function(min,max){return Math.random()*(max-min)+min},FloatBetween$2=Decompose_1$1,FloatBetween$1=Decompose_1$1,Normalize=HexagonalWorldToTileXY_1,MATH_CONST$f=Tweens,GetAdvancedValue_1={Between:GetTargets_1,BetweenPoints:BodyBounds_1,BetweenPointsY:function(point1,point2){return Math.atan2(point2.x-point1.x,point2.y-point1.y)},BetweenY:function(x1,y1,x2,y2){return Math.atan2(x2-x1,y2-y1)},CounterClockwise:function(angle){return angle>Math.PI&&(angle-=CONST$1c.PI2),Math.abs(((angle+CONST$1c.TAU)%CONST$1c.PI2-CONST$1c.PI2)%CONST$1c.PI2)},Normalize:HexagonalWorldToTileXY_1,Random:function(){return FloatBetween$2(-Math.PI,Math.PI)},RandomDegrees:function(){return FloatBetween$1(-180,180)},Reverse:function(angle){return Normalize(angle+Math.PI)},RotateTo:function(currentAngle,targetAngle,lerp){return void 0===lerp&&(lerp=.05),currentAngle===targetAngle||(Math.abs(targetAngle-currentAngle)<=lerp||Math.abs(targetAngle-currentAngle)>=MATH_CONST$f.PI2-lerp?currentAngle=targetAngle:(Math.abs(targetAngle-currentAngle)>Math.PI&&(targetAngle<currentAngle?targetAngle+=MATH_CONST$f.PI2:targetAngle-=MATH_CONST$f.PI2),currentAngle<targetAngle?currentAngle+=lerp:targetAngle<currentAngle&&(currentAngle-=lerp))),currentAngle},ShortestBetween:function(difference,angle2){difference=angle2-difference;return 0==difference?0:difference-360*Math.floor((difference+180)/360)},Wrap:HasTileAt_1,WrapDegrees:Factory_1},FitOutside_1=function(a,dy){var dx=a.x-dy.x,dy=a.y-dy.y;return Math.sqrt(dx*dx+dy*dy)},MatterPhysics=function(x1,y1,dx,dy){dx=x1-dx,dy=y1-dy;return dx*dx+dy*dy},CircumCenter_1={Between:DistanceBetween_1,BetweenPoints:FitOutside_1,BetweenPointsSquared:function(a,dy){var dx=a.x-dy.x,dy=a.y-dy.y;return dx*dx+dy*dy},Chebyshev:function(x1,y1,x2,y2){return Math.max(Math.abs(x1-x2),Math.abs(y1-y2))},Power:function(x1,y1,x2,y2,pow){return void 0===pow&&(pow=2),Math.sqrt(Math.pow(x2-x1,pow)+Math.pow(y2-y1,pow))},Snake:function(x1,y1,x2,y2){return Math.abs(x1-x2)+Math.abs(y1-y2)},Squared:MatterPhysics},Clone_1$4={Back:CreateGroupLayer_1,Bounce:HexagonalCullBounds_1,Circular:components,Cubic:Copy_1,Elastic:TimelineBuilder_1,Expo:GetCullTilesFunction_1,Linear:CreateFromTiles_1,Quadratic:CullBounds_1,Quartic:ForEachTile_1,Quintic:Blitter_1,Sine:ParseImageLayers_1,Stepped:Bob_1},PluginCache$3=function(a,b,epsilon){return b-(epsilon=void 0===epsilon?1e-4:epsilon)<a},Matter_1=function(a,b,epsilon){return a<b+(epsilon=void 0===epsilon?1e-4:epsilon)},BuildFromPolygon_1={Ceil:function(value,epsilon){return void 0===epsilon&&(epsilon=1e-4),Math.ceil(value-epsilon)},Equal:Detector_1,Floor:function(value,epsilon){return void 0===epsilon&&(epsilon=1e-4),Math.floor(value+epsilon)},GreaterThan:PluginCache$3,LessThan:Matter_1},World_1$1=function(value){if(0===value)return 1;for(var res=value;--value;)res*=value;return res},Factorial=World_1$1,create=function(n,i){return Factorial(n)/Factorial(i)/Factorial(n-i)},Bernstein=create,renderer=function(t,v1,p1,p2,t2){var v0=.5*(p2-v1),v1=.5*(t2-p1),t2=t*t;return(2*p1-2*p2+v0+v1)*(t*t2)+(-3*p1+3*p2-2*v0-v1)*t2+v0*t+p1},CatmullRom$1=renderer;var events$9=function(t,p0,p1,p2,p3){return(k=1-(k=t))*k*k*p0+function(t,p){var k=1-t;return 3*k*k*t*p}(t,p1)+function(t,p){return 3*(1-t)*t*t*p}(t,p2)+function(t,p){return t*t*t*p}(t,p3);var k},Linear$1=NoAudioSoundManager_1;var GLSLFile_1=function(t,p0,p1,p2){return(k=1-(k=t))*k*p0+function(t,p){return 2*(1-t)*t*p}(t,p1)+function(t,p){return t*t*p}(t,p2);var k},SmoothStep=WebAudioSoundManager_1,plugins=function(t,min,max){return min+(max-min)*SmoothStep(t,0,1)},SmootherStep=WebAudioSound_1,time={Bezier:function(v,k){for(var b=0,n=v.length-1,i=0;i<=n;i++)b+=Math.pow(1-k,n-i)*Math.pow(k,i)*v[i]*Bernstein(n,i);return b},CatmullRom:function(v,k){var m=v.length-1,f=m*k,i=Math.floor(f);return v[0]===v[m]?(k<0&&(i=Math.floor(f=m*(1+k))),CatmullRom$1(f-i,v[(i-1+m)%m],v[i],v[(i+1)%m],v[(i+2)%m])):k<0?v[0]-(CatmullRom$1(-f,v[0],v[0],v[1],v[1])-v[0]):1<k?v[m]-(CatmullRom$1(f-m,v[m],v[m],v[m-1],v[m-1])-v[m]):CatmullRom$1(f-i,v[i?i-1:0],v[i],v[m<i+1?m:i+1],v[m<i+2?m:i+2])},CubicBezier:events$9,Linear:function(v,k){var m=v.length-1,f=m*k,i=Math.floor(f);return k<0?Linear$1(v[0],v[1],f):1<k?Linear$1(v[m],v[m-1],m-f):Linear$1(v[i],v[m<i+1?m:i+1],f-i)},QuadraticBezier:GLSLFile_1,SmoothStep:plugins,SmootherStep:function(t,min,max){return min+(max-min)*SmootherStep(t,0,1)}},FitInside_1=function(index){index=Math.log(index)/.6931471805599453;return 1<<Math.ceil(index)},MatterGameObject_1=function(width,height){return 0<width&&0==(width&width-1)&&0<height&&0==(height&height-1)},GetNearestPoint_1={GetNext:FitInside_1,IsSize:MatterGameObject_1,IsValue:function(value){return 0<value&&0==(value&value-1)}},StaggerBuilder_1=function(value,gap,start,divide){return 0===gap?value:(value-=start=void 0===start?0:start,value=gap*Math.ceil(value/gap),divide?(start+value)/gap:start+value)},builders=function(value,gap,start,divide){return 0===gap?value:(value-=start=void 0===start?0:start,value=gap*Math.floor(value/gap),divide?(start+value)/gap:start+value)},core={Ceil:StaggerBuilder_1,Floor:builders,To:function(value,gap,start,divide){return 0===gap?value:(value-=start=void 0===start?0:start,value=gap*Math.round(value/gap),divide?(start+value)/gap:start+value)}},BuildGameObject_1=new Class_1({initialize:function(seeds){void 0===seeds&&(seeds=[(Date.now()*Math.random()).toString()]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.n=0,this.signs=[-1,1],seeds&&this.init(seeds)},rnd:function(){var t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|t,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},hash:function(data){var h,n=this.n;data=data.toString();for(var i=0;i<data.length;i++)h=.02519603282416938*(n+=data.charCodeAt(i)),h-=n=h>>>0,n=(h*=n)>>>0,n+=4294967296*(h-=n);return 2.3283064365386963e-10*((this.n=n)>>>0)},init:function(seeds){"string"==typeof seeds?this.state(seeds):this.sow(seeds)},sow:function(seeds){if(this.n=4022871197,this.s0=this.hash(" "),this.s1=this.hash(" "),this.s2=this.hash(" "),this.c=1,seeds)for(var i=0;i<seeds.length&&null!=seeds[i];i++){var seed=seeds[i];this.s0-=this.hash(seed),this.s0+=~~(this.s0<0),this.s1-=this.hash(seed),this.s1+=~~(this.s1<0),this.s2-=this.hash(seed),this.s2+=~~(this.s2<0)}},integer:function(){return 4294967296*this.rnd()},frac:function(){return this.rnd()+11102230246251565e-32*(2097152*this.rnd()|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(min,max){return Math.floor(this.realInRange(0,max-min+1)+min)},between:function(min,max){return Math.floor(this.realInRange(0,max-min+1)+min)},realInRange:function(min,max){return this.frac()*(max-min)+min},normal:function(){return 1-2*this.frac()},uuid:function(){for(var a="",b="",b=a="";a++<36;b+=~a%5|3*a&4?(15^a?8^this.frac()*(20^a?16:4):4).toString(16):"-");return b},pick:function(array){return array[this.integerInRange(0,array.length-1)]},sign:function(){return this.pick(this.signs)},weightedPick:function(array){return array[~~(Math.pow(this.frac(),2)*(array.length-1)+.5)]},timestamp:function(min,max){return this.realInRange(min||9466848e5,max||1577862e6)},angle:function(){return this.integerInRange(-180,180)},rotation:function(){return this.realInRange(-3.1415926,3.1415926)},state:function(state){return"string"==typeof state&&state.match(/^!rnd/)&&(state=state.split(","),this.c=parseFloat(state[1]),this.s0=parseFloat(state[2]),this.s1=parseFloat(state[3]),this.s2=parseFloat(state[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")},shuffle:function(array){for(var i=array.length-1;0<i;i--){var randomIndex=Math.floor(this.frac()*(i+1)),itemAtIndex=array[randomIndex];array[randomIndex]=array[i],array[i]=itemAtIndex}return array}}),RetroFont_1=function(values){for(var sum=0,i=0;i<values.length;i++)sum+=+values[i];return sum/values.length},Bodies_1=function(min,max){return Math.floor(Math.random()*(max-min+1)+min)},FromPoints_1=function(value,p,base){void 0===p&&(p=0),void 0===base&&(base=10);p=Math.pow(base,-p);return Math.ceil(value*p)/p},CSSFile_1=function(a,b){return Math.abs(a-b)},Vector3$a=new Class_1({initialize:function(x,y,z){this.x=0,this.y=0,this.z=0,"object"==typeof x?(this.x=x.x||0,this.y=x.y||0,this.z=x.z||0):(this.x=x||0,this.y=y||0,this.z=z||0)},up:function(){return this.x=0,this.y=1,this.z=0,this},min:function(v){return this.x=Math.min(this.x,v.x),this.y=Math.min(this.y,v.y),this.z=Math.min(this.z,v.z),this},max:function(v){return this.x=Math.max(this.x,v.x),this.y=Math.max(this.y,v.y),this.z=Math.max(this.z,v.z),this},clone:function(){return new Vector3$a(this.x,this.y,this.z)},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},crossVectors:function(by,bz){var ax=by.x,ay=by.y,az=by.z,bx=bz.x,by=bz.y,bz=bz.z;return this.x=ay*bz-az*by,this.y=az*bx-ax*bz,this.z=ax*by-ay*bx,this},equals:function(v){return this.x===v.x&&this.y===v.y&&this.z===v.z},copy:function(src){return this.x=src.x,this.y=src.y,this.z=src.z||0,this},set:function(x,y,z){return"object"==typeof x?(this.x=x.x||0,this.y=x.y||0,this.z=x.z||0):(this.x=x||0,this.y=y||0,this.z=z||0),this},setFromMatrixPosition:function(m){return this.fromArray(m.val,12)},setFromMatrixColumn:function(mat4,index){return this.fromArray(mat4.val,4*index)},fromArray:function(array,offset){return this.x=array[offset=void 0===offset?0:offset],this.y=array[offset+1],this.z=array[offset+2],this},add:function(v){return this.x+=v.x,this.y+=v.y,this.z+=v.z||0,this},addScalar:function(s){return this.x+=s,this.y+=s,this.z+=s,this},addScale:function(v,scale){return this.x+=v.x*scale,this.y+=v.y*scale,this.z+=v.z*scale||0,this},subtract:function(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z||0,this},multiply:function(v){return this.x*=v.x,this.y*=v.y,this.z*=v.z||1,this},scale:function(scale){return isFinite(scale)?(this.x*=scale,this.y*=scale,this.z*=scale):(this.x=0,this.y=0,this.z=0),this},divide:function(v){return this.x/=v.x,this.y/=v.y,this.z/=v.z||1,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},distance:function(dz){var dx=dz.x-this.x,dy=dz.y-this.y,dz=dz.z-this.z||0;return Math.sqrt(dx*dx+dy*dy+dz*dz)},distanceSq:function(dz){var dx=dz.x-this.x,dy=dz.y-this.y,dz=dz.z-this.z||0;return dx*dx+dy*dy+dz*dz},length:function(){var x=this.x,y=this.y,z=this.z;return Math.sqrt(x*x+y*y+z*z)},lengthSq:function(){var x=this.x,y=this.y,z=this.z;return x*x+y*y+z*z},normalize:function(){var x=this.x,y=this.y,z=this.z,len=x*x+y*y+z*z;return 0<len&&(len=1/Math.sqrt(len),this.x=x*len,this.y=y*len,this.z=z*len),this},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z},cross:function(bz){var ax=this.x,ay=this.y,az=this.z,bx=bz.x,by=bz.y,bz=bz.z;return this.x=ay*bz-az*by,this.y=az*bx-ax*bz,this.z=ax*by-ay*bx,this},lerp:function(v,t){var ax=this.x,ay=this.y,az=this.z;return this.x=ax+(t=void 0===t?0:t)*(v.x-ax),this.y=ay+t*(v.y-ay),this.z=az+t*(v.z-az),this},applyMatrix3:function(m){var x=this.x,y=this.y,z=this.z,m=m.val;return this.x=m[0]*x+m[3]*y+m[6]*z,this.y=m[1]*x+m[4]*y+m[7]*z,this.z=m[2]*x+m[5]*y+m[8]*z,this},applyMatrix4:function(w){var x=this.x,y=this.y,z=this.z,m=w.val,w=1/(m[3]*x+m[7]*y+m[11]*z+m[15]);return this.x=(m[0]*x+m[4]*y+m[8]*z+m[12])*w,this.y=(m[1]*x+m[5]*y+m[9]*z+m[13])*w,this.z=(m[2]*x+m[6]*y+m[10]*z+m[14])*w,this},transformMat3:function(m){var x=this.x,y=this.y,z=this.z,m=m.val;return this.x=x*m[0]+y*m[3]+z*m[6],this.y=x*m[1]+y*m[4]+z*m[7],this.z=x*m[2]+y*m[5]+z*m[8],this},transformMat4:function(m){var x=this.x,y=this.y,z=this.z,m=m.val;return this.x=m[0]*x+m[4]*y+m[8]*z+m[12],this.y=m[1]*x+m[5]*y+m[9]*z+m[13],this.z=m[2]*x+m[6]*y+m[10]*z+m[14],this},transformCoordinates:function(tz){var x=this.x,y=this.y,z=this.z,tw=tz.val,tx=x*tw[0]+y*tw[4]+z*tw[8]+tw[12],ty=x*tw[1]+y*tw[5]+z*tw[9]+tw[13],tz=x*tw[2]+y*tw[6]+z*tw[10]+tw[14],tw=x*tw[3]+y*tw[7]+z*tw[11]+tw[15];return this.x=tx/tw,this.y=ty/tw,this.z=tz/tw,this},transformQuat:function(iz){var x=this.x,y=this.y,iw=this.z,qx=iz.x,qy=iz.y,qz=iz.z,qw=iz.w,ix=qw*x+qy*iw-qz*y,iy=qw*y+qz*x-qx*iw,iz=qw*iw+qx*y-qy*x,iw=-qx*x-qy*y-qz*iw;return this.x=ix*qw+iw*-qx+iy*-qz-iz*-qy,this.y=iy*qw+iw*-qy+iz*-qx-ix*-qz,this.z=iz*qw+iw*-qz+ix*-qy-iy*-qx,this},project:function(a32){var x=this.x,y=this.y,z=this.z,lw=a32.val,a00=lw[0],a01=lw[1],a02=lw[2],a03=lw[3],a10=lw[4],a11=lw[5],a12=lw[6],a13=lw[7],a20=lw[8],a21=lw[9],a22=lw[10],a23=lw[11],a30=lw[12],a31=lw[13],a32=lw[14],lw=1/(x*a03+y*a13+z*a23+lw[15]);return this.x=(x*a00+y*a10+z*a20+a30)*lw,this.y=(x*a01+y*a11+z*a21+a31)*lw,this.z=(x*a02+y*a12+z*a22+a32)*lw,this},projectViewMatrix:function(viewMatrix,projectionMatrix){return this.applyMatrix4(viewMatrix).applyMatrix4(projectionMatrix)},unprojectViewMatrix:function(projectionMatrix,worldMatrix){return this.applyMatrix4(projectionMatrix).applyMatrix4(worldMatrix)},unproject:function(x,invProjectionView){var y=x.x,z=x.y,viewWidth=x.z,viewHeight=x.w,x=this.x-y,y=viewHeight-this.y-1-z,z=this.z;return this.x=2*x/viewWidth-1,this.y=2*y/viewHeight-1,this.z=2*z-1,this.project(invProjectionView)},reset:function(){return this.x=0,this.y=0,this.z=0,this}});Vector3$a.ZERO=new Vector3$a,Vector3$a.RIGHT=new Vector3$a(1,0,0),Vector3$a.LEFT=new Vector3$a(-1,0,0),Vector3$a.UP=new Vector3$a(0,-1,0),Vector3$a.DOWN=new Vector3$a(0,1,0),Vector3$a.FORWARD=new Vector3$a(0,0,1),Vector3$a.BACK=new Vector3$a(0,0,-1),Vector3$a.ONE=new Vector3$a(1,1,1);var FromXY_1=Vector3$a,structs=FromXY_1,Matrix4$7=new Class_1({initialize:function(m){this.val=new Float32Array(16),m?this.copy(m):this.identity()},clone:function(){return new Matrix4$7(this)},set:function(src){return this.copy(src)},setValues:function(m00,m01,m02,m03,m10,m11,m12,m13,m20,m21,m22,m23,m30,m31,m32,m33){var out=this.val;return out[0]=m00,out[1]=m01,out[2]=m02,out[3]=m03,out[4]=m10,out[5]=m11,out[6]=m12,out[7]=m13,out[8]=m20,out[9]=m21,out[10]=m22,out[11]=m23,out[12]=m30,out[13]=m31,out[14]=m32,out[15]=m33,this},copy:function(a){a=a.val;return this.setValues(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])},fromArray:function(a){return this.setValues(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])},zero:function(){return this.setValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},transform:function(position,sz,sy){var rm=_tempMat1.fromQuat(sy).val,sx=sz.x,sy=sz.y,sz=sz.z;return this.setValues(rm[0]*sx,rm[1]*sx,rm[2]*sx,0,rm[4]*sy,rm[5]*sy,rm[6]*sy,0,rm[8]*sz,rm[9]*sz,rm[10]*sz,0,position.x,position.y,position.z,1)},xyz:function(x,y,z){this.identity();var out=this.val;return out[12]=x,out[13]=y,out[14]=z,this},scaling:function(x,y,z){this.zero();var out=this.val;return out[0]=x,out[5]=y,out[10]=z,out[15]=1,this},identity:function(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},transpose:function(){var a=this.val,a01=a[1],a02=a[2],a03=a[3],a12=a[6],a13=a[7],a23=a[11];return a[1]=a[4],a[2]=a[8],a[3]=a[12],a[4]=a01,a[6]=a[9],a[7]=a[13],a[8]=a02,a[9]=a12,a[11]=a[14],a[12]=a03,a[13]=a13,a[14]=a23,this},getInverse:function(m){return this.copy(m),this.invert()},invert:function(){var det=this.val,a00=det[0],a01=det[1],a02=det[2],a03=det[3],a10=det[4],a11=det[5],a12=det[6],a13=det[7],a20=det[8],a21=det[9],a22=det[10],a23=det[11],a30=det[12],a31=det[13],a32=det[14],a33=det[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;return det?this.setValues((a11*b11-a12*b10+a13*b09)*(det=1/det),(a02*b10-a01*b11-a03*b09)*det,(a31*b05-a32*b04+a33*b03)*det,(a22*b04-a21*b05-a23*b03)*det,(a12*b08-a10*b11-a13*b07)*det,(a00*b11-a02*b08+a03*b07)*det,(a32*b02-a30*b05-a33*b01)*det,(a20*b05-a22*b02+a23*b01)*det,(a10*b10-a11*b08+a13*b06)*det,(a01*b08-a00*b10-a03*b06)*det,(a30*b04-a31*b02+a33*b00)*det,(a21*b02-a20*b04-a23*b00)*det,(a11*b07-a10*b09-a12*b06)*det,(a00*b09-a01*b07+a02*b06)*det,(a31*b01-a30*b03-a32*b00)*det,(a20*b03-a21*b01+a22*b00)*det):this},adjoint:function(){var a33=this.val,a00=a33[0],a01=a33[1],a02=a33[2],a03=a33[3],a10=a33[4],a11=a33[5],a12=a33[6],a13=a33[7],a20=a33[8],a21=a33[9],a22=a33[10],a23=a33[11],a30=a33[12],a31=a33[13],a32=a33[14],a33=a33[15];return this.setValues(a11*(a22*a33-a23*a32)-a21*(a12*a33-a13*a32)+a31*(a12*a23-a13*a22),-(a01*(a22*a33-a23*a32)-a21*(a02*a33-a03*a32)+a31*(a02*a23-a03*a22)),a01*(a12*a33-a13*a32)-a11*(a02*a33-a03*a32)+a31*(a02*a13-a03*a12),-(a01*(a12*a23-a13*a22)-a11*(a02*a23-a03*a22)+a21*(a02*a13-a03*a12)),-(a10*(a22*a33-a23*a32)-a20*(a12*a33-a13*a32)+a30*(a12*a23-a13*a22)),a00*(a22*a33-a23*a32)-a20*(a02*a33-a03*a32)+a30*(a02*a23-a03*a22),-(a00*(a12*a33-a13*a32)-a10*(a02*a33-a03*a32)+a30*(a02*a13-a03*a12)),a00*(a12*a23-a13*a22)-a10*(a02*a23-a03*a22)+a20*(a02*a13-a03*a12),a10*(a21*a33-a23*a31)-a20*(a11*a33-a13*a31)+a30*(a11*a23-a13*a21),-(a00*(a21*a33-a23*a31)-a20*(a01*a33-a03*a31)+a30*(a01*a23-a03*a21)),a00*(a11*a33-a13*a31)-a10*(a01*a33-a03*a31)+a30*(a01*a13-a03*a11),-(a00*(a11*a23-a13*a21)-a10*(a01*a23-a03*a21)+a20*(a01*a13-a03*a11)),-(a10*(a21*a32-a22*a31)-a20*(a11*a32-a12*a31)+a30*(a11*a22-a12*a21)),a00*(a21*a32-a22*a31)-a20*(a01*a32-a02*a31)+a30*(a01*a22-a02*a21),-(a00*(a11*a32-a12*a31)-a10*(a01*a32-a02*a31)+a30*(a01*a12-a02*a11)),a00*(a11*a22-a12*a21)-a10*(a01*a22-a02*a21)+a20*(a01*a12-a02*a11))},determinant:function(){var a33=this.val,a00=a33[0],a01=a33[1],a02=a33[2],a03=a33[3],a10=a33[4],a11=a33[5],a12=a33[6],a13=a33[7],a20=a33[8],a21=a33[9],a22=a33[10],a23=a33[11],a30=a33[12],a31=a33[13],a32=a33[14],a33=a33[15];return(a00*a11-a01*a10)*(a22*a33-a23*a32)-(a00*a12-a02*a10)*(a21*a33-a23*a31)+(a00*a13-a03*a10)*(a21*a32-a22*a31)+(a01*a12-a02*a11)*(a20*a33-a23*a30)-(a01*a13-a03*a11)*(a20*a32-a22*a30)+(a02*a13-a03*a12)*(a20*a31-a21*a30)},multiply:function(b3){var a=this.val,a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b=b3.val,b0=b[0],b1=b[1],b2=b[2],b3=b[3];return a[0]=b0*a00+b1*a10+b2*a20+b3*a30,a[1]=b0*a01+b1*a11+b2*a21+b3*a31,a[2]=b0*a02+b1*a12+b2*a22+b3*a32,a[3]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[4],b1=b[5],b2=b[6],b3=b[7],a[4]=b0*a00+b1*a10+b2*a20+b3*a30,a[5]=b0*a01+b1*a11+b2*a21+b3*a31,a[6]=b0*a02+b1*a12+b2*a22+b3*a32,a[7]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[8],b1=b[9],b2=b[10],b3=b[11],a[8]=b0*a00+b1*a10+b2*a20+b3*a30,a[9]=b0*a01+b1*a11+b2*a21+b3*a31,a[10]=b0*a02+b1*a12+b2*a22+b3*a32,a[11]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[12],b1=b[13],b2=b[14],b3=b[15],a[12]=b0*a00+b1*a10+b2*a20+b3*a30,a[13]=b0*a01+b1*a11+b2*a21+b3*a31,a[14]=b0*a02+b1*a12+b2*a22+b3*a32,a[15]=b0*a03+b1*a13+b2*a23+b3*a33,this},multiplyLocal:function(b){var a=this.val,b=b.val;return this.setValues(a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12],a[0]*b[1]+a[1]*b[5]+a[2]*b[9]+a[3]*b[13],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]+a[3]*b[14],a[0]*b[3]+a[1]*b[7]+a[2]*b[11]+a[3]*b[15],a[4]*b[0]+a[5]*b[4]+a[6]*b[8]+a[7]*b[12],a[4]*b[1]+a[5]*b[5]+a[6]*b[9]+a[7]*b[13],a[4]*b[2]+a[5]*b[6]+a[6]*b[10]+a[7]*b[14],a[4]*b[3]+a[5]*b[7]+a[6]*b[11]+a[7]*b[15],a[8]*b[0]+a[9]*b[4]+a[10]*b[8]+a[11]*b[12],a[8]*b[1]+a[9]*b[5]+a[10]*b[9]+a[11]*b[13],a[8]*b[2]+a[9]*b[6]+a[10]*b[10]+a[11]*b[14],a[8]*b[3]+a[9]*b[7]+a[10]*b[11]+a[11]*b[15],a[12]*b[0]+a[13]*b[4]+a[14]*b[8]+a[15]*b[12],a[12]*b[1]+a[13]*b[5]+a[14]*b[9]+a[15]*b[13],a[12]*b[2]+a[13]*b[6]+a[14]*b[10]+a[15]*b[14],a[12]*b[3]+a[13]*b[7]+a[14]*b[11]+a[15]*b[15])},premultiply:function(m){return this.multiplyMatrices(m,this)},multiplyMatrices:function(b41,b42){var b43=b41.val,b44=b42.val,a11=b43[0],a12=b43[4],a13=b43[8],a14=b43[12],a21=b43[1],a22=b43[5],a23=b43[9],a24=b43[13],a31=b43[2],a32=b43[6],a33=b43[10],a34=b43[14],a41=b43[3],a42=b43[7],a43=b43[11],a44=b43[15],b11=b44[0],b12=b44[4],b13=b44[8],b14=b44[12],b21=b44[1],b22=b44[5],b23=b44[9],b24=b44[13],b31=b44[2],b32=b44[6],b33=b44[10],b34=b44[14],b41=b44[3],b42=b44[7],b43=b44[11],b44=b44[15];return this.setValues(a11*b11+a12*b21+a13*b31+a14*b41,a21*b11+a22*b21+a23*b31+a24*b41,a31*b11+a32*b21+a33*b31+a34*b41,a41*b11+a42*b21+a43*b31+a44*b41,a11*b12+a12*b22+a13*b32+a14*b42,a21*b12+a22*b22+a23*b32+a24*b42,a31*b12+a32*b22+a33*b32+a34*b42,a41*b12+a42*b22+a43*b32+a44*b42,a11*b13+a12*b23+a13*b33+a14*b43,a21*b13+a22*b23+a23*b33+a24*b43,a31*b13+a32*b23+a33*b33+a34*b43,a41*b13+a42*b23+a43*b33+a44*b43,a11*b14+a12*b24+a13*b34+a14*b44,a21*b14+a22*b24+a23*b34+a24*b44,a31*b14+a32*b24+a33*b34+a34*b44,a41*b14+a42*b24+a43*b34+a44*b44)},translate:function(v){return this.translateXYZ(v.x,v.y,v.z)},translateXYZ:function(x,y,z){var a=this.val;return a[12]=a[0]*x+a[4]*y+a[8]*z+a[12],a[13]=a[1]*x+a[5]*y+a[9]*z+a[13],a[14]=a[2]*x+a[6]*y+a[10]*z+a[14],a[15]=a[3]*x+a[7]*y+a[11]*z+a[15],this},scale:function(v){return this.scaleXYZ(v.x,v.y,v.z)},scaleXYZ:function(x,y,z){var a=this.val;return a[0]=a[0]*x,a[1]=a[1]*x,a[2]=a[2]*x,a[3]=a[3]*x,a[4]=a[4]*y,a[5]=a[5]*y,a[6]=a[6]*y,a[7]=a[7]*y,a[8]=a[8]*z,a[9]=a[9]*z,a[10]=a[10]*z,a[11]=a[11]*z,this},makeRotationAxis:function(ty,tx){var c=Math.cos(tx),s=Math.sin(tx),t=1-c,x=ty.x,y=ty.y,z=ty.z,tx=t*x,ty=t*y;return this.setValues(tx*x+c,tx*y-s*z,tx*z+s*y,0,tx*y+s*z,ty*y+c,ty*z-s*x,0,tx*z-s*y,ty*z+s*x,t*z*z+c,0,0,0,0,1)},rotate:function(b12,b10){var b20=this.val,x=b10.x,y=b10.y,z=b10.z,b11=Math.sqrt(x*x+y*y+z*z);if(Math.abs(b11)<1e-6)return this;x*=b11=1/b11,y*=b11,z*=b11;var b21=Math.sin(b12),b22=Math.cos(b12),t=1-b22,a00=b20[0],a01=b20[1],a02=b20[2],a03=b20[3],a10=b20[4],a11=b20[5],a12=b20[6],a13=b20[7],a20=b20[8],a21=b20[9],a22=b20[10],a23=b20[11],a30=b20[12],a31=b20[13],a32=b20[14],a33=b20[15],b00=x*x*t+b22,b01=y*x*t+z*b21,b02=z*x*t-y*b21,b10=x*y*t-z*b21,b11=y*y*t+b22,b12=z*y*t+x*b21,b20=x*z*t+y*b21,b21=y*z*t-x*b21,b22=z*z*t+b22;return this.setValues(a00*b00+a10*b01+a20*b02,a01*b00+a11*b01+a21*b02,a02*b00+a12*b01+a22*b02,a03*b00+a13*b01+a23*b02,a00*b10+a10*b11+a20*b12,a01*b10+a11*b11+a21*b12,a02*b10+a12*b11+a22*b12,a03*b10+a13*b11+a23*b12,a00*b20+a10*b21+a20*b22,a01*b20+a11*b21+a21*b22,a02*b20+a12*b21+a22*b22,a03*b20+a13*b21+a23*b22,a30,a31,a32,a33)},rotateX:function(a23){var a=this.val,s=Math.sin(a23),c=Math.cos(a23),a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11];return a[4]=a10*c+a20*s,a[5]=a11*c+a21*s,a[6]=a12*c+a22*s,a[7]=a13*c+a23*s,a[8]=a20*c-a10*s,a[9]=a21*c-a11*s,a[10]=a22*c-a12*s,a[11]=a23*c-a13*s,this},rotateY:function(a23){var a=this.val,s=Math.sin(a23),c=Math.cos(a23),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a20=a[8],a21=a[9],a22=a[10],a23=a[11];return a[0]=a00*c-a20*s,a[1]=a01*c-a21*s,a[2]=a02*c-a22*s,a[3]=a03*c-a23*s,a[8]=a00*s+a20*c,a[9]=a01*s+a21*c,a[10]=a02*s+a22*c,a[11]=a03*s+a23*c,this},rotateZ:function(a13){var a=this.val,s=Math.sin(a13),c=Math.cos(a13),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7];return a[0]=a00*c+a10*s,a[1]=a01*c+a11*s,a[2]=a02*c+a12*s,a[3]=a03*c+a13*s,a[4]=a10*c-a00*s,a[5]=a11*c-a01*s,a[6]=a12*c-a02*s,a[7]=a13*c-a03*s,this},fromRotationTranslation:function(xz,v){var yy=xz.x,yz=xz.y,zz=xz.z,w=xz.w,wx=yy+yy,wy=yz+yz,wz=zz+zz,xx=yy*wx,xy=yy*wy,xz=yy*wz,yy=yz*wy,yz=yz*wz,zz=zz*wz,wx=w*wx,wy=w*wy,wz=w*wz;return this.setValues(1-(yy+zz),xy+wz,xz-wy,0,xy-wz,1-(xx+zz),yz+wx,0,xz+wy,yz-wx,1-(xx+yy),0,v.x,v.y,v.z,1)},fromQuat:function(xz){var yy=xz.x,yz=xz.y,zz=xz.z,w=xz.w,wx=yy+yy,wy=yz+yz,wz=zz+zz,xx=yy*wx,xy=yy*wy,xz=yy*wz,yy=yz*wy,yz=yz*wz,zz=zz*wz,wx=w*wx,wy=w*wy,wz=w*wz;return this.setValues(1-(yy+zz),xy+wz,xz-wy,0,xy-wz,1-(xx+zz),yz+wx,0,xz+wy,yz-wx,1-(xx+yy),0,0,0,0,1)},frustum:function(left,right,bottom,top,near,far){var rl=1/(right-left),tb=1/(top-bottom),nf=1/(near-far);return this.setValues(2*near*rl,0,0,0,0,2*near*tb,0,0,(right+left)*rl,(top+bottom)*tb,(far+near)*nf,-1,0,0,far*near*2*nf,0)},perspective:function(nf,aspect,near,far){var f=1/Math.tan(nf/2),nf=1/(near-far);return this.setValues(f/aspect,0,0,0,0,f,0,0,0,0,(far+near)*nf,-1,0,0,2*far*near*nf,0)},perspectiveLH:function(width,height,near,far){return this.setValues(2*near/width,0,0,0,0,2*near/height,0,0,0,0,-far/(near-far),1,0,0,near*far/(near-far),0)},ortho:function(left,right,bottom,top,near,far){var lr=0===(lr=left-right)?lr:1/lr,bt=0===(bt=bottom-top)?bt:1/bt,nf=0===(nf=near-far)?nf:1/nf;return this.setValues(-2*lr,0,0,0,0,-2*bt,0,0,0,0,2*nf,0,(left+right)*lr,(top+bottom)*bt,(far+near)*nf,1)},lookAtRH:function(eye,target,up){var m=this.val;return _z.subVectors(eye,target),0===_z.getLengthSquared()&&(_z.z=1),_z.normalize(),_x.crossVectors(up,_z),0===_x.getLengthSquared()&&(1===Math.abs(up.z)?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(up,_z)),_x.normalize(),_y.crossVectors(_z,_x),m[0]=_x.x,m[1]=_x.y,m[2]=_x.z,m[4]=_y.x,m[5]=_y.y,m[6]=_y.z,m[8]=_z.x,m[9]=_z.y,m[10]=_z.z,this},lookAt:function(z1,len,z2){var eyex=z1.x,eyey=z1.y,eyez=z1.z,y1=z2.x,y2=z2.y,y0=z2.z,x0=len.x,x1=len.y,x2=len.z;if(Math.abs(eyex-x0)<1e-6&&Math.abs(eyey-x1)<1e-6&&Math.abs(eyez-x2)<1e-6)return this.identity();var z0=eyex-x0,z1=eyey-x1,z2=eyez-x2,len=1/Math.sqrt(z0*z0+z1*z1+z2*z2),x0=y2*(z2*=len)-y0*(z1*=len),x1=y0*(z0*=len)-y1*z2,x2=y1*z1-y2*z0;(len=Math.sqrt(x0*x0+x1*x1+x2*x2))?(x0*=len=1/len,x1*=len,x2*=len):x2=x1=x0=0;y0=z1*x2-z2*x1,y1=z2*x0-z0*x2,y2=z0*x1-z1*x0;return(len=Math.sqrt(y0*y0+y1*y1+y2*y2))?(y0*=len=1/len,y1*=len,y2*=len):y2=y1=y0=0,this.setValues(x0,y0,z0,0,x1,y1,z1,0,x2,y2,z2,0,-(x0*eyex+x1*eyey+x2*eyez),-(y0*eyex+y1*eyey+y2*eyez),-(z0*eyex+z1*eyey+z2*eyez),1)},yawPitchRoll:function(yaw,pitch,c){this.zero(),_tempMat1.zero(),_tempMat2.zero();var m0=this.val,m1=_tempMat1.val,m2=_tempMat2.val,s=Math.sin(c),c=Math.cos(c);return m0[10]=1,m0[15]=1,m0[0]=c,m0[1]=s,m0[4]=-s,m0[5]=c,s=Math.sin(pitch),c=Math.cos(pitch),m1[0]=1,m1[15]=1,m1[5]=c,m1[10]=c,m1[9]=-s,m1[6]=s,s=Math.sin(yaw),c=Math.cos(yaw),m2[5]=1,m2[15]=1,m2[0]=c,m2[2]=-s,m2[8]=s,m2[10]=c,this.multiplyLocal(_tempMat1),this.multiplyLocal(_tempMat2),this},setWorldMatrix:function(rotation,position,scale,viewMatrix,projectionMatrix){return this.yawPitchRoll(rotation.y,rotation.x,rotation.z),_tempMat1.scaling(scale.x,scale.y,scale.z),_tempMat2.xyz(position.x,position.y,position.z),this.multiplyLocal(_tempMat1),this.multiplyLocal(_tempMat2),viewMatrix&&this.multiplyLocal(viewMatrix),projectionMatrix&&this.multiplyLocal(projectionMatrix),this},multiplyToMat4:function(b31,out){var b32=this.val,b33=b31.val,a00=b32[0],a01=b32[1],a02=b32[2],a03=b32[3],a10=b32[4],a11=b32[5],a12=b32[6],a13=b32[7],a20=b32[8],a21=b32[9],a22=b32[10],a23=b32[11],a30=b32[12],a31=b32[13],a32=b32[14],a33=b32[15],b00=b33[0],b01=b33[1],b02=b33[2],b03=b33[3],b10=b33[4],b11=b33[5],b12=b33[6],b13=b33[7],b20=b33[8],b21=b33[9],b22=b33[10],b23=b33[11],b30=b33[12],b31=b33[13],b32=b33[14],b33=b33[15];return out.setValues(b00*a00+b01*a10+b02*a20+b03*a30,b01*a01+b01*a11+b02*a21+b03*a31,b02*a02+b01*a12+b02*a22+b03*a32,b03*a03+b01*a13+b02*a23+b03*a33,b10*a00+b11*a10+b12*a20+b13*a30,b10*a01+b11*a11+b12*a21+b13*a31,b10*a02+b11*a12+b12*a22+b13*a32,b10*a03+b11*a13+b12*a23+b13*a33,b20*a00+b21*a10+b22*a20+b23*a30,b20*a01+b21*a11+b22*a21+b23*a31,b20*a02+b21*a12+b22*a22+b23*a32,b20*a03+b21*a13+b22*a23+b23*a33,b30*a00+b31*a10+b32*a20+b33*a30,b30*a01+b31*a11+b32*a21+b33*a31,b30*a02+b31*a12+b32*a22+b33*a32,b30*a03+b31*a13+b32*a23+b33*a33)},fromRotationXYTranslation:function(c21,c02,translateFirst){var x=c02.x,y=c02.y,z=c02.z,sx=Math.sin(c21.x),cx=Math.cos(c21.x),sy=Math.sin(c21.y),cy=Math.cos(c21.y),a30=x,a31=y,a32=z,c22=-sx,c01=0-c22*sy,c02=0-cx*sy,c21=c22*cy,c22=cx*cy;return translateFirst||(a30=cy*x+sy*z,a31=c01*x+cx*y+c21*z,a32=c02*x+sx*y+c22*z),this.setValues(cy,c01,c02,0,0,cx,sx,0,sy,c21,c22,0,a30,a31,a32,1)},getMaxScaleOnAxis:function(){var scaleZSq=this.val,scaleXSq=scaleZSq[0]*scaleZSq[0]+scaleZSq[1]*scaleZSq[1]+scaleZSq[2]*scaleZSq[2],scaleYSq=scaleZSq[4]*scaleZSq[4]+scaleZSq[5]*scaleZSq[5]+scaleZSq[6]*scaleZSq[6],scaleZSq=scaleZSq[8]*scaleZSq[8]+scaleZSq[9]*scaleZSq[9]+scaleZSq[10]*scaleZSq[10];return Math.sqrt(Math.max(scaleXSq,scaleYSq,scaleZSq))}}),_tempMat1=new Matrix4$7,_tempMat2=new Matrix4$7,_x=new structs,_y=new structs,_z=new structs,FloorAll_1=Matrix4$7,Clamp$9=Character,FileTypesManager$1=Class_1,NOOP$p=gameConfig,tempMatrix$5=new FloorAll_1,input=new FileTypesManager$1({initialize:function Euler(x,y,z,order){void 0===y&&(y=0),void 0===z&&(z=0),void 0===order&&(order=Euler.DefaultOrder),this._x=x=void 0===x?0:x,this._y=y,this._z=z,this._order=order,this.onChangeCallback=NOOP$p},x:{get:function(){return this._x},set:function(value){this._x=value,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(value){this._y=value,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(value){this._z=value,this.onChangeCallback(this)}},order:{get:function(){return this._order},set:function(value){this._order=value,this.onChangeCallback(this)}},set:function(x,y,z,order){return void 0===order&&(order=this._order),this._x=x,this._y=y,this._z=z,this._order=order,this.onChangeCallback(this),this},copy:function(euler){return this.set(euler.x,euler.y,euler.z,euler.order)},setFromQuaternion:function(quaternion,order,update){return void 0===order&&(order=this._order),void 0===update&&(update=!1),tempMatrix$5.fromQuat(quaternion),this.setFromRotationMatrix(tempMatrix$5,order,update)},setFromRotationMatrix:function(elements,order,update){void 0===order&&(order=this._order),void 0===update&&(update=!1);var elements=elements.val,m11=elements[0],m12=elements[4],m13=elements[8],m21=elements[1],m22=elements[5],m23=elements[9],m31=elements[2],m32=elements[6],m33=elements[10],x=0,y=0,z=0;switch(order){case"XYZ":y=Math.asin(Clamp$9(m13,-1,1)),Math.abs(m13)<.99999?(x=Math.atan2(-m23,m33),z=Math.atan2(-m12,m11)):x=Math.atan2(m32,m22);break;case"YXZ":x=Math.asin(-Clamp$9(m23,-1,1)),Math.abs(m23)<.99999?(y=Math.atan2(m13,m33),z=Math.atan2(m21,m22)):y=Math.atan2(-m31,m11);break;case"ZXY":x=Math.asin(Clamp$9(m32,-1,1)),z=Math.abs(m32)<.99999?(y=Math.atan2(-m31,m33),Math.atan2(-m12,m22)):Math.atan2(m21,m11);break;case"ZYX":y=Math.asin(-Clamp$9(m31,-1,1)),z=Math.abs(m31)<.99999?(x=Math.atan2(m32,m33),Math.atan2(m21,m11)):Math.atan2(-m12,m22);break;case"YZX":z=Math.asin(Clamp$9(m21,-1,1)),y=Math.abs(m21)<.99999?(x=Math.atan2(-m23,m22),Math.atan2(-m31,m11)):Math.atan2(m13,m33);break;case"XZY":z=Math.asin(-Clamp$9(m12,-1,1)),Math.abs(m12)<.99999?(x=Math.atan2(m32,m22),y=Math.atan2(m13,m11)):x=Math.atan2(-m23,m33)}return this._x=x,this._y=y,this._z=z,this._order=order,update&&this.onChangeCallback(this),this}});input.RotationOrders=["XYZ","YXZ","ZXY","ZYX","YZX","XZY"],input.DefaultOrder="XYZ";var tilemaps=input,Constraint_1=function(value,p,base){void 0===p&&(p=0),void 0===base&&(base=10);p=Math.pow(base,-p);return Math.floor(value*p)/p},Tween_1=function(distance,time){return distance/time/1e3},particles=function(value){return value==parseFloat(value)?!(value%2):void 0},HTML5AudioFile_1=function(value){return value===parseFloat(value)?!(value%2):void 0},SAT_1=function(value,amount,max){return Math.min(value+amount,max)},GetTilesWithinWorldXY_1=function(values){var valuesNum=values.length;if(0===valuesNum)return 0;values.sort(function(a,b){return a-b});var halfIndex=Math.floor(valuesNum/2);return valuesNum%2==0?(values[halfIndex]+values[halfIndex-1])/2:values[halfIndex]},components$1=function(value,amount,min){return Math.max(value-amount,min)},curves=function(value,percentage,max,upperMax){percentage=(value-percentage)/((max=void 0===max?percentage+1:max)-percentage);return 1<percentage?void 0!==upperMax?(percentage=(upperMax-value)/(upperMax-max))<0&&(percentage=0):percentage=1:percentage<0&&(percentage=0),percentage},CONST$1b=Tweens,Common_1=function(radians){return radians*CONST$1b.RAD_TO_DEG},PathFollower_1=function(vector,scale){void 0===scale&&(scale=1);var r=2*Math.random()*Math.PI;return vector.x=Math.cos(r)*scale,vector.y=Math.sin(r)*scale,vector},TweenManager=function(vec3,radius){void 0===radius&&(radius=1);var r=2*Math.random()*Math.PI,z=2*Math.random()-1,zScale=Math.sqrt(1-z*z)*radius;return vec3.x=Math.cos(r)*zScale,vec3.y=Math.sin(r)*zScale,vec3.z=z*radius,vec3},data=function(vec4,scale){return void 0===scale&&(scale=1),vec4.x=(2*Math.random()-1)*scale,vec4.y=(2*Math.random()-1)*scale,vec4.z=(2*Math.random()-1)*scale,vec4.w=(2*Math.random()-1)*scale,vec4},Rotate_1$2=function(point,angle){var x=point.x,y=point.y;return point.x=x*Math.cos(angle)-y*Math.sin(angle),point.y=x*Math.sin(angle)+y*Math.cos(angle),point},GetTileAtWorldXY_1=function(point,x,y,angle,distance){return point.x=x+distance*Math.cos(angle),point.y=y+distance*Math.sin(angle),point},Resolver_1=function(value){return 0<value?Math.ceil(value):Math.floor(value)},Inflate_1=function(value,p,base){void 0===p&&(p=0),void 0===base&&(base=10);p=Math.pow(base,-p);return Math.round(value*p)/p},Base64ToArrayBuffer_1=function(length,sinAmp,cosAmp,frequency){void 0===sinAmp&&(sinAmp=1),void 0===cosAmp&&(cosAmp=1),void 0===frequency&&(frequency=1),frequency*=Math.PI/length;for(var cos=[],sin=[],c=0;c<length;c++)sinAmp+=(cosAmp-=sinAmp*frequency)*frequency,cos[c]=cosAmp,sin[c]=sinAmp;return{sin:sin,cos:cos,length:length}},Vector2$I=BuildTilesetIndex_1,HTMLTextureFile_1=function(index,width,height,out){void 0===out&&(out=new Vector2$I);var x=0,y=0;return 0<index&&index<=width*height&&(x=width-1<index?index-(y=Math.floor(index/width))*width:index),out.set(x,y)},Game_1=function(a,b,tolerance){return Math.abs(a-b)<=tolerance},Vector4$3=new Class_1({initialize:function(x,y,z,w){this.x=0,this.y=0,this.z=0,this.w=0,"object"==typeof x?(this.x=x.x||0,this.y=x.y||0,this.z=x.z||0,this.w=x.w||0):(this.x=x||0,this.y=y||0,this.z=z||0,this.w=w||0)},clone:function(){return new Vector4$3(this.x,this.y,this.z,this.w)},copy:function(src){return this.x=src.x,this.y=src.y,this.z=src.z||0,this.w=src.w||0,this},equals:function(v){return this.x===v.x&&this.y===v.y&&this.z===v.z&&this.w===v.w},set:function(x,y,z,w){return"object"==typeof x?(this.x=x.x||0,this.y=x.y||0,this.z=x.z||0,this.w=x.w||0):(this.x=x||0,this.y=y||0,this.z=z||0,this.w=w||0),this},add:function(v){return this.x+=v.x,this.y+=v.y,this.z+=v.z||0,this.w+=v.w||0,this},subtract:function(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z||0,this.w-=v.w||0,this},scale:function(scale){return this.x*=scale,this.y*=scale,this.z*=scale,this.w*=scale,this},length:function(){var x=this.x,y=this.y,z=this.z,w=this.w;return Math.sqrt(x*x+y*y+z*z+w*w)},lengthSq:function(){var x=this.x,y=this.y,z=this.z,w=this.w;return x*x+y*y+z*z+w*w},normalize:function(){var x=this.x,y=this.y,z=this.z,w=this.w,len=x*x+y*y+z*z+w*w;return 0<len&&(len=1/Math.sqrt(len),this.x=x*len,this.y=y*len,this.z=z*len,this.w=w*len),this},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z+this.w*v.w},lerp:function(v,t){var ax=this.x,ay=this.y,az=this.z,aw=this.w;return this.x=ax+(t=void 0===t?0:t)*(v.x-ax),this.y=ay+t*(v.y-ay),this.z=az+t*(v.z-az),this.w=aw+t*(v.w-aw),this},multiply:function(v){return this.x*=v.x,this.y*=v.y,this.z*=v.z||1,this.w*=v.w||1,this},divide:function(v){return this.x/=v.x,this.y/=v.y,this.z/=v.z||1,this.w/=v.w||1,this},distance:function(dw){var dx=dw.x-this.x,dy=dw.y-this.y,dz=dw.z-this.z||0,dw=dw.w-this.w||0;return Math.sqrt(dx*dx+dy*dy+dz*dz+dw*dw)},distanceSq:function(dw){var dx=dw.x-this.x,dy=dw.y-this.y,dz=dw.z-this.z||0,dw=dw.w-this.w||0;return dx*dx+dy*dy+dz*dz+dw*dw},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},transformMat4:function(m){var x=this.x,y=this.y,z=this.z,w=this.w,m=m.val;return this.x=m[0]*x+m[4]*y+m[8]*z+m[12]*w,this.y=m[1]*x+m[5]*y+m[9]*z+m[13]*w,this.z=m[2]*x+m[6]*y+m[10]*z+m[14]*w,this.w=m[3]*x+m[7]*y+m[11]*z+m[15]*w,this},transformQuat:function(iz){var x=this.x,y=this.y,iw=this.z,qx=iz.x,qy=iz.y,qz=iz.z,qw=iz.w,ix=qw*x+qy*iw-qz*y,iy=qw*y+qz*x-qx*iw,iz=qw*iw+qx*y-qy*x,iw=-qx*x-qy*y-qz*iw;return this.x=ix*qw+iw*-qx+iy*-qz-iz*-qy,this.y=iy*qw+iw*-qy+iz*-qx-ix*-qz,this.z=iz*qw+iw*-qz+ix*-qy-iy*-qx,this},reset:function(){return this.x=0,this.y=0,this.z=0,this.w=0,this}});Vector4$3.prototype.sub=Vector4$3.prototype.subtract,Vector4$3.prototype.mul=Vector4$3.prototype.multiply,Vector4$3.prototype.div=Vector4$3.prototype.divide,Vector4$3.prototype.dist=Vector4$3.prototype.distance,Vector4$3.prototype.distSq=Vector4$3.prototype.distanceSq,Vector4$3.prototype.len=Vector4$3.prototype.length,Vector4$3.prototype.lenSq=Vector4$3.prototype.lengthSq;var GetEasedPoints_1=Vector4$3,Matrix3$1=new Class_1({initialize:function(m){this.val=new Float32Array(9),m?this.copy(m):this.identity()},clone:function(){return new Matrix3$1(this)},set:function(src){return this.copy(src)},copy:function(a){var out=this.val,a=a.val;return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],this},fromMat4:function(out){var a=out.val,out=this.val;return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[4],out[4]=a[5],out[5]=a[6],out[6]=a[8],out[7]=a[9],out[8]=a[10],this},fromArray:function(a){var out=this.val;return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],this},identity:function(){var out=this.val;return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=1,out[5]=0,out[6]=0,out[7]=0,out[8]=1,this},transpose:function(){var a=this.val,a01=a[1],a02=a[2],a12=a[5];return a[1]=a[3],a[2]=a[6],a[3]=a01,a[5]=a[7],a[6]=a02,a[7]=a12,this},invert:function(){var a=this.val,a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],b01=a22*a11-a12*a21,b11=-a22*a10+a12*a20,b21=a21*a10-a11*a20,det=a00*b01+a01*b11+a02*b21;return det?(a[0]=b01*(det=1/det),a[1]=(-a22*a01+a02*a21)*det,a[2]=(a12*a01-a02*a11)*det,a[3]=b11*det,a[4]=(a22*a00-a02*a20)*det,a[5]=(-a12*a00+a02*a10)*det,a[6]=b21*det,a[7]=(-a21*a00+a01*a20)*det,a[8]=(a11*a00-a01*a10)*det,this):null},adjoint:function(){var a=this.val,a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8];return a[0]=a11*a22-a12*a21,a[1]=a02*a21-a01*a22,a[2]=a01*a12-a02*a11,a[3]=a12*a20-a10*a22,a[4]=a00*a22-a02*a20,a[5]=a02*a10-a00*a12,a[6]=a10*a21-a11*a20,a[7]=a01*a20-a00*a21,a[8]=a00*a11-a01*a10,this},determinant:function(){var a22=this.val,a00=a22[0],a01=a22[1],a02=a22[2],a10=a22[3],a11=a22[4],a12=a22[5],a20=a22[6],a21=a22[7],a22=a22[8];return a00*(a22*a11-a12*a21)+a01*(-a22*a10+a12*a20)+a02*(a21*a10-a11*a20)},multiply:function(b21){var a=this.val,a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],b22=b21.val,b00=b22[0],b01=b22[1],b02=b22[2],b10=b22[3],b11=b22[4],b12=b22[5],b20=b22[6],b21=b22[7],b22=b22[8];return a[0]=b00*a00+b01*a10+b02*a20,a[1]=b00*a01+b01*a11+b02*a21,a[2]=b00*a02+b01*a12+b02*a22,a[3]=b10*a00+b11*a10+b12*a20,a[4]=b10*a01+b11*a11+b12*a21,a[5]=b10*a02+b11*a12+b12*a22,a[6]=b20*a00+b21*a10+b22*a20,a[7]=b20*a01+b21*a11+b22*a21,a[8]=b20*a02+b21*a12+b22*a22,this},translate:function(y){var a=this.val,x=y.x,y=y.y;return a[6]=x*a[0]+y*a[3]+a[6],a[7]=x*a[1]+y*a[4]+a[7],a[8]=x*a[2]+y*a[5]+a[8],this},rotate:function(c){var a=this.val,a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],s=Math.sin(c),c=Math.cos(c);return a[0]=c*a00+s*a10,a[1]=c*a01+s*a11,a[2]=c*a02+s*a12,a[3]=c*a10-s*a00,a[4]=c*a11-s*a01,a[5]=c*a12-s*a02,this},scale:function(y){var a=this.val,x=y.x,y=y.y;return a[0]=x*a[0],a[1]=x*a[1],a[2]=x*a[2],a[3]=y*a[3],a[4]=y*a[4],a[5]=y*a[5],this},fromQuat:function(xz){var yy=xz.x,yz=xz.y,zz=xz.z,wz=xz.w,wx=yy+yy,wy=yz+yz,out=zz+zz,xx=yy*wx,xy=yy*wy,xz=yy*out,yy=yz*wy,yz=yz*out,zz=zz*out,wx=wz*wx,wy=wz*wy,wz=wz*out,out=this.val;return out[0]=1-(yy+zz),out[3]=xy+wz,out[6]=xz-wy,out[1]=xy-wz,out[4]=1-(xx+zz),out[7]=yz+wx,out[2]=xz+wy,out[5]=yz-wx,out[8]=1-(xx+yy),this},normalFromMat4:function(b07){var b08=b07.val,out=this.val,a00=b08[0],a01=b08[1],a02=b08[2],a03=b08[3],a10=b08[4],a11=b08[5],a12=b08[6],a13=b08[7],b09=b08[8],b10=b08[9],b11=b08[10],det=b08[11],a30=b08[12],a31=b08[13],a32=b08[14],a33=b08[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=b09*a31-b10*a30,b07=b09*a32-b11*a30,b08=b09*a33-det*a30,b09=b10*a32-b11*a31,b10=b10*a33-det*a31,b11=b11*a33-det*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;return det?(out[0]=(a11*b11-a12*b10+a13*b09)*(det=1/det),out[1]=(a12*b08-a10*b11-a13*b07)*det,out[2]=(a10*b10-a11*b08+a13*b06)*det,out[3]=(a02*b10-a01*b11-a03*b09)*det,out[4]=(a00*b11-a02*b08+a03*b07)*det,out[5]=(a01*b08-a00*b10-a03*b06)*det,out[6]=(a31*b05-a32*b04+a33*b03)*det,out[7]=(a32*b02-a30*b05-a33*b01)*det,out[8]=(a30*b04-a31*b02+a33*b00)*det,this):null}}),BitmapFontFile_1=Matrix3$1,CullTiles_1=Class_1,textures=BitmapFontFile_1,NOOP$o=gameConfig,dom=FromXY_1,siNext=new Int8Array([1,2,0]),tmp$1=new Float32Array([0,0,0]),xUnitVec3=new dom(1,0,0),yUnitVec3=new dom(0,1,0),tmpvec=new dom,tmpMat3=new textures,MatterWrap_1=new CullTiles_1({initialize:function(x,y,z,w){this.onChangeCallback=NOOP$o,this.set(x,y,z,w)},x:{get:function(){return this._x},set:function(value){this._x=value,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(value){this._y=value,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(value){this._z=value,this.onChangeCallback(this)}},w:{get:function(){return this._w},set:function(value){this._w=value,this.onChangeCallback(this)}},copy:function(src){return this.set(src)},set:function(x,y,z,w,update){return void 0===update&&(update=!0),"object"==typeof x?(this._x=x.x||0,this._y=x.y||0,this._z=x.z||0,this._w=x.w||0):(this._x=x||0,this._y=y||0,this._z=z||0,this._w=w||0),update&&this.onChangeCallback(this),this},add:function(v){return this._x+=v.x,this._y+=v.y,this._z+=v.z,this._w+=v.w,this.onChangeCallback(this),this},subtract:function(v){return this._x-=v.x,this._y-=v.y,this._z-=v.z,this._w-=v.w,this.onChangeCallback(this),this},scale:function(scale){return this._x*=scale,this._y*=scale,this._z*=scale,this._w*=scale,this.onChangeCallback(this),this},length:function(){var x=this.x,y=this.y,z=this.z,w=this.w;return Math.sqrt(x*x+y*y+z*z+w*w)},lengthSq:function(){var x=this.x,y=this.y,z=this.z,w=this.w;return x*x+y*y+z*z+w*w},normalize:function(){var x=this.x,y=this.y,z=this.z,w=this.w,len=x*x+y*y+z*z+w*w;return 0<len&&(len=1/Math.sqrt(len),this._x=x*len,this._y=y*len,this._z=z*len,this._w=w*len),this.onChangeCallback(this),this},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z+this.w*v.w},lerp:function(v,t){var ax=this.x,ay=this.y,az=this.z,aw=this.w;return this.set(ax+(t=void 0===t?0:t)*(v.x-ax),ay+t*(v.y-ay),az+t*(v.z-az),aw+t*(v.w-aw))},rotationTo:function(a,b){var dot=a.x*b.x+a.y*b.y+a.z*b.z;return dot<-.999999?(tmpvec.copy(xUnitVec3).cross(a).length()<1e-6&&tmpvec.copy(yUnitVec3).cross(a),tmpvec.normalize(),this.setAxisAngle(tmpvec,Math.PI)):.999999<dot?this.set(0,0,0,1):(tmpvec.copy(a).cross(b),this._x=tmpvec.x,this._y=tmpvec.y,this._z=tmpvec.z,this._w=1+dot,this.normalize())},setAxes:function(view,right,up){var m=tmpMat3.val;return m[0]=right.x,m[3]=right.y,m[6]=right.z,m[1]=up.x,m[4]=up.y,m[7]=up.z,m[2]=-view.x,m[5]=-view.y,m[8]=-view.z,this.fromMat3(tmpMat3).normalize()},identity:function(){return this.set(0,0,0,1)},setAxisAngle:function(axis,rad){rad*=.5;var s=Math.sin(rad);return this.set(s*axis.x,s*axis.y,s*axis.z,Math.cos(rad))},multiply:function(bw){var ax=this.x,ay=this.y,az=this.z,aw=this.w,bx=bw.x,by=bw.y,bz=bw.z,bw=bw.w;return this.set(ax*bw+aw*bx+ay*bz-az*by,ay*bw+aw*by+az*bx-ax*bz,az*bw+aw*bz+ax*by-ay*bx,aw*bw-ax*bx-ay*by-az*bz)},slerp:function(omega,t){var ax=this.x,ay=this.y,az=this.z,aw=this.w,bx=omega.x,by=omega.y,bz=omega.z,bw=omega.w,sinom=ax*bx+ay*by+az*bz+aw*bw;sinom<0&&(sinom=-sinom,bx=-bx,by=-by,bz=-bz,bw=-bw);var scale0=1-t,scale1=t;return 1e-6<1-sinom&&(omega=Math.acos(sinom),sinom=Math.sin(omega),scale0=Math.sin((1-t)*omega)/sinom,scale1=Math.sin(t*omega)/sinom),this.set(scale0*ax+scale1*bx,scale0*ay+scale1*by,scale0*az+scale1*bz,scale0*aw+scale1*bw)},invert:function(){var a0=this.x,a1=this.y,a2=this.z,a3=this.w,invDot=a0*a0+a1*a1+a2*a2+a3*a3,invDot=invDot?1/invDot:0;return this.set(-a0*invDot,-a1*invDot,-a2*invDot,a3*invDot)},conjugate:function(){return this._x=-this.x,this._y=-this.y,this._z=-this.z,this.onChangeCallback(this),this},rotateX:function(bw){bw*=.5;var ax=this.x,ay=this.y,az=this.z,aw=this.w,bx=Math.sin(bw),bw=Math.cos(bw);return this.set(ax*bw+aw*bx,ay*bw+az*bx,az*bw-ay*bx,aw*bw-ax*bx)},rotateY:function(bw){bw*=.5;var ax=this.x,ay=this.y,az=this.z,aw=this.w,by=Math.sin(bw),bw=Math.cos(bw);return this.set(ax*bw-az*by,ay*bw+aw*by,az*bw+ax*by,aw*bw-ay*by)},rotateZ:function(bw){bw*=.5;var ax=this.x,ay=this.y,az=this.z,aw=this.w,bz=Math.sin(bw),bw=Math.cos(bw);return this.set(ax*bw+ay*bz,ay*bw-ax*bz,az*bw+aw*bz,aw*bw-az*bz)},calculateW:function(){var x=this.x,y=this.y,z=this.z;return this.w=-Math.sqrt(1-x*x-y*y-z*z),this},setFromEuler:function(euler,update){var x=euler.x/2,y=euler.y/2,z=euler.z/2,c1=Math.cos(x),c2=Math.cos(y),c3=Math.cos(z),s1=Math.sin(x),s2=Math.sin(y),s3=Math.sin(z);switch(euler.order){case"XYZ":this.set(s1*c2*c3+c1*s2*s3,c1*s2*c3-s1*c2*s3,c1*c2*s3+s1*s2*c3,c1*c2*c3-s1*s2*s3,update);break;case"YXZ":this.set(s1*c2*c3+c1*s2*s3,c1*s2*c3-s1*c2*s3,c1*c2*s3-s1*s2*c3,c1*c2*c3+s1*s2*s3,update);break;case"ZXY":this.set(s1*c2*c3-c1*s2*s3,c1*s2*c3+s1*c2*s3,c1*c2*s3+s1*s2*c3,c1*c2*c3-s1*s2*s3,update);break;case"ZYX":this.set(s1*c2*c3-c1*s2*s3,c1*s2*c3+s1*c2*s3,c1*c2*s3-s1*s2*c3,c1*c2*c3+s1*s2*s3,update);break;case"YZX":this.set(s1*c2*c3+c1*s2*s3,c1*s2*c3+s1*c2*s3,c1*c2*s3-s1*s2*c3,c1*c2*c3-s1*s2*s3,update);break;case"XZY":this.set(s1*c2*c3-c1*s2*s3,c1*s2*c3-s1*c2*s3,c1*c2*s3+s1*s2*c3,c1*c2*c3+s1*s2*s3,update)}return this},setFromRotationMatrix:function(m33){var s,trace=m33.val,m11=trace[0],m12=trace[4],m13=trace[8],m21=trace[1],m22=trace[5],m23=trace[9],m31=trace[2],m32=trace[6],m33=trace[10],trace=m11+m22+m33;return 0<trace?(s=.5/Math.sqrt(trace+1),this.set((m32-m23)*s,(m13-m31)*s,(m21-m12)*s,.25/s)):m22<m11&&m33<m11?(s=2*Math.sqrt(1+m11-m22-m33),this.set(.25*s,(m12+m21)/s,(m13+m31)/s,(m32-m23)/s)):m33<m22?(s=2*Math.sqrt(1+m22-m11-m33),this.set((m12+m21)/s,.25*s,(m23+m32)/s,(m13-m31)/s)):(s=2*Math.sqrt(1+m33-m11-m22),this.set((m13+m31)/s,(m23+m32)/s,.25*s,(m21-m12)/s)),this},fromMat3:function(j){var i,fRoot,m=j.val,k=m[0]+m[4]+m[8];return 0<k?(fRoot=Math.sqrt(k+1),this.w=.5*fRoot,this._x=(m[7]-m[5])*(fRoot=.5/fRoot),this._y=(m[2]-m[6])*fRoot,this._z=(m[3]-m[1])*fRoot):(m[4]>m[i=0]&&(i=1),m[8]>m[3*i+i]&&(i=2),j=siNext[i],k=siNext[j],fRoot=Math.sqrt(m[3*i+i]-m[3*j+j]-m[3*k+k]+1),tmp$1[i]=.5*fRoot,tmp$1[j]=(m[3*j+i]+m[3*i+j])*(fRoot=.5/fRoot),tmp$1[k]=(m[3*k+i]+m[3*i+k])*fRoot,this._x=tmp$1[0],this._y=tmp$1[1],this._z=tmp$1[2],this._w=(m[3*k+j]-m[3*j+k])*fRoot),this.onChangeCallback(this),this}}),scene=FromXY_1,GetTileAt_1=MatterWrap_1,tmpMat4=new FloorAll_1,tmpQuat=new GetTileAt_1,tmpVec3=new scene,math=Extend_1$1(!1,{Angle:GetAdvancedValue_1,Distance:CircumCenter_1,Easing:Clone_1$4,Fuzzy:BuildFromPolygon_1,Interpolation:time,Pow2:GetNearestPoint_1,Snap:core,RandomDataGenerator:BuildGameObject_1,Average:RetroFont_1,Bernstein:create,Between:Bodies_1,CatmullRom:renderer,CeilTo:FromPoints_1,Clamp:Character,DegToRad:DegToRad_1,Difference:CSSFile_1,Euler:tilemaps,Factorial:World_1$1,FloatBetween:Decompose_1$1,FloorTo:Constraint_1,FromPercent:Rope_1,GetSpeed:Tween_1,IsEven:particles,IsEvenStrict:HTML5AudioFile_1,Linear:NoAudioSoundManager_1,MaxAdd:SAT_1,Median:GetTilesWithinWorldXY_1,MinSub:components$1,Percent:curves,RadToDeg:Common_1,RandomXY:PathFollower_1,RandomXYZ:TweenManager,RandomXYZW:data,Rotate:Rotate_1$2,RotateAround:ParseTilesets_1,RotateAroundDistance:GetWorldToTileXFunction_1,RotateTo:GetTileAtWorldXY_1,RoundAwayFromZero:Resolver_1,RoundTo:Inflate_1,SinCosTableGenerator:Base64ToArrayBuffer_1,SmootherStep:WebAudioSound_1,SmoothStep:WebAudioSoundManager_1,ToXY:HTMLTextureFile_1,TransformXY:Equals_1$1,Within:Game_1,Wrap:Vector_1,Vector2:BuildTilesetIndex_1,Vector3:FromXY_1,Vector4:GetEasedPoints_1,Matrix3:BitmapFontFile_1,Matrix4:FloorAll_1,Quaternion:MatterWrap_1,RotateVec3:function(vec,axis,radians){return tmpQuat.setAxisAngle(axis,radians),tmpMat4.fromRotationTranslation(tmpQuat,tmpVec3.set(0,0,0)),vec.transformMat4(tmpMat4)}},Tweens),ParseCSV_1={Global:["game","anims","cache","plugins","registry","scale","sound","textures","renderer"],CoreScene:["EventEmitter","CameraManager","GameObjectCreator","GameObjectFactory","ScenePlugin","DisplayList","UpdateList"],DefaultScene:["Clock","DataManagerPlugin","InputPlugin","Loader","TweenManager","LightsPlugin"]},CONST$19=Extend,Device$1=Graphics_1,GetFastValue$1f=GetFastValue_1,GetValue$u=GetValue_1,IsPlainObject$w=IsPlainObject_1,PhaserMath=math,NOOP$n=gameConfig,DefaultPlugins$1=ParseCSV_1,ValueToColor=HTMLFile_1,CenterOn_1$1=new Class_1({initialize:function(config){this.width=GetValue$u(config=void 0===config?{}:config,"width",1024),this.height=GetValue$u(config,"height",768),this.zoom=GetValue$u(config,"zoom",1),this.parent=GetValue$u(config,"parent",void 0),this.scaleMode=GetValue$u(config,"scaleMode",0),this.expandParent=GetValue$u(config,"expandParent",!0),this.autoRound=GetValue$u(config,"autoRound",!1),this.autoCenter=GetValue$u(config,"autoCenter",0),this.resizeInterval=GetValue$u(config,"resizeInterval",500),this.fullscreenTarget=GetValue$u(config,"fullscreenTarget",null),this.minWidth=GetValue$u(config,"minWidth",0),this.maxWidth=GetValue$u(config,"maxWidth",0),this.minHeight=GetValue$u(config,"minHeight",0),this.maxHeight=GetValue$u(config,"maxHeight",0);var plugins=GetValue$u(config,"scale",null);plugins&&(this.width=GetValue$u(plugins,"width",this.width),this.height=GetValue$u(plugins,"height",this.height),this.zoom=GetValue$u(plugins,"zoom",this.zoom),this.parent=GetValue$u(plugins,"parent",this.parent),this.scaleMode=GetValue$u(plugins,"mode",this.scaleMode),this.expandParent=GetValue$u(plugins,"expandParent",this.expandParent),this.autoRound=GetValue$u(plugins,"autoRound",this.autoRound),this.autoCenter=GetValue$u(plugins,"autoCenter",this.autoCenter),this.resizeInterval=GetValue$u(plugins,"resizeInterval",this.resizeInterval),this.fullscreenTarget=GetValue$u(plugins,"fullscreenTarget",this.fullscreenTarget),this.minWidth=GetValue$u(plugins,"min.width",this.minWidth),this.maxWidth=GetValue$u(plugins,"max.width",this.maxWidth),this.minHeight=GetValue$u(plugins,"min.height",this.minHeight),this.maxHeight=GetValue$u(plugins,"max.height",this.maxHeight)),this.renderType=GetValue$u(config,"type",CONST$19.AUTO),this.canvas=GetValue$u(config,"canvas",null),this.context=GetValue$u(config,"context",null),this.canvasStyle=GetValue$u(config,"canvasStyle",null),this.customEnvironment=GetValue$u(config,"customEnvironment",!1),this.sceneConfig=GetValue$u(config,"scene",null),this.seed=GetValue$u(config,"seed",[(Date.now()*Math.random()).toString()]),PhaserMath.RND=new PhaserMath.RandomDataGenerator(this.seed),this.gameTitle=GetValue$u(config,"title",""),this.gameURL=GetValue$u(config,"url","https://phaser.io"),this.gameVersion=GetValue$u(config,"version",""),this.autoFocus=GetValue$u(config,"autoFocus",!0),this.domCreateContainer=GetValue$u(config,"dom.createContainer",!1),this.domBehindCanvas=GetValue$u(config,"dom.behindCanvas",!1),this.domPointerEvents=GetValue$u(config,"dom.pointerEvents","none"),this.inputKeyboard=GetValue$u(config,"input.keyboard",!0),this.inputKeyboardEventTarget=GetValue$u(config,"input.keyboard.target",window),this.inputKeyboardCapture=GetValue$u(config,"input.keyboard.capture",[]),this.inputMouse=GetValue$u(config,"input.mouse",!0),this.inputMouseEventTarget=GetValue$u(config,"input.mouse.target",null),this.inputMousePreventDefaultDown=GetValue$u(config,"input.mouse.preventDefaultDown",!0),this.inputMousePreventDefaultUp=GetValue$u(config,"input.mouse.preventDefaultUp",!0),this.inputMousePreventDefaultMove=GetValue$u(config,"input.mouse.preventDefaultMove",!0),this.inputMousePreventDefaultWheel=GetValue$u(config,"input.mouse.preventDefaultWheel",!0),this.inputTouch=GetValue$u(config,"input.touch",Device$1.input.touch),this.inputTouchEventTarget=GetValue$u(config,"input.touch.target",null),this.inputTouchCapture=GetValue$u(config,"input.touch.capture",!0),this.inputActivePointers=GetValue$u(config,"input.activePointers",1),this.inputSmoothFactor=GetValue$u(config,"input.smoothFactor",0),this.inputWindowEvents=GetValue$u(config,"input.windowEvents",!0),this.inputGamepad=GetValue$u(config,"input.gamepad",!1),this.inputGamepadEventTarget=GetValue$u(config,"input.gamepad.target",window),this.disableContextMenu=GetValue$u(config,"disableContextMenu",!1),this.audio=GetValue$u(config,"audio",{}),this.hideBanner=!1===GetValue$u(config,"banner",null),this.hidePhaser=GetValue$u(config,"banner.hidePhaser",!1),this.bannerTextColor=GetValue$u(config,"banner.text","#ffffff"),this.bannerBackgroundColor=GetValue$u(config,"banner.background",["#ff0000","#ffff00","#00ff00","#00ffff","#000000"]),""===this.gameTitle&&this.hidePhaser&&(this.hideBanner=!0),this.fps=GetValue$u(config,"fps",null);var pngPrefix=GetValue$u(config,"render",config);this.pipeline=GetValue$u(pngPrefix,"pipeline",null),this.antialias=GetValue$u(pngPrefix,"antialias",!0),this.antialiasGL=GetValue$u(pngPrefix,"antialiasGL",!0),this.mipmapFilter=GetValue$u(pngPrefix,"mipmapFilter","LINEAR"),this.desynchronized=GetValue$u(pngPrefix,"desynchronized",!1),this.roundPixels=GetValue$u(pngPrefix,"roundPixels",!1),this.pixelArt=GetValue$u(pngPrefix,"pixelArt",1!==this.zoom),this.pixelArt&&(this.antialias=!1,this.antialiasGL=!1,this.roundPixels=!0),this.transparent=GetValue$u(pngPrefix,"transparent",!1),this.clearBeforeRender=GetValue$u(pngPrefix,"clearBeforeRender",!0),this.preserveDrawingBuffer=GetValue$u(pngPrefix,"preserveDrawingBuffer",!1),this.premultipliedAlpha=GetValue$u(pngPrefix,"premultipliedAlpha",!0),this.failIfMajorPerformanceCaveat=GetValue$u(pngPrefix,"failIfMajorPerformanceCaveat",!1),this.powerPreference=GetValue$u(pngPrefix,"powerPreference","default"),this.batchSize=GetValue$u(pngPrefix,"batchSize",4096),this.maxTextures=GetValue$u(pngPrefix,"maxTextures",-1),this.maxLights=GetValue$u(pngPrefix,"maxLights",10);plugins=GetValue$u(config,"backgroundColor",0);this.backgroundColor=ValueToColor(plugins),this.transparent&&(this.backgroundColor=ValueToColor(0),this.backgroundColor.alpha=0),this.preBoot=GetValue$u(config,"callbacks.preBoot",NOOP$n),this.postBoot=GetValue$u(config,"callbacks.postBoot",NOOP$n),this.physics=GetValue$u(config,"physics",{}),this.defaultPhysicsSystem=GetValue$u(this.physics,"default",!1),this.loaderBaseURL=GetValue$u(config,"loader.baseURL",""),this.loaderPath=GetValue$u(config,"loader.path","");pngPrefix=Device$1.os.android?6:32;this.loaderMaxParallelDownloads=GetValue$u(config,"loader.maxParallelDownloads",pngPrefix),this.loaderCrossOrigin=GetValue$u(config,"loader.crossOrigin",void 0),this.loaderResponseType=GetValue$u(config,"loader.responseType",""),this.loaderAsync=GetValue$u(config,"loader.async",!0),this.loaderUser=GetValue$u(config,"loader.user",""),this.loaderPassword=GetValue$u(config,"loader.password",""),this.loaderTimeout=GetValue$u(config,"loader.timeout",0),this.loaderWithCredentials=GetValue$u(config,"loader.withCredentials",!1),this.installGlobalPlugins=[],this.installScenePlugins=[];plugins=GetValue$u(config,"plugins",null),pngPrefix=DefaultPlugins$1.DefaultScene;plugins&&(Array.isArray(plugins)?this.defaultPlugins=plugins:IsPlainObject$w(plugins)&&(this.installGlobalPlugins=GetFastValue$1f(plugins,"global",[]),this.installScenePlugins=GetFastValue$1f(plugins,"scene",[]),Array.isArray(plugins.default)?pngPrefix=plugins.default:Array.isArray(plugins.defaultMerge)&&(pngPrefix=pngPrefix.concat(plugins.defaultMerge)))),this.defaultPlugins=pngPrefix;pngPrefix="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAg";this.defaultImage=GetValue$u(config,"images.default",pngPrefix+"AQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg=="),this.missingImage=GetValue$u(config,"images.missing",pngPrefix+"CAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg=="),this.whiteImage=GetValue$u(config,"images.white","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABdJREFUeNpi/P//PwMMMDEgAdwcgAADAJZuAwXJYZOzAAAAAElFTkSuQmCC"),window&&(window.FORCE_WEBGL?this.renderType=CONST$19.WEBGL:window.FORCE_CANVAS&&(this.renderType=CONST$19.CANVAS))}}),CopyFrom_1$1={setCrisp:function(canvas){return["optimizeSpeed","-moz-crisp-edges","-o-crisp-edges","-webkit-optimize-contrast","optimize-contrast","crisp-edges","pixelated"].forEach(function(type){canvas.style["image-rendering"]=type}),canvas.style.msInterpolationMode="nearest-neighbor",canvas},setBicubic:function(canvas){return canvas.style["image-rendering"]="auto",canvas.style.msInterpolationMode="bicubic",canvas}},CanvasPool$a=SetValue_1,Color$7=Container_1,GetFastValue$1e=GetFastValue_1,ParseObjectLayers_1=function(canvas,data){var copyCanvas,image1,image2,callback=GetFastValue$1e(data,"callback"),type=GetFastValue$1e(data,"type","image/png"),encoderOptions=GetFastValue$1e(data,"encoder",.92),x=Math.abs(Math.round(GetFastValue$1e(data,"x",0))),y=Math.abs(Math.round(GetFastValue$1e(data,"y",0))),width=GetFastValue$1e(data,"width",canvas.width),height=GetFastValue$1e(data,"height",canvas.height);GetFastValue$1e(data,"getPixel",!1)?(data=canvas.getContext("2d").getImageData(x,y,1,1).data,callback.call(null,new Color$7(data[0],data[1],data[2],data[3]/255))):0!==x||0!==y||width!==canvas.width||height!==canvas.height?((copyCanvas=CanvasPool$a.createWebGL(this,width,height)).getContext("2d").drawImage(canvas,x,y,width,height,0,0,width,height),(image1=new Image).onerror=function(){callback.call(null),CanvasPool$a.remove(copyCanvas)},image1.onload=function(){callback.call(null,image1),CanvasPool$a.remove(copyCanvas)},image1.src=copyCanvas.toDataURL(type,encoderOptions)):((image2=new Image).onerror=function(){callback.call(null)},image2.onload=function(){callback.call(null,image2)},image2.src=canvas.toDataURL(type,encoderOptions))},modes=BlendModes$8,CanvasFeatures=Extend_1,scale=function(){var output=[],useNew=CanvasFeatures.supportNewBlendModes,so="source-over";return output[modes.NORMAL]=so,output[modes.ADD]="lighter",output[modes.MULTIPLY]=useNew?"multiply":so,output[modes.SCREEN]=useNew?"screen":so,output[modes.OVERLAY]=useNew?"overlay":so,output[modes.DARKEN]=useNew?"darken":so,output[modes.LIGHTEN]=useNew?"lighten":so,output[modes.COLOR_DODGE]=useNew?"color-dodge":so,output[modes.COLOR_BURN]=useNew?"color-burn":so,output[modes.HARD_LIGHT]=useNew?"hard-light":so,output[modes.SOFT_LIGHT]=useNew?"soft-light":so,output[modes.DIFFERENCE]=useNew?"difference":so,output[modes.EXCLUSION]=useNew?"exclusion":so,output[modes.HUE]=useNew?"hue":so,output[modes.SATURATION]=useNew?"saturation":so,output[modes.COLOR]=useNew?"color":so,output[modes.LUMINOSITY]=useNew?"luminosity":so,output[modes.ERASE]="destination-out",output[modes.SOURCE_IN]="source-in",output[modes.SOURCE_OUT]="source-out",output[modes.SOURCE_ATOP]="source-atop",output[modes.DESTINATION_OVER]="destination-over",output[modes.DESTINATION_IN]="destination-in",output[modes.DESTINATION_OUT]="destination-out",output[modes.DESTINATION_ATOP]="destination-atop",output[modes.LIGHTER]="lighter",output[modes.COPY]="copy",output[modes.XOR]="xor",output},TweenData_1={ADD:"addtexture",ERROR:"onerror",LOAD:"onload",READY:"ready",REMOVE:"removetexture"},CameraEvents$1=GetCalcMatrix_1,CanvasSnapshot=ParseObjectLayers_1,HasValue_1=Class_1,CONST$18=Extend,EventEmitter$q=eventemitter3.exports,Events$F=events,GetBlendModes=scale,ScaleEvents$1=HexagonalCullTiles_1,TextureEvents$2=TweenData_1,TransformMatrix$d=TransformMatrix,CanvasRenderer_1=new HasValue_1({Extends:EventEmitter$q,initialize:function(game){EventEmitter$q.call(this);var gameConfig=game.config;this.config={clearBeforeRender:gameConfig.clearBeforeRender,backgroundColor:gameConfig.backgroundColor,antialias:gameConfig.antialias,roundPixels:gameConfig.roundPixels},this.game=game,this.type=CONST$18.CANVAS,this.drawCount=0,this.width=0,this.height=0,this.gameCanvas=game.canvas;var contextOptions={alpha:game.config.transparent,desynchronized:game.config.desynchronized};this.gameContext=gameConfig.context||this.gameCanvas.getContext("2d",contextOptions),this.currentContext=this.gameContext,this.antialias=game.config.antialias,this.blendModes=GetBlendModes(),this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92},this._tempMatrix1=new TransformMatrix$d,this._tempMatrix2=new TransformMatrix$d,this._tempMatrix3=new TransformMatrix$d,this.isBooted=!1,this.init()},init:function(){this.game.textures.once(TextureEvents$2.READY,this.boot,this)},boot:function(){var game=this.game,baseSize=game.scale.baseSize;this.width=baseSize.width,this.height=baseSize.height,this.isBooted=!0,game.scale.on(ScaleEvents$1.RESIZE,this.onResize,this),this.resize(baseSize.width,baseSize.height)},onResize:function(gameSize,baseSize){baseSize.width===this.width&&baseSize.height===this.height||this.resize(baseSize.width,baseSize.height)},resize:function(width,height){this.width=width,this.height=height,this.emit(Events$F.RESIZE,width,height)},resetTransform:function(){this.currentContext.setTransform(1,0,0,1,0,0)},setBlendMode:function(blendMode){return this.currentContext.globalCompositeOperation=blendMode,this},setContext:function(ctx){return this.currentContext=ctx||this.gameContext,this},setAlpha:function(alpha){return this.currentContext.globalAlpha=alpha,this},preRender:function(){var ctx=this.gameContext,config=this.config,width=this.width,height=this.height;ctx.globalAlpha=1,ctx.globalCompositeOperation="source-over",ctx.setTransform(1,0,0,1,0,0),config.clearBeforeRender&&(ctx.clearRect(0,0,width,height),config.transparent||(ctx.fillStyle=config.backgroundColor.rgba,ctx.fillRect(0,0,width,height))),ctx.save(),this.drawCount=0,this.emit(Events$F.PRE_RENDER)},render:function(scene,children,camera){var childCount=children.length;this.emit(Events$F.RENDER,scene,camera);var cx=camera.x,cy=camera.y,cw=camera.width,ch=camera.height,ctx=(camera.renderToTexture?camera:scene.sys).context;ctx.save(),this.game.scene.customViewports&&(ctx.beginPath(),ctx.rect(cx,cy,cw,ch),ctx.clip()),this.currentContext=ctx;var mask=camera.mask;mask&&mask.preRenderCanvas(this,null,camera._maskCamera),camera.transparent||(ctx.fillStyle=camera.backgroundColor.rgba,ctx.fillRect(cx,cy,cw,ch)),ctx.globalAlpha=camera.alpha,ctx.globalCompositeOperation="source-over",this.drawCount+=childCount,camera.renderToTexture&&camera.emit(CameraEvents$1.PRE_RENDER,camera),camera.matrix.copyToContext(ctx);for(var i=0;i<childCount;i++){var child=children[i];child.mask&&child.mask.preRenderCanvas(this,child,camera),child.renderCanvas(this,child,camera),child.mask&&child.mask.postRenderCanvas(this,child,camera)}ctx.setTransform(1,0,0,1,0,0),ctx.globalCompositeOperation="source-over",ctx.globalAlpha=1,camera.flashEffect.postRenderCanvas(ctx),camera.fadeEffect.postRenderCanvas(ctx),camera.dirty=!1,mask&&mask.postRenderCanvas(this),ctx.restore(),camera.renderToTexture&&(camera.emit(CameraEvents$1.POST_RENDER,camera),camera.renderToGame&&scene.sys.context.drawImage(camera.canvas,cx,cy))},postRender:function(){this.gameContext.restore(),this.emit(Events$F.POST_RENDER);var state=this.snapshotState;state.callback&&(CanvasSnapshot(this.gameCanvas,state),state.callback=null)},snapshotCanvas:function(canvas,callback,getPixel,x,y,width,height,type,state){void 0===getPixel&&(getPixel=!1),this.snapshotArea(x,y,width,height,callback,type,state);state=this.snapshotState;return state.getPixel=getPixel,CanvasSnapshot(this.canvas,state),state.callback=null,this},snapshot:function(callback,type,encoderOptions){return this.snapshotArea(0,0,this.gameCanvas.width,this.gameCanvas.height,callback,type,encoderOptions)},snapshotArea:function(x,y,width,height,callback,type,encoderOptions){var state=this.snapshotState;return state.callback=callback,state.type=type,state.encoder=encoderOptions,state.getPixel=!1,state.x=x,state.y=y,state.width=Math.min(width,this.gameCanvas.width),state.height=Math.min(height,this.gameCanvas.height),this},snapshotPixel:function(x,y,callback){return this.snapshotArea(x,y,1,1,callback),this.snapshotState.getPixel=!0,this},batchSprite:function(sprite,frame,camera,parentTransformMatrix){var ctx,camMatrix,spriteMatrix,frameX,frameY,frameWidth,frameHeight,customPivot,res,displayOriginX,displayOriginY,x,y,flipX,flipY,alpha=camera.alpha*sprite.alpha;0!=alpha&&(ctx=this.currentContext,camMatrix=this._tempMatrix1,spriteMatrix=this._tempMatrix2,frameX=(flipX=frame.canvasData).x,frameY=flipX.y,frameWidth=frame.cutWidth,frameHeight=frame.cutHeight,customPivot=frame.customPivot,res=frame.source.resolution,displayOriginX=sprite.displayOriginX,displayOriginY=sprite.displayOriginY,x=-displayOriginX+frame.x,y=-displayOriginY+frame.y,sprite.isCropped&&((flipY=sprite._crop).flipX===sprite.flipX&&flipY.flipY===sprite.flipY||frame.updateCropUVs(flipY,sprite.flipX,sprite.flipY),frameWidth=flipY.cw,frameHeight=flipY.ch,frameX=flipY.cx,frameY=flipY.cy,x=-displayOriginX+flipY.x,y=-displayOriginY+flipY.y,sprite.flipX&&(0<=x?x=-(x+frameWidth):x<0&&(x=Math.abs(x)-frameWidth)),sprite.flipY&&(0<=y?y=-(y+frameHeight):y<0&&(y=Math.abs(y)-frameHeight))),flipY=flipX=1,sprite.flipX&&(customPivot||(x+=-frame.realWidth+2*displayOriginX),flipX=-1),sprite.flipY&&(customPivot||(y+=-frame.realHeight+2*displayOriginY),flipY=-1),spriteMatrix.applyITRS(sprite.x,sprite.y,sprite.rotation,sprite.scaleX*flipX,sprite.scaleY*flipY),camMatrix.copyFrom(camera.matrix),parentTransformMatrix?(camMatrix.multiplyWithOffset(parentTransformMatrix,-camera.scrollX*sprite.scrollFactorX,-camera.scrollY*sprite.scrollFactorY),spriteMatrix.e=sprite.x,spriteMatrix.f=sprite.y):(spriteMatrix.e-=camera.scrollX*sprite.scrollFactorX,spriteMatrix.f-=camera.scrollY*sprite.scrollFactorY),camMatrix.multiply(spriteMatrix),ctx.save(),camMatrix.setToContext(ctx),ctx.globalCompositeOperation=this.blendModes[sprite.blendMode],ctx.globalAlpha=alpha,ctx.imageSmoothingEnabled=!(!this.antialias||frame.source.scaleMode),sprite.mask&&sprite.mask.preRenderCanvas(this,sprite,camera),ctx.drawImage(frame.source.image,frameX,frameY,frameWidth,frameHeight,x,y,frameWidth/res,frameHeight/res),sprite.mask&&sprite.mask.postRenderCanvas(this,sprite,camera),ctx.restore())},destroy:function(){this.removeAllListeners(),this.game=null,this.gameCanvas=null,this.gameContext=null}}),SpliceOne$4=SpliceOne_1,Remove_1=function(array,item,callback,context){if(void 0===context&&(context=array),!Array.isArray(item))return-1!==(index=array.indexOf(item))?(SpliceOne$4(array,index),callback&&callback.call(context,item),item):null;for(var itemLength=item.length-1,removed=[];0<=itemLength;){var index,entry=item[itemLength];-1!==(index=array.indexOf(entry))&&(SpliceOne$4(array,index),removed.push(entry),callback&&callback.call(context,entry)),itemLength--}return removed},Pick_1=["#define SHADER_NAME PHASER_BITMAP_MASK_FS","","precision mediump float;","","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uMaskSampler;","uniform bool uInvertMaskAlpha;","","void main ()","{","    vec2 uv = gl_FragCoord.xy / uResolution;","    vec4 mainColor = texture2D(uMainSampler, uv);","    vec4 maskColor = texture2D(uMaskSampler, uv);","    float alpha = mainColor.a;","","    if (!uInvertMaskAlpha)","    {","        alpha *= (maskColor.a);","    }","    else","    {","        alpha *= (1.0 - maskColor.a);","    }","","    gl_FragColor = vec4(mainColor.rgb * alpha, alpha);","}",""].join("\n"),UpdateList_1=["#define SHADER_NAME PHASER_BITMAP_MASK_VS","","precision mediump float;","","attribute vec2 inPosition;","","void main ()","{","    gl_Position = vec4(inPosition, 0.0, 1.0);","}",""].join("\n"),FindTile_1={BYTE:{enum:5120,size:1},UNSIGNED_BYTE:{enum:5121,size:1},SHORT:{enum:5122,size:2},UNSIGNED_SHORT:{enum:5123,size:2},INT:{enum:5124,size:4},UNSIGNED_INT:{enum:5125,size:4},FLOAT:{enum:5126,size:4}},CalculateFacesWithin_1={AFTER_FLUSH:"pipelineafterflush",BEFORE_FLUSH:"pipelinebeforeflush",BIND:"pipelinebind",BOOT:"pipelineboot",DESTROY:"pipelinedestroy",REBIND:"pipelinerebind",RESIZE:"pipelineresize"},Events$E=events,Fill_1=new Class_1({initialize:function(renderer,width,height,scale,minFilter,autoClear,autoResize){void 0===scale&&(scale=1),void 0===minFilter&&(minFilter=0),void 0===autoClear&&(autoClear=!0),void 0===autoResize&&(autoResize=!1),this.renderer=renderer,this.framebuffer=null,this.texture=null,this.width=0,this.height=0,this.scale=scale,this.minFilter=minFilter,this.autoClear=autoClear,this.autoResize=!1,this.resize(width,height),autoResize&&this.setAutoResize(!0)},setAutoResize:function(autoResize){return autoResize&&!this.autoResize?(this.renderer.on(Events$E.RESIZE,this.resize,this),this.autoResize=!0):!autoResize&&this.autoResize&&(this.renderer.off(Events$E.RESIZE,this.resize,this),this.autoResize=!1),this},resize:function(width,height){var scaledWidth=width*this.scale,renderer=height*this.scale;return scaledWidth===this.width&&renderer===this.height||((renderer=this.renderer).deleteFramebuffer(this.framebuffer),renderer.deleteTexture(this.texture),width*=this.scale,height*=this.scale,width=Math.round(width),height=Math.round(height),this.texture=renderer.createTextureFromSource(null,width=width<=0?1:width,height=height<=0?1:height,this.minFilter),this.framebuffer=renderer.createFramebuffer(width,height,this.texture,!1),this.width=width,this.height=height),this},bind:function(gl,width,height){(gl=void 0===gl?!1:gl)&&this.renderer.flush(),width&&height&&this.resize(width,height),this.renderer.pushFramebuffer(this.framebuffer,!1,!1,!1),gl&&this.adjustViewport(),this.autoClear&&((gl=this.renderer.gl).clearColor(0,0,0,0),gl.clear(gl.COLOR_BUFFER_BIT))},adjustViewport:function(){var gl=this.renderer.gl;gl.viewport(0,0,this.width,this.height),gl.disable(gl.SCISSOR_TEST)},clear:function(){var renderer=this.renderer,gl=renderer.gl;renderer.pushFramebuffer(this.framebuffer),gl.disable(gl.SCISSOR_TEST),gl.clearColor(0,0,0,0),gl.clear(gl.COLOR_BUFFER_BIT),renderer.popFramebuffer(),renderer.resetScissor()},unbind:function(flush){var renderer=this.renderer;return(flush=void 0===flush?!1:flush)&&renderer.flush(),renderer.popFramebuffer()},destroy:function(){var renderer=this.renderer;renderer.deleteFramebuffer(this.framebuffer),renderer.deleteTexture(this.texture),renderer.off(Events$E.RESIZE,this.resize,this),this.renderer=null,this.framebuffer=null,this.texture=null}});var GetProps_1={getTintFromFloats:function(r,g,b,a){return((255&(255*a|0))<<24|(255&(255*r|0))<<16|(255&(255*g|0))<<8|255&(255*b|0))>>>0},getTintAppendFloatAlpha:function(rgb,a){return((255&(255*a|0))<<24|rgb)>>>0},getTintAppendFloatAlphaAndSwap:function(rgb,a){return((255&(255*a|0))<<24|(255&(0|rgb))<<16|(255&(rgb>>8|0))<<8|255&(rgb>>16|0))>>>0},getFloatsFromUintRGB:function(rgb){return[(255&(rgb>>16|0))/255,(255&(rgb>>8|0))/255,(255&(0|rgb))/255]},checkShaderMax:function(gl,maxTextures){maxTextures&&-1!==maxTextures||(maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS));for(var shader=gl.createShader(gl.FRAGMENT_SHADER),fragTemplate=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");;){var fragmentSrc=fragTemplate.replace(/%forloop%/gi,function(maxIfs){for(var src="",i=0;i<maxIfs;++i)0<i&&(src+="\nelse "),i<maxIfs-1&&(src+="if(test == "+i+".0){}");return src}(maxTextures));if(gl.shaderSource(shader,fragmentSrc),gl.compileShader(shader),gl.getShaderParameter(shader,gl.COMPILE_STATUS))break;maxTextures=maxTextures/2|0}return maxTextures},parseFragmentShaderMaxTextures:function(fragmentShaderSource,maxTextures){if(!fragmentShaderSource)return"";for(var src="",i=0;i<maxTextures;i++)0<i&&(src+="\n\telse "),i<maxTextures-1&&(src+="if (outTexId < "+i+".5)"),src+="\n\t{",src+="\n\t\ttexture = texture2D(uMainSampler["+i+"], outTexCoord);",src+="\n\t}";return(fragmentShaderSource=fragmentShaderSource.replace(/%count%/gi,maxTextures.toString())).replace(/%forloop%/gi,src)}},GetFastValue$1d=GetFastValue_1,WEBGL_CONST$4=FindTile_1,FindByIndex_1=new Class_1({initialize:function(pipeline,name,vertexShader,fragmentShader,attributes){this.pipeline=pipeline,this.name=name,this.renderer=pipeline.renderer,this.gl=this.renderer.gl,this.program=this.renderer.createProgram(vertexShader,fragmentShader),this.attributes,this.vertexComponentCount=0,this.vertexSize=0,this.uniforms={},this.createAttributes(attributes),this.createUniforms()},createAttributes:function(attributes){for(var count=0,offset=0,result=[],i=this.vertexComponentCount=0;i<attributes.length;i++){var normalized=attributes[i],name=normalized.name,size=GetFastValue$1d(normalized,"size",1),typeSize=GetFastValue$1d(normalized,"type",WEBGL_CONST$4.FLOAT),type=typeSize.enum,typeSize=typeSize.size,normalized=!!normalized.normalized;result.push({name:name,size:size,type:type,normalized:normalized,offset:offset,enabled:!1,location:-1}),4===typeSize?count+=size:count++,offset+=size*typeSize}this.vertexSize=offset,this.vertexComponentCount=count,this.attributes=result},bind:function(setAttributes,flush){return void 0===setAttributes&&(setAttributes=!1),(flush=void 0===flush?!1:flush)&&this.pipeline.flush(),this.renderer.setProgram(this.program),setAttributes&&this.setAttribPointers(),this},rebind:function(){return this.renderer.setProgram(this.program),this.setAttribPointers(!0),this},setAttribPointers:function(reset){void 0===reset&&(reset=!1);for(var gl=this.gl,vertexSize=this.vertexSize,attributes=this.attributes,program=this.program,i=0;i<attributes.length;i++){var attribLocation,element=attributes[i],size=element.size,type=element.type,offset=element.offset,enabled=element.enabled,location=element.location,normalized=!!element.normalized;reset?0<=(attribLocation=gl.getAttribLocation(program,element.name))?(gl.enableVertexAttribArray(attribLocation),gl.vertexAttribPointer(attribLocation,size,type,normalized,vertexSize,offset),element.enabled=!0,element.location=attribLocation):-1!==attribLocation&&gl.disableVertexAttribArray(attribLocation):enabled?gl.vertexAttribPointer(location,size,type,normalized,vertexSize,offset):!enabled&&-1<location&&(gl.disableVertexAttribArray(location),element.location=-1)}return this},createUniforms:function(){for(var name,location,gl=this.gl,program=this.program,uniforms=this.uniforms,totalUniforms=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS),i=0;i<totalUniforms;i++){var struct=gl.getActiveUniform(program,i);struct&&(name=struct.name,null!==(location=gl.getUniformLocation(program,name))&&(uniforms[name]={name:name,location:location,value1:null,value2:null,value3:null,value4:null}),0<(struct=name.indexOf("["))&&(name=name.substr(0,struct),uniforms.hasOwnProperty(name)||null!==(location=gl.getUniformLocation(program,name))&&(uniforms[name]={name:name,location:location,value1:null,value2:null,value3:null,value4:null})))}return this},hasUniform:function(name){return this.uniforms.hasOwnProperty(name)},resetUniform:function(uniform){uniform=this.uniforms[uniform];return uniform&&(uniform.value1=null,uniform.value2=null,uniform.value3=null,uniform.value4=null),this},setUniform1:function(setter,uniform,value1,skipCheck){uniform=this.uniforms[uniform];return uniform&&(!skipCheck&&uniform.value1===value1||(uniform.value1=value1,this.renderer.setProgram(this.program),setter.call(this.gl,uniform.location,value1),this.pipeline.currentShader=this)),this},setUniform2:function(setter,uniform,value1,value2,skipCheck){uniform=this.uniforms[uniform];return uniform&&(!skipCheck&&uniform.value1===value1&&uniform.value2===value2||(uniform.value1=value1,uniform.value2=value2,this.renderer.setProgram(this.program),setter.call(this.gl,uniform.location,value1,value2),this.pipeline.currentShader=this)),this},setUniform3:function(setter,uniform,value1,value2,value3,skipCheck){uniform=this.uniforms[uniform];return uniform&&(!skipCheck&&uniform.value1===value1&&uniform.value2===value2&&uniform.value3===value3||(uniform.value1=value1,uniform.value2=value2,uniform.value3=value3,this.renderer.setProgram(this.program),setter.call(this.gl,uniform.location,value1,value2,value3),this.pipeline.currentShader=this)),this},setUniform4:function(setter,uniform,value1,value2,value3,value4,skipCheck){uniform=this.uniforms[uniform];return uniform&&(!skipCheck&&uniform.value1===value1&&uniform.value2===value2&&uniform.value3===value3&&uniform.value4===value4||(uniform.value1=value1,uniform.value2=value2,uniform.value3=value3,uniform.value4=value4,this.renderer.setProgram(this.program),setter.call(this.gl,uniform.location,value1,value2,value3,value4),this.pipeline.currentShader=this)),this},set1f:function(name,x){return this.setUniform1(this.gl.uniform1f,name,x)},set2f:function(name,x,y){return this.setUniform2(this.gl.uniform2f,name,x,y)},set3f:function(name,x,y,z){return this.setUniform3(this.gl.uniform3f,name,x,y,z)},set4f:function(name,x,y,z,w){return this.setUniform4(this.gl.uniform4f,name,x,y,z,w)},set1fv:function(name,arr){return this.setUniform1(this.gl.uniform1fv,name,arr,!0)},set2fv:function(name,arr){return this.setUniform1(this.gl.uniform2fv,name,arr,!0)},set3fv:function(name,arr){return this.setUniform1(this.gl.uniform3fv,name,arr,!0)},set4fv:function(name,arr){return this.setUniform1(this.gl.uniform4fv,name,arr,!0)},set1iv:function(name,arr){return this.setUniform1(this.gl.uniform1iv,name,arr,!0)},set2iv:function(name,arr){return this.setUniform1(this.gl.uniform2iv,name,arr,!0)},set3iv:function(name,arr){return this.setUniform1(this.gl.uniform3iv,name,arr,!0)},set4iv:function(name,arr){return this.setUniform1(this.gl.uniform4iv,name,arr,!0)},set1i:function(name,x){return this.setUniform1(this.gl.uniform1i,name,x)},set2i:function(name,x,y){return this.setUniform2(this.gl.uniform2i,name,x,y)},set3i:function(name,x,y,z){return this.setUniform3(this.gl.uniform3i,name,x,y,z)},set4i:function(name,x,y,z,w){return this.setUniform4(this.gl.uniform4i,name,x,y,z,w)},setMatrix2fv:function(name,transpose,matrix){return this.setUniform2(this.gl.uniformMatrix2fv,name,transpose,matrix,!0)},setMatrix3fv:function(name,transpose,matrix){return this.setUniform2(this.gl.uniformMatrix3fv,name,transpose,matrix,!0)},setMatrix4fv:function(name,transpose,matrix){return this.setUniform2(this.gl.uniformMatrix4fv,name,transpose,matrix,!0)},destroy:function(){this.gl.deleteProgram(this.program),this.pipeline=null,this.renderer=null,this.gl=null,this.program=null,this.attributes=null,this.uniforms=null}}),DisplayList_1=Class_1,DeepCopy=DeepCopy_1,EventEmitter$p=eventemitter3.exports,Events$D=CalculateFacesWithin_1,GetFastValue$1c=GetFastValue_1,Matrix4$4=FloorAll_1,RendererEvents=events,RenderTarget$2=Fill_1,Utils$o=GetProps_1,WebGLShader=FindByIndex_1,FilterTiles_1=new DisplayList_1({Extends:EventEmitter$p,initialize:function(config){EventEmitter$p.call(this);var game=config.game,renderer=game.renderer,gl=renderer.gl;this.name=GetFastValue$1c(config,"name","WebGLPipeline"),this.game=game,this.renderer=renderer,this.manager,this.gl=gl,this.view=game.canvas,this.width=0,this.height=0,this.vertexCount=0,this.vertexCapacity=0,this.vertexData,this.vertexBuffer,this.topology=GetFastValue$1c(config,"topology",gl.TRIANGLES),this.bytes,this.vertexViewF32,this.vertexViewU32,this.active=!0,this.currentUnit=0,this.forceZero=GetFastValue$1c(config,"forceZero",!1),this.hasBooted=!1,this.isPostFX=!1,this.renderTargets=[],this.currentRenderTarget,this.shaders=[],this.currentShader,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.config=config,this.glReset=!1},boot:function(){var gl=this.gl,configVerts=this.config,renderer=this.renderer;this.isPostFX||(this.projectionMatrix=(new Matrix4$4).identity());var renderTargets=this.renderTargets,targets=GetFastValue$1c(configVerts,"renderTarget",!1),width=renderer.width,height=renderer.height;if("number"==typeof(targets="boolean"==typeof targets&&targets?1:targets))for(i=0;i<targets;i++)renderTargets.push(new RenderTarget$2(renderer,width,height,1,0,!0));else if(Array.isArray(targets))for(i=0;i<targets.length;i++){var scale=GetFastValue$1c(targets[i],"scale",1),minFilter=GetFastValue$1c(targets[i],"minFilter",0),autoClear=GetFastValue$1c(targets[i],"autoClear",1);renderTargets.push(new RenderTarget$2(renderer,width,height,scale,minFilter,autoClear))}renderTargets.length&&(this.currentRenderTarget=renderTargets[0]),this.setShadersFromConfig(configVerts);for(var shaders=this.shaders,vertexSize=0,i=0;i<shaders.length;i++)shaders[i].vertexSize>vertexSize&&(vertexSize=shaders[i].vertexSize);var data=GetFastValue$1c(configVerts,"batchSize",renderer.config.batchSize);this.vertexCapacity=6*data;data=new ArrayBuffer(this.vertexCapacity*vertexSize);this.vertexData=data,this.bytes=new Uint8Array(data),this.vertexViewF32=new Float32Array(data),this.vertexViewU32=new Uint32Array(data);configVerts=GetFastValue$1c(configVerts,"vertices",null);for(configVerts?(this.vertexViewF32.set(configVerts),this.vertexBuffer=renderer.createVertexBuffer(data,gl.STATIC_DRAW)):this.vertexBuffer=renderer.createVertexBuffer(data.byteLength,gl.DYNAMIC_DRAW),this.setVertexBuffer(),i=shaders.length-1;0<=i;i--)shaders[i].rebind();this.hasBooted=!0,renderer.on(RendererEvents.RESIZE,this.resize,this),renderer.on(RendererEvents.PRE_RENDER,this.onPreRender,this),renderer.on(RendererEvents.RENDER,this.onRender,this),renderer.on(RendererEvents.POST_RENDER,this.onPostRender,this),this.emit(Events$D.BOOT,this),this.onBoot()},onBoot:function(){},onResize:function(){},setShader:function(shader,setAttributes){var wasBound=this.renderer;return shader===this.currentShader&&wasBound.currentProgram===this.currentShader.program||(this.flush(),wasBound.resetTextures(),wasBound=this.setVertexBuffer(),shader.bind(setAttributes=wasBound&&!setAttributes?!0:setAttributes,!1),this.currentShader=shader),this},getShaderByName:function(name){for(var shaders=this.shaders,i=0;i<shaders.length;i++)if(shaders[i].name===name)return shaders[i]},setShadersFromConfig:function(config){var shaders=this.shaders,renderer=this.renderer;for(i=0;i<shaders.length;i++)shaders[i].destroy();var defaultVertShader=GetFastValue$1c(config,"vertShader",null),defaultFragShader=Utils$o.parseFragmentShaderMaxTextures(GetFastValue$1c(config,"fragShader",null),renderer.maxTextures),defaultAttribs=GetFastValue$1c(config,"attributes",null),configShaders=GetFastValue$1c(config,"shaders",[]),len=configShaders.length;if(0===len)defaultVertShader&&defaultFragShader&&(this.shaders=[new WebGLShader(this,"default",defaultVertShader,defaultFragShader,DeepCopy(defaultAttribs))]);else{for(var newShaders=[],i=0;i<len;i++){var attributes=configShaders[i],name=GetFastValue$1c(attributes,"name","default"),vertShader=GetFastValue$1c(attributes,"vertShader",defaultVertShader),fragShader=Utils$o.parseFragmentShaderMaxTextures(GetFastValue$1c(attributes,"fragShader",defaultFragShader),renderer.maxTextures),attributes=GetFastValue$1c(attributes,"attributes",defaultAttribs);vertShader&&fragShader&&newShaders.push(new WebGLShader(this,name,vertShader,fragShader,DeepCopy(attributes)))}this.shaders=newShaders}return 0===this.shaders.length?console.warn("Pipeline: "+this.name+" - Invalid shader config"):this.currentShader=this.shaders[0],this},setGameObject:function(gameObject,frame){return void 0===frame&&(frame=gameObject.frame),this.currentUnit=this.renderer.setTextureSource(frame.source),this.currentUnit},shouldFlush:function(amount){return this.vertexCount+(amount=void 0===amount?0:amount)>this.vertexCapacity},resize:function(width,height){width===this.width&&height===this.height||this.flush(),this.width=width,this.height=height;for(var targets=this.renderTargets,i=0;i<targets.length;i++)targets[i].resize(width,height);return this.setProjectionMatrix(width,height),this.emit(Events$D.RESIZE,width,height,this),this.onResize(width,height),this},setProjectionMatrix:function(width,height){var projectionMatrix=this.projectionMatrix;if(!projectionMatrix)return this;this.projectionWidth=width,this.projectionHeight=height,projectionMatrix.ortho(0,width,height,0,-1e3,1e3);for(var shaders=this.shaders,name="uProjectionMatrix",i=0;i<shaders.length;i++){var shader=shaders[i];shader.hasUniform(name)&&(shader.resetUniform(name),shader.setMatrix4fv(name,!1,projectionMatrix.val,shader))}return this},updateProjectionMatrix:function(){var globalWidth,globalHeight;this.projectionMatrix&&(globalWidth=this.renderer.projectionWidth,globalHeight=this.renderer.projectionHeight,this.projectionWidth===globalWidth&&this.projectionHeight===globalHeight||this.setProjectionMatrix(globalWidth,globalHeight))},bind:function(currentShader){if(void 0===currentShader&&(currentShader=this.currentShader),this.glReset)return this.rebind(currentShader);var wasBound=this.setVertexBuffer();return currentShader.bind(wasBound),this.currentShader=currentShader,this.emit(Events$D.BIND,this,currentShader),this.onActive(currentShader),this},rebind:function(currentShader){this.setVertexBuffer();for(var shaders=this.shaders,i=shaders.length-1;0<=i;i--){var shader=shaders[i].rebind();currentShader&&shader!==currentShader||(this.currentShader=shader)}return this.emit(Events$D.REBIND,this.currentShader),this.onActive(this.currentShader),this.onRebind(),this.glReset=!1,this},setVertexBuffer:function(){var gl=this.gl,buffer=this.vertexBuffer;return gl.getParameter(gl.ARRAY_BUFFER_BINDING)!==buffer&&(gl.bindBuffer(gl.ARRAY_BUFFER,buffer),!0)},preBatch:function(gameObject){return this.currentRenderTarget&&this.currentRenderTarget.bind(),this.onPreBatch(gameObject),this},postBatch:function(gameObject){return this.onDraw(this.currentRenderTarget),this.onPostBatch(gameObject),this},onDraw:function(){},unbind:function(){this.currentRenderTarget&&this.currentRenderTarget.unbind()},flush:function(isPostFlush){var gl,vertexCount,vertexSize;return void 0===isPostFlush&&(isPostFlush=!1),0<this.vertexCount&&(this.emit(Events$D.BEFORE_FLUSH,this,isPostFlush),this.onBeforeFlush(isPostFlush),gl=this.gl,vertexCount=this.vertexCount,vertexSize=this.currentShader.vertexSize,this.active&&(this.setVertexBuffer(),vertexCount===this.vertexCapacity?gl.bufferData(gl.ARRAY_BUFFER,this.vertexData,gl.DYNAMIC_DRAW):gl.bufferSubData(gl.ARRAY_BUFFER,0,this.bytes.subarray(0,vertexCount*vertexSize)),gl.drawArrays(this.topology,0,vertexCount)),this.vertexCount=0,this.emit(Events$D.AFTER_FLUSH,this,isPostFlush),this.onAfterFlush(isPostFlush)),this},onActive:function(){},onBind:function(){},onRebind:function(){},onBatch:function(){},onPreBatch:function(){},onPostBatch:function(){},onPreRender:function(){},onRender:function(){},onPostRender:function(){},onBeforeFlush:function(){},onAfterFlush:function(){},batchVert:function(x,y,u,v,unit,tintEffect,tint){var vertexViewF32=this.vertexViewF32,vertexViewU32=this.vertexViewU32,vertexOffset=this.vertexCount*this.currentShader.vertexComponentCount-1;vertexViewF32[++vertexOffset]=x,vertexViewF32[++vertexOffset]=y,vertexViewF32[++vertexOffset]=u,vertexViewF32[++vertexOffset]=v,vertexViewF32[++vertexOffset]=unit,vertexViewF32[++vertexOffset]=tintEffect,vertexViewU32[++vertexOffset]=tint,this.vertexCount++},batchQuad:function(gameObject,x0,y0,x1,y1,x2,y2,x3,y3,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintBR,tintEffect,texture,unit){void 0===unit&&(unit=this.currentUnit);var hasFlushed=!1;return this.shouldFlush(6)&&(this.flush(),hasFlushed=!0,unit=this.setTexture2D(texture)),this.batchVert(x0,y0,u0,v0,unit,tintEffect,tintTL),this.batchVert(x1,y1,u0,v1,unit,tintEffect,tintBL),this.batchVert(x2,y2,u1,v1,unit,tintEffect,tintBR),this.batchVert(x0,y0,u0,v0,unit,tintEffect,tintTL),this.batchVert(x2,y2,u1,v1,unit,tintEffect,tintBR),this.batchVert(x3,y3,u1,v0,unit,tintEffect,tintTR),this.onBatch(gameObject),hasFlushed},batchTri:function(gameObject,x0,y0,x1,y1,x2,y2,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintEffect,texture,unit){void 0===unit&&(unit=this.currentUnit);var hasFlushed=!1;return this.shouldFlush(3)&&(this.flush(),hasFlushed=!0,unit=this.setTexture2D(texture)),this.batchVert(x0,y0,u0,v0,unit,tintEffect,tintTL),this.batchVert(x1,y1,u0,v1,unit,tintEffect,tintTR),this.batchVert(x2,y2,u1,v1,unit,tintEffect,tintBL),this.onBatch(gameObject),hasFlushed},drawFillRect:function(x,y,unit,tint,v0,v1,texture,flipUV){void 0===texture&&(texture=this.renderer.whiteTexture.glTexture),void 0===flipUV&&(flipUV=!0),x=Math.floor(x),y=Math.floor(y);var xw=Math.floor(x+unit),yh=Math.floor(y+tint),unit=this.setTexture2D(texture),tint=Utils$o.getTintAppendFloatAlphaAndSwap(v0,v1),v0=0,v1=1;flipUV&&(v0=1,v1=0),this.batchQuad(null,x,y,x,yh,xw,yh,xw,y,0,v0,1,v1,tint,tint,tint,tint,0,texture,unit)},setTexture2D:function(texture){return void 0===texture&&(texture=this.renderer.whiteTexture.glTexture),this.currentUnit=this.renderer.setTexture2D(texture),this.currentUnit},bindTexture:function(texture,unit){var gl=this.gl;return gl.activeTexture(gl.TEXTURE0+(unit=void 0===unit?0:unit)),gl.bindTexture(gl.TEXTURE_2D,texture),this},bindRenderTarget:function(target,unit){return this.bindTexture(target.texture,unit)},setTime:function(uniform){return this.set1f(uniform,this.game.loop.getDuration()),this},set1f:function(name,x,shader){return(shader=void 0===shader?this.currentShader:shader).set1f(name,x),this},set2f:function(name,x,y,shader){return(shader=void 0===shader?this.currentShader:shader).set2f(name,x,y),this},set3f:function(name,x,y,z,shader){return(shader=void 0===shader?this.currentShader:shader).set3f(name,x,y,z),this},set4f:function(name,x,y,z,w,shader){return(shader=void 0===shader?this.currentShader:shader).set4f(name,x,y,z,w),this},set1fv:function(name,arr,shader){return(shader=void 0===shader?this.currentShader:shader).set1fv(name,arr),this},set2fv:function(name,arr,shader){return(shader=void 0===shader?this.currentShader:shader).set2fv(name,arr),this},set3fv:function(name,arr,shader){return(shader=void 0===shader?this.currentShader:shader).set3fv(name,arr),this},set4fv:function(name,arr,shader){return(shader=void 0===shader?this.currentShader:shader).set4fv(name,arr),this},set1iv:function(name,arr,shader){return(shader=void 0===shader?this.currentShader:shader).set1iv(name,arr),this},set2iv:function(name,arr,shader){return(shader=void 0===shader?this.currentShader:shader).set2iv(name,arr),this},set3iv:function(name,arr,shader){return(shader=void 0===shader?this.currentShader:shader).set3iv(name,arr),this},set4iv:function(name,arr,shader){return(shader=void 0===shader?this.currentShader:shader).set4iv(name,arr),this},set1i:function(name,x,shader){return(shader=void 0===shader?this.currentShader:shader).set1i(name,x),this},set2i:function(name,x,y,shader){return(shader=void 0===shader?this.currentShader:shader).set2i(name,x,y),this},set3i:function(name,x,y,z,shader){return(shader=void 0===shader?this.currentShader:shader).set3i(name,x,y,z),this},set4i:function(name,x,y,z,w,shader){return(shader=void 0===shader?this.currentShader:shader).set4i(name,x,y,z,w),this},setMatrix2fv:function(name,transpose,matrix,shader){return(shader=void 0===shader?this.currentShader:shader).setMatrix2fv(name,transpose,matrix),this},setMatrix3fv:function(name,transpose,matrix,shader){return(shader=void 0===shader?this.currentShader:shader).setMatrix3fv(name,transpose,matrix),this},setMatrix4fv:function(name,transpose,matrix,shader){return(shader=void 0===shader?this.currentShader:shader).setMatrix4fv(name,transpose,matrix),this},destroy:function(){this.emit(Events$D.DESTROY,this);for(var shaders=this.shaders,i=0;i<shaders.length;i++)shaders[i].destroy();var targets=this.renderTargets;for(i=0;i<targets.length;i++)targets[i].destroy();this.gl.deleteBuffer(this.vertexBuffer);var renderer=this.renderer;return renderer.off(RendererEvents.RESIZE,this.resize,this),renderer.off(RendererEvents.PRE_RENDER,this.onPreRender,this),renderer.off(RendererEvents.RENDER,this.onRender,this),renderer.off(RendererEvents.POST_RENDER,this.onPostRender,this),this.removeAllListeners(),this.game=null,this.renderer=null,this.manager=null,this.gl=null,this.view=null,this.shaders=null,this.renderTargets=null,this.bytes=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexData=null,this.vertexBuffer=null,this.currentShader=null,this.currentRenderTarget=null,this}}),GetFastValue$1b=GetFastValue_1,ShaderSourceFS$4=Pick_1,ShaderSourceVS$4=UpdateList_1,WEBGL_CONST$3=FindTile_1,WebGLPipeline$7=FilterTiles_1,CalculateFacesAt_1=new Class_1({Extends:WebGLPipeline$7,initialize:function(config){config.fragShader=GetFastValue$1b(config,"fragShader",ShaderSourceFS$4),config.vertShader=GetFastValue$1b(config,"vertShader",ShaderSourceVS$4),config.batchSize=GetFastValue$1b(config,"batchSize",1),config.vertices=GetFastValue$1b(config,"vertices",[-1,1,-1,-7,7,1]),config.attributes=GetFastValue$1b(config,"attributes",[{name:"inPosition",size:2,type:WEBGL_CONST$3.FLOAT}]),WebGLPipeline$7.call(this,config)},boot:function(){WebGLPipeline$7.prototype.boot.call(this),this.set1i("uMainSampler",0),this.set1i("uMaskSampler",1)},resize:function(width,height){WebGLPipeline$7.prototype.resize.call(this,width,height),this.set2f("uResolution",width,height)},beginMask:function(mask,maskedObject,camera){var renderer,gl=this.gl;mask.bitmapMask&&gl&&((renderer=this.renderer).flush(),renderer.pushFramebuffer(mask.mainFramebuffer),gl.disable(gl.STENCIL_TEST),gl.clearColor(0,0,0,0),gl.clear(gl.COLOR_BUFFER_BIT),renderer.currentCameraMask.mask!==mask&&(renderer.currentMask.mask=mask,renderer.currentMask.camera=camera))},endMask:function(mask,prev){var gl=this.gl,renderer=this.renderer,bitmapMask=mask.bitmapMask;bitmapMask&&gl&&(renderer.flush(),renderer.pushFramebuffer(mask.maskFramebuffer),gl.clearColor(0,0,0,0),gl.clear(gl.COLOR_BUFFER_BIT),renderer.setBlendMode(0,!0),bitmapMask.renderWebGL(renderer,bitmapMask,prev),renderer.flush(),renderer.popFramebuffer(),renderer.popFramebuffer(),(prev=renderer.getCurrentStencilMask())?(gl.enable(gl.STENCIL_TEST),prev.mask.applyStencil(renderer,prev.camera,!0)):renderer.currentMask.mask=null,renderer.pipelines.set(this),gl.activeTexture(gl.TEXTURE1),gl.bindTexture(gl.TEXTURE_2D,mask.maskTexture),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,mask.mainTexture),this.set1i("uInvertMaskAlpha",mask.invertAlpha),gl.drawArrays(this.topology,0,3),renderer.resetTextures())}});function earcut(data,holeIndices,dim){dim=dim||2;var maxX,maxY,x,y,invSize,hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim:data.length,outerNode=linkedList(data,0,outerLen,dim,!0),triangles=[];if(!outerNode||outerNode.next===outerNode.prev)return triangles;if(hasHoles&&(outerNode=function(data,holeIndices,outerNode,dim){var i,len,start,list,queue=[];for(i=0,len=holeIndices.length;i<len;i++)start=holeIndices[i]*dim,list=i<len-1?holeIndices[i+1]*dim:data.length,(list=linkedList(data,start,list,dim,!1))===list.next&&(list.steiner=!0),queue.push(function(start){var p=start,leftmost=start;for(;(p.x<leftmost.x||p.x===leftmost.x&&p.y<leftmost.y)&&(leftmost=p),p=p.next,p!==start;);return leftmost}(list));for(queue.sort(compareX),i=0;i<queue.length;i++)!function(b,outerNode){(outerNode=function(hole,outerNode){var m,p=outerNode,hx=hole.x,hy=hole.y,qx=-1/0;do{if(hy<=p.y&&hy>=p.next.y&&p.next.y!==p.y){var x=p.x+(hy-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(x<=hx&&qx<x){if((qx=x)===hx){if(hy===p.y)return p;if(hy===p.next.y)return p.next}m=p.x<p.next.x?p:p.next}}}while(p=p.next,p!==outerNode);if(!m)return null;if(hx===qx)return m;var tan,stop=m,mx=m.x,my=m.y,tanMin=1/0;p=m;for(;hx>=p.x&&p.x>=mx&&hx!==p.x&&pointInTriangle(hy<my?hx:qx,hy,mx,my,hy<my?qx:hx,hy,p.x,p.y)&&(tan=Math.abs(hy-p.y)/(hx-p.x),locallyInside(p,hole)&&(tan<tanMin||tan===tanMin&&(p.x>m.x||p.x===m.x&&function(m,p){return area(m.prev,m,p.prev)<0&&area(p.next,m,m.next)<0}(m,p)))&&(m=p,tanMin=tan)),p=p.next,p!==stop;);return m}(b,outerNode))&&(b=splitPolygon(outerNode,b),filterPoints(outerNode,outerNode.next),filterPoints(b,b.next))}(queue[i],outerNode),outerNode=filterPoints(outerNode,outerNode.next);return outerNode}(data,holeIndices,outerNode,dim)),data.length>80*dim){for(var minX=maxX=data[0],minY=maxY=data[1],i=dim;i<outerLen;i+=dim)(x=data[i])<minX&&(minX=x),(y=data[i+1])<minY&&(minY=y),maxX<x&&(maxX=x),maxY<y&&(maxY=y);invSize=0!==(invSize=Math.max(maxX-minX,maxY-minY))?1/invSize:0}return earcutLinked(outerNode,triangles,dim,minX,minY,invSize),triangles}function linkedList(data,start,end,dim,clockwise){var i,last;if(clockwise===0<signedArea(data,start,end,dim))for(i=start;i<end;i+=dim)last=insertNode(i,data[i],data[i+1],last);else for(i=end-dim;start<=i;i-=dim)last=insertNode(i,data[i],data[i+1],last);return last&&equals(last,last.next)&&(removeNode(last),last=last.next),last}function filterPoints(start,end){if(!start)return start;end=end||start;var again,p=start;do{if(again=!1,p.steiner||!equals(p,p.next)&&0!==area(p.prev,p,p.next))p=p.next;else{if(removeNode(p),(p=end=p.prev)===p.next)break;again=!0}}while(again||p!==end);return end}function earcutLinked(ear,triangles,dim,minX,minY,invSize,pass){if(ear){!pass&&invSize&&function(start,minX,minY,invSize){var p=start;for(;null===p.z&&(p.z=zOrder(p.x,p.y,minX,minY,invSize)),p.prevZ=p.prev,p.nextZ=p.next,p=p.next,p!==start;);p.prevZ.nextZ=null,p.prevZ=null,function(list){var i,p,q,e,tail,numMerges,pSize,qSize,inSize=1;do{for(p=list,tail=list=null,numMerges=0;p;){for(numMerges++,q=p,i=pSize=0;i<inSize&&(pSize++,q=q.nextZ);i++);for(qSize=inSize;0<pSize||0<qSize&&q;)0!==pSize&&(0===qSize||!q||p.z<=q.z)?(p=(e=p).nextZ,pSize--):(q=(e=q).nextZ,qSize--),tail?tail.nextZ=e:list=e,e.prevZ=tail,tail=e;p=q}}while(tail.nextZ=null,inSize*=2,1<numMerges)}(p)}(ear,minX,minY,invSize);for(var prev,next,stop=ear;ear.prev!==ear.next;)if(prev=ear.prev,next=ear.next,invSize?function(ear,minX,minY,invSize){var a=ear.prev,b=ear,c=ear.next;if(0<=area(a,b,c))return!1;var minTX=(a.x<b.x?a.x<c.x?a:c:b.x<c.x?b:c).x,minTY=(a.y<b.y?a.y<c.y?a:c:b.y<c.y?b:c).y,maxTX=(a.x>b.x?a.x>c.x?a:c:b.x>c.x?b:c).x,maxTY=(a.y>b.y?a.y>c.y?a:c:b.y>c.y?b:c).y,minZ=zOrder(minTX,minTY,minX,minY,invSize),maxZ=zOrder(maxTX,maxTY,minX,minY,invSize),p=ear.prevZ,n=ear.nextZ;for(;p&&p.z>=minZ&&n&&n.z<=maxZ;){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&0<=area(p.prev,p,p.next))return!1;if(p=p.prevZ,n!==ear.prev&&n!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&0<=area(n.prev,n,n.next))return!1;n=n.nextZ}for(;p&&p.z>=minZ;){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&0<=area(p.prev,p,p.next))return!1;p=p.prevZ}for(;n&&n.z<=maxZ;){if(n!==ear.prev&&n!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&0<=area(n.prev,n,n.next))return!1;n=n.nextZ}return!0}(ear,minX,minY,invSize):function(ear){var a=ear.prev,b=ear,c=ear.next;if(0<=area(a,b,c))return!1;var p=ear.next.next;for(;p!==ear.prev;){if(pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&0<=area(p.prev,p,p.next))return!1;p=p.next}return!0}(ear))triangles.push(prev.i/dim),triangles.push(ear.i/dim),triangles.push(next.i/dim),removeNode(ear),ear=next.next,stop=next.next;else if((ear=next)===stop){pass?1===pass?earcutLinked(ear=function(start,triangles,dim){var p=start;do{var a=p.prev,b=p.next.next}while(!equals(a,b)&&intersects$2(a,p,p.next,b)&&locallyInside(a,b)&&locallyInside(b,a)&&(triangles.push(a.i/dim),triangles.push(p.i/dim),triangles.push(b.i/dim),removeNode(p),removeNode(p.next),p=start=b),p=p.next,p!==start);return filterPoints(p)}(filterPoints(ear),triangles,dim),triangles,dim,minX,minY,invSize,2):2===pass&&function(start,triangles,dim,minX,minY,invSize){var a=start;do{for(var b=a.next.next;b!==a.prev;){if(a.i!==b.i&&function(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!function(a,b){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==b.i&&p.next.i!==b.i&&intersects$2(p,p.next,a,b))return!0}while(p=p.next,p!==a);return!1}(a,b)&&(locallyInside(a,b)&&locallyInside(b,a)&&function(a,b){var p=a,inside=!1,px=(a.x+b.x)/2,py=(a.y+b.y)/2;for(;p.y>py!=p.next.y>py&&p.next.y!==p.y&&px<(p.next.x-p.x)*(py-p.y)/(p.next.y-p.y)+p.x&&(inside=!inside),p=p.next,p!==a;);return inside}(a,b)&&(area(a.prev,a,b.prev)||area(a,b.prev,b))||equals(a,b)&&0<area(a.prev,a,a.next)&&0<area(b.prev,b,b.next))}(a,b)){var c=splitPolygon(a,b);return a=filterPoints(a,a.next),c=filterPoints(c,c.next),earcutLinked(a,triangles,dim,minX,minY,invSize),earcutLinked(c,triangles,dim,minX,minY,invSize)}b=b.next}}while(a=a.next,a!==start)}(ear,triangles,dim,minX,minY,invSize):earcutLinked(filterPoints(ear),triangles,dim,minX,minY,invSize,1);break}}}function compareX(a,b){return a.x-b.x}function zOrder(x,y,minX,minY,invSize){return(x=1431655765&((x=858993459&((x=252645135&((x=16711935&((x=32767*(x-minX)*invSize)|x<<8))|x<<4))|x<<2))|x<<1))|(y=1431655765&((y=858993459&((y=252645135&((y=16711935&((y=32767*(y-minY)*invSize)|y<<8))|y<<4))|y<<2))|y<<1))<<1}function pointInTriangle(ax,ay,bx,by,cx,cy,px,py){return 0<=(cx-px)*(ay-py)-(ax-px)*(cy-py)&&0<=(ax-px)*(by-py)-(bx-px)*(ay-py)&&0<=(bx-px)*(cy-py)-(cx-px)*(by-py)}function area(p,q,r){return(q.y-p.y)*(r.x-q.x)-(q.x-p.x)*(r.y-q.y)}function equals(p1,p2){return p1.x===p2.x&&p1.y===p2.y}function intersects$2(p1,q1,p2,q2){var o1=sign(area(p1,q1,p2)),o2=sign(area(p1,q1,q2)),o3=sign(area(p2,q2,p1)),o4=sign(area(p2,q2,q1));return o1!==o2&&o3!==o4||(0===o1&&onSegment(p1,p2,q1)||(0===o2&&onSegment(p1,q2,q1)||(0===o3&&onSegment(p2,p1,q2)||!(0!==o4||!onSegment(p2,q1,q2)))))}function onSegment(p,q,r){return q.x<=Math.max(p.x,r.x)&&q.x>=Math.min(p.x,r.x)&&q.y<=Math.max(p.y,r.y)&&q.y>=Math.min(p.y,r.y)}function sign(num){return 0<num?1:num<0?-1:0}function locallyInside(a,b){return area(a.prev,a,a.next)<0?0<=area(a,b,a.next)&&0<=area(a,a.prev,b):area(a,b,a.prev)<0||area(a,a.next,b)<0}function splitPolygon(a,b){var a2=new Node(a.i,a.x,a.y),b2=new Node(b.i,b.x,b.y),an=a.next,bp=b.prev;return(a.next=b).prev=a,(a2.next=an).prev=a2,(b2.next=a2).prev=b2,(bp.next=b2).prev=bp,b2}function insertNode(i,x,p,last){p=new Node(i,x,p);return last?(p.next=last.next,(p.prev=last).next.prev=p,last.next=p):(p.prev=p).next=p,p}function removeNode(p){p.next.prev=p.prev,p.prev.next=p.next,p.prevZ&&(p.prevZ.nextZ=p.nextZ),p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function Node(i,x,y){this.i=i,this.x=x,this.y=y,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(data,start,end,dim){for(var sum=0,i=start,j=end-dim;i<end;i+=dim)sum+=(data[j]-data[i])*(data[i+1]+data[j+1]),j=i;return sum}earcut.deviation=function(data,holeIndices,dim,triangles){var hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim:data.length,polygonArea=Math.abs(signedArea(data,0,outerLen,dim));if(hasHoles)for(var i=0,len=holeIndices.length;i<len;i++){var start=holeIndices[i]*dim,end=i<len-1?holeIndices[i+1]*dim:data.length;polygonArea-=Math.abs(signedArea(data,start,end,dim))}for(var trianglesArea=0,i=0;i<triangles.length;i+=3){var a=triangles[i]*dim,b=triangles[i+1]*dim,c=triangles[i+2]*dim;trianglesArea+=Math.abs((data[a]-data[c])*(data[1+b]-data[1+a])-(data[a]-data[b])*(data[1+c]-data[1+a]))}return 0===polygonArea&&0===trianglesArea?0:Math.abs((trianglesArea-polygonArea)/polygonArea)},earcut.flatten=function(data){for(var dim=data[0][0].length,result={vertices:[],holes:[],dimensions:dim},holeIndex=0,i=0;i<data.length;i++){for(var j=0;j<data[i].length;j++)for(var d=0;d<dim;d++)result.vertices.push(data[i][j][d]);0<i&&(holeIndex+=data[i-1].length,result.holes.push(holeIndex))}return result};var AtlasJSONFile_1=earcut,PluginCache$7=["#define SHADER_NAME PHASER_GRAPHICS_FS","","precision mediump float;","","varying vec4 outColor;","","void main ()","{","    gl_FragColor = vec4(outColor.bgr * outColor.a, outColor.a);","}",""].join("\n"),display=["#define SHADER_NAME PHASER_GRAPHICS_VS","","precision mediump float;","","uniform mat4 uProjectionMatrix;","","attribute vec2 inPosition;","attribute vec4 inColor;","","varying vec4 outColor;","","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","","    outColor = inColor;","}",""].join("\n"),Earcut$6=AtlasJSONFile_1,GetFastValue$1a=GetFastValue_1,ShaderSourceFS$3=PluginCache$7,ShaderSourceVS$3=display,TransformMatrix$c=TransformMatrix,WEBGL_CONST$2=FindTile_1,WebGLPipeline$6=FilterTiles_1,CheckIsoBounds_1=new Class_1({Extends:WebGLPipeline$6,initialize:function(config){config.fragShader=GetFastValue$1a(config,"fragShader",ShaderSourceFS$3),config.vertShader=GetFastValue$1a(config,"vertShader",ShaderSourceVS$3),config.attributes=GetFastValue$1a(config,"attributes",[{name:"inPosition",size:2},{name:"inColor",size:4,type:WEBGL_CONST$2.UNSIGNED_BYTE,normalized:!0}]),WebGLPipeline$6.call(this,config),this.calcMatrix=new TransformMatrix$c,this.tempTriangle=[{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0}],this.strokeTint={TL:0,TR:0,BL:0,BR:0},this.fillTint={TL:0,TR:0,BL:0,BR:0},this.currentFrame={u0:0,v0:0,u1:1,v1:1},this.firstQuad=[0,0,0,0,0],this.prevQuad=[0,0,0,0,0],this.polygonCache=[]},batchFillRect:function(y2,tint,y1,x2,x1,y0){this.renderer.pipelines.set(this);var calcMatrix=this.calcMatrix;y0&&y0.multiply(x1,calcMatrix);var y3=y2+y1,x3=tint+x2,x0=calcMatrix.getX(y2,tint),y0=calcMatrix.getY(y2,tint),x1=calcMatrix.getX(y2,x3),y1=calcMatrix.getY(y2,x3),x2=calcMatrix.getX(y3,x3),y2=calcMatrix.getY(y3,x3),x3=calcMatrix.getX(y3,tint),y3=calcMatrix.getY(y3,tint),tint=this.fillTint;this.batchQuad(x0,y0,x1,y1,x2,y2,x3,y3,tint.TL,tint.TR,tint.BL,tint.BR)},batchFillTriangle:function(ty0,tx1,ty1,tx2,ty2,tint,tx0,parentMatrix){this.renderer.pipelines.set(this);var calcMatrix=this.calcMatrix;parentMatrix&&parentMatrix.multiply(tx0,calcMatrix);tx0=calcMatrix.getX(ty0,tx1),ty0=calcMatrix.getY(ty0,tx1),tx1=calcMatrix.getX(ty1,tx2),ty1=calcMatrix.getY(ty1,tx2),tx2=calcMatrix.getX(ty2,tint),ty2=calcMatrix.getY(ty2,tint),tint=this.fillTint;this.batchTri(tx0,ty0,tx1,ty1,tx2,ty2,tint.TL,tint.TR,tint.BL)},batchStrokeTriangle:function(x0,y0,x1,y1,x2,y2,lineWidth,currentMatrix,parentMatrix){var tempTriangle=this.tempTriangle;tempTriangle[0].x=x0,tempTriangle[0].y=y0,tempTriangle[0].width=lineWidth,tempTriangle[1].x=x1,tempTriangle[1].y=y1,tempTriangle[1].width=lineWidth,tempTriangle[2].x=x2,tempTriangle[2].y=y2,tempTriangle[2].width=lineWidth,tempTriangle[3].x=x0,tempTriangle[3].y=y0,tempTriangle[3].width=lineWidth,this.batchStrokePath(tempTriangle,lineWidth,!1,currentMatrix,parentMatrix)},batchFillPath:function(path,currentMatrix,parentMatrix){this.renderer.pipelines.set(this);var calcMatrix=this.calcMatrix;parentMatrix&&parentMatrix.multiply(currentMatrix,calcMatrix);for(var point,length=path.length,polygonCache=this.polygonCache,tintTL=this.fillTint.TL,tintTR=this.fillTint.TR,tintBL=this.fillTint.BL,pathIndex=0;pathIndex<length;++pathIndex)point=path[pathIndex],polygonCache.push(point.x,point.y);for(var polygonIndexArray,length=(polygonIndexArray=Earcut$6(polygonCache)).length,index=0;index<length;index+=3){var x2=2*polygonIndexArray[index+0],ty2=2*polygonIndexArray[index+1],tx0=2*polygonIndexArray[index+2],ty0=polygonCache[0+x2],tx1=polygonCache[1+x2],ty1=polygonCache[0+ty2],tx2=polygonCache[1+ty2],x2=polygonCache[0+tx0],ty2=polygonCache[1+tx0],tx0=calcMatrix.getX(ty0,tx1),ty0=calcMatrix.getY(ty0,tx1),tx1=calcMatrix.getX(ty1,tx2),ty1=calcMatrix.getY(ty1,tx2),tx2=calcMatrix.getX(x2,ty2),ty2=calcMatrix.getY(x2,ty2);this.batchTri(tx0,ty0,tx1,ty1,tx2,ty2,tintTL,tintTR,tintBL)}polygonCache.length=0},batchStrokePath:function(path,lineWidth,pathOpen,currentMatrix,parentMatrix){this.renderer.pipelines.set(this),this.prevQuad[4]=0,this.firstQuad[4]=0;for(var pathLength=path.length-1,pathIndex=0;pathIndex<pathLength;pathIndex++){var point0=path[pathIndex],point1=path[pathIndex+1];this.batchLine(point0.x,point0.y,point1.x,point1.y,point0.width/2,point1.width/2,lineWidth,pathIndex,!pathOpen&&pathIndex===pathLength-1,currentMatrix,parentMatrix)}},batchLine:function(brX,blX,prev,tintBL,trY,tlX,first,index,closePath,tintTL,blY){this.renderer.pipelines.set(this);var tintTR=this.calcMatrix;blY&&blY.multiply(tintTL,tintTR);var tintBR=prev-brX,trX=tintBL-blX,tlY=Math.sqrt(tintBR*tintBR+trX*trX),brY=trY*(tintBL-blX)/tlY,blY=trY*(brX-prev)/tlY,tintTL=tlX*(tintBL-blX)/tlY,tintBR=tlX*(brX-prev)/tlY,trX=prev-tintTL,trY=tintBL-tintBR,tlX=brX-brY,tlY=blX-blY,prev=prev+tintTL,tintTL=tintBL+tintBR,tintBL=brX+brY,tintBR=blX+blY,brX=tintTR.getX(trX,trY),brY=tintTR.getY(trX,trY),blX=tintTR.getX(tlX,tlY),blY=tintTR.getY(tlX,tlY),trX=tintTR.getX(prev,tintTL),trY=tintTR.getY(prev,tintTL),tlX=tintTR.getX(tintBL,tintBR),tlY=tintTR.getY(tintBL,tintBR),prev=this.strokeTint,tintTL=prev.TL,tintTR=prev.TR,tintBL=prev.BL,tintBR=prev.BR;this.batchQuad(tlX,tlY,blX,blY,brX,brY,trX,trY,tintTL,tintTR,tintBL,tintBR),first<=2||(prev=this.prevQuad,first=this.firstQuad,0<index&&prev[4]?this.batchQuad(tlX,tlY,blX,blY,prev[0],prev[1],prev[2],prev[3],tintTL,tintTR,tintBL,tintBR):(first[0]=tlX,first[1]=tlY,first[2]=blX,first[3]=blY,first[4]=1),closePath&&first[4]?this.batchQuad(brX,brY,trX,trY,first[0],first[1],first[2],first[3],tintTL,tintTR,tintBL,tintBR):(prev[0]=brX,prev[1]=brY,prev[2]=trX,prev[3]=trY,prev[4]=1))},batchVert:function(x,y,tint){var vertexViewF32=this.vertexViewF32,vertexViewU32=this.vertexViewU32,vertexOffset=this.vertexCount*this.currentShader.vertexComponentCount-1;vertexViewF32[++vertexOffset]=x,vertexViewF32[++vertexOffset]=y,vertexViewU32[++vertexOffset]=tint,this.vertexCount++},batchQuad:function(x0,y0,x1,y1,x2,y2,x3,y3,tintTL,tintTR,tintBL,tintBR){var hasFlushed=!1;return this.shouldFlush(6)&&(this.flush(),hasFlushed=!0),this.batchVert(x0,y0,tintTL),this.batchVert(x1,y1,tintBL),this.batchVert(x2,y2,tintBR),this.batchVert(x0,y0,tintTL),this.batchVert(x2,y2,tintBR),this.batchVert(x3,y3,tintTR),hasFlushed},batchTri:function(x0,y0,x1,y1,x2,y2,tintTL,tintTR,tintBL){var hasFlushed=!1;return this.shouldFlush(3)&&(this.flush(),hasFlushed=!0),this.batchVert(x0,y0,tintTL),this.batchVert(x1,y1,tintTR),this.batchVert(x2,y2,tintBL),hasFlushed},destroy:function(){return WebGLPipeline$6.prototype.destroy.call(this),this.polygonCache=null,this}}),UUID_1=["#define SHADER_NAME PHASER_LIGHT_FS","","precision mediump float;","","struct Light","{","    vec2 position;","    vec3 color;","    float intensity;","    float radius;","};","","const int kMaxLights = %LIGHT_COUNT%;","","uniform vec4 uCamera; /* x, y, rotation, zoom */","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uNormSampler;","uniform vec3 uAmbientLightColor;","uniform Light uLights[kMaxLights];","uniform mat3 uInverseRotationMatrix;","","varying vec2 outTexCoord;","varying vec4 outTint;","","void main()","{","    vec3 finalColor = vec3(0.0, 0.0, 0.0);","    vec4 color = texture2D(uMainSampler, outTexCoord) * vec4(outTint.bgr * outTint.a, outTint.a);","    vec3 normalMap = texture2D(uNormSampler, outTexCoord).rgb;","    vec3 normal = normalize(uInverseRotationMatrix * vec3(normalMap * 2.0 - 1.0));","    vec2 res = vec2(min(uResolution.x, uResolution.y)) * uCamera.w;","","    for (int index = 0; index < kMaxLights; ++index)","    {","        Light light = uLights[index];","        vec3 lightDir = vec3((light.position.xy / res) - (gl_FragCoord.xy / res), 0.1);","        vec3 lightNormal = normalize(lightDir);","        float distToSurf = length(lightDir) * uCamera.w;","        float diffuseFactor = max(dot(normal, lightNormal), 0.0);","        float radius = (light.radius / res.x * uCamera.w) * uCamera.w;","        float attenuation = clamp(1.0 - distToSurf * distToSurf / (radius * radius), 0.0, 1.0);","        vec3 diffuse = light.color * diffuseFactor;","        finalColor += (attenuation * diffuse) * light.intensity;","    }","","    vec4 colorOutput = vec4(uAmbientLightColor + finalColor, 1.0);","","    gl_FragColor = color * vec4(colorOutput.rgb * colorOutput.a, colorOutput.a);","}",""].join("\n"),Engine_1=["#define SHADER_NAME PHASER_MULTI_FS","","precision mediump float;","","uniform sampler2D uMainSampler[%count%];","","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","","void main ()","{","    vec4 texture;","","    %forloop%","","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","","    //  Multiply texture tint","    vec4 color = texture * texel;","","    if (outTintEffect == 1.0)","    {","        //  Solid color + texture alpha","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        //  Solid color, no texture","        color = texel;","    }","","    gl_FragColor = color;","}",""].join("\n"),HexagonalWorldToTileXY_1=["#define SHADER_NAME PHASER_MULTI_VS","","precision mediump float;","","uniform mat4 uProjectionMatrix;","","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","","    outTexCoord = inTexCoord;","    outTexId = inTexId;","    outTint = inTint;","    outTintEffect = inTintEffect;","}",""].join("\n"),Earcut$5=AtlasJSONFile_1,GetFastValue$19=GetFastValue_1,ShaderSourceFS$2=Engine_1,ShaderSourceVS$2=HexagonalWorldToTileXY_1,TransformMatrix$b=TransformMatrix,Utils$n=GetProps_1,WEBGL_CONST$1=FindTile_1,WebGLPipeline$5=FilterTiles_1,CreateGroupLayer_1=new Class_1({Extends:WebGLPipeline$5,initialize:function(config){var renderer=config.game.renderer,fragmentShaderSource=GetFastValue$19(config,"fragShader",ShaderSourceFS$2);config.fragShader=Utils$n.parseFragmentShaderMaxTextures(fragmentShaderSource,renderer.maxTextures),config.vertShader=GetFastValue$19(config,"vertShader",ShaderSourceVS$2),config.attributes=GetFastValue$19(config,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:WEBGL_CONST$1.UNSIGNED_BYTE,normalized:!0}]),WebGLPipeline$5.call(this,config),this._tempMatrix1=new TransformMatrix$b,this._tempMatrix2=new TransformMatrix$b,this._tempMatrix3=new TransformMatrix$b,this.calcMatrix=new TransformMatrix$b,this.tempTriangle=[{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0}],this.strokeTint={TL:0,TR:0,BL:0,BR:0},this.fillTint={TL:0,TR:0,BL:0,BR:0},this.currentFrame={u0:0,v0:0,u1:1,v1:1},this.firstQuad=[0,0,0,0,0],this.prevQuad=[0,0,0,0,0],this.polygonCache=[]},boot:function(){WebGLPipeline$5.prototype.boot.call(this),this.currentShader.set1iv("uMainSampler",this.renderer.textureIndexes)},batchSprite:function(gameObject,tintBL,ty0){this.manager.set(this,gameObject);var tx1=this._tempMatrix1,ty1=this._tempMatrix2,getTint=this._tempMatrix3,unit=gameObject.frame,texture=unit.glTexture,u0=unit.u0,v0=unit.v0,u1=unit.u1,v1=unit.v1,frameX=unit.x,tx0=unit.y,tx2=unit.cutWidth,ty2=unit.cutHeight,tintBR=unit.customPivot,displayOriginX=gameObject.displayOriginX,ty3=gameObject.displayOriginY,tx3=-displayOriginX+frameX,tintTL=-ty3+tx0;gameObject.isCropped&&((tintTR=gameObject._crop).flipX===gameObject.flipX&&tintTR.flipY===gameObject.flipY||unit.updateCropUVs(tintTR,gameObject.flipX,gameObject.flipY),u0=tintTR.u0,v0=tintTR.v0,u1=tintTR.u1,v1=tintTR.v1,tx2=tintTR.width,ty2=tintTR.height,tx3=-displayOriginX+tintTR.x,tintTL=-ty3+(tx0=tintTR.y));var tintTR=1,tx0=1;gameObject.flipX&&(tintBR||(tx3+=-unit.realWidth+2*displayOriginX),tintTR=-1),(gameObject.flipY||unit.source.isGLTexture&&!texture.flipY)&&(tintBR||(tintTL+=-unit.realHeight+2*ty3),tx0=-1),ty1.applyITRS(gameObject.x,gameObject.y,gameObject.rotation,gameObject.scaleX*tintTR,gameObject.scaleY*tx0),tx1.copyFrom(tintBL.matrix),ty0?(tx1.multiplyWithOffset(ty0,-tintBL.scrollX*gameObject.scrollFactorX,-tintBL.scrollY*gameObject.scrollFactorY),ty1.e=gameObject.x,ty1.f=gameObject.y):(ty1.e-=tintBL.scrollX*gameObject.scrollFactorX,ty1.f-=tintBL.scrollY*gameObject.scrollFactorY),tx1.multiply(ty1,getTint);tintBR=tx3+tx2,ty3=tintTL+ty2,tintTR=tintBL.roundPixels,tx0=getTint.getXRound(tx3,tintTL,tintTR),ty0=getTint.getYRound(tx3,tintTL,tintTR),tx1=getTint.getXRound(tx3,ty3,tintTR),ty1=getTint.getYRound(tx3,ty3,tintTR),tx2=getTint.getXRound(tintBR,ty3,tintTR),ty2=getTint.getYRound(tintBR,ty3,tintTR),tx3=getTint.getXRound(tintBR,tintTL,tintTR),ty3=getTint.getYRound(tintBR,tintTL,tintTR),getTint=Utils$n.getTintAppendFloatAlpha,tintBR=tintBL.alpha,tintTL=getTint(gameObject.tintTopLeft,tintBR*gameObject._alphaTL),tintTR=getTint(gameObject.tintTopRight,tintBR*gameObject._alphaTR),tintBL=getTint(gameObject.tintBottomLeft,tintBR*gameObject._alphaBL),tintBR=getTint(gameObject.tintBottomRight,tintBR*gameObject._alphaBR);this.shouldFlush(6)&&this.flush();unit=this.setGameObject(gameObject,unit);this.manager.preBatch(gameObject),this.batchQuad(gameObject,tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintBR,gameObject.tintFill,texture,unit),this.manager.postBatch(gameObject)},batchTexture:function(gameObject,texture,textureWidth,textureHeight,srcX,ty3,srcWidth,srcHeight,scaleX,scaleY,rotation,flipX,flipY,tx0,ty0,displayOriginX,displayOriginY,frameX,frameY,frameWidth,frameHeight,tintTL,tintTR,tintBL,tintBR,tintEffect,uOffset,vOffset,tx2,parentTransformMatrix,skipFlip,textureUnit){this.manager.set(this,gameObject);var crop,cropWidth,cropHeight,ox,oy,tx1=this._tempMatrix1,ty1=this._tempMatrix2,calcMatrix=this._tempMatrix3,u0=frameX/textureWidth+uOffset,v0=frameY/textureHeight+vOffset,u1=(frameX+frameWidth)/textureWidth+uOffset,v1=(frameY+frameHeight)/textureHeight+vOffset,xw=srcWidth,tx3=srcHeight,ty2=-displayOriginX,y=-displayOriginY;gameObject.isCropped&&(cropWidth=(crop=gameObject._crop).width,cropHeight=crop.height,ox=frameX=crop.x,oy=frameY=crop.y,u0=(ox=flipX?frameWidth-crop.x-cropWidth:ox)/textureWidth+uOffset,v0=(oy=flipY?frameHeight-crop.y-cropHeight:oy)/textureHeight+vOffset,u1=(ox+(srcWidth=xw=cropWidth))/textureWidth+uOffset,v1=(oy+(srcHeight=tx3=cropHeight))/textureHeight+vOffset,ty2=-displayOriginX+frameX,y=-displayOriginY+frameY),flipX&&(xw*=-1,ty2+=srcWidth),(flipY^=!skipFlip&&texture.isRenderTexture?1:0)&&(tx3*=-1,y+=srcHeight);xw=ty2+xw,tx3=y+tx3;ty1.applyITRS(srcX,ty3,rotation,scaleX,scaleY),tx1.copyFrom(tx2.matrix),parentTransformMatrix?(tx1.multiplyWithOffset(parentTransformMatrix,-tx2.scrollX*tx0,-tx2.scrollY*ty0),ty1.e=srcX,ty1.f=ty3):(ty1.e-=tx2.scrollX*tx0,ty1.f-=tx2.scrollY*ty0),tx1.multiply(ty1,calcMatrix);ty3=tx2.roundPixels,tx0=calcMatrix.getXRound(ty2,y,ty3),ty0=calcMatrix.getYRound(ty2,y,ty3),tx1=calcMatrix.getXRound(ty2,tx3,ty3),ty1=calcMatrix.getYRound(ty2,tx3,ty3),tx2=calcMatrix.getXRound(xw,tx3,ty3),ty2=calcMatrix.getYRound(xw,tx3,ty3),tx3=calcMatrix.getXRound(xw,y,ty3),ty3=calcMatrix.getYRound(xw,y,ty3);void 0===textureUnit&&(textureUnit=this.renderer.setTexture2D(texture)),gameObject&&this.manager.preBatch(gameObject),this.batchQuad(gameObject,tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintBR,tintEffect,texture,textureUnit),gameObject&&this.manager.postBatch(gameObject)},batchTextureFrame:function(frame,ty2,unit,tint,alpha,tx1,ty1){this.manager.set(this);var tx2=this._tempMatrix1.copyFrom(tx1),calcMatrix=this._tempMatrix2,ty3=ty2+frame.width,tx3=unit+frame.height;ty1?tx2.multiply(ty1,calcMatrix):calcMatrix=tx2;var tx0=calcMatrix.getX(ty2,unit),ty0=calcMatrix.getY(ty2,unit),tx1=calcMatrix.getX(ty2,tx3),ty1=calcMatrix.getY(ty2,tx3),tx2=calcMatrix.getX(ty3,tx3),ty2=calcMatrix.getY(ty3,tx3),tx3=calcMatrix.getX(ty3,unit),ty3=calcMatrix.getY(ty3,unit),unit=this.renderer.setTextureSource(frame.source);tint=Utils$n.getTintAppendFloatAlpha(tint,alpha),this.batchQuad(null,tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,frame.u0,frame.v0,frame.u1,frame.v1,tint,tint,tint,tint,0,frame.glTexture,unit)},batchFillRect:function(y2,tint,y1,x2,x1,y0){this.renderer.pipelines.set(this);var calcMatrix=this.calcMatrix;y0&&y0.multiply(x1,calcMatrix);var y3=y2+y1,x3=tint+x2,x0=calcMatrix.getX(y2,tint),y0=calcMatrix.getY(y2,tint),x1=calcMatrix.getX(y2,x3),y1=calcMatrix.getY(y2,x3),x2=calcMatrix.getX(y3,x3),y2=calcMatrix.getY(y3,x3),x3=calcMatrix.getX(y3,tint),y3=calcMatrix.getY(y3,tint),tint=this.fillTint;this.batchQuad(null,x0,y0,x1,y1,x2,y2,x3,y3,0,0,1,1,tint.TL,tint.TR,tint.BL,tint.BR,2)},batchFillTriangle:function(ty0,tx1,ty1,tx2,ty2,tint,tx0,parentMatrix){this.renderer.pipelines.set(this);var calcMatrix=this.calcMatrix;parentMatrix&&parentMatrix.multiply(tx0,calcMatrix);tx0=calcMatrix.getX(ty0,tx1),ty0=calcMatrix.getY(ty0,tx1),tx1=calcMatrix.getX(ty1,tx2),ty1=calcMatrix.getY(ty1,tx2),tx2=calcMatrix.getX(ty2,tint),ty2=calcMatrix.getY(ty2,tint),tint=this.fillTint;this.batchTri(null,tx0,ty0,tx1,ty1,tx2,ty2,0,0,1,1,tint.TL,tint.TR,tint.BL,2)},batchStrokeTriangle:function(x0,y0,x1,y1,x2,y2,lineWidth,currentMatrix,parentMatrix){var tempTriangle=this.tempTriangle;tempTriangle[0].x=x0,tempTriangle[0].y=y0,tempTriangle[0].width=lineWidth,tempTriangle[1].x=x1,tempTriangle[1].y=y1,tempTriangle[1].width=lineWidth,tempTriangle[2].x=x2,tempTriangle[2].y=y2,tempTriangle[2].width=lineWidth,tempTriangle[3].x=x0,tempTriangle[3].y=y0,tempTriangle[3].width=lineWidth,this.batchStrokePath(tempTriangle,lineWidth,!1,currentMatrix,parentMatrix)},batchFillPath:function(path,currentMatrix,parentMatrix){this.renderer.pipelines.set(this);var calcMatrix=this.calcMatrix;parentMatrix&&parentMatrix.multiply(currentMatrix,calcMatrix);for(var point,length=path.length,polygonCache=this.polygonCache,tintTL=this.fillTint.TL,tintTR=this.fillTint.TR,tintBL=this.fillTint.BL,pathIndex=0;pathIndex<length;++pathIndex)point=path[pathIndex],polygonCache.push(point.x,point.y);for(var polygonIndexArray,length=(polygonIndexArray=Earcut$5(polygonCache)).length,index=0;index<length;index+=3){var x2=2*polygonIndexArray[index+0],ty2=2*polygonIndexArray[index+1],tx0=2*polygonIndexArray[index+2],ty0=polygonCache[0+x2],tx1=polygonCache[1+x2],ty1=polygonCache[0+ty2],tx2=polygonCache[1+ty2],x2=polygonCache[0+tx0],ty2=polygonCache[1+tx0],tx0=calcMatrix.getX(ty0,tx1),ty0=calcMatrix.getY(ty0,tx1),tx1=calcMatrix.getX(ty1,tx2),ty1=calcMatrix.getY(ty1,tx2),tx2=calcMatrix.getX(x2,ty2),ty2=calcMatrix.getY(x2,ty2);this.batchTri(null,tx0,ty0,tx1,ty1,tx2,ty2,0,0,1,1,tintTL,tintTR,tintBL,2)}polygonCache.length=0},batchStrokePath:function(path,lineWidth,pathOpen,currentMatrix,parentMatrix){this.renderer.pipelines.set(this),this.prevQuad[4]=0,this.firstQuad[4]=0;for(var pathLength=path.length-1,pathIndex=0;pathIndex<pathLength;pathIndex++){var point0=path[pathIndex],point1=path[pathIndex+1];this.batchLine(point0.x,point0.y,point1.x,point1.y,point0.width/2,point1.width/2,lineWidth,pathIndex,!pathOpen&&pathIndex===pathLength-1,currentMatrix,parentMatrix)}},batchLine:function(brX,blX,prev,tintBL,trY,tlX,first,index,closePath,tintTL,blY){this.renderer.pipelines.set(this);var tintTR=this.calcMatrix;blY&&blY.multiply(tintTL,tintTR);var tintBR=prev-brX,trX=tintBL-blX,tlY=Math.sqrt(tintBR*tintBR+trX*trX),brY=trY*(tintBL-blX)/tlY,blY=trY*(brX-prev)/tlY,tintTL=tlX*(tintBL-blX)/tlY,tintBR=tlX*(brX-prev)/tlY,trX=prev-tintTL,trY=tintBL-tintBR,tlX=brX-brY,tlY=blX-blY,prev=prev+tintTL,tintTL=tintBL+tintBR,tintBL=brX+brY,tintBR=blX+blY,brX=tintTR.getX(trX,trY),brY=tintTR.getY(trX,trY),blX=tintTR.getX(tlX,tlY),blY=tintTR.getY(tlX,tlY),trX=tintTR.getX(prev,tintTL),trY=tintTR.getY(prev,tintTL),tlX=tintTR.getX(tintBL,tintBR),tlY=tintTR.getY(tintBL,tintBR),prev=this.strokeTint,tintTL=prev.TL,tintTR=prev.TR,tintBL=prev.BL,tintBR=prev.BR;this.batchQuad(null,tlX,tlY,blX,blY,brX,brY,trX,trY,0,0,1,1,tintTL,tintTR,tintBL,tintBR,2),first<=2||(prev=this.prevQuad,first=this.firstQuad,0<index&&prev[4]?this.batchQuad(null,tlX,tlY,blX,blY,prev[0],prev[1],prev[2],prev[3],0,0,1,1,tintTL,tintTR,tintBL,tintBR,2):(first[0]=tlX,first[1]=tlY,first[2]=blX,first[3]=blY,first[4]=1),closePath&&first[4]?this.batchQuad(null,brX,brY,trX,trY,first[0],first[1],first[2],first[3],0,0,1,1,tintTL,tintTR,tintBL,tintBR,2):(prev[0]=brX,prev[1]=brY,prev[2]=trX,prev[3]=trY,prev[4]=1))}}),HexagonalCullBounds_1=Class_1,GetFastValue$18=GetFastValue_1,LightShaderSourceFS=UUID_1,MultiPipeline$3=CreateGroupLayer_1,WebGLPipeline$4=FilterTiles_1,LIGHT_COUNT=10,tempVec2=new BuildTilesetIndex_1,components=new HexagonalCullBounds_1({Extends:MultiPipeline$3,initialize:function(config){LIGHT_COUNT=config.game.renderer.config.maxLights;for(var fragShader=GetFastValue$18(config,"fragShader",LightShaderSourceFS),shaders=[],i=1;i<=LIGHT_COUNT;i++)shaders.push({name:"lights"+i,fragShader:fragShader.replace("%LIGHT_COUNT%",i.toString())});config.shaders=shaders,MultiPipeline$3.call(this,config),this.inverseRotationMatrix=new Float32Array([1,0,0,0,1,0,0,0,1]),this.defaultNormalMap,this.lightsActive=!0},boot:function(){WebGLPipeline$4.prototype.boot.call(this);var gl=this.gl,tempTexture=gl.createTexture();gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,tempTexture),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,new Uint8Array([127,127,255,255])),this.defaultNormalMap={glTexture:tempTexture};for(var i=0;i<this.shaders.length;i++)this["lightShader"+(i+1)]=this.shaders[i]},onRender:function(lightManager,camera){lightManager=lightManager.sys.lights;if(this.lightsActive=!1,lightManager&&lightManager.active){var i,lights=lightManager.getLights(camera),lightsCount=lights.length;if(0!==lightsCount){this.lightsActive=!0,this.setShader(this["lightShader"+lightsCount],!0);var height=this.renderer.height,cameraMatrix=camera.matrix;for(this.set1i("uMainSampler",0),this.set1i("uNormSampler",1),this.set2f("uResolution",this.width/2,this.height/2),this.set4f("uCamera",camera.x,camera.y,camera.rotation,camera.zoom),this.set3f("uAmbientLightColor",lightManager.ambientColor.r,lightManager.ambientColor.g,lightManager.ambientColor.b),i=0;i<lightsCount;i++){var light=lights[i].light,color=light.color,lightName="uLights["+i+"].";cameraMatrix.transformPoint(light.x,light.y,tempVec2),this.set2f(lightName+"position",tempVec2.x-camera.scrollX*light.scrollFactorX*camera.zoom,height-(tempVec2.y-camera.scrollY*light.scrollFactorY*camera.zoom)),this.set3f(lightName+"color",color.r,color.g,color.b),this.set1f(lightName+"intensity",light.intensity),this.set1f(lightName+"radius",light.radius)}this.currentNormalMapRotation=null}}},setNormalMapRotation:function(rotation){var inverseRotationMatrix,c,s;rotation===this.currentNormalMapRotation&&0!==this.vertexCount||(0<this.vertexCount&&this.flush(),inverseRotationMatrix=this.inverseRotationMatrix,rotation?(s=-rotation,c=Math.cos(s),s=Math.sin(s),inverseRotationMatrix[1]=s,inverseRotationMatrix[3]=-s,inverseRotationMatrix[0]=inverseRotationMatrix[4]=c):(inverseRotationMatrix[0]=inverseRotationMatrix[4]=1,inverseRotationMatrix[1]=inverseRotationMatrix[3]=0),this.setMatrix3fv("uInverseRotationMatrix",!1,inverseRotationMatrix),this.currentNormalMapRotation=rotation)},setTexture2D:function(texture,rotation){var renderer=this.renderer;void 0===texture&&(texture=renderer.tempTextures[0]);var normalTexture=this.getNormalMap(rotation);renderer.isNewNormalMap(texture,normalTexture)&&(this.flush(),renderer.setTextureZero(texture),renderer.setNormalMap(normalTexture));rotation=rotation?rotation.rotation:0;return this.setNormalMapRotation(rotation),this.currentUnit=0},setGameObject:function(gameObject,normalTexture){void 0===normalTexture&&(normalTexture=gameObject.frame);var renderer=this.renderer,texture=normalTexture.glTexture,normalTexture=this.getNormalMap(gameObject);return renderer.isNewNormalMap()&&(this.flush(),renderer.setTextureZero(texture),renderer.setNormalMap(normalTexture)),this.setNormalMapRotation(gameObject.rotation),this.currentUnit=0},getNormalMap:function(gameObject){var normalTexture;return gameObject?gameObject.displayTexture?normalTexture=gameObject.displayTexture.dataSource[gameObject.displayFrame.sourceIndex]:gameObject.texture?normalTexture=gameObject.texture.dataSource[gameObject.frame.sourceIndex]:gameObject.tileset&&(normalTexture=(Array.isArray(gameObject.tileset)?gameObject.tileset[0]:gameObject.tileset).image.dataSource[0]):normalTexture=this.defaultNormalMap,(normalTexture=normalTexture||this.defaultNormalMap).glTexture},batchSprite:function(gameObject,camera,parentTransformMatrix){this.lightsActive&&MultiPipeline$3.prototype.batchSprite.call(this,gameObject,camera,parentTransformMatrix)},batchTexture:function(gameObject,texture,textureWidth,textureHeight,srcX,srcY,srcWidth,srcHeight,scaleX,scaleY,rotation,flipX,flipY,scrollFactorX,scrollFactorY,displayOriginX,displayOriginY,frameX,frameY,frameWidth,frameHeight,tintTL,tintTR,tintBL,tintBR,tintEffect,uOffset,vOffset,camera,parentTransformMatrix,skipFlip,textureUnit){this.lightsActive&&MultiPipeline$3.prototype.batchTexture.call(this,gameObject,texture,textureWidth,textureHeight,srcX,srcY,srcWidth,srcHeight,scaleX,scaleY,rotation,flipX,flipY,scrollFactorX,scrollFactorY,displayOriginX,displayOriginY,frameX,frameY,frameWidth,frameHeight,tintTL,tintTR,tintBL,tintBR,tintEffect,uOffset,vOffset,camera,parentTransformMatrix,skipFlip,textureUnit)},batchTextureFrame:function(frame,x,y,tint,alpha,transformMatrix,parentTransformMatrix){this.lightsActive&&MultiPipeline$3.prototype.batchTextureFrame.call(this,frame,x,y,tint,alpha,transformMatrix,parentTransformMatrix)}});components.LIGHT_COUNT=LIGHT_COUNT;var Copy_1=components,TimelineBuilder_1=["#define SHADER_NAME PHASER_POINTLIGHT_FS","","precision mediump float;","","uniform vec2 uResolution;","uniform float uCameraZoom;","","varying vec4 lightPosition;","varying vec4 lightColor;","varying float lightRadius;","varying float lightAttenuation;","","void main ()","{","    vec2 center = (lightPosition.xy + 1.0) * (uResolution.xy * 0.5);","","    float distToSurf = length(center - gl_FragCoord.xy);","","    float radius = 1.0 - distToSurf / (lightRadius * uCameraZoom);","","    float intensity = smoothstep(0.0, 1.0, radius * lightAttenuation);","","    vec4 color = vec4(intensity, intensity, intensity, 0.0) * lightColor;","","    gl_FragColor = vec4(color.rgb * lightColor.a, color.a);","}",""].join("\n"),GetCullTilesFunction_1=["#define SHADER_NAME PHASER_POINTLIGHT_VS","","precision mediump float;","","uniform mat4 uProjectionMatrix;","","attribute vec2 inPosition;","attribute vec2 inLightPosition;","attribute vec4 inLightColor;","attribute float inLightRadius;","attribute float inLightAttenuation;","","varying vec4 lightPosition;","varying vec4 lightColor;","varying float lightRadius;","varying float lightAttenuation;","","void main ()","{","    lightColor = inLightColor;","    lightRadius = inLightRadius;","    lightAttenuation = inLightAttenuation;","    lightPosition = uProjectionMatrix * vec4(inLightPosition, 1.0, 1.0);","","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","}",""].join("\n"),GetFastValue$17=GetFastValue_1,PointLightShaderSourceFS=TimelineBuilder_1,PointLightShaderSourceVS=GetCullTilesFunction_1,WebGLPipeline$3=FilterTiles_1,CreateFromTiles_1=new Class_1({Extends:WebGLPipeline$3,initialize:function(config){config.vertShader=GetFastValue$17(config,"vertShader",PointLightShaderSourceVS),config.fragShader=GetFastValue$17(config,"fragShader",PointLightShaderSourceFS),config.attributes=GetFastValue$17(config,"attributes",[{name:"inPosition",size:2},{name:"inLightPosition",size:2},{name:"inLightRadius"},{name:"inLightAttenuation"},{name:"inLightColor",size:4}]),WebGLPipeline$3.call(this,config)},onRender:function(scene,camera){this.set2f("uResolution",this.width,this.height),this.set1f("uCameraZoom",camera.zoom)},batchPointLight:function(a,camera,x0,y0,x1,y1,x2,y2,x3,y3,lightX,lightY){var color=a.color,b=a.intensity,radius=a.radius,attenuation=a.attenuation,r=color.r*b,g=color.g*b,b=color.b*b,a=camera.alpha*a.alpha;this.shouldFlush(6)&&this.flush(),this.batchLightVert(x0,y0,lightX,lightY,radius,attenuation,r,g,b,a),this.batchLightVert(x1,y1,lightX,lightY,radius,attenuation,r,g,b,a),this.batchLightVert(x2,y2,lightX,lightY,radius,attenuation,r,g,b,a),this.batchLightVert(x0,y0,lightX,lightY,radius,attenuation,r,g,b,a),this.batchLightVert(x2,y2,lightX,lightY,radius,attenuation,r,g,b,a),this.batchLightVert(x3,y3,lightX,lightY,radius,attenuation,r,g,b,a)},batchLightVert:function(x,y,lightX,lightY,radius,attenuation,r,g,b,a){var vertexViewF32=this.vertexViewF32,vertexOffset=this.vertexCount*this.currentShader.vertexComponentCount-1;vertexViewF32[++vertexOffset]=x,vertexViewF32[++vertexOffset]=y,vertexViewF32[++vertexOffset]=lightX,vertexViewF32[++vertexOffset]=lightY,vertexViewF32[++vertexOffset]=radius,vertexViewF32[++vertexOffset]=attenuation,vertexViewF32[++vertexOffset]=r,vertexViewF32[++vertexOffset]=g,vertexViewF32[++vertexOffset]=b,vertexViewF32[++vertexOffset]=a,this.vertexCount++}}),GetFastValue$16=GetFastValue_1,MultiPipeline$2=CreateGroupLayer_1,CullBounds_1=new Class_1({Extends:MultiPipeline$2,initialize:function(config){config.topology=5,config.batchSize=GetFastValue$16(config,"batchSize",256),MultiPipeline$2.call(this,config)}}),ForEachTile_1=["#define SHADER_NAME PHASER_SINGLE_FS","","precision mediump float;","","uniform sampler2D uMainSampler;","","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","","    //  Multiply texture tint","    vec4 color = texture * texel;","","    if (outTintEffect == 1.0)","    {","        //  Solid color + texture alpha","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        //  Solid color, no texture","        color = texel;","    }","","    gl_FragColor = color;","}",""].join("\n"),Blitter_1=["#define SHADER_NAME PHASER_SINGLE_VS","","precision mediump float;","","uniform mat4 uProjectionMatrix;","","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}",""].join("\n"),GetFastValue$15=GetFastValue_1,MultiPipeline$1=CreateGroupLayer_1,ShaderSourceFS$1=ForEachTile_1,ShaderSourceVS$1=Blitter_1,WebGLPipeline$2=FilterTiles_1,ParseImageLayers_1=new Class_1({Extends:MultiPipeline$1,initialize:function(config){config.fragShader=GetFastValue$15(config,"fragShader",ShaderSourceFS$1),config.vertShader=GetFastValue$15(config,"vertShader",ShaderSourceVS$1),config.forceZero=!0,MultiPipeline$1.call(this,config)},boot:function(){WebGLPipeline$2.prototype.boot.call(this),this.set1i("uMainSampler",0)}}),Bob_1=["#define SHADER_NAME PHASER_ADD_BLEND_FS","","precision mediump float;","","uniform sampler2D uMainSampler1;","uniform sampler2D uMainSampler2;","uniform float uStrength;","","varying vec2 outTexCoord;","","void main ()","{","    vec4 frame1 = texture2D(uMainSampler1, outTexCoord);","    vec4 frame2 = texture2D(uMainSampler2, outTexCoord);","","    gl_FragColor = frame1 + frame2 * uStrength;","}",""].join("\n"),structs=new Class_1({initialize:function(){this._matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.alpha=1,this._dirty=!0,this._data},set:function(value){return this._matrix=value,this._dirty=!0,this},reset:function(){var m=this._matrix;return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=0,m[6]=1,m[7]=0,m[8]=0,m[9]=0,m[10]=0,m[11]=0,m[12]=1,m[13]=0,m[14]=0,m[15]=0,m[16]=0,m[17]=0,m[18]=1,m[19]=0,this._dirty=!0,this},getData:function(){var f32;return this._dirty&&((f32=new Float32Array(this._matrix))[4]/=255,f32[9]/=255,f32[14]/=255,f32[19]/=255,this._data=f32,this._dirty=!1),this._data},brightness:function(b,multiply){b=void 0===b?0:b;return this.multiply([b,0,0,0,0,0,b,0,0,0,0,0,b,0,0,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},saturate:function(y,multiply){var x=2*(y=void 0===y?0:y)/3+1,y=-.5*(x-1);return this.multiply([x,y,y,0,0,y,x,y,0,0,y,y,x,0,0,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},desaturate:function(multiply){return this.saturate(-1,multiply=void 0===multiply?!1:multiply)},hue:function(sin,multiply){void 0===multiply&&(multiply=!1),sin=(sin=void 0===sin?0:sin)/180*Math.PI;var cos=Math.cos(sin),sin=Math.sin(sin);return this.multiply([.213+.787*cos+-.213*sin,.715+-.715*cos+-.715*sin,.072+-.072*cos+.928*sin,0,0,.213+-.213*cos+.143*sin,.715+cos*(1-.715)+.14*sin,.072+-.072*cos+-.283*sin,0,0,.213+-.213*cos+-.787*sin,.715+-.715*cos+.715*sin,.072+.928*cos+.072*sin,0,0,0,0,0,1,0],multiply)},grayscale:function(value,multiply){return this.saturate(-(value=void 0===value?1:value),multiply=void 0===multiply?!1:multiply)},blackWhite:function(multiply){return this.multiply([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},contrast:function(o,multiply){var v=(o=void 0===o?0:o)+1,o=-.5*(v-1);return this.multiply([v,0,0,0,o,0,v,0,0,o,0,0,v,0,o,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},negative:function(multiply){return this.multiply([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},desaturateLuminance:function(multiply){return this.multiply([.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},sepia:function(multiply){return this.multiply([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},night:function(intensity,multiply){return this.multiply([-2*(intensity=void 0===intensity?.1:intensity),-intensity,0,0,0,-intensity,0,intensity,0,0,0,intensity,2*intensity,0,0,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},lsd:function(multiply){return this.multiply([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},brown:function(multiply){return this.multiply([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},vintagePinhole:function(multiply){return this.multiply([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},kodachrome:function(multiply){return this.multiply([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},technicolor:function(multiply){return this.multiply([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},polaroid:function(multiply){return this.multiply([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},shiftToBGR:function(multiply){return this.multiply([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],multiply=void 0===multiply?!1:multiply)},multiply:function(a,multiply){multiply||this.reset();for(var m=this._matrix,c=[],i=0;i<20;i++)c[i]=m[i];return m[0]=c[0]*a[0]+c[1]*a[5]+c[2]*a[10]+c[3]*a[15],m[1]=c[0]*a[1]+c[1]*a[6]+c[2]*a[11]+c[3]*a[16],m[2]=c[0]*a[2]+c[1]*a[7]+c[2]*a[12]+c[3]*a[17],m[3]=c[0]*a[3]+c[1]*a[8]+c[2]*a[13]+c[3]*a[18],m[4]=c[0]*a[4]+c[1]*a[9]+c[2]*a[14]+c[3]*a[19]+c[4],m[5]=c[5]*a[0]+c[6]*a[5]+c[7]*a[10]+c[8]*a[15],m[6]=c[5]*a[1]+c[6]*a[6]+c[7]*a[11]+c[8]*a[16],m[7]=c[5]*a[2]+c[6]*a[7]+c[7]*a[12]+c[8]*a[17],m[8]=c[5]*a[3]+c[6]*a[8]+c[7]*a[13]+c[8]*a[18],m[9]=c[5]*a[4]+c[6]*a[9]+c[7]*a[14]+c[8]*a[19]+c[9],m[10]=c[10]*a[0]+c[11]*a[5]+c[12]*a[10]+c[13]*a[15],m[11]=c[10]*a[1]+c[11]*a[6]+c[12]*a[11]+c[13]*a[16],m[12]=c[10]*a[2]+c[11]*a[7]+c[12]*a[12]+c[13]*a[17],m[13]=c[10]*a[3]+c[11]*a[8]+c[12]*a[13]+c[13]*a[18],m[14]=c[10]*a[4]+c[11]*a[9]+c[12]*a[14]+c[13]*a[19]+c[14],m[15]=c[15]*a[0]+c[16]*a[5]+c[17]*a[10]+c[18]*a[15],m[16]=c[15]*a[1]+c[16]*a[6]+c[17]*a[11]+c[18]*a[16],m[17]=c[15]*a[2]+c[16]*a[7]+c[17]*a[12]+c[18]*a[17],m[18]=c[15]*a[3]+c[16]*a[8]+c[17]*a[13]+c[18]*a[18],m[19]=c[15]*a[4]+c[16]*a[9]+c[17]*a[14]+c[18]*a[19]+c[19],this._dirty=!0,this}}),FileTypesManager$1=["#define SHADER_NAME PHASER_COLORMATRIX_FS","","precision mediump float;","","uniform sampler2D uMainSampler;","uniform float uColorMatrix[20];","uniform float uAlpha;","","varying vec2 outTexCoord;","","void main ()","{","    vec4 c = texture2D(uMainSampler, outTexCoord);","","    if (uAlpha == 0.0)","    {","        gl_FragColor = c;","","        return;","    }","","    if (c.a > 0.0)","    {","        c.rgb /= c.a;","    }","","    vec4 result;","","    result.r = (uColorMatrix[0] * c.r) + (uColorMatrix[1] * c.g) + (uColorMatrix[2] * c.b) + (uColorMatrix[3] * c.a) + uColorMatrix[4];","    result.g = (uColorMatrix[5] * c.r) + (uColorMatrix[6] * c.g) + (uColorMatrix[7] * c.b) + (uColorMatrix[8] * c.a) + uColorMatrix[9];","    result.b = (uColorMatrix[10] * c.r) + (uColorMatrix[11] * c.g) + (uColorMatrix[12] * c.b) + (uColorMatrix[13] * c.a) + uColorMatrix[14];","    result.a = (uColorMatrix[15] * c.r) + (uColorMatrix[16] * c.g) + (uColorMatrix[17] * c.b) + (uColorMatrix[18] * c.a) + uColorMatrix[19];","","    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);","","    rgb *= result.a;","","    gl_FragColor = vec4(rgb, result.a);","}",""].join("\n"),input=["#define SHADER_NAME PHASER_COPY_FS","","precision mediump float;","","uniform sampler2D uMainSampler;","uniform float uBrightness;","","varying vec2 outTexCoord;","","void main ()","{","    gl_FragColor = texture2D(uMainSampler, outTexCoord) * uBrightness;","}",""].join("\n"),dom=["#define SHADER_NAME PHASER_LINEAR_BLEND_FS","","precision mediump float;","","uniform sampler2D uMainSampler1;","uniform sampler2D uMainSampler2;","uniform float uStrength;","","varying vec2 outTexCoord;","","void main ()","{","    vec4 frame1 = texture2D(uMainSampler1, outTexCoord);","    vec4 frame2 = texture2D(uMainSampler2, outTexCoord);","","    gl_FragColor = mix(frame1, frame2 * uStrength, 0.5);","}",""].join("\n"),textures=["#define SHADER_NAME PHASER_QUAD_VS","","precision mediump float;","","attribute vec2 inPosition;","attribute vec2 inTexCoord;","","varying vec2 outFragCoord;","varying vec2 outTexCoord;","","void main ()","{","    outFragCoord = inPosition.xy * 0.5 + 0.5;","    outTexCoord = inTexCoord;","","    gl_Position = vec4(inPosition, 0, 1);","}",""].join("\n"),AddBlendFS=Bob_1,BlendModes$5=BlendModes$8,ColorMatrix$1=structs,ColorMatrixFS=FileTypesManager$1,CopyFS=input,GetFastValue$14=GetFastValue_1,LinearBlendFS=dom,QuadVS=textures,WebGLPipeline$1=FilterTiles_1,CullTiles_1=new Class_1({Extends:WebGLPipeline$1,initialize:function(config){config.renderTarget=GetFastValue$14(config,"renderTarget",[{scale:1},{scale:1},{scale:.5},{scale:.5}]),config.vertShader=GetFastValue$14(config,"vertShader",QuadVS),config.shaders=GetFastValue$14(config,"shaders",[{name:"Copy",fragShader:CopyFS},{name:"AddBlend",fragShader:AddBlendFS},{name:"LinearBlend",fragShader:LinearBlendFS},{name:"ColorMatrix",fragShader:ColorMatrixFS}]),config.attributes=GetFastValue$14(config,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2}]),config.vertices=[-1,-1,0,0,-1,1,0,1,1,1,1,1,-1,-1,0,0,1,1,1,1,1,-1,1,0],config.batchSize=1,WebGLPipeline$1.call(this,config),this.colorMatrix=new ColorMatrix$1,this.copyShader,this.addShader,this.linearShader,this.colorMatrixShader,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2},boot:function(){WebGLPipeline$1.prototype.boot.call(this);var shaders=this.shaders,targets=this.renderTargets;this.copyShader=shaders[0],this.addShader=shaders[1],this.linearShader=shaders[2],this.colorMatrixShader=shaders[3],this.fullFrame1=targets[0],this.fullFrame2=targets[1],this.halfFrame1=targets[2],this.halfFrame2=targets[3]},copyFrame:function(source,target,brightness,clear,clearAlpha){void 0===brightness&&(brightness=1),void 0===clear&&(clear=!0),void 0===clearAlpha&&(clearAlpha=!0);var gl=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",brightness),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,source.texture),target?(gl.viewport(0,0,target.width,target.height),gl.bindFramebuffer(gl.FRAMEBUFFER,target.framebuffer),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,target.texture,0)):gl.viewport(0,0,source.width,source.height),clear&&(clearAlpha?gl.clearColor(0,0,0,0):gl.clearColor(0,0,0,1),gl.clear(gl.COLOR_BUFFER_BIT)),gl.bufferData(gl.ARRAY_BUFFER,this.vertexData,gl.STATIC_DRAW),gl.drawArrays(gl.TRIANGLES,0,6),gl.bindFramebuffer(gl.FRAMEBUFFER,null),gl.bindTexture(gl.TEXTURE_2D,null)},blitFrame:function(source,target,diff,clear,clearAlpha,eraseMode){void 0===diff&&(diff=1),void 0===clear&&(clear=!0),void 0===clearAlpha&&(clearAlpha=!0),void 0===eraseMode&&(eraseMode=!1);var blendMode,gl=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",diff),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,source.texture),source.height>target.height?(gl.viewport(0,0,source.width,source.height),this.setTargetUVs(source,target)):(diff=target.height-source.height,gl.viewport(0,diff,source.width,source.height)),gl.bindFramebuffer(gl.FRAMEBUFFER,target.framebuffer),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,target.texture,0),clear&&(clearAlpha?gl.clearColor(0,0,0,0):gl.clearColor(0,0,0,1),gl.clear(gl.COLOR_BUFFER_BIT)),eraseMode&&(blendMode=this.renderer.currentBlendMode,this.renderer.setBlendMode(BlendModes$5.ERASE)),gl.bufferData(gl.ARRAY_BUFFER,this.vertexData,gl.STATIC_DRAW),gl.drawArrays(gl.TRIANGLES,0,6),eraseMode&&this.renderer.setBlendMode(blendMode),gl.bindFramebuffer(gl.FRAMEBUFFER,null),gl.bindTexture(gl.TEXTURE_2D,null),this.resetUVs()},copyFrameRect:function(source,target,x,y,width,height,clear,clearAlpha){void 0===clear&&(clear=!0),void 0===clearAlpha&&(clearAlpha=!0);var gl=this.gl;gl.bindFramebuffer(gl.FRAMEBUFFER,source.framebuffer),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,source.texture,0),clear&&(clearAlpha?gl.clearColor(0,0,0,0):gl.clearColor(0,0,0,1),gl.clear(gl.COLOR_BUFFER_BIT)),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,target.texture),gl.copyTexSubImage2D(gl.TEXTURE_2D,0,0,0,x,y,width,height),gl.bindFramebuffer(gl.FRAMEBUFFER,null),gl.bindTexture(gl.TEXTURE_2D,null)},copyToGame:function(source){var gl=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",1),this.renderer.popFramebuffer(),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,source.texture),gl.bufferData(gl.ARRAY_BUFFER,this.vertexData,gl.STATIC_DRAW),gl.drawArrays(gl.TRIANGLES,0,6),this.renderer.resetTextures()},drawFrame:function(source,target,clearAlpha,colorMatrix){void 0===clearAlpha&&(clearAlpha=!0),void 0===colorMatrix&&(colorMatrix=this.colorMatrix);var gl=this.gl;this.setShader(this.colorMatrixShader),this.set1i("uMainSampler",0),this.set1fv("uColorMatrix",colorMatrix.getData()),this.set1f("uAlpha",colorMatrix.alpha),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,source.texture),target?(gl.viewport(0,0,target.width,target.height),gl.bindFramebuffer(gl.FRAMEBUFFER,target.framebuffer),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,target.texture,0)):gl.viewport(0,0,source.width,source.height),clearAlpha?gl.clearColor(0,0,0,0):gl.clearColor(0,0,0,1),gl.clear(gl.COLOR_BUFFER_BIT),gl.bufferData(gl.ARRAY_BUFFER,this.vertexData,gl.STATIC_DRAW),gl.drawArrays(gl.TRIANGLES,0,6),gl.bindFramebuffer(gl.FRAMEBUFFER,null),gl.bindTexture(gl.TEXTURE_2D,null)},blendFrames:function(source1,source2,target,strength,clearAlpha,blendShader){void 0===strength&&(strength=1),void 0===clearAlpha&&(clearAlpha=!0),void 0===blendShader&&(blendShader=this.linearShader);var gl=this.gl;this.setShader(blendShader),this.set1i("uMainSampler1",0),this.set1i("uMainSampler2",1),this.set1f("uStrength",strength),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,source1.texture),gl.activeTexture(gl.TEXTURE1),gl.bindTexture(gl.TEXTURE_2D,source2.texture),target?(gl.bindFramebuffer(gl.FRAMEBUFFER,target.framebuffer),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,target.texture,0),gl.viewport(0,0,target.width,target.height)):gl.viewport(0,0,source1.width,source1.height),clearAlpha?gl.clearColor(0,0,0,0):gl.clearColor(0,0,0,1),gl.clear(gl.COLOR_BUFFER_BIT),gl.bufferData(gl.ARRAY_BUFFER,this.vertexData,gl.STATIC_DRAW),gl.drawArrays(gl.TRIANGLES,0,6),gl.bindFramebuffer(gl.FRAMEBUFFER,null),gl.bindTexture(gl.TEXTURE_2D,null)},blendFramesAdditive:function(source1,source2,target,strength,clearAlpha){this.blendFrames(source1,source2,target,strength,clearAlpha,this.addShader)},clearFrame:function(target,fbo){void 0===fbo&&(fbo=!0);var gl=this.gl;gl.viewport(0,0,target.width,target.height),gl.bindFramebuffer(gl.FRAMEBUFFER,target.framebuffer),fbo?gl.clearColor(0,0,0,0):gl.clearColor(0,0,0,1),gl.clear(gl.COLOR_BUFFER_BIT);fbo=this.renderer.currentFramebuffer;gl.bindFramebuffer(gl.FRAMEBUFFER,fbo)},setUVs:function(uA,vA,uB,vB,uC,vC,uD,vD){var vertexViewF32=this.vertexViewF32;vertexViewF32[2]=uA,vertexViewF32[3]=vA,vertexViewF32[6]=uB,vertexViewF32[7]=vB,vertexViewF32[10]=uC,vertexViewF32[11]=vC,vertexViewF32[14]=uA,vertexViewF32[15]=vA,vertexViewF32[18]=uC,vertexViewF32[19]=vC,vertexViewF32[22]=uD,vertexViewF32[23]=vD},setTargetUVs:function(diff,target){diff=.5<(diff=target.height/diff.height)?.5-(diff-.5):.5-diff+.5;this.setUVs(0,diff,0,1+diff,1,1+diff,1,diff)},flipX:function(){this.setUVs(1,0,1,1,0,1,0,0)},flipY:function(){this.setUVs(0,1,0,0,1,0,1,1)},resetUVs:function(){this.setUVs(0,0,0,1,1,1,1,0)}}),CONST$17=ParseGID_1,CustomMap=GetTileToWorldYFunction_1,BitmapMaskPipeline=CalculateFacesAt_1,GraphicsPipeline=CheckIsoBounds_1,LightPipeline=Copy_1,MultiPipeline=CreateGroupLayer_1,PointLightPipeline=CreateFromTiles_1,RopePipeline=CullBounds_1,SinglePipeline=ParseImageLayers_1,UtilityPipeline=CullTiles_1,GetTileAt_1=new Class_1({initialize:function(renderer){this.game=renderer.game,this.renderer=renderer,this.classes=new CustomMap([[CONST$17.UTILITY_PIPELINE,UtilityPipeline],[CONST$17.MULTI_PIPELINE,MultiPipeline],[CONST$17.BITMAPMASK_PIPELINE,BitmapMaskPipeline],[CONST$17.SINGLE_PIPELINE,SinglePipeline],[CONST$17.ROPE_PIPELINE,RopePipeline],[CONST$17.LIGHT_PIPELINE,LightPipeline],[CONST$17.POINTLIGHT_PIPELINE,PointLightPipeline],[CONST$17.GRAPHICS_PIPELINE,GraphicsPipeline]]),this.postPipelineClasses=new CustomMap,this.pipelines=new CustomMap,this.current=null,this.previous=null,this.MULTI_PIPELINE=null,this.BITMAPMASK_PIPELINE=null,this.UTILITY_PIPELINE=null,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2},boot:function(pipelineConfig){var pipelineName,_this=this,game=this.game;if(this.classes.each(function(pipelineName,pipeline){instance=_this.add(pipelineName,new pipeline({game:game})),pipelineName===CONST$17.UTILITY_PIPELINE&&(_this.UTILITY_PIPELINE=instance,_this.fullFrame1=instance.fullFrame1,_this.fullFrame2=instance.fullFrame2,_this.halfFrame1=instance.halfFrame1,_this.halfFrame2=instance.halfFrame2)}),this.MULTI_PIPELINE=this.get(CONST$17.MULTI_PIPELINE),this.BITMAPMASK_PIPELINE=this.get(CONST$17.BITMAPMASK_PIPELINE),pipelineConfig)for(pipelineName in pipelineConfig){var instance,pipelineClass=pipelineConfig[pipelineName];(instance=new pipelineClass(game)).isPostFX?this.postPipelineClasses.set(pipelineName,pipelineClass):this.has(pipelineName)||(this.classes.set(pipelineName,pipelineClass),this.add(pipelineName,instance))}},add:function(name,pipeline){if(!pipeline.isPostFX){var pipelines=this.pipelines,renderer=this.renderer;return pipelines.has(name)?console.warn("Pipeline exists: "+name):(pipeline.name=name,pipeline.manager=this,pipelines.set(name,pipeline)),pipeline.hasBooted||pipeline.boot(),0!==renderer.width&&0!==renderer.height&&pipeline.resize(renderer.width,renderer.height),pipeline}console.warn(name+" is a Post Pipeline. Use `addPostPipeline` instead")},addPostPipeline:function(name,pipeline){this.postPipelineClasses.has(name)||this.postPipelineClasses.set(name,pipeline)},flush:function(){this.current&&this.current.flush()},has:function(pipeline){var pipelines=this.pipelines;return"string"==typeof pipeline?pipelines.has(pipeline):!!pipelines.contains(pipeline)},get:function(pipeline){var pipelines=this.pipelines;return"string"==typeof pipeline?pipelines.get(pipeline):pipelines.contains(pipeline)?pipeline:void 0},getPostPipeline:function(pipeline,gameObject){var pipelineClasses=this.postPipelineClasses;if("string"==typeof pipeline?newPipeline=pipelineClasses.get(pipeline):"function"==typeof pipeline?pipelineClasses.contains(pipeline)&&(newPipeline=pipeline):"object"==typeof pipeline&&(newPipeline=pipelineClasses.get(pipeline.name)),newPipeline){var newPipeline=new newPipeline(this.game);return gameObject&&(newPipeline.gameObject=gameObject),newPipeline}},remove:function(name,removeClass,removePostPipelineClass){void 0===removeClass&&(removeClass=!0),void 0===removePostPipelineClass&&(removePostPipelineClass=!0),this.pipelines.delete(name),removeClass&&this.classes.delete(name),removePostPipelineClass&&this.postPipelineClasses.delete(name)},set:function(pipeline,gameObject,currentShader){if(!pipeline.isPostFX)return this.isCurrent(pipeline,currentShader)||(this.flush(),this.current&&this.current.unbind(),(this.current=pipeline).bind(currentShader)),pipeline.updateProjectionMatrix(),pipeline.onBind(gameObject),pipeline},preBatch:function(gameObject){if(gameObject.hasPostPipeline){this.flush();for(var pipelines=gameObject.postPipelines,i=pipelines.length-1;0<=i;i--){var pipeline=pipelines[i];pipeline.active&&pipeline.preBatch(gameObject)}}},postBatch:function(gameObject){if(gameObject.hasPostPipeline){this.flush();for(var pipelines=gameObject.postPipelines,i=0;i<pipelines.length;i++){var pipeline=pipelines[i];pipeline.active&&pipeline.postBatch(gameObject)}}},preBatchCamera:function(camera){if(camera.hasPostPipeline){this.flush();for(var pipelines=camera.postPipelines,i=pipelines.length-1;0<=i;i--){var pipeline=pipelines[i];pipeline.active&&pipeline.preBatch(camera)}}},postBatchCamera:function(camera){if(camera.hasPostPipeline){this.flush();for(var pipelines=camera.postPipelines,i=0;i<pipelines.length;i++){var pipeline=pipelines[i];pipeline.active&&pipeline.postBatch(camera)}}},isCurrent:function(pipeline,currentShader){var renderer=this.renderer,current=this.current;return current&&!currentShader&&(currentShader=current.currentShader),!(current!==pipeline||currentShader.program!==renderer.currentProgram)},copyFrame:function(source,target,brightness,clear,clearAlpha){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyFrame(source,target,brightness,clear,clearAlpha),this},copyToGame:function(source){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyToGame(source),this},drawFrame:function(source,target,clearAlpha,colorMatrix){return this.setUtility(this.UTILITY_PIPELINE.colorMatrixShader).drawFrame(source,target,clearAlpha,colorMatrix),this},blendFrames:function(source1,source2,target,strength,clearAlpha){return this.setUtility(this.UTILITY_PIPELINE.linearShader).blendFrames(source1,source2,target,strength,clearAlpha),this},blendFramesAdditive:function(source1,source2,target,strength,clearAlpha){return this.setUtility(this.UTILITY_PIPELINE.addShader).blendFramesAdditive(source1,source2,target,strength,clearAlpha),this},clearFrame:function(target,clearAlpha){return this.UTILITY_PIPELINE.clearFrame(target,clearAlpha),this},blitFrame:function(source,target,brightness,clear,clearAlpha,eraseMode){return this.setUtility(this.UTILITY_PIPELINE.copyShader).blitFrame(source,target,brightness,clear,clearAlpha,eraseMode),this},copyFrameRect:function(source,target,x,y,width,height,clear,clearAlpha){return this.UTILITY_PIPELINE.copyFrameRect(source,target,x,y,width,height,clear,clearAlpha),this},forceZero:function(){return this.current&&this.current.forceZero},setMulti:function(){return this.set(this.MULTI_PIPELINE)},setUtility:function(currentShader){return this.UTILITY_PIPELINE.bind(currentShader)},rebind:function(pipeline){void 0===pipeline&&this.previous&&(pipeline=this.previous);var renderer=this.renderer,gl=renderer.gl;gl.disable(gl.DEPTH_TEST),gl.disable(gl.CULL_FACE),renderer.hasActiveStencilMask()?gl.clear(gl.DEPTH_BUFFER_BIT):(gl.disable(gl.STENCIL_TEST),gl.clear(gl.DEPTH_BUFFER_BIT|gl.STENCIL_BUFFER_BIT)),gl.viewport(0,0,renderer.width,renderer.height),renderer.currentProgram=null,renderer.setBlendMode(0,!0);var key,entries=this.pipelines.entries;for(key in entries)entries[key].glReset=!0;pipeline&&(this.current=pipeline).rebind(),renderer.resetTextures()},clear:function(){var renderer=this.renderer;this.flush(),this.current?(this.current.unbind(),this.previous=this.current,this.current=null):this.previous=null,renderer.currentProgram=null,renderer.setBlendMode(0,!0)},destroy:function(){this.flush(),this.classes.clear(),this.postPipelineClasses.clear(),this.pipelines.clear(),this.renderer=null,this.game=null,this.classes=null,this.postPipelineClasses=null,this.pipelines=null,this.current=null,this.previous=null}}),CanvasPool$9=SetValue_1,Color$6=Container_1,GetFastValue$13=GetFastValue_1,scene=function(bufferHeight,config){var imageData=bufferHeight.getContext("experimental-webgl"),callback=GetFastValue$13(config,"callback"),type=GetFastValue$13(config,"type","image/png"),encoderOptions=GetFastValue$13(config,"encoder",.92),x=GetFastValue$13(config,"x",0),ctx=GetFastValue$13(config,"y",0),pixel=GetFastValue$13(config,"getPixel",!1),isFramebuffer=GetFastValue$13(config,"isFramebuffer",!1),bufferWidth=isFramebuffer?GetFastValue$13(config,"bufferWidth",1):imageData.drawingBufferWidth,bufferHeight=isFramebuffer?GetFastValue$13(config,"bufferHeight",1):imageData.drawingBufferHeight;if(pixel){pixel=new Uint8Array(4);imageData.readPixels(x,isFramebuffer?ctx:bufferHeight-ctx,1,1,imageData.RGBA,imageData.UNSIGNED_BYTE,pixel),callback.call(null,new Color$6(pixel[0],pixel[1],pixel[2],pixel[3]/255))}else{var width=GetFastValue$13(config,"width",bufferWidth),height=GetFastValue$13(config,"height",bufferHeight),pixels=new Uint8Array(width*height*4);imageData.readPixels(x,bufferHeight-ctx-height,width,height,imageData.RGBA,imageData.UNSIGNED_BYTE,pixels);for(var canvas=CanvasPool$9.createWebGL(this,width,height),ctx=canvas.getContext("2d"),imageData=ctx.getImageData(0,0,width,height),data=imageData.data,py=0;py<height;py++)for(var px=0;px<width;px++){var sourceIndex=4*((height-py-1)*width+px),destIndex=4*(py*width+px);data[0+destIndex]=pixels[0+sourceIndex],data[1+destIndex]=pixels[1+sourceIndex],data[2+destIndex]=pixels[2+sourceIndex],data[3+destIndex]=pixels[3+sourceIndex]}ctx.putImageData(imageData,0,0);var image=new Image;image.onerror=function(){callback.call(null),CanvasPool$9.remove(canvas)},image.onload=function(){callback.call(null,image),CanvasPool$9.remove(canvas)},image.src=canvas.toDataURL(type,encoderOptions)}},ArrayRemove$2=Remove_1,CameraEvents=GetCalcMatrix_1,GetAdvancedValue_1=Class_1,CONST$16=Extend,EventEmitter$o=eventemitter3.exports,Events$C=events,GameEvents$c=ImageFile_1,IsSizePowerOfTwo$2=MatterGameObject_1,Matrix4$3=FloorAll_1,NOOP$m=gameConfig,PipelineManager=GetTileAt_1,RenderTarget$1=Fill_1,ScaleEvents=HexagonalCullTiles_1,TextureEvents$1=TweenData_1,Utils$m=GetProps_1,WebGLSnapshot=scene,WebGLRenderer_1=new GetAdvancedValue_1({Extends:EventEmitter$o,initialize:function(game){EventEmitter$o.call(this);var gameConfig=game.config,contextCreationConfig={alpha:gameConfig.transparent,desynchronized:gameConfig.desynchronized,depth:!1,antialias:gameConfig.antialiasGL,premultipliedAlpha:gameConfig.premultipliedAlpha,stencil:!0,failIfMajorPerformanceCaveat:gameConfig.failIfMajorPerformanceCaveat,powerPreference:gameConfig.powerPreference,preserveDrawingBuffer:gameConfig.preserveDrawingBuffer};this.config={clearBeforeRender:gameConfig.clearBeforeRender,antialias:gameConfig.antialias,backgroundColor:gameConfig.backgroundColor,contextCreation:contextCreationConfig,roundPixels:gameConfig.roundPixels,maxTextures:gameConfig.maxTextures,maxTextureSize:gameConfig.maxTextureSize,batchSize:gameConfig.batchSize,maxLights:gameConfig.maxLights,mipmapFilter:gameConfig.mipmapFilter},this.game=game,this.type=CONST$16.WEBGL,this.pipelines=null,this.width=0,this.height=0,this.canvas=game.canvas,this.blendModes=[],this.contextLost=!1,this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92,isFramebuffer:!1,bufferWidth:0,bufferHeight:0},this.currentActiveTexture=0,this.startActiveTexture=0,this.maxTextures=0,this.textureIndexes,this.tempTextures,this.textureZero,this.normalTexture,this.currentFramebuffer=null,this.fboStack=[],this.currentProgram=null,this.currentBlendMode=1/0,this.currentScissorEnabled=!1,this.currentScissor=null,this.scissorStack=[],this.contextLostHandler=NOOP$m,this.contextRestoredHandler=NOOP$m,this.gl=null,this.supportedExtensions=null,this.instancedArraysExtension=null,this.vaoExtension=null,this.extensions={},this.glFormats=[],this.compression={ETC1:!1,PVRTC:!1,S3TC:!1},this.drawingBufferHeight=0,this.blankTexture=null,this.whiteTexture=null,this.maskCount=0,this.maskStack=[],this.currentMask={mask:null,camera:null},this.currentCameraMask={mask:null,camera:null},this.glFuncMap=null,this.currentType="",this.newType=!1,this.nextTypeMatch=!1,this.finalType=!1,this.mipmapFilter=null,this.textureFlush=0,this.isTextureClean=!1,this.defaultScissor=[0,0,0,0],this.isBooted=!1,this.renderTarget=null,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.init(this.config)},init:function(config){var game=this.game,wkExtString=this.canvas,clearColor=config.backgroundColor,gl=game.config.context||wkExtString.getContext("webgl",config.contextCreation)||wkExtString.getContext("experimental-webgl",config.contextCreation);if(!gl||gl.isContextLost())throw this.contextLost=!0,new Error("WebGL unsupported");this.gl=gl;var _this=this;this.contextLostHandler=function(event){_this.contextLost=!0,_this.game.events.emit(GameEvents$c.CONTEXT_LOST,_this),event.preventDefault()},this.contextRestoredHandler=function(){_this.contextLost=!1,_this.init(_this.config),_this.game.events.emit(GameEvents$c.CONTEXT_RESTORED,_this)},wkExtString.addEventListener("webglcontextlost",this.contextLostHandler,!1),wkExtString.addEventListener("webglcontextrestored",this.contextRestoredHandler,!1),game.context=gl;for(var i=0;i<=27;i++)this.blendModes.push({func:[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],equation:gl.FUNC_ADD});this.blendModes[1].func=[gl.ONE,gl.DST_ALPHA],this.blendModes[2].func=[gl.DST_COLOR,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[3].func=[gl.ONE,gl.ONE_MINUS_SRC_COLOR],this.blendModes[17]={func:[gl.ZERO,gl.ONE_MINUS_SRC_ALPHA],equation:gl.FUNC_REVERSE_SUBTRACT},this.glFormats[0]=gl.BYTE,this.glFormats[1]=gl.SHORT,this.glFormats[2]=gl.UNSIGNED_BYTE,this.glFormats[3]=gl.UNSIGNED_SHORT,this.glFormats[4]=gl.FLOAT,this.glFuncMap={mat2:{func:gl.uniformMatrix2fv,length:1,matrix:!0},mat3:{func:gl.uniformMatrix3fv,length:1,matrix:!0},mat4:{func:gl.uniformMatrix4fv,length:1,matrix:!0},"1f":{func:gl.uniform1f,length:1},"1fv":{func:gl.uniform1fv,length:1},"1i":{func:gl.uniform1i,length:1},"1iv":{func:gl.uniform1iv,length:1},"2f":{func:gl.uniform2f,length:2},"2fv":{func:gl.uniform2fv,length:1},"2i":{func:gl.uniform2i,length:2},"2iv":{func:gl.uniform2iv,length:1},"3f":{func:gl.uniform3f,length:3},"3fv":{func:gl.uniform3fv,length:1},"3i":{func:gl.uniform3i,length:3},"3iv":{func:gl.uniform3iv,length:1},"4f":{func:gl.uniform4f,length:4},"4fv":{func:gl.uniform4fv,length:1},"4i":{func:gl.uniform4i,length:4},"4iv":{func:gl.uniform4iv,length:1}};var exts=gl.getSupportedExtensions();config.maxTextures&&-1!==config.maxTextures||(config.maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS)),config.maxTextureSize||(config.maxTextureSize=gl.getParameter(gl.MAX_TEXTURE_SIZE));var extString="WEBGL_compressed_texture_",wkExtString="WEBKIT_"+extString;this.compression.ETC1=gl.getExtension(extString+"etc1")||gl.getExtension(wkExtString+"etc1"),this.compression.PVRTC=gl.getExtension(extString+"pvrtc")||gl.getExtension(wkExtString+"pvrtc"),this.compression.S3TC=gl.getExtension(extString+"s3tc")||gl.getExtension(wkExtString+"s3tc"),this.supportedExtensions=exts;this.instancedArraysExtension=-1<exts.indexOf("ANGLE_instanced_arrays")?gl.getExtension("ANGLE_instanced_arrays"):null;this.vaoExtension=-1<exts.indexOf("OES_vertex_array_object")?gl.getExtension("OES_vertex_array_object"):null,gl.disable(gl.DEPTH_TEST),gl.disable(gl.CULL_FACE),gl.enable(gl.BLEND),gl.clearColor(clearColor.redGL,clearColor.greenGL,clearColor.blueGL,clearColor.alphaGL),this.mipmapFilter=gl[config.mipmapFilter],this.maxTextures=Utils$m.checkShaderMax(gl,config.maxTextures),this.textureIndexes=[];var tempTextures=this.tempTextures;if(Array.isArray(tempTextures))for(var t=0;i<this.maxTextures;t++)gl.deleteTexture(tempTextures[t]);else tempTextures=new Array(this.maxTextures);for(var index=0;index<this.maxTextures;index++){var tempTexture=gl.createTexture();gl.activeTexture(gl.TEXTURE0+index),gl.bindTexture(gl.TEXTURE_2D,tempTexture),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),tempTextures[index]=tempTexture,this.textureIndexes.push(index)}return this.tempTextures=tempTextures,this.currentActiveTexture=1,this.startActiveTexture++,gl.activeTexture(gl.TEXTURE1),this.pipelines=new PipelineManager(this),this.setBlendMode(CONST$16.BlendModes.NORMAL),this.projectionMatrix=(new Matrix4$3).identity(),game.textures.once(TextureEvents$1.READY,this.boot,this),this},boot:function(){var game=this.game,gl=this.pipelines,baseSize=game.scale.baseSize;this.width=baseSize.width,this.height=baseSize.height,this.isBooted=!0,this.renderTarget=new RenderTarget$1(this,this.width,this.height,1,0,!0,!0),gl.boot(game.config.pipeline),this.blankTexture=game.textures.getFrame("__DEFAULT"),this.whiteTexture=game.textures.getFrame("__WHITE");gl=this.gl;gl.bindFramebuffer(gl.FRAMEBUFFER,null),gl.enable(gl.SCISSOR_TEST),game.scale.on(ScaleEvents.RESIZE,this.onResize,this),this.resize(baseSize.width,baseSize.height)},onResize:function(gameSize,baseSize){baseSize.width===this.width&&baseSize.height===this.height||this.resize(baseSize.width,baseSize.height)},beginCapture:function(width,height){void 0===width&&(width=this.width),void 0===height&&(height=this.height),this.renderTarget.bind(!0,width,height),this.setProjectionMatrix(width,height),this.resetTextures()},endCapture:function(){return this.renderTarget.unbind(!0),this.resetProjectionMatrix(),this.renderTarget},resize:function(width,height){var gl=this.gl;return this.width=width,this.height=height,this.setProjectionMatrix(width,height),gl.viewport(0,0,width,height),this.drawingBufferHeight=gl.drawingBufferHeight,gl.scissor(0,gl.drawingBufferHeight-height,width,height),this.defaultScissor[2]=width,this.defaultScissor[3]=height,this.emit(Events$C.RESIZE,width,height),this},getAspectRatio:function(){return this.width/this.height},setProjectionMatrix:function(width,height){return width===this.projectionWidth&&height===this.projectionHeight||(this.projectionWidth=width,this.projectionHeight=height,this.projectionMatrix.ortho(0,width,height,0,-1e3,1e3)),this},resetProjectionMatrix:function(){this.projectionWidth=this.width,this.projectionHeight=this.height,this.projectionMatrix.ortho(0,this.width,this.height,0,-1e3,1e3)},hasExtension:function(extensionName){return!!this.supportedExtensions&&this.supportedExtensions.indexOf(extensionName)},getExtension:function(extensionName){return this.hasExtension(extensionName)?(extensionName in this.extensions||(this.extensions[extensionName]=this.gl.getExtension(extensionName)),this.extensions[extensionName]):null},flush:function(){this.pipelines.flush()},pushScissor:function(x,y,width,height,drawingBufferHeight){void 0===drawingBufferHeight&&(drawingBufferHeight=this.drawingBufferHeight);var scissor=[x,y,width,height];return this.scissorStack.push(scissor),this.setScissor(x,y,width,height,drawingBufferHeight),this.currentScissor=scissor},setScissor:function(x,y,width,height,drawingBufferHeight){void 0===drawingBufferHeight&&(drawingBufferHeight=this.drawingBufferHeight);var cx,cy,cw,gl=this.gl,ch=this.currentScissor,setScissor=0<width&&0<height;ch&&setScissor&&(cx=ch[0],cy=ch[1],cw=ch[2],ch=ch[3],setScissor=cx!==x||cy!==y||cw!==width||ch!==height),setScissor&&(this.flush(),gl.scissor(x,drawingBufferHeight-y-height,width,height))},resetScissor:function(){var gl=this.gl;gl.enable(gl.SCISSOR_TEST);var x,y,width,height=this.currentScissor;height&&(x=height[0],y=height[1],width=height[2],height=height[3],0<width&&0<height&&gl.scissor(x,this.drawingBufferHeight-y-height,width,height))},popScissor:function(){var scissor=this.scissorStack;scissor.pop();scissor=scissor[scissor.length-1];scissor&&this.setScissor(scissor[0],scissor[1],scissor[2],scissor[3]),this.currentScissor=scissor},hasActiveStencilMask:function(){var mask=this.currentMask.mask,camMask=this.currentCameraMask.mask;return mask&&mask.isStencil||camMask&&camMask.isStencil},resetViewport:function(){var gl=this.gl;gl.viewport(0,0,this.width,this.height),this.drawingBufferHeight=gl.drawingBufferHeight},setBlendMode:function(blendModeId,force){var gl=this.gl,blendMode=this.blendModes[blendModeId];return!!((force=void 0===force?!1:force)||blendModeId!==CONST$16.BlendModes.SKIP_CHECK&&this.currentBlendMode!==blendModeId)&&(this.flush(),gl.enable(gl.BLEND),gl.blendEquation(blendMode.equation),2<blendMode.func.length?gl.blendFuncSeparate(blendMode.func[0],blendMode.func[1],blendMode.func[2],blendMode.func[3]):gl.blendFunc(blendMode.func[0],blendMode.func[1]),this.currentBlendMode=blendModeId,!0)},addBlendMode:function(func,equation){return this.blendModes.push({func:func,equation:equation})-1},updateBlendMode:function(index,func,equation){return this.blendModes[index]&&(this.blendModes[index].func=func,equation&&(this.blendModes[index].equation=equation)),this},removeBlendMode:function(index){return 17<index&&this.blendModes[index]&&this.blendModes.splice(index,1),this},setBlankTexture:function(){this.setTexture2D(this.blankTexture.glTexture)},setTextureSource:function(textureSource){if(this.pipelines.forceZero())return this.setTextureZero(textureSource.glTexture,!0),0;var gl=this.gl,currentActiveTexture=this.currentActiveTexture;return textureSource.glIndexCounter<this.startActiveTexture&&(textureSource.glIndexCounter=this.startActiveTexture,currentActiveTexture<this.maxTextures?(textureSource.glIndex=currentActiveTexture,gl.activeTexture(gl.TEXTURE0+currentActiveTexture),gl.bindTexture(gl.TEXTURE_2D,textureSource.glTexture),this.currentActiveTexture++):(this.flush(),this.startActiveTexture++,this.textureFlush++,textureSource.glIndexCounter=this.startActiveTexture,textureSource.glIndex=1,gl.activeTexture(gl.TEXTURE1),gl.bindTexture(gl.TEXTURE_2D,textureSource.glTexture),this.currentActiveTexture=2)),this.isTextureClean=!1,textureSource.glIndex},isNewNormalMap:function(texture,normalMap){return this.textureZero!==texture||this.normalTexture!==normalMap},setTextureZero:function(texture,gl){this.textureZero!==texture&&(gl&&this.flush(),(gl=this.gl).activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,texture),this.textureZero=texture)},clearTextureZero:function(){this.textureZero=null},setNormalMap:function(texture){var gl;this.normalTexture!==texture&&((gl=this.gl).activeTexture(gl.TEXTURE1),gl.bindTexture(gl.TEXTURE_2D,texture),this.normalTexture=texture,1===this.currentActiveTexture&&(this.currentActiveTexture=2))},clearNormalMap:function(){this.normalTexture=null,this.startActiveTexture++,this.currentActiveTexture=1,this.textureFlush++},unbindTextures:function(){for(var gl=this.gl,temp=this.tempTextures,i=0;i<temp.length;i++)gl.activeTexture(gl.TEXTURE0+i),gl.bindTexture(gl.TEXTURE_2D,null);this.normalTexture=null,this.textureZero=null,this.currentActiveTexture=1,this.startActiveTexture++,this.textureFlush++},resetTextures:function(all){if(void 0===all&&(all=!1),!this.isTextureClean){this.flush();var gl=this.gl,temp=this.tempTextures;if(all){for(var i=0;i<temp.length;i++)gl.activeTexture(gl.TEXTURE0+i),gl.bindTexture(gl.TEXTURE_2D,temp[i]);gl.activeTexture(gl.TEXTURE1),gl.bindTexture(gl.TEXTURE_2D,temp[1]),this.isTextureClean=!0}else gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,temp[0]),gl.activeTexture(gl.TEXTURE1),gl.bindTexture(gl.TEXTURE_2D,temp[1]);this.normalTexture=null,this.textureZero=null,this.currentActiveTexture=1,this.startActiveTexture++,this.textureFlush++}},setTexture2D:function(texture){if(this.pipelines.forceZero())return this.setTextureZero(texture,!0),0;var gl=this.gl,currentActiveTexture=this.currentActiveTexture;return texture.glIndexCounter<this.startActiveTexture&&(texture.glIndexCounter=this.startActiveTexture,currentActiveTexture<this.maxTextures?(texture.glIndex=currentActiveTexture,gl.activeTexture(gl.TEXTURE0+currentActiveTexture),gl.bindTexture(gl.TEXTURE_2D,texture),this.currentActiveTexture++):(this.flush(),this.startActiveTexture++,this.textureFlush++,texture.glIndexCounter=this.startActiveTexture,texture.glIndex=1,gl.activeTexture(gl.TEXTURE1),gl.bindTexture(gl.TEXTURE_2D,texture),this.currentActiveTexture=2)),this.isTextureClean=!1,texture.glIndex},pushFramebuffer:function(framebuffer,updateScissor,resetTextures,setViewport){return framebuffer===this.currentFramebuffer?this:(this.fboStack.push(framebuffer),this.setFramebuffer(framebuffer,updateScissor,resetTextures,setViewport))},setFramebuffer:function(framebuffer,updateScissor,resetTextures,setViewport){if(void 0===updateScissor&&(updateScissor=!1),void 0===resetTextures&&(resetTextures=!1),void 0===setViewport&&(setViewport=!0),framebuffer===this.currentFramebuffer)return this;var gl=this.gl,width=this.width,height=this.height;return framebuffer&&framebuffer.renderTexture&&setViewport?(width=framebuffer.renderTexture.width,height=framebuffer.renderTexture.height):this.flush(),gl.bindFramebuffer(gl.FRAMEBUFFER,framebuffer),setViewport&&gl.viewport(0,0,width,height),updateScissor&&(framebuffer?(this.drawingBufferHeight=height,this.pushScissor(0,0,width,height)):(this.drawingBufferHeight=this.height,this.popScissor())),this.currentFramebuffer=framebuffer,resetTextures&&this.resetTextures(),this},popFramebuffer:function(updateScissor,resetTextures,setViewport){void 0===updateScissor&&(updateScissor=!1),void 0===resetTextures&&(resetTextures=!1),void 0===setViewport&&(setViewport=!0);var framebuffer=this.fboStack;framebuffer.pop();framebuffer=framebuffer[framebuffer.length-1]||null;return this.setFramebuffer(framebuffer,updateScissor,resetTextures,setViewport),framebuffer},setProgram:function(program){return program!==this.currentProgram&&(this.flush(),this.gl.useProgram(program),this.currentProgram=program,!0)},resetProgram:function(){return this.gl.useProgram(this.currentProgram),this},createTextureFromSource:function(source,width,height,scaleMode){var gl=this.gl,minFilter=gl.NEAREST,magFilter=gl.NEAREST,wrap=gl.CLAMP_TO_EDGE;width=source?source.width:width,height=source?source.height:height;var pow=IsSizePowerOfTwo$2(width,height);return pow&&(wrap=gl.REPEAT),scaleMode===CONST$16.ScaleModes.LINEAR&&this.config.antialias&&(minFilter=pow?this.mipmapFilter:gl.LINEAR,magFilter=gl.LINEAR),source||"number"!=typeof width||"number"!=typeof height?this.createTexture2D(0,minFilter,magFilter,wrap,wrap,gl.RGBA,source):this.createTexture2D(0,minFilter,magFilter,wrap,wrap,gl.RGBA,null,width,height)},createTexture2D:function(mipLevel,minFilter,magFilter,wrapT,wrapS,format,pixels,width,height,pma,forceSize,flipY){pma=null==pma||pma,void 0===forceSize&&(forceSize=!1),void 0===flipY&&(flipY=!1);var gl=this.gl,texture=gl.createTexture();gl.activeTexture(gl.TEXTURE0);var currentTexture=gl.getParameter(gl.TEXTURE_BINDING_2D);return gl.bindTexture(gl.TEXTURE_2D,texture),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,minFilter),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,magFilter),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,wrapS),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,wrapT),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,pma),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,flipY),null==pixels?gl.texImage2D(gl.TEXTURE_2D,mipLevel,format,width,height,0,format,gl.UNSIGNED_BYTE,null):(forceSize||(width=pixels.width,height=pixels.height),gl.texImage2D(gl.TEXTURE_2D,mipLevel,format,format,gl.UNSIGNED_BYTE,pixels)),IsSizePowerOfTwo$2(width,height)&&gl.generateMipmap(gl.TEXTURE_2D),currentTexture&&gl.bindTexture(gl.TEXTURE_2D,currentTexture),texture.isAlphaPremultiplied=pma,texture.isRenderTexture=!1,texture.width=width,texture.height=height,texture.glIndex=0,texture.glIndexCounter=-1,texture},createFramebuffer:function(width,height,renderTexture,depthStencilBuffer){var complete,gl=this.gl,framebuffer=gl.createFramebuffer();if(this.setFramebuffer(framebuffer),depthStencilBuffer&&(depthStencilBuffer=gl.createRenderbuffer(),gl.bindRenderbuffer(gl.RENDERBUFFER,depthStencilBuffer),gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,width,height),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,depthStencilBuffer)),renderTexture.isRenderTexture=!0,renderTexture.isAlphaPremultiplied=!1,gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,renderTexture,0),(complete=gl.checkFramebufferStatus(gl.FRAMEBUFFER))===gl.FRAMEBUFFER_COMPLETE)return framebuffer.renderTexture=renderTexture,this.setFramebuffer(null),this.resetTextures(),framebuffer;throw new Error("Framebuffer status: "+{36054:"Incomplete Attachment",36055:"Missing Attachment",36057:"Incomplete Dimensions",36061:"Framebuffer Unsupported"}[complete])},createProgram:function(vertexShader,fragmentShader){var gl=this.gl,program=gl.createProgram(),vs=gl.createShader(gl.VERTEX_SHADER),fs=gl.createShader(gl.FRAGMENT_SHADER);if(gl.shaderSource(vs,vertexShader),gl.shaderSource(fs,fragmentShader),gl.compileShader(vs),gl.compileShader(fs),!gl.getShaderParameter(vs,gl.COMPILE_STATUS))throw new Error("Vertex Shader failed:\n"+gl.getShaderInfoLog(vs));if(!gl.getShaderParameter(fs,gl.COMPILE_STATUS))throw new Error("Fragment Shader failed:\n"+gl.getShaderInfoLog(fs));if(gl.attachShader(program,vs),gl.attachShader(program,fs),gl.linkProgram(program),!gl.getProgramParameter(program,gl.LINK_STATUS))throw new Error("Link Program failed:\n"+gl.getProgramInfoLog(program));return gl.useProgram(program),program},createVertexBuffer:function(initialDataOrSize,bufferUsage){var gl=this.gl,vertexBuffer=gl.createBuffer();return gl.bindBuffer(gl.ARRAY_BUFFER,vertexBuffer),gl.bufferData(gl.ARRAY_BUFFER,initialDataOrSize,bufferUsage),gl.bindBuffer(gl.ARRAY_BUFFER,null),vertexBuffer},createIndexBuffer:function(initialDataOrSize,bufferUsage){var gl=this.gl,indexBuffer=gl.createBuffer();return gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,indexBuffer),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,initialDataOrSize,bufferUsage),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,null),indexBuffer},deleteTexture:function(texture,reset){return reset&&this.resetTextures(!0),texture&&this.gl.deleteTexture(texture),this},deleteFramebuffer:function(framebuffer){return framebuffer&&(this.gl.deleteFramebuffer(framebuffer),ArrayRemove$2(this.fboStack,framebuffer),this.currentFramebuffer===framebuffer&&(this.currentFramebuffer=null)),this},deleteProgram:function(program){return program&&this.gl.deleteProgram(program),this},deleteBuffer:function(buffer){return this.gl.deleteBuffer(buffer),this},preRenderCamera:function(camera){var cx=camera.x,cy=camera.y,cw=camera.width,ch=camera.height,color=camera.backgroundColor;camera.emit(CameraEvents.PRE_RENDER,camera),this.pipelines.preBatchCamera(camera),this.pushScissor(cx,cy,cw,ch),camera.mask&&(this.currentCameraMask.mask=camera.mask,this.currentCameraMask.camera=camera._maskCamera,camera.mask.preRenderWebGL(this,camera,camera._maskCamera)),0<color.alphaGL&&this.pipelines.setMulti().drawFillRect(cx,cy,cw,ch,Utils$m.getTintFromFloats(color.blueGL,color.greenGL,color.redGL,1),color.alphaGL)},getCurrentStencilMask:function(){var prev=null,stack=this.maskStack,cameraMask=this.currentCameraMask;return 0<stack.length?prev=stack[stack.length-1]:cameraMask.mask&&cameraMask.mask.isStencil&&(prev=cameraMask),prev},postRenderCamera:function(camera){var pipeline,flashEffect=camera.flashEffect,fadeEffect=camera.fadeEffect;(flashEffect.isRunning||fadeEffect.isRunning||fadeEffect.isComplete)&&(pipeline=this.pipelines.setMulti(),flashEffect.postRenderWebGL(pipeline,Utils$m.getTintFromFloats),fadeEffect.postRenderWebGL(pipeline,Utils$m.getTintFromFloats)),camera.dirty=!1,this.popScissor(),camera.mask&&(this.currentCameraMask.mask=null,camera.mask.postRenderWebGL(this,camera._maskCamera)),this.pipelines.postBatchCamera(camera),camera.emit(CameraEvents.POST_RENDER,camera)},preRender:function(){var gl,clearColor;this.contextLost||((gl=this.gl).bindFramebuffer(gl.FRAMEBUFFER,null),this.config.clearBeforeRender&&(clearColor=this.config.backgroundColor,gl.clearColor(clearColor.redGL,clearColor.greenGL,clearColor.blueGL,clearColor.alphaGL),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT|gl.STENCIL_BUFFER_BIT)),gl.enable(gl.SCISSOR_TEST),this.currentScissor=this.defaultScissor,this.scissorStack.length=0,this.scissorStack.push(this.currentScissor),this.game.scene.customViewports&&gl.scissor(0,this.drawingBufferHeight-this.height,this.width,this.height),this.currentMask.mask=null,this.currentCameraMask.mask=null,this.maskStack.length=0,this.textureFlush=0,this.emit(Events$C.PRE_RENDER))},render:function(scene,children,camera){if(!this.contextLost){var childCount=children.length;if(this.emit(Events$C.RENDER,scene,camera),this.preRenderCamera(camera),0===childCount)return this.setBlendMode(CONST$16.BlendModes.NORMAL),void this.postRenderCamera(camera);this.currentType="";for(var current=this.currentMask,i=0;i<childCount;i++){this.finalType=i===childCount-1;var child=children[i],type=child.mask;(current=this.currentMask).mask&&current.mask!==type&&current.mask.postRenderWebGL(this,current.camera),type&&current.mask!==type&&type.preRenderWebGL(this,child,camera),child.blendMode!==this.currentBlendMode&&this.setBlendMode(child.blendMode);type=child.type;type!==this.currentType&&(this.newType=!0,this.currentType=type),this.finalType?this.nextTypeMatch=!1:this.nextTypeMatch=children[i+1].type===this.currentType,child.renderWebGL(this,child,camera),this.newType=!1}(current=this.currentMask).mask&&current.mask.postRenderWebGL(this,current.camera),this.setBlendMode(CONST$16.BlendModes.NORMAL),this.postRenderCamera(camera)}},postRender:function(){var state;this.contextLost||(this.flush(),this.emit(Events$C.POST_RENDER),(state=this.snapshotState).callback&&(WebGLSnapshot(this.canvas,state),state.callback=null),0<this.textureFlush&&(this.startActiveTexture++,this.currentActiveTexture=1))},snapshot:function(callback,type,encoderOptions){return this.snapshotArea(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight,callback,type,encoderOptions)},snapshotArea:function(x,y,width,height,callback,type,encoderOptions){var state=this.snapshotState;return state.callback=callback,state.type=type,state.encoder=encoderOptions,state.getPixel=!1,state.x=x,state.y=y,state.width=Math.min(width,this.gl.drawingBufferWidth),state.height=Math.min(height,this.gl.drawingBufferHeight),this},snapshotPixel:function(x,y,callback){return this.snapshotArea(x,y,1,1,callback),this.snapshotState.getPixel=!0,this},snapshotFramebuffer:function(framebuffer,bufferWidth,bufferHeight,callback,getPixel,x,y,width,height,type,state){void 0===getPixel&&(getPixel=!1);var currentFramebuffer=this.currentFramebuffer;this.snapshotArea(x=void 0===x?0:x,y=void 0===y?0:y,width=void 0===width?bufferWidth:width,height=void 0===height?bufferHeight:height,callback,type,state);state=this.snapshotState;return state.getPixel=getPixel,state.isFramebuffer=!0,state.bufferWidth=bufferWidth,state.bufferHeight=bufferHeight,this.setFramebuffer(framebuffer),WebGLSnapshot(this.canvas,state),this.setFramebuffer(currentFramebuffer),state.callback=null,state.isFramebuffer=!1,this},canvasToTexture:function(srcCanvas,dstTexture,noRepeat,flipY){return void 0===noRepeat&&(noRepeat=!1),void 0===flipY&&(flipY=!1),dstTexture?this.updateCanvasTexture(srcCanvas,dstTexture,flipY):this.createCanvasTexture(srcCanvas,noRepeat,flipY)},createCanvasTexture:function(srcCanvas,noRepeat,flipY){void 0===noRepeat&&(noRepeat=!1),void 0===flipY&&(flipY=!1);var gl=this.gl,minFilter=gl.NEAREST,magFilter=gl.NEAREST,width=srcCanvas.width,height=srcCanvas.height,wrapping=gl.CLAMP_TO_EDGE,pow=IsSizePowerOfTwo$2(width,height);return!noRepeat&&pow&&(wrapping=gl.REPEAT),this.config.antialias&&(minFilter=pow?this.mipmapFilter:gl.LINEAR,magFilter=gl.LINEAR),this.createTexture2D(0,minFilter,magFilter,wrapping,wrapping,gl.RGBA,srcCanvas,width,height,!0,!1,flipY)},updateCanvasTexture:function(srcCanvas,dstTexture,flipY){void 0===flipY&&(flipY=!1);var currentTexture,gl=this.gl,width=srcCanvas.width,height=srcCanvas.height;return 0<width&&0<height&&(gl.activeTexture(gl.TEXTURE0),currentTexture=gl.getParameter(gl.TEXTURE_BINDING_2D),gl.bindTexture(gl.TEXTURE_2D,dstTexture),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,flipY),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,srcCanvas),dstTexture.width=width,dstTexture.height=height,currentTexture&&gl.bindTexture(gl.TEXTURE_2D,currentTexture)),dstTexture},createVideoTexture:function(srcVideo,noRepeat,flipY){void 0===noRepeat&&(noRepeat=!1),void 0===flipY&&(flipY=!1);var gl=this.gl,minFilter=gl.NEAREST,magFilter=gl.NEAREST,width=srcVideo.videoWidth,height=srcVideo.videoHeight,wrapping=gl.CLAMP_TO_EDGE,pow=IsSizePowerOfTwo$2(width,height);return!noRepeat&&pow&&(wrapping=gl.REPEAT),this.config.antialias&&(minFilter=pow?this.mipmapFilter:gl.LINEAR,magFilter=gl.LINEAR),this.createTexture2D(0,minFilter,magFilter,wrapping,wrapping,gl.RGBA,srcVideo,width,height,!0,!0,flipY)},updateVideoTexture:function(srcVideo,dstTexture,flipY){void 0===flipY&&(flipY=!1);var currentTexture,gl=this.gl,width=srcVideo.videoWidth,height=srcVideo.videoHeight;return 0<width&&0<height&&(gl.activeTexture(gl.TEXTURE0),currentTexture=gl.getParameter(gl.TEXTURE_BINDING_2D),gl.bindTexture(gl.TEXTURE_2D,dstTexture),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,flipY),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,srcVideo),dstTexture.width=width,dstTexture.height=height,currentTexture&&gl.bindTexture(gl.TEXTURE_2D,currentTexture)),dstTexture},setTextureFilter:function(texture,currentTexture){var gl=this.gl,glFilter=[gl.LINEAR,gl.NEAREST][currentTexture];gl.activeTexture(gl.TEXTURE0);currentTexture=gl.getParameter(gl.TEXTURE_BINDING_2D);return gl.bindTexture(gl.TEXTURE_2D,texture),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,glFilter),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,glFilter),currentTexture&&gl.bindTexture(gl.TEXTURE_2D,currentTexture),this},getMaxTextureSize:function(){return this.config.maxTextureSize},destroy:function(){this.canvas.removeEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.removeEventListener("webglcontextrestored",this.contextRestoredHandler,!1);for(var gl=this.gl,temp=this.tempTextures,i=0;i<temp.length;i++)gl.deleteTexture(temp[i]);this.pipelines.destroy(),this.removeAllListeners(),this.fboStack=[],this.maskStack=[],this.extensions={},this.textureIndexes=[],this.gl=null,this.game=null,this.canvas=null,this.contextLost=!0,this.currentMask=null,this.currentCameraMask=null}}),CanvasInterpolation=CopyFrom_1$1,CanvasPool$8=SetValue_1,CONST$15=Extend,Features$1=BuildGameObjectAnimation_1,CircumCenter_1=function(game){var config=game.config;if((config.customEnvironment||config.canvas)&&config.renderType===CONST$15.AUTO)throw new Error("Must set explicit renderType in custom environment");if(!config.customEnvironment&&!config.canvas&&config.renderType!==CONST$15.HEADLESS)if(config.renderType===CONST$15.CANVAS||config.renderType!==CONST$15.CANVAS&&!Features$1.webGL){if(!Features$1.canvas)throw new Error("Cannot create Canvas or WebGL context, aborting.");config.renderType=CONST$15.CANVAS}else config.renderType=CONST$15.WEBGL;config.antialias||CanvasPool$8.disableSmoothing();var CanvasRenderer=game.scale.baseSize,width=CanvasRenderer.width,CanvasRenderer=CanvasRenderer.height;config.canvas?(game.canvas=config.canvas,game.canvas.width=width,game.canvas.height=CanvasRenderer):game.canvas=CanvasPool$8.create(game,width,CanvasRenderer,config.renderType),config.canvasStyle&&(game.canvas.style=config.canvasStyle),config.antialias||CanvasInterpolation.setCrisp(game.canvas),config.renderType!==CONST$15.HEADLESS&&(CanvasRenderer=CanvasRenderer_1,config.renderType===CONST$15.WEBGL?game.renderer=new WebGLRenderer_1(game):(game.renderer=new CanvasRenderer(game),game.context=game.renderer.gameContext))},CONST$14=Extend,Clone_1$4=function(game){var renderType,audioConfig,args,lastColor,c,audioType,config=game.config;config.hideBanner||(renderType="WebGL",config.renderType===CONST$14.CANVAS?renderType="Canvas":config.renderType===CONST$14.HEADLESS&&(renderType="Headless"),audioConfig=config.audio,audioType=(audioType=game.device.audio).webAudio&&!audioConfig.disableWebAudio?"Web Audio":audioConfig.noAudio||!audioType.webAudio&&!audioType.audioData?"No Audio":"HTML5 Audio",game.device.browser.ie?window.console&&console.log("Phaser v"+CONST$14.VERSION+" / https://phaser.io"):(args=[c=""],Array.isArray(config.bannerBackgroundColor)?(config.bannerBackgroundColor.forEach(function(color){c=c.concat("%c "),args.push("background: "+color),lastColor=color}),args[args.length-1]="color: "+config.bannerTextColor+"; background: "+lastColor):(c=c.concat("%c "),args.push("color: "+config.bannerTextColor+"; background: "+config.bannerBackgroundColor)),args.push("background: transparent"),config.gameTitle&&(c=c.concat(config.gameTitle),config.gameVersion&&(c=c.concat(" v"+config.gameVersion)),config.hidePhaser||(c=c.concat(" / "))),c=(c=!config.hidePhaser?c.concat("Phaser v"+CONST$14.VERSION+" ("+renderType+" | "+audioType+")"):c).concat(" %c "+config.gameURL),args[0]=c,console.log.apply(console,args)))},NOOP$l=gameConfig,BuildFromPolygon_1=new Class_1({initialize:function(){this.isRunning=!1,this.callback=NOOP$l,this.tick=0,this.isSetTimeOut=!1,this.timeOutID=null,this.lastTime=0,this.target=0;var _this=this;this.step=function step(){var timestamp=window.performance.now();_this.lastTime=_this.tick,_this.tick=timestamp,_this.callback(timestamp),_this.timeOutID=window.requestAnimationFrame(step)},this.stepTimeout=function stepTimeout(){var d=Date.now(),delay=Math.min(Math.max(2*_this.target+_this.tick-d,0),_this.target);_this.lastTime=_this.tick,_this.tick=d,_this.callback(d),_this.timeOutID=window.setTimeout(stepTimeout,delay)}},start:function(callback,forceSetTimeOut,targetFPS){this.isRunning||(this.callback=callback,this.isSetTimeOut=forceSetTimeOut,this.target=targetFPS,this.isRunning=!0,this.timeOutID=forceSetTimeOut?window.setTimeout(this.stepTimeout,0):window.requestAnimationFrame(this.step))},stop:function(){this.isRunning=!1,this.isSetTimeOut?clearTimeout(this.timeOutID):window.cancelAnimationFrame(this.timeOutID)},destroy:function(){this.stop(),this.callback=NOOP$l}}),GetValue$t=GetValue_1,NOOP$k=gameConfig,RequestAnimationFrame=BuildFromPolygon_1,time=new Class_1({initialize:function(game,config){this.game=game,this.raf=new RequestAnimationFrame,this.started=!1,this.running=!1,this.minFps=GetValue$t(config,"min",5),this.targetFps=GetValue$t(config,"target",60),this._min=1e3/this.minFps,this._target=1e3/this.targetFps,this.actualFps=this.targetFps,this.nextFpsUpdate=0,this.framesThisSecond=0,this.callback=NOOP$k,this.forceSetTimeOut=GetValue$t(config,"forceSetTimeOut",!1),this.time=0,this.startTime=0,this.lastTime=0,this.frame=0,this.inFocus=!0,this._pauseTime=0,this._coolDown=0,this.delta=0,this.deltaIndex=0,this.deltaHistory=[],this.deltaSmoothingMax=GetValue$t(config,"deltaHistory",10),this.panicMax=GetValue$t(config,"panicMax",120),this.rawDelta=0,this.now=0,this.smoothStep=GetValue$t(config,"smoothStep",!0)},blur:function(){this.inFocus=!1},focus:function(){this.inFocus=!0,this.resetDelta()},pause:function(){this._pauseTime=window.performance.now()},resume:function(){this.resetDelta(),this.startTime+=this.time-this._pauseTime},resetDelta:function(){var now=window.performance.now();this.time=now,this.lastTime=now,this.nextFpsUpdate=now+1e3;for(var i=this.framesThisSecond=0;i<this.deltaSmoothingMax;i++)this.deltaHistory[i]=Math.min(this._target,this.deltaHistory[i]);this.delta=0,this.deltaIndex=0,this._coolDown=this.panicMax},start:function(callback){if(this.started)return this;this.started=!0,this.running=!0;for(var i=0;i<this.deltaSmoothingMax;i++)this.deltaHistory[i]=this._target;this.resetDelta(),this.startTime=window.performance.now(),this.callback=callback,this.raf.start(this.step.bind(this),this.forceSetTimeOut,this._target)},step:function(){var time=window.performance.now(),before=(this.now=time)-this.lastTime;this.rawDelta=before=before<0?0:before;var idx=this.deltaIndex,history=this.deltaHistory,max=this.deltaSmoothingMax,interpolation=before,avg=before;if(this.smoothStep){(0<this._coolDown||!this.inFocus)&&(this._coolDown--,interpolation=Math.min(interpolation,this._target)),interpolation>this._min&&(interpolation=history[idx],interpolation=Math.min(interpolation,this._min)),history[idx]=interpolation,this.deltaIndex++,this.deltaIndex>max&&(this.deltaIndex=0);for(var avg=0,i=0;i<max;i++)avg+=history[i];avg/=max}this.delta=avg,this.time+=this.rawDelta,time>this.nextFpsUpdate&&(this.actualFps=.25*this.framesThisSecond+.75*this.actualFps,this.nextFpsUpdate=time+1e3,this.framesThisSecond=0),this.framesThisSecond++;interpolation=avg/this._target;this.callback(time,avg,interpolation),this.lastTime=time,this.frame++},tick:function(){this.step()},sleep:function(){this.running&&(this.raf.stop(),this.running=!1)},wake:function(seamless){this.running||(seamless&&(this.startTime+=-this.lastTime+(this.lastTime+window.performance.now())),this.raf.start(this.step.bind(this),this.useRAF),this.running=!0,this.step())},getDuration:function(){return Math.round(this.lastTime-this.startTime)/1e3},getDurationMS:function(){return Math.round(this.lastTime-this.startTime)},stop:function(){return this.running=!1,this.started=!1,this.raf.stop(),this},destroy:function(){this.stop(),this.callback=NOOP$k,this.raf=null,this.game=null}}),Events$B=ImageFile_1,GetNearestPoint_1=function(game){var hiddenVar,eventEmitter=game.events;void 0!==document.hidden?hiddenVar="visibilitychange":["webkit","moz","ms"].forEach(function(prefix){void 0!==document[prefix+"Hidden"]&&(document.hidden=function(){return document[prefix+"Hidden"]},hiddenVar=prefix+"visibilitychange")});hiddenVar&&document.addEventListener(hiddenVar,function(event){document.hidden||"pause"===event.type?eventEmitter.emit(Events$B.HIDDEN):eventEmitter.emit(Events$B.VISIBLE)},!1),window.onblur=function(){eventEmitter.emit(Events$B.BLUR)},window.onfocus=function(){eventEmitter.emit(Events$B.FOCUS)},window.focus&&game.config.autoFocus&&window.focus()},core={Config:CenterOn_1$1,CreateRenderer:CircumCenter_1,DebugHeader:Clone_1$4,Events:ImageFile_1,TimeStep:time,VisibilityHandler:GetNearestPoint_1},BuildGameObject_1={0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"},Arne16=BuildGameObject_1,CanvasPool$7=SetValue_1,GetValue$s=GetValue_1,RetroFont_1=function(height){var data=GetValue$s(height,"data",[]),canvas=GetValue$s(height,"canvas",null),palette=GetValue$s(height,"palette",Arne16),pixelWidth=GetValue$s(height,"pixelWidth",1),pixelHeight=GetValue$s(height,"pixelHeight",pixelWidth),resizeCanvas=GetValue$s(height,"resizeCanvas",!0),clearCanvas=GetValue$s(height,"clearCanvas",!0),preRender=GetValue$s(height,"preRender",null),postRender=GetValue$s(height,"postRender",null),width=Math.floor(Math.abs(data[0].length*pixelWidth)),height=Math.floor(Math.abs(data.length*pixelHeight));canvas||(canvas=CanvasPool$7.create2D(this,width,height),clearCanvas=resizeCanvas=!1),resizeCanvas&&(canvas.width=width,canvas.height=height);var ctx=canvas.getContext("2d");clearCanvas&&ctx.clearRect(0,0,width,height),preRender&&preRender(canvas,ctx);for(var y=0;y<data.length;y++)for(var row=data[y],x=0;x<row.length;x++){var d=row[x];"."!==d&&" "!==d&&(ctx.fillStyle=palette[d],ctx.fillRect(x*pixelWidth,y*pixelHeight,pixelWidth,pixelHeight))}return postRender&&postRender(canvas,ctx),canvas},create={GenerateTexture:RetroFont_1,Palettes:{ARNE16:BuildGameObject_1,C64:{0:"#000",1:"#fff",2:"#8b4131",3:"#7bbdc5",4:"#8b41ac",5:"#6aac41",6:"#3931a4",7:"#d5de73",8:"#945a20",9:"#5a4100",A:"#bd736a",B:"#525252",C:"#838383",D:"#acee8b",E:"#7b73de",F:"#acacac"},CGA:{0:"#000",1:"#2234d1",2:"#0c7e45",3:"#44aacc",4:"#8a3622",5:"#5c2e78",6:"#aa5c3d",7:"#b5b5b5",8:"#5e606e",9:"#4c81fb",A:"#6cd947",B:"#7be2f9",C:"#eb8a60",D:"#e23d69",E:"#ffd93f",F:"#fff"},JMP:{0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#f5f4eb"},MSX:{0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#fff"}}},Rectangle$q=HasTileAtWorldXY_1,MATH_CONST$e=Tweens,FromPoints_1=function(points,out){if(void 0===out&&(out=new Rectangle$q),0===points.length)return out;for(var px,py,minX=Number.MAX_VALUE,minY=Number.MAX_VALUE,maxX=MATH_CONST$e.MIN_SAFE_INTEGER,maxY=MATH_CONST$e.MIN_SAFE_INTEGER,i=0;i<points.length;i++)py=points[i],py=Array.isArray(py)?(px=py[0],py[1]):(px=py.x,py.y),minX=Math.min(minX,px),minY=Math.min(minY,py),maxX=Math.max(maxX,px),maxY=Math.max(maxY,py);return out.x=minX,out.y=minY,out.width=maxX-minX,out.height=maxY-minY,out},FromPoints$1=FromPoints_1,Rectangle$p=HasTileAtWorldXY_1,Vector2$H=BuildTilesetIndex_1,CSSFile_1=new Class_1({initialize:function(type){this.type=type,this.defaultDivisions=5,this.arcLengthDivisions=100,this.cacheArcLengths=[],this.needsUpdate=!0,this.active=!0,this._tmpVec2A=new Vector2$H,this._tmpVec2B=new Vector2$H},draw:function(graphics,pointsTotal){return graphics.strokePoints(this.getPoints(pointsTotal=void 0===pointsTotal?32:pointsTotal))},getBounds:function(out,spaced){out=out||new Rectangle$p,void 0===spaced&&(spaced=16);var len=this.getLength();len<spaced&&(spaced=len/2);spaced=Math.max(1,Math.round(len/spaced));return FromPoints$1(this.getSpacedPoints(spaced),out)},getDistancePoints:function(spaced){var len=this.getLength(),spaced=Math.max(1,len/spaced);return this.getSpacedPoints(spaced)},getEndPoint:function(out){return void 0===out&&(out=new Vector2$H),this.getPointAt(1,out)},getLength:function(){var lengths=this.getLengths();return lengths[lengths.length-1]},getLengths:function(divisions){if(void 0===divisions&&(divisions=this.arcLengthDivisions),this.cacheArcLengths.length===divisions+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var current,cache=[],last=this.getPoint(0,this._tmpVec2A),sum=0;cache.push(0);for(var p=1;p<=divisions;p++)sum+=(current=this.getPoint(p/divisions,this._tmpVec2B)).distance(last),cache.push(sum),last.copy(current);return this.cacheArcLengths=cache},getPointAt:function(t,out){t=this.getUtoTmapping(t);return this.getPoint(t,out)},getPoints:function(divisions,stepRate,out){void 0===out&&(out=[]),divisions=divisions||(stepRate?this.getLength()/stepRate:this.defaultDivisions);for(var d=0;d<=divisions;d++)out.push(this.getPoint(d/divisions));return out},getRandomPoint:function(out){return void 0===out&&(out=new Vector2$H),this.getPoint(Math.random(),out)},getSpacedPoints:function(divisions,stepRate,out){void 0===out&&(out=[]),divisions=divisions||(stepRate?this.getLength()/stepRate:this.defaultDivisions);for(var d=0;d<=divisions;d++){var t=this.getUtoTmapping(d/divisions,null,divisions);out.push(this.getPoint(t))}return out},getStartPoint:function(out){return void 0===out&&(out=new Vector2$H),this.getPointAt(0,out)},getTangent:function(t2,out){void 0===out&&(out=new Vector2$H);var t1=t2-1e-4,t2=t2+1e-4;return 1<t2&&(t2=1),this.getPoint(t1=t1<0?0:t1,this._tmpVec2A),this.getPoint(t2,out),out.subtract(this._tmpVec2A).normalize()},getTangentAt:function(t,out){t=this.getUtoTmapping(t);return this.getTangent(t,out)},getTFromDistance:function(distance,divisions){return distance<=0?0:this.getUtoTmapping(0,distance,divisions)},getUtoTmapping:function(lengthBefore,distance,il){for(var comparison,arcLengths=this.getLengths(il),i=0,il=arcLengths.length,targetArcLength=distance?Math.min(distance,arcLengths[il-1]):lengthBefore*arcLengths[il-1],low=0,high=il-1;low<=high;)if((comparison=arcLengths[i=Math.floor(low+(high-low)/2)]-targetArcLength)<0)low=i+1;else{if(!(0<comparison)){high=i;break}high=i-1}if(arcLengths[i=high]===targetArcLength)return i/(il-1);lengthBefore=arcLengths[i];return(i+(targetArcLength-lengthBefore)/(arcLengths[i+1]-lengthBefore))/(il-1)},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()}}),CubicBezier=events$9,Curve$6=CSSFile_1,Vector2$G=BuildTilesetIndex_1,CubicBezierCurve$1=new Class_1({Extends:Curve$6,initialize:function(p0,p1,p2,p3){Curve$6.call(this,"CubicBezierCurve"),Array.isArray(p0)&&(p3=new Vector2$G(p0[6],p0[7]),p2=new Vector2$G(p0[4],p0[5]),p1=new Vector2$G(p0[2],p0[3]),p0=new Vector2$G(p0[0],p0[1])),this.p0=p0,this.p1=p1,this.p2=p2,this.p3=p3},getStartPoint:function(out){return(out=void 0===out?new Vector2$G:out).copy(this.p0)},getResolution:function(divisions){return divisions},getPoint:function(t,out){void 0===out&&(out=new Vector2$G);var p0=this.p0,p1=this.p1,p2=this.p2,p3=this.p3;return out.set(CubicBezier(t,p0.x,p1.x,p2.x,p3.x),CubicBezier(t,p0.y,p1.y,p2.y,p3.y))},draw:function(graphics,pointsTotal){var points=this.getPoints(pointsTotal=void 0===pointsTotal?32:pointsTotal);graphics.beginPath(),graphics.moveTo(this.p0.x,this.p0.y);for(var i=1;i<points.length;i++)graphics.lineTo(points[i].x,points[i].y);return graphics.strokePath(),graphics},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y,this.p3.x,this.p3.y]}}});CubicBezierCurve$1.fromJSON=function(p2){var p3=p2.points,p0=new Vector2$G(p3[0],p3[1]),p1=new Vector2$G(p3[2],p3[3]),p2=new Vector2$G(p3[4],p3[5]),p3=new Vector2$G(p3[6],p3[7]);return new CubicBezierCurve$1(p0,p1,p2,p3)};var tilemaps=CubicBezierCurve$1,Curve$5=CSSFile_1,DegToRad$7=DegToRad_1,GetValue$r=GetValue_1,RadToDeg$1=Common_1,Vector2$F=BuildTilesetIndex_1,EllipseCurve$1=new Class_1({Extends:Curve$5,initialize:function(x,y,xRadius,yRadius,startAngle,endAngle,clockwise,rotation){var config;"object"==typeof x?(x=GetValue$r(config=x,"x",0),y=GetValue$r(config,"y",0),xRadius=GetValue$r(config,"xRadius",0),yRadius=GetValue$r(config,"yRadius",xRadius),startAngle=GetValue$r(config,"startAngle",0),endAngle=GetValue$r(config,"endAngle",360),clockwise=GetValue$r(config,"clockwise",!1),rotation=GetValue$r(config,"rotation",0)):(void 0===yRadius&&(yRadius=xRadius),void 0===startAngle&&(startAngle=0),void 0===endAngle&&(endAngle=360),void 0===clockwise&&(clockwise=!1),void 0===rotation&&(rotation=0)),Curve$5.call(this,"EllipseCurve"),this.p0=new Vector2$F(x,y),this._xRadius=xRadius,this._yRadius=yRadius,this._startAngle=DegToRad$7(startAngle),this._endAngle=DegToRad$7(endAngle),this._clockwise=clockwise,this._rotation=DegToRad$7(rotation)},getStartPoint:function(out){return void 0===out&&(out=new Vector2$F),this.getPoint(0,out)},getResolution:function(divisions){return 2*divisions},getPoint:function(tx,out){void 0===out&&(out=new Vector2$F);for(var twoPi=2*Math.PI,deltaAngle=this._endAngle-this._startAngle,sin=Math.abs(deltaAngle)<Number.EPSILON;deltaAngle<0;)deltaAngle+=twoPi;for(;twoPi<deltaAngle;)deltaAngle-=twoPi;deltaAngle<Number.EPSILON&&(deltaAngle=sin?0:twoPi),this._clockwise&&!sin&&(deltaAngle===twoPi?deltaAngle=-twoPi:deltaAngle-=twoPi);var cos,ty=this._startAngle+tx*deltaAngle,x=this.p0.x+this._xRadius*Math.cos(ty),y=this.p0.y+this._yRadius*Math.sin(ty);return 0!==this._rotation&&(cos=Math.cos(this._rotation),sin=Math.sin(this._rotation),x=(tx=x-this.p0.x)*cos-(ty=y-this.p0.y)*sin+this.p0.x,y=tx*sin+ty*cos+this.p0.y),out.set(x,y)},setXRadius:function(value){return this.xRadius=value,this},setYRadius:function(value){return this.yRadius=value,this},setWidth:function(value){return this.xRadius=value/2,this},setHeight:function(value){return this.yRadius=value/2,this},setStartAngle:function(value){return this.startAngle=value,this},setEndAngle:function(value){return this.endAngle=value,this},setClockwise:function(value){return this.clockwise=value,this},setRotation:function(value){return this.rotation=value,this},x:{get:function(){return this.p0.x},set:function(value){this.p0.x=value}},y:{get:function(){return this.p0.y},set:function(value){this.p0.y=value}},xRadius:{get:function(){return this._xRadius},set:function(value){this._xRadius=value}},yRadius:{get:function(){return this._yRadius},set:function(value){this._yRadius=value}},startAngle:{get:function(){return RadToDeg$1(this._startAngle)},set:function(value){this._startAngle=DegToRad$7(value)}},endAngle:{get:function(){return RadToDeg$1(this._endAngle)},set:function(value){this._endAngle=DegToRad$7(value)}},clockwise:{get:function(){return this._clockwise},set:function(value){this._clockwise=value}},angle:{get:function(){return RadToDeg$1(this._rotation)},set:function(value){this._rotation=DegToRad$7(value)}},rotation:{get:function(){return this._rotation},set:function(value){this._rotation=value}},toJSON:function(){return{type:this.type,x:this.p0.x,y:this.p0.y,xRadius:this._xRadius,yRadius:this._yRadius,startAngle:RadToDeg$1(this._startAngle),endAngle:RadToDeg$1(this._endAngle),clockwise:this._clockwise,rotation:RadToDeg$1(this._rotation)}}});EllipseCurve$1.fromJSON=function(data){return new EllipseCurve$1(data)};var World_1$1=EllipseCurve$1,Constraint_1=PluginCache,SceneEvents$e=events$g,GameObjectFactory$B=new Class_1({initialize:function(scene){this.scene=scene,this.systems=scene.sys,this.events=scene.sys.events,this.displayList,this.updateList,this.events.once(SceneEvents$e.BOOT,this.boot,this),this.events.on(SceneEvents$e.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(SceneEvents$e.DESTROY,this.destroy,this)},start:function(){this.events.once(SceneEvents$e.SHUTDOWN,this.shutdown,this)},existing:function(child){return(child.renderCanvas||child.renderWebGL)&&this.displayList.add(child),child.preUpdate&&this.updateList.add(child),child},shutdown:function(){this.events.off(SceneEvents$e.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(SceneEvents$e.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});GameObjectFactory$B.register=function(factoryType,factoryFunction){GameObjectFactory$B.prototype.hasOwnProperty(factoryType)||(GameObjectFactory$B.prototype[factoryType]=factoryFunction)},GameObjectFactory$B.remove=function(factoryType){GameObjectFactory$B.prototype.hasOwnProperty(factoryType)&&delete GameObjectFactory$B.prototype[factoryType]},Constraint_1.register("GameObjectFactory",GameObjectFactory$B,"add");var Tween_1=GameObjectFactory$B,Curve$4=CSSFile_1,FromPoints=FromPoints_1,Rectangle$o=HasTileAtWorldXY_1,Vector2$E=BuildTilesetIndex_1,LineCurve$1=new Class_1({Extends:Curve$4,initialize:function(p0,p1){Curve$4.call(this,"LineCurve"),Array.isArray(p0)&&(p1=new Vector2$E(p0[2],p0[3]),p0=new Vector2$E(p0[0],p0[1])),this.p0=p0,this.p1=p1,this.arcLengthDivisions=1},getBounds:function(out){return void 0===out&&(out=new Rectangle$o),FromPoints([this.p0,this.p1],out)},getStartPoint:function(out){return(out=void 0===out?new Vector2$E:out).copy(this.p0)},getResolution:function(divisions){return divisions=void 0===divisions?1:divisions},getPoint:function(t,out){return void 0===out&&(out=new Vector2$E),1===t?out.copy(this.p1):(out.copy(this.p1).subtract(this.p0).scale(t).add(this.p0),out)},getPointAt:function(u,out){return this.getPoint(u,out)},getTangent:function(t,out){return(out=void 0===out?new Vector2$E:out).copy(this.p1).subtract(this.p0).normalize(),out},getUtoTmapping:function(u,distance,lineLength){return distance?(lineLength=(lineLength=this.getLengths(lineLength))[lineLength.length-1],Math.min(distance,lineLength)/lineLength):u},draw:function(graphics){return graphics.lineBetween(this.p0.x,this.p0.y,this.p1.x,this.p1.y),graphics},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y]}}});LineCurve$1.fromJSON=function(p0){var p1=p0.points,p0=new Vector2$E(p1[0],p1[1]),p1=new Vector2$E(p1[2],p1[3]);return new LineCurve$1(p0,p1)};var particles=LineCurve$1,Vector2$D=BuildTilesetIndex_1,HTML5AudioFile_1=new Class_1({initialize:function(x,y){this.active=!1,this.p0=new Vector2$D(x,y)},getPoint:function(t,out){return(out=void 0===out?new Vector2$D:out).copy(this.p0)},getPointAt:function(u,out){return this.getPoint(u,out)},getResolution:function(){return 1},getLength:function(){return 0},toJSON:function(){return{type:"MoveTo",points:[this.p0.x,this.p0.y]}}}),Curve$3=CSSFile_1,QuadraticBezierInterpolation=GLSLFile_1,Vector2$C=BuildTilesetIndex_1,QuadraticBezier=new Class_1({Extends:Curve$3,initialize:function(p0,p1,p2){Curve$3.call(this,"QuadraticBezier"),Array.isArray(p0)&&(p2=new Vector2$C(p0[4],p0[5]),p1=new Vector2$C(p0[2],p0[3]),p0=new Vector2$C(p0[0],p0[1])),this.p0=p0,this.p1=p1,this.p2=p2},getStartPoint:function(out){return(out=void 0===out?new Vector2$C:out).copy(this.p0)},getResolution:function(divisions){return divisions},getPoint:function(t,out){void 0===out&&(out=new Vector2$C);var p0=this.p0,p1=this.p1,p2=this.p2;return out.set(QuadraticBezierInterpolation(t,p0.x,p1.x,p2.x),QuadraticBezierInterpolation(t,p0.y,p1.y,p2.y))},draw:function(graphics,pointsTotal){var points=this.getPoints(pointsTotal=void 0===pointsTotal?32:pointsTotal);graphics.beginPath(),graphics.moveTo(this.p0.x,this.p0.y);for(var i=1;i<points.length;i++)graphics.lineTo(points[i].x,points[i].y);return graphics.strokePath(),graphics},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y]}}});QuadraticBezier.fromJSON=function(p1){var p2=p1.points,p0=new Vector2$C(p2[0],p2[1]),p1=new Vector2$C(p2[2],p2[3]),p2=new Vector2$C(p2[4],p2[5]);return new QuadraticBezier(p0,p1,p2)};var SAT_1=QuadraticBezier,CatmullRom=renderer,Curve$2=CSSFile_1,Vector2$B=BuildTilesetIndex_1,SplineCurve$1=new Class_1({Extends:Curve$2,initialize:function(points){void 0===points&&(points=[]),Curve$2.call(this,"SplineCurve"),this.points=[],this.addPoints(points)},addPoints:function(points){for(var i=0;i<points.length;i++){var p=new Vector2$B;"number"==typeof points[i]?(p.x=points[i],p.y=points[i+1],i++):Array.isArray(points[i])?(p.x=points[i][0],p.y=points[i][1]):(p.x=points[i].x,p.y=points[i].y),this.points.push(p)}return this},addPoint:function(x,vec){vec=new Vector2$B(x,vec);return this.points.push(vec),vec},getStartPoint:function(out){return(out=void 0===out?new Vector2$B:out).copy(this.points[0])},getResolution:function(divisions){return divisions*this.points.length},getPoint:function(p1,out){void 0===out&&(out=new Vector2$B);var points=this.points,p2=(points.length-1)*p1,p3=Math.floor(p2),weight=p2-p3,p0=points[0===p3?p3:p3-1],p1=points[p3],p2=points[p3>points.length-2?points.length-1:p3+1],p3=points[p3>points.length-3?points.length-1:p3+2];return out.set(CatmullRom(weight,p0.x,p1.x,p2.x,p3.x),CatmullRom(weight,p0.y,p1.y,p2.y,p3.y))},toJSON:function(){for(var points=[],i=0;i<this.points.length;i++)points.push(this.points[i].x),points.push(this.points[i].y);return{type:this.type,points:points}}});SplineCurve$1.fromJSON=function(data){return new SplineCurve$1(data.points)};var GetTilesWithinWorldXY_1=SplineCurve$1,CubicBezierCurve=tilemaps,EllipseCurve=World_1$1,components$1=Tween_1,LineCurve=particles,MovePathTo=HTML5AudioFile_1,QuadraticBezierCurve=SAT_1,Rectangle$n=HasTileAtWorldXY_1,SplineCurve=GetTilesWithinWorldXY_1,Vector2$A=BuildTilesetIndex_1,MATH_CONST$d=Tweens,Path$1=new Class_1({initialize:function(x,y){void 0===x&&(x=0),void 0===y&&(y=0),this.name="",this.curves=[],this.cacheLengths=[],this.autoClose=!1,this.startPoint=new Vector2$A,this._tmpVec2A=new Vector2$A,this._tmpVec2B=new Vector2$A,"object"==typeof x?this.fromJSON(x):this.startPoint.set(x,y)},add:function(curve){return this.curves.push(curve),this},circleTo:function(radius,clockwise,rotation){return this.ellipseTo(radius,radius,0,360,clockwise=void 0===clockwise?!1:clockwise,rotation)},closePath:function(){var startPoint=this.curves[0].getPoint(0),endPoint=this.curves[this.curves.length-1].getPoint(1);return startPoint.equals(endPoint)||this.curves.push(new LineCurve(endPoint,startPoint)),this},cubicBezierTo:function(x,p3,control1X,control1Y,control2X,control2Y){var p1,p2,p0=this.getEndPoint(),p3=x instanceof Vector2$A?(p1=x,p2=p3,control1X):(p1=new Vector2$A(control1X,control1Y),p2=new Vector2$A(control2X,control2Y),new Vector2$A(x,p3));return this.add(new CubicBezierCurve(p0,p1,p2,p3))},quadraticBezierTo:function(x,p2,controlX,controlY){var p1,p0=this.getEndPoint(),p2=x instanceof Vector2$A?(p1=x,p2):(p1=new Vector2$A(controlX,controlY),new Vector2$A(x,p2));return this.add(new QuadraticBezierCurve(p0,p1,p2))},draw:function(graphics,pointsTotal){for(var i=0;i<this.curves.length;i++){var curve=this.curves[i];curve.active&&curve.draw(graphics,pointsTotal)}return graphics},ellipseTo:function(xRadius,yRadius,startAngle,ellipse,end,start){ellipse=new EllipseCurve(0,0,xRadius,yRadius,startAngle,ellipse,end,start),end=this.getEndPoint(this._tmpVec2A),start=ellipse.getStartPoint(this._tmpVec2B);return end.subtract(start),ellipse.x=end.x,ellipse.y=end.y,this.add(ellipse)},fromJSON:function(data){this.curves=[],this.cacheLengths=[],this.startPoint.set(data.x,data.y),this.autoClose=data.autoClose;for(var i=0;i<data.curves.length;i++){var curve=data.curves[i];switch(curve.type){case"LineCurve":this.add(LineCurve.fromJSON(curve));break;case"EllipseCurve":this.add(EllipseCurve.fromJSON(curve));break;case"SplineCurve":this.add(SplineCurve.fromJSON(curve));break;case"CubicBezierCurve":this.add(CubicBezierCurve.fromJSON(curve));break;case"QuadraticBezierCurve":this.add(QuadraticBezierCurve.fromJSON(curve))}}return this},getBounds:function(out,accuracy){void 0===accuracy&&(accuracy=16),(out=void 0===out?new Rectangle$n:out).x=Number.MAX_VALUE,out.y=Number.MAX_VALUE;for(var bounds=new Rectangle$n,maxRight=MATH_CONST$d.MIN_SAFE_INTEGER,maxBottom=MATH_CONST$d.MIN_SAFE_INTEGER,i=0;i<this.curves.length;i++){var curve=this.curves[i];curve.active&&(curve.getBounds(bounds,accuracy),out.x=Math.min(out.x,bounds.x),out.y=Math.min(out.y,bounds.y),maxRight=Math.max(maxRight,bounds.right),maxBottom=Math.max(maxBottom,bounds.bottom))}return out.right=maxRight,out.bottom=maxBottom,out},getCurveLengths:function(){if(this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var lengths=[],sums=0,i=0;i<this.curves.length;i++)sums+=this.curves[i].getLength(),lengths.push(sums);return this.cacheLengths=lengths},getEndPoint:function(out){return void 0===out&&(out=new Vector2$A),0<this.curves.length?this.curves[this.curves.length-1].getPoint(1,out):out.copy(this.startPoint),out},getLength:function(){var lens=this.getCurveLengths();return lens[lens.length-1]},getPoint:function(t,out){void 0===out&&(out=new Vector2$A);for(var d=t*this.getLength(),curveLengths=this.getCurveLengths(),i=0;i<curveLengths.length;){if(curveLengths[i]>=d){var diff=curveLengths[i]-d,curve=this.curves[i],segmentLength=curve.getLength();return curve.getPointAt(0===segmentLength?0:1-diff/segmentLength,out)}i++}return null},getPoints:function(divisions){void 0===divisions&&(divisions=12);for(var last,points=[],i=0;i<this.curves.length;i++){var curve=this.curves[i];if(curve.active)for(var resolution=curve.getResolution(divisions),pts=curve.getPoints(resolution),j=0;j<pts.length;j++){var point=pts[j];last&&last.equals(point)||(points.push(point),last=point)}}return this.autoClose&&1<points.length&&!points[points.length-1].equals(points[0])&&points.push(points[0]),points},getRandomPoint:function(out){return void 0===out&&(out=new Vector2$A),this.getPoint(Math.random(),out)},getSpacedPoints:function(divisions){void 0===divisions&&(divisions=40);for(var points=[],i=0;i<=divisions;i++)points.push(this.getPoint(i/divisions));return this.autoClose&&points.push(points[0]),points},getStartPoint:function(out){return(out=void 0===out?new Vector2$A:out).copy(this.startPoint)},getTangent:function(t,out){void 0===out&&(out=new Vector2$A);for(var d=t*this.getLength(),curveLengths=this.getCurveLengths(),i=0;i<curveLengths.length;){if(curveLengths[i]>=d){var diff=curveLengths[i]-d,curve=this.curves[i],segmentLength=curve.getLength();return curve.getTangentAt(0===segmentLength?0:1-diff/segmentLength,out)}i++}return null},lineTo:function(x,end){x instanceof Vector2$A?this._tmpVec2B.copy(x):this._tmpVec2B.set(x,end);end=this.getEndPoint(this._tmpVec2A);return this.add(new LineCurve([end.x,end.y,this._tmpVec2B.x,this._tmpVec2B.y]))},splineTo:function(points){return points.unshift(this.getEndPoint()),this.add(new SplineCurve(points))},moveTo:function(x,y){return x instanceof Vector2$A?this.add(new MovePathTo(x.x,x.y)):this.add(new MovePathTo(x,y))},toJSON:function(){for(var out=[],i=0;i<this.curves.length;i++)out.push(this.curves[i].toJSON());return{type:"Path",x:this.startPoint.x,y:this.startPoint.y,autoClose:this.autoClose,curves:out}},updateArcLengths:function(){this.cacheLengths=[],this.getCurveLengths()},destroy:function(){this.curves.length=0,this.cacheLengths.length=0,this.startPoint=void 0}});components$1.register("path",function(x,y){return new Path$1(x,y)});var curves={Path:Path$1,MoveTo:HTML5AudioFile_1,CubicBezier:tilemaps,Curve:CSSFile_1,Ellipse:World_1$1,Line:particles,QuadraticBezier:SAT_1,Spline:GetTilesWithinWorldXY_1},DataManager$2=CustomMain,PathFollower_1=PluginCache,SceneEvents$d=events$g,TweenManager=new Class_1({Extends:DataManager$2,initialize:function(scene){DataManager$2.call(this,scene,scene.sys.events),this.scene=scene,this.systems=scene.sys,scene.sys.events.once(SceneEvents$d.BOOT,this.boot,this),scene.sys.events.on(SceneEvents$d.START,this.start,this)},boot:function(){this.events=this.systems.events,this.events.once(SceneEvents$d.DESTROY,this.destroy,this)},start:function(){this.events.once(SceneEvents$d.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.systems.events.off(SceneEvents$d.SHUTDOWN,this.shutdown,this)},destroy:function(){DataManager$2.prototype.destroy.call(this),this.events.off(SceneEvents$d.START,this.start,this),this.scene=null,this.systems=null}});PathFollower_1.register("DataManagerPlugin",TweenManager,"data");function RGBWithRGB(r1,g1,b1,r2,g2,b2,t,index){return t=(index=void 0===index?0:index)/(t=void 0===t?100:t),{r:Linear(r1,r2,t),g:Linear(g1,g2,t),b:Linear(b1,b2,t)}}var data={DataManager:CustomMain,DataManagerPlugin:TweenManager,Events:BitmapText_1},ParseTilesets_1=Extend_1$1(!1,{In:{BottomCenter:GetTilesWithinShape_1,BottomLeft:GetTweens_1,BottomRight:RenderTexture_1,Center:ParseObject_1,LeftCenter:GetTileToWorldXYFunction_1,QuickSet:Pairs_1,RightCenter:UppercaseFirst_1,TopCenter:GetTileToWorldXFunction_1,TopLeft:HexagonalTileToWorldXY_1,TopRight:Clone_1$7},To:{BottomCenter:Merge_1,BottomLeft:ParseTileLayers_1,BottomRight:ParseJSONTiled_1,LeftBottom:Scene_1,LeftCenter:FromOrientationString_1,LeftTop:ParseWeltmeister_1,QuickSet:GetWorldToTileYFunction_1,RightBottom:HexagonalWorldToTileY_1,RightCenter:ParseTileLayers_1$1,RightTop:GetWorldToTileXYFunction_1,TopCenter:IsInLayerBounds_1,TopLeft:NumberTweenBuilder_1,TopRight:events$6}},_const$d),GetWorldToTileXFunction_1=new Class_1({initialize:function(key,fragmentSrc,vertexSrc,uniforms){fragmentSrc&&""!==fragmentSrc||(fragmentSrc=["precision mediump float;","uniform vec2 resolution;","varying vec2 fragCoord;","void main () {","    vec2 uv = fragCoord / resolution.xy;","    gl_FragColor = vec4(uv.xyx, 1.0);","}"].join("\n")),vertexSrc&&""!==vertexSrc||(vertexSrc=["precision mediump float;","uniform mat4 uProjectionMatrix;","uniform mat4 uViewMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","varying vec2 fragCoord;","varying vec2 outTexCoord;","void main () {","   gl_Position = uProjectionMatrix * uViewMatrix * vec4(inPosition, 1.0, 1.0);","   fragCoord = vec2(inPosition.x, uResolution.y - inPosition.y);","   outTexCoord = vec2(inPosition.x / uResolution.x, fragCoord.y / uResolution.y);","}"].join("\n")),void 0===uniforms&&(uniforms=null),this.key=key,this.fragmentSrc=fragmentSrc,this.vertexSrc=vertexSrc,this.uniforms=uniforms}}),GetBottom=Parse2DArray_1,GetLeft=BaseSoundManager_1,GetRight=DynamicBitmapText_1,GetTop=BaseSound_1,GetTileAtWorldXY_1={CenterOn:BinaryFile_1,GetBottom:Parse2DArray_1,GetBounds:function(gameObject,output){void 0===output&&(output={});var left=GetLeft(gameObject),top=GetTop(gameObject);return output.x=left,output.y=top,output.width=GetRight(gameObject)-left,output.height=GetBottom(gameObject)-top,output},GetCenterX:Centroid_1,GetCenterY:DOMElement_1,GetLeft:BaseSoundManager_1,GetOffsetX:function(gameObject){return gameObject.width*gameObject.originX},GetOffsetY:function(gameObject){return gameObject.height*gameObject.originY},GetRight:DynamicBitmapText_1,GetTop:BaseSound_1,SetBottom:HTML5AudioSound_1,SetCenterX:HTML5AudioSoundManager_1,SetCenterY:Extern_1,SetLeft:GetTextSize_1,SetRight:Composites_1,SetTop:NoAudioSound_1},Inflate_1={CanvasInterpolation:CopyFrom_1$1,CanvasPool:SetValue_1,Smoothing:BuildRight_1,TouchAction:function(canvas,value){return canvas.style.msTouchAction=value=void 0===value?"none":value,canvas.style["ms-touch-action"]=value,canvas.style["touch-action"]=value,canvas},UserSelect:function(canvas,value){void 0===value&&(value="none");return["-webkit-","-khtml-","-moz-","-ms-",""].forEach(function(vendor){canvas.style[vendor+"user-select"]=value}),canvas.style["-webkit-touch-callout"]=value,canvas.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",canvas}},GetColor$1=AssignTileProperties_1,Base64ToArrayBuffer_1=function(limit){void 0===limit&&(limit=1024);var colors=[],r=255,g=0,b=0;for(i=0;i<=255;i++)colors.push({r:r,g:i,b:b,color:GetColor$1(r,i,b)});for(i=g=255;0<=i;i--)colors.push({r:i,g:g,b:b,color:GetColor$1(i,g,b)});for(i=r=0;i<=255;i++,g--)colors.push({r:r,g:g,b:i,color:GetColor$1(r,g,i)});for(b=255,i=g=0;i<=255;i++,b--,r++)colors.push({r:r,g:g,b:b,color:GetColor$1(r,g,b)});if(1024===limit)return colors;for(var out=[],t=0,inc=1024/limit,i=0;i<limit;i++)out.push(colors[Math.floor(t)]),t+=inc;return out},WebAudioSound_1=function(color){var output={r:color>>16&255,g:color>>8&255,b:255&color,a:255};return 16777215<color&&(output.a=color>>>24),output},WebAudioSoundManager_1=function(hex){hex=hex.toString(16);return 1===hex.length?"0"+hex:hex},HTMLTextureFile_1=function(p,q,t){return t<0&&(t+=1),1<t&&--t,t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p},Color$5=Container_1,HueToComponent=HTMLTextureFile_1,Game_1=function(h,p,q){var r=q,g=q,b=q;return 0!==p&&(r=HueToComponent(p=2*q-(q=q<.5?q*(1+p):q+p-q*p),q,h+1/3),g=HueToComponent(p,q,h),b=HueToComponent(p,q,h-1/3)),(new Color$5).setGLTo(r,g,b,1)},HSVToRGB=Layer_1,BitmapFontFile_1=function(s,v){void 0===s&&(s=1),void 0===v&&(v=1);for(var colors=[],c=0;c<=359;c++)colors.push(HSVToRGB(c/359,s,v));return colors},Linear=NoAudioSoundManager_1,MatterWrap_1={RGBWithRGB:RGBWithRGB,ColorWithRGB:function(color,r,g,b,length,index){return RGBWithRGB(color.r,color.g,color.b,r,g,b,length=void 0===length?100:length,index=void 0===index?0:index)},ColorWithColor:function(color1,color2,length,index){return RGBWithRGB(color1.r,color1.g,color1.b,color2.r,color2.g,color2.b,length=void 0===length?100:length,index=void 0===index?0:index)}},Between$1=Bodies_1,Color$4=Container_1,Extend_1=function(min,max){return new Color$4(Between$1(min=void 0===min?0:min,max=void 0===max?255:max),Between$1(min,max),Between$1(min,max))},ComponentToHex=WebAudioSoundManager_1,HasValue_1=function(r,g,b,a,prefix){return void 0===a&&(a=255),"#"===(prefix=void 0===prefix?"#":prefix)?"#"+((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1,7):"0x"+ComponentToHex(a)+ComponentToHex(r)+ComponentToHex(g)+ComponentToHex(b)},DisplayList_1=Container_1;DisplayList_1.ColorSpectrum=Base64ToArrayBuffer_1,DisplayList_1.ColorToRGBA=WebAudioSound_1,DisplayList_1.ComponentToHex=WebAudioSoundManager_1,DisplayList_1.GetColor=AssignTileProperties_1,DisplayList_1.GetColor32=SoundManagerCreator_1,DisplayList_1.HexStringToColor=events$1,DisplayList_1.HSLToColor=Game_1,DisplayList_1.HSVColorWheel=BitmapFontFile_1,DisplayList_1.HSVToRGB=Layer_1,DisplayList_1.HueToComponent=HTMLTextureFile_1,DisplayList_1.IntegerToColor=CopyFrom_1$3,DisplayList_1.IntegerToRGB=GetNewValue_1,DisplayList_1.Interpolate=MatterWrap_1,DisplayList_1.ObjectToColor=CenterOn_1,DisplayList_1.RandomRGB=Extend_1,DisplayList_1.RGBStringToColor=array,DisplayList_1.RGBToHSV=Base64Decode_1,DisplayList_1.RGBToString=HasValue_1,DisplayList_1.ValueToColor=HTMLFile_1;var Pick_1=DisplayList_1,UpdateList_1={BitmapMask:HexagonalTileToWorldY_1,GeometryMask:AnimationJSONFile_1},NOOP$j=gameConfig,PluginCache$7=new Class_1({initialize:function(red,green,blue){this._rgb=[0,0,0],this.onChangeCallback=NOOP$j,this.dirty=!1,this.set(red,green,blue)},set:function(red,green,blue){return this._rgb=[red=void 0===red?0:red,green=void 0===green?0:green,blue=void 0===blue?0:blue],this.onChange(),this},equals:function(red,green,blue){var rgb=this._rgb;return rgb.r===red&&rgb.g===green&&rgb.b===blue},onChange:function(){this.dirty=!0;var rgb=this._rgb;this.onChangeCallback.call(this,rgb[0],rgb[1],rgb[2])},r:{get:function(){return this._rgb[0]},set:function(value){this._rgb[0]=value,this.onChange()}},g:{get:function(){return this._rgb[1]},set:function(value){this._rgb[1]=value,this.onChange()}},b:{get:function(){return this._rgb[2]},set:function(value){this._rgb[2]=value,this.onChange()}},destroy:function(){this.onChangeCallback=null}}),display={Align:ParseTilesets_1,BaseShader:GetWorldToTileXFunction_1,Bounds:GetTileAtWorldXY_1,Canvas:Inflate_1,Color:Pick_1,ColorMatrix:structs,Masks:UpdateList_1,RGB:PluginCache$7},Engine_1=function(element,parent){var target;if(parent)"string"==typeof parent?target=document.getElementById(parent):"object"==typeof parent&&1===parent.nodeType&&(target=parent);else if(element.parentElement||null===parent)return element;return(target=target||document.body).appendChild(element),element},OS$1=parsers,HexagonalWorldToTileXY_1=function(callback){var check;"complete"!==document.readyState&&"interactive"!==document.readyState?(check=function(){document.removeEventListener("deviceready",check,!0),document.removeEventListener("DOMContentLoaded",check,!0),window.removeEventListener("load",check,!0),callback()},document.body?OS$1.cordova?document.addEventListener("deviceready",check,!1):(document.addEventListener("DOMContentLoaded",check,!0),window.addEventListener("load",check,!0)):window.setTimeout(check,20)):callback()},UUID_1=function(ruler){if(!ruler)return window.innerHeight;var axis=Math.abs(window.orientation),size={w:0,h:0},ruler=document.createElement("div");return ruler.setAttribute("style","position: fixed; height: 100vh; width: 0; top: 0"),document.documentElement.appendChild(ruler),size.w=90===axis?ruler.offsetHeight:window.innerWidth,size.h=90===axis?window.innerWidth:ruler.offsetHeight,document.documentElement.removeChild(ruler),ruler=null,90!==Math.abs(window.orientation)?size.h:size.w},HexagonalCullBounds_1={NO_CENTER:0,CENTER_BOTH:1,CENTER_HORIZONTALLY:2,CENTER_VERTICALLY:3},components={LANDSCAPE:"landscape-primary",PORTRAIT:"portrait-primary"},TimelineBuilder_1={NONE:0,WIDTH_CONTROLS_HEIGHT:1,HEIGHT_CONTROLS_WIDTH:2,FIT:3,ENVELOP:4,RESIZE:5},GetCullTilesFunction_1={NO_ZOOM:1,ZOOM_2X:2,ZOOM_4X:4,MAX_ZOOM:-1},ForEachTile_1={CENTER:HexagonalCullBounds_1,ORIENTATION:components,SCALE_MODE:TimelineBuilder_1,ZOOM:GetCullTilesFunction_1},CONST$11=ForEachTile_1,Blitter_1=function(width,height){var orientation=window.screen,orientation=!!orientation&&(orientation.orientation||orientation.mozOrientation||orientation.msOrientation);return orientation&&"string"==typeof orientation.type?orientation.type:"string"==typeof orientation?orientation:"number"==typeof window.orientation?0===window.orientation||180===window.orientation?CONST$11.ORIENTATION.PORTRAIT:CONST$11.ORIENTATION.LANDSCAPE:window.matchMedia?window.matchMedia("(orientation: portrait)").matches?CONST$11.ORIENTATION.PORTRAIT:window.matchMedia("(orientation: landscape)").matches?CONST$11.ORIENTATION.LANDSCAPE:void 0:width<height?CONST$11.ORIENTATION.PORTRAIT:CONST$11.ORIENTATION.LANDSCAPE},Bob_1=function(element){var target;return""!==element&&("string"==typeof element?target=document.getElementById(element):element&&1===element.nodeType&&(target=element)),target=target||document.body},FileTypesManager$1=function(data){var xml="";try{window.DOMParser?xml=(new DOMParser).parseFromString(data,"text/xml"):(xml=new ActiveXObject("Microsoft.XMLDOM")).loadXML(data)}catch(e){xml=null}return xml&&xml.documentElement&&!xml.getElementsByTagName("parsererror").length?xml:null},input=function(element){element.parentNode&&element.parentNode.removeChild(element)},dom={AddToDOM:Engine_1,DOMContentLoaded:HexagonalWorldToTileXY_1,GetInnerHeight:UUID_1,GetScreenOrientation:Blitter_1,GetTarget:Bob_1,ParseXML:FileTypesManager$1,RemoveFromDOM:input,RequestAnimationFrame:BuildFromPolygon_1},GetCalcMatrix_1=Class_1,EE=eventemitter3.exports,GetAdvancedValue_1=PluginCache,BuildGameObject_1=new GetCalcMatrix_1({Extends:EE,initialize:function(){EE.call(this)},shutdown:function(){this.removeAllListeners()},destroy:function(){this.removeAllListeners()}});GetAdvancedValue_1.register("EventEmitter",BuildGameObject_1,"events");var events$9={EventEmitter:BuildGameObject_1},AddToDOM$2=Engine_1,Constraint_1=function(game){var div,config=game.config;config.parent&&config.domCreateContainer&&((div=document.createElement("div")).style.cssText=["display: block;","width: "+game.scale.width+"px;","height: "+game.scale.height+"px;","padding: 0; margin: 0;","position: absolute;","overflow: hidden;","pointer-events: "+config.domPointerEvents+";","transform: scale(1);","transform-origin: left top;"].join(" "),game.domContainer=div,AddToDOM$2(div,config.parent))},GLSLFile_1={MOUSE_DOWN:0,MOUSE_MOVE:1,MOUSE_UP:2,TOUCH_START:3,TOUCH_MOVE:4,TOUCH_END:5,POINTER_LOCK_CHANGE:6,TOUCH_CANCEL:7,MOUSE_WHEEL:8},renderer={BOOT:"boot",DESTROY:"destroy",DRAG_END:"dragend",DRAG_ENTER:"dragenter",DRAG:"drag",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DRAG_START:"dragstart",DROP:"drop",GAME_OUT:"gameout",GAME_OVER:"gameover",GAMEOBJECT_DOWN:"gameobjectdown",GAMEOBJECT_DRAG_END:"dragend",GAMEOBJECT_DRAG_ENTER:"dragenter",GAMEOBJECT_DRAG:"drag",GAMEOBJECT_DRAG_LEAVE:"dragleave",GAMEOBJECT_DRAG_OVER:"dragover",GAMEOBJECT_DRAG_START:"dragstart",GAMEOBJECT_DROP:"drop",GAMEOBJECT_MOVE:"gameobjectmove",GAMEOBJECT_OUT:"gameobjectout",GAMEOBJECT_OVER:"gameobjectover",GAMEOBJECT_POINTER_DOWN:"pointerdown",GAMEOBJECT_POINTER_MOVE:"pointermove",GAMEOBJECT_POINTER_OUT:"pointerout",GAMEOBJECT_POINTER_OVER:"pointerover",GAMEOBJECT_POINTER_UP:"pointerup",GAMEOBJECT_POINTER_WHEEL:"wheel",GAMEOBJECT_UP:"gameobjectup",GAMEOBJECT_WHEEL:"gameobjectwheel",MANAGER_BOOT:"boot",MANAGER_PROCESS:"process",MANAGER_UPDATE:"update",POINTER_DOWN:"pointerdown",POINTER_DOWN_OUTSIDE:"pointerdownoutside",POINTER_MOVE:"pointermove",POINTER_OUT:"pointerout",POINTER_OVER:"pointerover",POINTER_UP:"pointerup",POINTER_UP_OUTSIDE:"pointerupoutside",POINTER_WHEEL:"wheel",POINTERLOCK_CHANGE:"pointerlockchange",PRE_UPDATE:"preupdate",SHUTDOWN:"shutdown",START:"start",UPDATE:"update"},components$1={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:42,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUMPAD_ZERO:96,NUMPAD_ONE:97,NUMPAD_TWO:98,NUMPAD_THREE:99,NUMPAD_FOUR:100,NUMPAD_FIVE:101,NUMPAD_SIX:102,NUMPAD_SEVEN:103,NUMPAD_EIGHT:104,NUMPAD_NINE:105,NUMPAD_ADD:107,NUMPAD_SUBTRACT:109,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,FORWARD_SLASH:191,BACK_SLASH:220,QUOTES:222,BACKTICK:192,OPEN_BRACKET:219,CLOSED_BRACKET:221,SEMICOLON_FIREFOX:59,COLON:58,COMMA_FIREFOX_WINDOWS:60,COMMA_FIREFOX:62,BRACKET_RIGHT_FIREFOX:174,BRACKET_LEFT_FIREFOX:175},ArrayRemove$1=Remove_1,GameEvents$b=ImageFile_1,InputEvents$6=renderer,KeyCodes$2=components$1,NOOP$i=gameConfig,HTML5AudioFile_1=new Class_1({initialize:function(inputManager){this.manager=inputManager,this.queue=[],this.preventDefault=!0,this.captures=[],this.enabled=!1,this.target,this.onKeyDown=NOOP$i,this.onKeyUp=NOOP$i,inputManager.events.once(InputEvents$6.MANAGER_BOOT,this.boot,this)},boot:function(){var config=this.manager.config;this.enabled=config.inputKeyboard,this.target=config.inputKeyboardEventTarget,this.addCapture(config.inputKeyboardCapture),!this.target&&window&&(this.target=window),this.enabled&&this.target&&this.startListeners(),this.manager.game.events.on(GameEvents$b.POST_STEP,this.postUpdate,this)},startListeners:function(){var _this=this;this.onKeyDown=function(event){var modified;!event.defaultPrevented&&_this.enabled&&_this.manager&&(_this.queue.push(event),_this.manager.events.emit(InputEvents$6.MANAGER_PROCESS),modified=event.altKey||event.ctrlKey||event.shiftKey||event.metaKey,_this.preventDefault&&!modified&&-1<_this.captures.indexOf(event.keyCode)&&event.preventDefault())},this.onKeyUp=function(event){var modified;!event.defaultPrevented&&_this.enabled&&_this.manager&&(_this.queue.push(event),_this.manager.events.emit(InputEvents$6.MANAGER_PROCESS),modified=event.altKey||event.ctrlKey||event.shiftKey||event.metaKey,_this.preventDefault&&!modified&&-1<_this.captures.indexOf(event.keyCode)&&event.preventDefault())};var target=this.target;target&&(target.addEventListener("keydown",this.onKeyDown,!1),target.addEventListener("keyup",this.onKeyUp,!1),this.enabled=!0)},stopListeners:function(){var target=this.target;target.removeEventListener("keydown",this.onKeyDown,!1),target.removeEventListener("keyup",this.onKeyUp,!1),this.enabled=!1},postUpdate:function(){this.queue=[]},addCapture:function(keycode){"string"==typeof keycode&&(keycode=keycode.split(",")),Array.isArray(keycode)||(keycode=[keycode]);for(var captures=this.captures,i=0;i<keycode.length;i++){var code=keycode[i];"string"==typeof code&&(code=KeyCodes$2[code.trim().toUpperCase()]),-1===captures.indexOf(code)&&captures.push(code)}this.preventDefault=0<captures.length},removeCapture:function(keycode){"string"==typeof keycode&&(keycode=keycode.split(",")),Array.isArray(keycode)||(keycode=[keycode]);for(var captures=this.captures,i=0;i<keycode.length;i++){var code=keycode[i];"string"==typeof code&&(code=KeyCodes$2[code.toUpperCase()]),ArrayRemove$1(captures,code)}this.preventDefault=0<captures.length},clearCaptures:function(){this.captures=[],this.preventDefault=!1},destroy:function(){this.stopListeners(),this.clearCaptures(),this.queue=[],this.manager.game.events.off(GameEvents$b.POST_RENDER,this.postUpdate,this),this.target=null,this.enabled=!1,this.manager=null}}),Features=BuildGameObjectAnimation_1,InputEvents$5=renderer,NOOP$h=gameConfig,tilemaps=new Class_1({initialize:function(inputManager){this.manager=inputManager,this.preventDefaultDown=!0,this.preventDefaultUp=!0,this.preventDefaultMove=!0,this.preventDefaultWheel=!1,this.enabled=!1,this.target,this.locked=!1,this.onMouseMove=NOOP$h,this.onMouseDown=NOOP$h,this.onMouseUp=NOOP$h,this.onMouseDownWindow=NOOP$h,this.onMouseUpWindow=NOOP$h,this.onMouseOver=NOOP$h,this.onMouseOut=NOOP$h,this.onMouseWheel=NOOP$h,this.pointerLockChange=NOOP$h,this.isTop=!0,inputManager.events.once(InputEvents$5.MANAGER_BOOT,this.boot,this)},boot:function(){var config=this.manager.config;this.enabled=config.inputMouse,this.target=config.inputMouseEventTarget,this.passive=config.inputMousePassive,this.preventDefaultDown=config.inputMousePreventDefaultDown,this.preventDefaultUp=config.inputMousePreventDefaultUp,this.preventDefaultMove=config.inputMousePreventDefaultMove,this.preventDefaultWheel=config.inputMousePreventDefaultWheel,this.target?"string"==typeof this.target&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,config.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return document.body.addEventListener("contextmenu",function(event){return event.preventDefault(),!1}),this},requestPointerLock:function(){var element;Features.pointerLock&&((element=this.target).requestPointerLock=element.requestPointerLock||element.mozRequestPointerLock||element.webkitRequestPointerLock,element.requestPointerLock())},releasePointerLock:function(){Features.pointerLock&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock())},startListeners:function(){var target=this.target;if(target){var _this=this,manager=this.manager,canvas=manager.canvas,autoFocus=window&&window.focus&&manager.game.config.autoFocus;this.onMouseMove=function(event){!event.defaultPrevented&&_this.enabled&&manager&&manager.enabled&&(manager.onMouseMove(event),_this.preventDefaultMove&&event.preventDefault())},this.onMouseDown=function(event){autoFocus&&window.focus(),!event.defaultPrevented&&_this.enabled&&manager&&manager.enabled&&(manager.onMouseDown(event),_this.preventDefaultDown&&event.target===canvas&&event.preventDefault())},this.onMouseDownWindow=function(event){!event.defaultPrevented&&_this.enabled&&manager&&manager.enabled&&event.target!==canvas&&manager.onMouseDown(event)},this.onMouseUp=function(event){!event.defaultPrevented&&_this.enabled&&manager&&manager.enabled&&(manager.onMouseUp(event),_this.preventDefaultUp&&event.target===canvas&&event.preventDefault())},this.onMouseUpWindow=function(event){!event.defaultPrevented&&_this.enabled&&manager&&manager.enabled&&event.target!==canvas&&manager.onMouseUp(event)},this.onMouseOver=function(event){!event.defaultPrevented&&_this.enabled&&manager&&manager.enabled&&manager.setCanvasOver(event)},this.onMouseOut=function(event){!event.defaultPrevented&&_this.enabled&&manager&&manager.enabled&&manager.setCanvasOut(event)},this.onMouseWheel=function(event){!event.defaultPrevented&&_this.enabled&&manager&&manager.enabled&&manager.onMouseWheel(event),_this.preventDefaultWheel&&event.target===canvas&&event.preventDefault()};var passive={passive:!0};if(target.addEventListener("mousemove",this.onMouseMove),target.addEventListener("mousedown",this.onMouseDown),target.addEventListener("mouseup",this.onMouseUp),target.addEventListener("mouseover",this.onMouseOver,passive),target.addEventListener("mouseout",this.onMouseOut,passive),this.preventDefaultWheel?target.addEventListener("wheel",this.onMouseWheel,{passive:!1}):target.addEventListener("wheel",this.onMouseWheel,passive),window&&manager.game.config.inputWindowEvents)try{window.top.addEventListener("mousedown",this.onMouseDownWindow,passive),window.top.addEventListener("mouseup",this.onMouseUpWindow,passive)}catch(exception){window.addEventListener("mousedown",this.onMouseDownWindow,passive),window.addEventListener("mouseup",this.onMouseUpWindow,passive),this.isTop=!1}Features.pointerLock&&(this.pointerLockChange=function(event){var element=_this.target;_this.locked=document.pointerLockElement===element||document.mozPointerLockElement===element||document.webkitPointerLockElement===element,manager.onPointerLockChange(event)},document.addEventListener("pointerlockchange",this.pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this.pointerLockChange,!0)),this.enabled=!0}},stopListeners:function(){var target=this.target;target.removeEventListener("mousemove",this.onMouseMove),target.removeEventListener("mousedown",this.onMouseDown),target.removeEventListener("mouseup",this.onMouseUp),target.removeEventListener("mouseover",this.onMouseOver),target.removeEventListener("mouseout",this.onMouseOut),window&&((target=this.isTop?window.top:window).removeEventListener("mousedown",this.onMouseDownWindow),target.removeEventListener("mouseup",this.onMouseUpWindow)),Features.pointerLock&&(document.removeEventListener("pointerlockchange",this.pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this.pointerLockChange,!0))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}}),Angle$6=GetTargets_1,Distance=DistanceBetween_1,FuzzyEqual$1=Detector_1,SmoothStepInterpolation=plugins,Vector2$z=BuildTilesetIndex_1,OS=parsers,CSSFile_1=new Class_1({initialize:function(manager,id){this.manager=manager,this.id=id,this.event,this.downElement,this.upElement,this.camera=null,this.button=0,this.buttons=0,this.position=new Vector2$z,this.prevPosition=new Vector2$z,this.midPoint=new Vector2$z(-1,-1),this.velocity=new Vector2$z,this.angle=0,this.distance=0,this.smoothFactor=0,this.motionFactor=.2,this.worldX=0,this.worldY=0,this.moveTime=0,this.downX=0,this.downY=0,this.downTime=0,this.upX=0,this.upY=0,this.upTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.active=0===id,this.locked=!1,this.deltaX=0,this.deltaY=0,this.deltaZ=0},updateWorldPoint:function(temp){temp=temp.getWorldPoint(this.x,this.y);return this.worldX=temp.x,this.worldY=temp.y,this},positionToCamera:function(camera,output){return camera.getWorldPoint(this.x,this.y,output)},updateMotion:function(){var vx,vy,cx=this.position.x,cy=this.position.y,dx=this.midPoint.x,dy=this.midPoint.y;cx===dx&&cy===dy||(vx=SmoothStepInterpolation(this.motionFactor,dx,cx),vy=SmoothStepInterpolation(this.motionFactor,dy,cy),FuzzyEqual$1(vx,cx,.1)&&(vx=cx),FuzzyEqual$1(vy,cy,.1)&&(vy=cy),this.midPoint.set(vx,vy),this.velocity.set(dx=cx-vx,dy=cy-vy),this.angle=Angle$6(vx,vy,cx,cy),this.distance=Math.sqrt(dx*dx+dy*dy))},up:function(event){"buttons"in event&&(this.buttons=event.buttons),this.event=event,this.button=event.button,this.upElement=event.target,this.manager.transformPointer(this,event.pageX,event.pageY,!1),0===event.button&&(this.primaryDown=!1,this.upX=this.x,this.upY=this.y),0===this.buttons&&(this.isDown=!1,this.upTime=event.timeStamp,this.wasTouch=!1)},down:function(event){"buttons"in event&&(this.buttons=event.buttons),this.event=event,this.button=event.button,this.downElement=event.target,this.manager.transformPointer(this,event.pageX,event.pageY,!1),0===event.button&&(this.primaryDown=!0,this.downX=this.x,this.downY=this.y),OS.macOS&&event.ctrlKey&&(this.buttons=2,this.primaryDown=!1),this.isDown||(this.isDown=!0,this.downTime=event.timeStamp),this.wasTouch=!1},move:function(event){"buttons"in event&&(this.buttons=event.buttons),this.event=event,this.manager.transformPointer(this,event.pageX,event.pageY,!0),this.locked&&(this.movementX=event.movementX||event.mozMovementX||event.webkitMovementX||0,this.movementY=event.movementY||event.mozMovementY||event.webkitMovementY||0),this.moveTime=event.timeStamp,this.wasTouch=!1},wheel:function(event){"buttons"in event&&(this.buttons=event.buttons),this.event=event,this.manager.transformPointer(this,event.pageX,event.pageY,!1),this.deltaX=event.deltaX,this.deltaY=event.deltaY,this.deltaZ=event.deltaZ,this.wasTouch=!1},touchstart:function(touch,event){touch.pointerId&&(this.pointerId=touch.pointerId),this.identifier=touch.identifier,this.target=touch.target,this.active=!0,this.buttons=1,this.event=event,this.downElement=touch.target,this.manager.transformPointer(this,touch.pageX,touch.pageY,!1),this.primaryDown=!0,this.downX=this.x,this.downY=this.y,this.downTime=event.timeStamp,this.isDown=!0,this.wasTouch=!0,this.wasCanceled=!1,this.updateMotion()},touchmove:function(touch,event){this.event=event,this.manager.transformPointer(this,touch.pageX,touch.pageY,!0),this.moveTime=event.timeStamp,this.wasTouch=!0,this.updateMotion()},touchend:function(touch,event){this.buttons=0,this.event=event,this.upElement=touch.target,this.manager.transformPointer(this,touch.pageX,touch.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=event.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!1,this.active=!1,this.updateMotion()},touchcancel:function(touch,event){this.buttons=0,this.event=event,this.upElement=touch.target,this.manager.transformPointer(this,touch.pageX,touch.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=event.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!0,this.active=!1},noButtonDown:function(){return 0===this.buttons},leftButtonDown:function(){return!!(1&this.buttons)},rightButtonDown:function(){return!!(2&this.buttons)},middleButtonDown:function(){return!!(4&this.buttons)},backButtonDown:function(){return!!(8&this.buttons)},forwardButtonDown:function(){return!!(16&this.buttons)},leftButtonReleased:function(){return 0===this.button&&!this.isDown},rightButtonReleased:function(){return 2===this.button&&!this.isDown},middleButtonReleased:function(){return 1===this.button&&!this.isDown},backButtonReleased:function(){return 3===this.button&&!this.isDown},forwardButtonReleased:function(){return 4===this.button&&!this.isDown},getDistance:function(){return this.isDown?Distance(this.downX,this.downY,this.x,this.y):Distance(this.downX,this.downY,this.upX,this.upY)},getDistanceX:function(){return this.isDown?Math.abs(this.downX-this.x):Math.abs(this.downX-this.upX)},getDistanceY:function(){return this.isDown?Math.abs(this.downY-this.y):Math.abs(this.downY-this.upY)},getDuration:function(){return this.isDown?this.manager.time-this.downTime:this.upTime-this.downTime},getAngle:function(){return this.isDown?Angle$6(this.downX,this.downY,this.x,this.y):Angle$6(this.downX,this.downY,this.upX,this.upY)},getInterpolatedPosition:function(steps,out){void 0===steps&&(steps=10),void 0===out&&(out=[]);for(var prevX=this.prevPosition.x,prevY=this.prevPosition.y,curX=this.position.x,curY=this.position.y,i=0;i<steps;i++){var t=1/steps*i;out[i]={x:SmoothStepInterpolation(t,prevX,curX),y:SmoothStepInterpolation(t,prevY,curY)}}return out},destroy:function(){this.camera=null,this.manager=null,this.position=null},x:{get:function(){return this.position.x},set:function(value){this.position.x=value}},y:{get:function(){return this.position.y},set:function(value){this.position.y=value}},time:{get:function(){return this.event?this.event.timeStamp:0}}}),InputEvents$4=renderer,NOOP$g=gameConfig,World_1$1=new Class_1({initialize:function(inputManager){this.manager=inputManager,this.capture=!0,this.enabled=!1,this.target,this.onTouchStart=NOOP$g,this.onTouchStartWindow=NOOP$g,this.onTouchMove=NOOP$g,this.onTouchEnd=NOOP$g,this.onTouchEndWindow=NOOP$g,this.onTouchCancel=NOOP$g,this.onTouchCancelWindow=NOOP$g,this.onTouchOver=NOOP$g,this.onTouchOut=NOOP$g,inputManager.events.once(InputEvents$4.MANAGER_BOOT,this.boot,this)},boot:function(){var config=this.manager.config;this.enabled=config.inputTouch,this.target=config.inputTouchEventTarget,this.capture=config.inputTouchCapture,this.target||(this.target=this.manager.game.canvas),config.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return document.body.addEventListener("contextmenu",function(event){return event.preventDefault(),!1}),this},startListeners:function(){var _this=this,canvas=this.manager.canvas,autoFocus=window&&window.focus&&this.manager.game.config.autoFocus;this.onTouchStart=function(event){autoFocus&&window.focus(),!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled&&(_this.manager.onTouchStart(event),_this.capture&&event.cancelable&&event.target===canvas&&event.preventDefault())},this.onTouchStartWindow=function(event){!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled&&event.target!==canvas&&_this.manager.onTouchStart(event)},this.onTouchMove=function(event){!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled&&(_this.manager.onTouchMove(event),_this.capture&&event.cancelable&&event.preventDefault())},this.onTouchEnd=function(event){!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled&&(_this.manager.onTouchEnd(event),_this.capture&&event.cancelable&&event.target===canvas&&event.preventDefault())},this.onTouchEndWindow=function(event){!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled&&event.target!==canvas&&_this.manager.onTouchEnd(event)},this.onTouchCancel=function(event){!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled&&(_this.manager.onTouchCancel(event),_this.capture&&event.preventDefault())},this.onTouchCancelWindow=function(event){!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled&&_this.manager.onTouchCancel(event)},this.onTouchOver=function(event){!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled&&_this.manager.setCanvasOver(event)},this.onTouchOut=function(event){!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled&&_this.manager.setCanvasOut(event)};var passive,nonPassive,target=this.target;target&&(nonPassive={passive:!(passive={passive:!0})},target.addEventListener("touchstart",this.onTouchStart,this.capture?nonPassive:passive),target.addEventListener("touchmove",this.onTouchMove,this.capture?nonPassive:passive),target.addEventListener("touchend",this.onTouchEnd,this.capture?nonPassive:passive),target.addEventListener("touchcancel",this.onTouchCancel,this.capture?nonPassive:passive),target.addEventListener("touchover",this.onTouchOver,this.capture?nonPassive:passive),target.addEventListener("touchout",this.onTouchOut,this.capture?nonPassive:passive),window&&this.manager.game.config.inputWindowEvents&&(window.addEventListener("touchstart",this.onTouchStartWindow,nonPassive),window.addEventListener("touchend",this.onTouchEndWindow,nonPassive),window.addEventListener("touchcancel",this.onTouchCancelWindow,nonPassive)),this.enabled=!0)},stopListeners:function(){var target=this.target;target.removeEventListener("touchstart",this.onTouchStart),target.removeEventListener("touchmove",this.onTouchMove),target.removeEventListener("touchend",this.onTouchEnd),target.removeEventListener("touchcancel",this.onTouchCancel),target.removeEventListener("touchover",this.onTouchOver),target.removeEventListener("touchout",this.onTouchOut),window&&(window.removeEventListener("touchstart",this.onTouchStartWindow),window.removeEventListener("touchend",this.onTouchEndWindow))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}}),particles=Class_1,CONST$10=GLSLFile_1,EventEmitter$m=eventemitter3.exports,Events$A=renderer,GameEvents$a=ImageFile_1,Keyboard=HTML5AudioFile_1,Mouse=tilemaps,Pointer=CSSFile_1,Touch=World_1$1,TransformMatrix$a=TransformMatrix,TransformXY=Equals_1$1,SAT_1=new particles({initialize:function(game,config){this.game=game,this.scaleManager,this.canvas,this.config=config,this.enabled=!0,this.events=new EventEmitter$m,this.isOver=!0,this.defaultCursor="",this.keyboard=config.inputKeyboard?new Keyboard(this):null,this.mouse=config.inputMouse?new Mouse(this):null,this.touch=config.inputTouch?new Touch(this):null,this.pointers=[],this.pointersTotal=config.inputActivePointers,config.inputTouch&&1===this.pointersTotal&&(this.pointersTotal=2);for(var i=0;i<=this.pointersTotal;i++){var pointer=new Pointer(this,i);pointer.smoothFactor=config.inputSmoothFactor,this.pointers.push(pointer)}this.mousePointer=config.inputMouse?this.pointers[0]:null,this.activePointer=this.pointers[0],this.globalTopOnly=!0,this.time=0,this._tempPoint={x:0,y:0},this._tempHitTest=[],this._tempMatrix=new TransformMatrix$a,this._tempMatrix2=new TransformMatrix$a,this._tempSkip=!1,this.mousePointerContainer=[this.mousePointer],game.events.once(GameEvents$a.BOOT,this.boot,this)},boot:function(){this.canvas=this.game.canvas,this.scaleManager=this.game.scale,this.events.emit(Events$A.MANAGER_BOOT),this.game.events.on(GameEvents$a.PRE_RENDER,this.preRender,this),this.game.events.once(GameEvents$a.DESTROY,this.destroy,this)},setCanvasOver:function(event){this.isOver=!0,this.events.emit(Events$A.GAME_OVER,event)},setCanvasOut:function(event){this.isOver=!1,this.events.emit(Events$A.GAME_OUT,event)},preRender:function(){var time=this.game.loop.now,delta=this.game.loop.delta,scenes=this.game.scene.getScenes(!0,!0);this.time=time,this.events.emit(Events$A.MANAGER_UPDATE);for(var i=0;i<scenes.length;i++){var scene=scenes[i];if(scene.sys.input&&scene.sys.input.updatePoll(time,delta)&&this.globalTopOnly)return}},setDefaultCursor:function(cursor){this.defaultCursor=cursor,this.canvas.style.cursor!==cursor&&(this.canvas.style.cursor=cursor)},setCursor:function(interactiveObject){interactiveObject.cursor&&(this.canvas.style.cursor=interactiveObject.cursor)},resetCursor:function(interactiveObject){interactiveObject.cursor&&this.canvas&&(this.canvas.style.cursor=this.defaultCursor)},addPointer:function(quantity){var output=[];10<this.pointersTotal+(quantity=void 0===quantity?1:quantity)&&(quantity=10-this.pointersTotal);for(var i=0;i<quantity;i++){var pointer=this.pointers.length,pointer=new Pointer(this,pointer);pointer.smoothFactor=this.config.inputSmoothFactor,this.pointers.push(pointer),this.pointersTotal++,output.push(pointer)}return output},updateInputPlugins:function(type,pointers){var scenes=this.game.scene.getScenes(!0,!0);this._tempSkip=!1;for(var i=0;i<scenes.length;i++){var scene=scenes[i];if(scene.sys.input)if(scene.sys.input.update(type,pointers)&&this.globalTopOnly||this._tempSkip)return}},onTouchStart:function(event){for(var pointers=this.pointers,changed=[],c=0;c<event.changedTouches.length;c++)for(var changedTouch=event.changedTouches[c],i=1;i<this.pointersTotal;i++){var pointer=pointers[i];if(!pointer.active){pointer.touchstart(changedTouch,event),this.activePointer=pointer,changed.push(pointer);break}}this.updateInputPlugins(CONST$10.TOUCH_START,changed)},onTouchMove:function(event){for(var pointers=this.pointers,changed=[],c=0;c<event.changedTouches.length;c++)for(var changedTouch=event.changedTouches[c],i=1;i<this.pointersTotal;i++){var pointer=pointers[i];if(pointer.active&&pointer.identifier===changedTouch.identifier){pointer.touchmove(changedTouch,event),this.activePointer=pointer,changed.push(pointer);break}}this.updateInputPlugins(CONST$10.TOUCH_MOVE,changed)},onTouchEnd:function(event){for(var pointers=this.pointers,changed=[],c=0;c<event.changedTouches.length;c++)for(var changedTouch=event.changedTouches[c],i=1;i<this.pointersTotal;i++){var pointer=pointers[i];if(pointer.active&&pointer.identifier===changedTouch.identifier){pointer.touchend(changedTouch,event),changed.push(pointer);break}}this.updateInputPlugins(CONST$10.TOUCH_END,changed)},onTouchCancel:function(event){for(var pointers=this.pointers,changed=[],c=0;c<event.changedTouches.length;c++)for(var changedTouch=event.changedTouches[c],i=1;i<this.pointersTotal;i++){var pointer=pointers[i];if(pointer.active&&pointer.identifier===changedTouch.identifier){pointer.touchcancel(changedTouch,event),changed.push(pointer);break}}this.updateInputPlugins(CONST$10.TOUCH_CANCEL,changed)},onMouseDown:function(event){var mousePointer=this.mousePointer;mousePointer.down(event),mousePointer.updateMotion(),this.activePointer=mousePointer,this.updateInputPlugins(CONST$10.MOUSE_DOWN,this.mousePointerContainer)},onMouseMove:function(event){var mousePointer=this.mousePointer;mousePointer.move(event),mousePointer.updateMotion(),this.activePointer=mousePointer,this.updateInputPlugins(CONST$10.MOUSE_MOVE,this.mousePointerContainer)},onMouseUp:function(event){var mousePointer=this.mousePointer;mousePointer.up(event),mousePointer.updateMotion(),this.activePointer=mousePointer,this.updateInputPlugins(CONST$10.MOUSE_UP,this.mousePointerContainer)},onMouseWheel:function(event){var mousePointer=this.mousePointer;mousePointer.wheel(event),this.activePointer=mousePointer,this.updateInputPlugins(CONST$10.MOUSE_WHEEL,this.mousePointerContainer)},onPointerLockChange:function(event){var isLocked=this.mouse.locked;this.mousePointer.locked=isLocked,this.events.emit(Events$A.POINTERLOCK_CHANGE,event,isLocked)},inputCandidate:function(gameObject,camera){var input=gameObject.input;if(!input||!input.enabled||!input.alwaysEnabled&&!gameObject.willRender(camera))return!1;var visible=!0,parent=gameObject.parentContainer;if(parent)do{if(!parent.willRender(camera)){visible=!1;break}}while(parent=parent.parentContainer);return visible},hitTest:function(pointer,gameObjects,camera,output){void 0===output&&(output=this._tempHitTest);var tempPoint=this._tempPoint,csx=camera.scrollX,csy=camera.scrollY;output.length=0;var x=pointer.x,y=pointer.y;camera.getWorldPoint(x,y,tempPoint),pointer.worldX=tempPoint.x,pointer.worldY=tempPoint.y;for(var point={x:0,y:0},matrix=this._tempMatrix,parentMatrix=this._tempMatrix2,i=0;i<gameObjects.length;i++){var px,py,gameObject=gameObjects[i];this.inputCandidate(gameObject,camera)&&(px=tempPoint.x+csx*gameObject.scrollFactorX-csx,py=tempPoint.y+csy*gameObject.scrollFactorY-csy,gameObject.parentContainer?(gameObject.getWorldTransformMatrix(matrix,parentMatrix),matrix.applyInverse(px,py,point)):TransformXY(px,py,gameObject.x,gameObject.y,gameObject.rotation,gameObject.scaleX,gameObject.scaleY,point),this.pointWithinHitArea(gameObject,point.x,point.y)&&output.push(gameObject))}return output},pointWithinHitArea:function(gameObject,x,y){x+=gameObject.displayOriginX,y+=gameObject.displayOriginY;var input=gameObject.input;return!(!input||!input.hitAreaCallback(input.hitArea,x,y,gameObject))&&(input.localX=x,input.localY=y,!0)},pointWithinInteractiveObject:function(object,x,y){return!!object.hitArea&&(x+=object.gameObject.displayOriginX,y+=object.gameObject.displayOriginY,object.localX=x,object.localY=y,object.hitAreaCallback(object.hitArea,x,y,object))},transformPointer:function(a,x,y,wasMove){var p0=a.position,p1=a.prevPosition;p1.x=p0.x,p1.y=p0.y;x=this.scaleManager.transformX(x),y=this.scaleManager.transformY(y),a=a.smoothFactor;wasMove&&0!==a?(p0.x=x*a+p1.x*(1-a),p0.y=y*a+p1.y*(1-a)):(p0.x=x,p0.y=y)},destroy:function(){this.events.removeAllListeners(),this.game.events.off(GameEvents$a.PRE_RENDER),this.keyboard&&this.keyboard.destroy(),this.mouse&&this.mouse.destroy(),this.touch&&this.touch.destroy();for(var i=0;i<this.pointers.length;i++)this.pointers[i].destroy();this.pointers=[],this._tempHitTest=[],this._tempMatrix.destroy(),this.canvas=null,this.game=null}}),types={},GetTilesWithinWorldXY_1={install:function(loader){for(var key in types)loader[key]=types[key]},register:function(key,factoryFunction){types[key]=factoryFunction},destroy:function(){types={}}},PathFollower_1=PluginCache,SceneEvents$c=events$g,GameObjectCreator$m=new Class_1({initialize:function(scene){this.scene=scene,this.systems=scene.sys,this.events=scene.sys.events,this.displayList,this.updateList,this.events.once(SceneEvents$c.BOOT,this.boot,this),this.events.on(SceneEvents$c.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(SceneEvents$c.DESTROY,this.destroy,this)},start:function(){this.events.once(SceneEvents$c.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.events.off(SceneEvents$c.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(SceneEvents$c.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});GameObjectCreator$m.register=function(factoryType,factoryFunction){GameObjectCreator$m.prototype.hasOwnProperty(factoryType)||(GameObjectCreator$m.prototype[factoryType]=factoryFunction)},GameObjectCreator$m.remove=function(factoryType){GameObjectCreator$m.prototype.hasOwnProperty(factoryType)&&delete GameObjectCreator$m.prototype[factoryType]},PathFollower_1.register("GameObjectCreator",GameObjectCreator$m,"make");var TweenManager=GameObjectCreator$m,BitmapText_1=Class_1,GameEvents$9=ImageFile_1,EventEmitter$l=eventemitter3.exports,FileTypesManager$w=GetTilesWithinWorldXY_1,GameObjectCreator$l=TweenManager,GameObjectFactory$z=Tween_1,GetFastValue$12=GetFastValue_1,PluginCache$b=PluginCache,Remove$1=Remove_1,GetTilesWithinShape_1=new BitmapText_1({Extends:EventEmitter$l,initialize:function(game){EventEmitter$l.call(this),this.game=game,this.plugins=[],this.scenePlugins=[],this._pendingGlobal=[],this._pendingScene=[],game.isBooted?this.boot():game.events.once(GameEvents$9.BOOT,this.boot,this)},boot:function(){for(var entry,key,plugin,start,mapping,data,config=this.game.config,list=(list=config.installGlobalPlugins).concat(this._pendingGlobal),i=0;i<list.length;i++)entry=list[i],key=GetFastValue$12(entry,"key",null),plugin=GetFastValue$12(entry,"plugin",null),start=GetFastValue$12(entry,"start",!1),mapping=GetFastValue$12(entry,"mapping",null),data=GetFastValue$12(entry,"data",null),key&&(plugin?this.install(key,plugin,start,mapping,data):console.warn("Missing `plugin` for key: "+key));for(list=(list=config.installScenePlugins).concat(this._pendingScene),i=0;i<list.length;i++)entry=list[i],key=GetFastValue$12(entry,"key",null),plugin=GetFastValue$12(entry,"plugin",null),mapping=GetFastValue$12(entry,"mapping",null),key&&(plugin?this.installScenePlugin(key,plugin,mapping):console.warn("Missing `plugin` for key: "+key));this._pendingGlobal=[],this._pendingScene=[],this.game.events.once(GameEvents$9.DESTROY,this.destroy,this)},addToScene:function(sys,globalPlugins,scenePlugins){for(var pluginList,game=this.game,scene=sys.scene,map=sys.settings.map,isBooted=sys.settings.isBooted,i=0;i<globalPlugins.length;i++)game[pluginKey=globalPlugins[i]]?(sys[pluginKey]=game[pluginKey],map.hasOwnProperty(pluginKey)&&(scene[map[pluginKey]]=sys[pluginKey])):"game"===pluginKey&&map.hasOwnProperty(pluginKey)&&(scene[map[pluginKey]]=game);for(var s=0;s<scenePlugins.length;s++)for(pluginList=scenePlugins[s],i=0;i<pluginList.length;i++){var source,mapKey,plugin,pluginKey=pluginList[i];PluginCache$b.hasCore(pluginKey)&&(mapKey=(source=PluginCache$b.getCore(pluginKey)).mapping,plugin=new source.plugin(scene,this,mapKey),sys[mapKey]=plugin,source.custom?scene[mapKey]=plugin:map.hasOwnProperty(mapKey)&&(scene[map[mapKey]]=plugin),isBooted&&plugin.boot())}for(pluginList=this.plugins,i=0;i<pluginList.length;i++){var entry=pluginList[i];entry.mapping&&(scene[entry.mapping]=entry.plugin)}},getDefaultScenePlugins:function(){return this.game.config.defaultPlugins.concat(this.scenePlugins)},installScenePlugin:function(key,instance,mapping,addToScene,fromLoader){if(void 0===fromLoader&&(fromLoader=!1),"function"==typeof instance){if(PluginCache$b.hasCore(key)){if(!fromLoader&&PluginCache$b.hasCore(key))return void console.warn("Scene Plugin key in use: "+key)}else PluginCache$b.register(key,instance,mapping,!0),this.scenePlugins.push(key);addToScene&&(instance=new instance(addToScene,this,key),addToScene.sys[key]=instance,mapping&&""!==mapping&&(addToScene[mapping]=instance),instance.boot())}else console.warn("Invalid Scene Plugin: "+key)},install:function(key,plugin,start,mapping,data){if(void 0===start&&(start=!1),void 0===mapping&&(mapping=null),void 0===data&&(data=null),"function"!=typeof plugin)return console.warn("Invalid Plugin: "+key),null;if(PluginCache$b.hasCustom(key))return console.warn("Plugin key in use: "+key),null;if(null!==mapping&&(start=!0),this.game.isBooted){if(PluginCache$b.registerCustom(key,plugin,mapping,data),start)return this.start(key)}else this._pendingGlobal.push({key:key,plugin:plugin,start:start,mapping:mapping,data:data});return null},getIndex:function(key){for(var list=this.plugins,i=0;i<list.length;i++)if(list[i].key===key)return i;return-1},getEntry:function(idx){idx=this.getIndex(idx);if(-1!==idx)return this.plugins[idx]},isActive:function(entry){entry=this.getEntry(entry);return entry&&entry.active},start:function(key,runAs){var entry=this.getEntry(runAs=void 0===runAs?key:runAs);return entry&&!entry.active?(entry.active=!0,entry.plugin.start()):entry=entry||this.createEntry(key,runAs),entry?entry.plugin:null},createEntry:function(entry,instance){entry=PluginCache$b.getCustom(entry);return entry&&(entry={key:instance,plugin:instance=new entry.plugin(this),active:!0,mapping:entry.mapping,data:entry.data},this.plugins.push(entry),instance.init(entry.data),instance.start()),entry},stop:function(entry){entry=this.getEntry(entry);return entry&&entry.active&&(entry.active=!1,entry.plugin.stop()),this},get:function(key,autoStart){void 0===autoStart&&(autoStart=!0);var entry=this.getEntry(key);if(entry)return entry.plugin;var plugin=this.getClass(key);return plugin&&autoStart?(entry=this.createEntry(key,key))?entry.plugin:null:plugin||null},getClass:function(key){return PluginCache$b.getCustomClass(key)},removeGlobalPlugin:function(key){var entry=this.getEntry(key);entry&&Remove$1(this.plugins,entry),PluginCache$b.removeCustom(key)},removeScenePlugin:function(key){Remove$1(this.scenePlugins,key),PluginCache$b.remove(key)},registerGameObject:function(key,factoryCallback,creatorCallback){return factoryCallback&&GameObjectFactory$z.register(key,factoryCallback),creatorCallback&&GameObjectCreator$l.register(key,creatorCallback),this},removeGameObject:function(key,removeFromFactory,removeFromCreator){return void 0===removeFromCreator&&(removeFromCreator=!0),(removeFromFactory=void 0===removeFromFactory?!0:removeFromFactory)&&GameObjectFactory$z.remove(key),removeFromCreator&&GameObjectCreator$l.remove(key),this},registerFileType:function(key,callback,addToScene){FileTypesManager$w.register(key,callback),addToScene&&addToScene.sys.load&&(addToScene.sys.load[key]=callback)},destroy:function(){for(var i=0;i<this.plugins.length;i++)this.plugins[i].plugin.destroy();PluginCache$b.destroyCustomPlugins(),this.game.noReturn&&PluginCache$b.destroyCorePlugins(),this.game=null,this.plugins=[],this.scenePlugins=[]}}),Clamp$8=Character,SnapFloor$5=builders,Vector2$y=BuildTilesetIndex_1,Size$2=new Class_1({initialize:function(width,height,aspectMode,parent){void 0===width&&(width=0),void 0===height&&(height=width),void 0===aspectMode&&(aspectMode=0),void 0===parent&&(parent=null),this._width=width,this._height=height,this._parent=parent,this.aspectMode=aspectMode,this.aspectRatio=0===height?1:width/height,this.minWidth=0,this.minHeight=0,this.maxWidth=Number.MAX_VALUE,this.maxHeight=Number.MAX_VALUE,this.snapTo=new Vector2$y},setAspectMode:function(value){return this.aspectMode=value=void 0===value?0:value,this.setSize(this._width,this._height)},setSnap:function(snapWidth,snapHeight){return void 0===snapWidth&&(snapWidth=0),void 0===snapHeight&&(snapHeight=snapWidth),this.snapTo.set(snapWidth,snapHeight),this.setSize(this._width,this._height)},setParent:function(parent){return this._parent=parent,this.setSize(this._width,this._height)},setMin:function(width,height){return void 0===width&&(width=0),void 0===height&&(height=width),this.minWidth=Clamp$8(width,0,this.maxWidth),this.minHeight=Clamp$8(height,0,this.maxHeight),this.setSize(this._width,this._height)},setMax:function(width,height){return void 0===width&&(width=Number.MAX_VALUE),void 0===height&&(height=width),this.maxWidth=Clamp$8(width,this.minWidth,Number.MAX_VALUE),this.maxHeight=Clamp$8(height,this.minHeight,Number.MAX_VALUE),this.setSize(this._width,this._height)},setSize:function(width,height){switch(void 0===width&&(width=0),void 0===height&&(height=width),this.aspectMode){case Size$2.NONE:this._width=this.getNewWidth(SnapFloor$5(width,this.snapTo.x)),this._height=this.getNewHeight(SnapFloor$5(height,this.snapTo.y)),this.aspectRatio=0===this._height?1:this._width/this._height;break;case Size$2.WIDTH_CONTROLS_HEIGHT:this._width=this.getNewWidth(SnapFloor$5(width,this.snapTo.x)),this._height=this.getNewHeight(this._width*(1/this.aspectRatio),!1);break;case Size$2.HEIGHT_CONTROLS_WIDTH:this._height=this.getNewHeight(SnapFloor$5(height,this.snapTo.y)),this._width=this.getNewWidth(this._height*this.aspectRatio,!1);break;case Size$2.FIT:this.constrain(width,height,!0);break;case Size$2.ENVELOP:this.constrain(width,height,!1)}return this},setAspectRatio:function(ratio){return this.aspectRatio=ratio,this.setSize(this._width,this._height)},resize:function(width,height){return this._width=this.getNewWidth(SnapFloor$5(width,this.snapTo.x)),this._height=this.getNewHeight(SnapFloor$5(height,this.snapTo.y)),this.aspectRatio=0===this._height?1:this._width/this._height,this},getNewWidth:function(value,checkParent){return void 0===checkParent&&(checkParent=!0),value=Clamp$8(value,this.minWidth,this.maxWidth),value=checkParent&&this._parent&&value>this._parent.width?Math.max(this.minWidth,this._parent.width):value},getNewHeight:function(value,checkParent){return void 0===checkParent&&(checkParent=!0),value=Clamp$8(value,this.minHeight,this.maxHeight),value=checkParent&&this._parent&&value>this._parent.height?Math.max(this.minHeight,this._parent.height):value},constrain:function(width,height,fit){void 0===width&&(width=0),void 0===height&&(height=width),void 0===fit&&(fit=!0),width=this.getNewWidth(width),height=this.getNewHeight(height);var snap=this.snapTo,newRatio=0===height?1:width/height;return fit&&this.aspectRatio>newRatio||!fit&&this.aspectRatio<newRatio?(height=(width=SnapFloor$5(width,snap.x))/this.aspectRatio,0<snap.y&&(width=(height=SnapFloor$5(height,snap.y))*this.aspectRatio)):(fit&&this.aspectRatio<newRatio||!fit&&this.aspectRatio>newRatio)&&(width=(height=SnapFloor$5(height,snap.y))*this.aspectRatio,0<snap.x&&(height=(width=SnapFloor$5(width,snap.x))*(1/this.aspectRatio))),this._width=width,this._height=height,this},fitTo:function(width,height){return this.constrain(width,height,!0)},envelop:function(width,height){return this.constrain(width,height,!1)},setWidth:function(value){return this.setSize(value,this._height)},setHeight:function(value){return this.setSize(this._width,value)},toString:function(){return"[{ Size (width="+this._width+" height="+this._height+" aspectRatio="+this.aspectRatio+" aspectMode="+this.aspectMode+") }]"},setCSS:function(element){element&&element.style&&(element.style.width=this._width+"px",element.style.height=this._height+"px")},copy:function(destination){return destination.setAspectMode(this.aspectMode),destination.aspectRatio=this.aspectRatio,destination.setSize(this.width,this.height)},destroy:function(){this._parent=null,this.snapTo=null},width:{get:function(){return this._width},set:function(value){this.setSize(value,this._height)}},height:{get:function(){return this._height},set:function(value){this.setSize(this._width,value)}}});Size$2.NONE=0,Size$2.WIDTH_CONTROLS_HEIGHT=1,Size$2.HEIGHT_CONTROLS_WIDTH=2,Size$2.FIT=3,Size$2.ENVELOP=4;for(var GetTweens_1=Size$2,CONST$$=ForEachTile_1,RenderTexture_1=Class_1,EventEmitter$k=eventemitter3.exports,Events$z=HexagonalCullTiles_1,GameEvents$8=ImageFile_1,GetInnerHeight=UUID_1,GetTarget=Bob_1,GetScreenOrientation=Blitter_1,NOOP$f=gameConfig,Rectangle$m=HasTileAtWorldXY_1,Size$1=GetTweens_1,SnapFloor$4=builders,Vector2$x=BuildTilesetIndex_1,ParseObject_1=new RenderTexture_1({Extends:EventEmitter$k,initialize:function(game){EventEmitter$k.call(this),this.game=game,this.canvas,this.canvasBounds=new Rectangle$m,this.parent=null,this.parentIsWindow=!1,this.parentSize=new Size$1,this.gameSize=new Size$1,this.baseSize=new Size$1,this.displaySize=new Size$1,this.scaleMode=CONST$$.SCALE_MODE.NONE,this.zoom=1,this._resetZoom=!1,this.displayScale=new Vector2$x(1,1),this.autoRound=!1,this.autoCenter=CONST$$.CENTER.NO_CENTER,this.orientation=CONST$$.ORIENTATION.LANDSCAPE,this.fullscreen,this.fullscreenTarget=null,this._createdFullscreenTarget=!1,this.dirty=!1,this.resizeInterval=500,this._lastCheck=0,this._checkOrientation=!1,this.listeners={orientationChange:NOOP$f,windowResize:NOOP$f,fullScreenChange:NOOP$f,fullScreenError:NOOP$f}},preBoot:function(){this.parseConfig(this.game.config),this.game.events.once(GameEvents$8.BOOT,this.boot,this)},boot:function(){var game=this.game;this.canvas=game.canvas,this.fullscreen=game.device.fullscreen,this.scaleMode!==CONST$$.SCALE_MODE.RESIZE&&this.displaySize.setAspectMode(this.scaleMode),this.scaleMode===CONST$$.SCALE_MODE.NONE?this.resize(this.width,this.height):(this.getParentBounds(),0<this.parentSize.width&&0<this.parentSize.height&&this.displaySize.setParent(this.parentSize),this.refresh()),game.events.on(GameEvents$8.PRE_STEP,this.step,this),game.events.once(GameEvents$8.READY,this.refresh,this),game.events.once(GameEvents$8.DESTROY,this.destroy,this),this.startListeners()},parseConfig:function(config){this.getParent(config),this.getParentBounds();var parentHeight,parentScaleY,width=config.width,height=config.height,scaleMode=config.scaleMode,zoom=config.zoom,autoRound=config.autoRound;"string"==typeof width&&(0===(parentHeight=this.parentSize.width)&&(parentHeight=window.innerWidth),parentScaleY=parseInt(width,10)/100,width=Math.floor(parentHeight*parentScaleY)),"string"==typeof height&&(0===(parentHeight=this.parentSize.height)&&(parentHeight=window.innerHeight),parentScaleY=parseInt(height,10)/100,height=Math.floor(parentHeight*parentScaleY)),this.scaleMode=scaleMode,this.autoRound=autoRound,this.autoCenter=config.autoCenter,this.resizeInterval=config.resizeInterval,autoRound&&(width=Math.floor(width),height=Math.floor(height)),this.gameSize.setSize(width,height),zoom===CONST$$.ZOOM.MAX_ZOOM&&(zoom=this.getMaxZoom()),1!==(this.zoom=zoom)&&(this._resetZoom=!0),this.baseSize.setSize(width,height),autoRound&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),0<config.minWidth&&this.displaySize.setMin(config.minWidth*zoom,config.minHeight*zoom),0<config.maxWidth&&this.displaySize.setMax(config.maxWidth*zoom,config.maxHeight*zoom),this.displaySize.setSize(width,height),this.orientation=GetScreenOrientation(width,height)},getParent:function(config){var DOMRect=config.parent;null!==DOMRect&&(this.parent=GetTarget(DOMRect),this.parentIsWindow=this.parent===document.body,config.expandParent&&config.scaleMode!==CONST$$.SCALE_MODE.NONE&&(DOMRect=this.parent.getBoundingClientRect(),!this.parentIsWindow&&0!==DOMRect.height||(document.documentElement.style.height="100%",document.body.style.height="100%",DOMRect=this.parent.getBoundingClientRect(),this.parentIsWindow||0!==DOMRect.height||(this.parent.style.overflow="hidden",this.parent.style.width="100%",this.parent.style.height="100%"))),config.fullscreenTarget&&!this.fullscreenTarget&&(this.fullscreenTarget=GetTarget(config.fullscreenTarget)))},getParentBounds:function(){if(!this.parent)return!1;var parentSize=this.parentSize,newHeight=this.parent.getBoundingClientRect();this.parentIsWindow&&this.game.device.os.iOS&&(newHeight.height=GetInnerHeight(!0));var newWidth=newHeight.width,newHeight=newHeight.height;return(parentSize.width!==newWidth||parentSize.height!==newHeight)&&(parentSize.setSize(newWidth,newHeight),!0)},lockOrientation:function(orientation){var lock=screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation;return!!lock&&lock.call(screen,orientation)},setParentSize:function(width,height){return this.parentSize.setSize(width,height),this.refresh()},setGameSize:function(width,height){var autoRound=this.autoRound;autoRound&&(width=Math.floor(width),height=Math.floor(height));var previousWidth=this.width,previousHeight=this.height;return this.gameSize.resize(width,height),this.baseSize.resize(width,height),autoRound&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setAspectRatio(width/height),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height,this.refresh(previousWidth,previousHeight)},resize:function(width,height){var styleHeight=this.zoom,autoRound=this.autoRound;autoRound&&(width=Math.floor(width),height=Math.floor(height));var previousWidth=this.width,previousHeight=this.height;this.gameSize.resize(width,height),this.baseSize.resize(width,height),autoRound&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setSize(width*styleHeight,height*styleHeight),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height;var style=this.canvas.style,styleWidth=width*styleHeight,styleHeight=height*styleHeight;return autoRound&&(styleWidth=Math.floor(styleWidth),styleHeight=Math.floor(styleHeight)),styleWidth===width&&styleHeight===height||(style.width=styleWidth+"px",style.height=styleHeight+"px"),this.refresh(previousWidth,previousHeight)},setZoom:function(value){return this.zoom=value,this._resetZoom=!0,this.refresh()},setMaxZoom:function(){return this.zoom=this.getMaxZoom(),this._resetZoom=!0,this.refresh()},refresh:function(previousWidth,previousHeight){void 0===previousWidth&&(previousWidth=this.width),void 0===previousHeight&&(previousHeight=this.height),this.updateScale(),this.updateBounds(),this.updateOrientation(),this.displayScale.set(this.baseSize.width/this.canvasBounds.width,this.baseSize.height/this.canvasBounds.height);var canvasStyle,domStyle=this.game.domContainer;return domStyle&&(this.baseSize.setCSS(domStyle),canvasStyle=this.canvas.style,(domStyle=domStyle.style).transform="scale("+this.displaySize.width/this.baseSize.width+","+this.displaySize.height/this.baseSize.height+")",domStyle.marginLeft=canvasStyle.marginLeft,domStyle.marginTop=canvasStyle.marginTop),this.emit(Events$z.RESIZE,this.gameSize,this.baseSize,this.displaySize,previousWidth,previousHeight),this},updateOrientation:function(){var newOrientation;this._checkOrientation&&(this._checkOrientation=!1,(newOrientation=GetScreenOrientation(this.width,this.height))!==this.orientation&&(this.orientation=newOrientation,this.emit(Events$z.ORIENTATION_CHANGE,newOrientation)))},updateScale:function(){var styleWidth,styleHeight,style=this.canvas.style,width=this.gameSize.width,height=this.gameSize.height,zoom=this.zoom,autoRound=this.autoRound;this.scaleMode===CONST$$.SCALE_MODE.NONE?(this.displaySize.setSize(width*zoom,height*zoom),styleWidth=this.displaySize.width,styleHeight=this.displaySize.height,autoRound&&(styleWidth=Math.floor(styleWidth),styleHeight=Math.floor(styleHeight)),this._resetZoom&&(style.width=styleWidth+"px",style.height=styleHeight+"px",this._resetZoom=!1)):this.scaleMode===CONST$$.SCALE_MODE.RESIZE?(this.displaySize.setSize(this.parentSize.width,this.parentSize.height),this.gameSize.setSize(this.displaySize.width,this.displaySize.height),this.baseSize.setSize(this.displaySize.width,this.displaySize.height),styleWidth=this.displaySize.width,styleHeight=this.displaySize.height,autoRound&&(styleWidth=Math.floor(styleWidth),styleHeight=Math.floor(styleHeight)),this.canvas.width=styleWidth,this.canvas.height=styleHeight):(this.displaySize.setSize(this.parentSize.width,this.parentSize.height),styleWidth=this.displaySize.width,styleHeight=this.displaySize.height,autoRound&&(styleWidth=Math.floor(styleWidth),styleHeight=Math.floor(styleHeight)),style.width=styleWidth+"px",style.height=styleHeight+"px"),this.getParentBounds(),this.updateCenter()},getMaxZoom:function(){var zoomH=SnapFloor$4(this.parentSize.width,this.gameSize.width,0,!0),zoomV=SnapFloor$4(this.parentSize.height,this.gameSize.height,0,!0);return Math.max(Math.min(zoomH,zoomV),1)},updateCenter:function(){var style,offsetX,offsetY,autoCenter=this.autoCenter;autoCenter!==CONST$$.CENTER.NO_CENTER&&(style=(offsetX=this.canvas).style,offsetX=(offsetY=offsetX.getBoundingClientRect()).width,offsetY=offsetY.height,offsetX=Math.floor((this.parentSize.width-offsetX)/2),offsetY=Math.floor((this.parentSize.height-offsetY)/2),autoCenter===CONST$$.CENTER.CENTER_HORIZONTALLY?offsetY=0:autoCenter===CONST$$.CENTER.CENTER_VERTICALLY&&(offsetX=0),style.marginLeft=offsetX+"px",style.marginTop=offsetY+"px")},updateBounds:function(){var bounds=this.canvasBounds,clientRect=this.canvas.getBoundingClientRect();bounds.x=clientRect.left+(window.pageXOffset||0)-(document.documentElement.clientLeft||0),bounds.y=clientRect.top+(window.pageYOffset||0)-(document.documentElement.clientTop||0),bounds.width=clientRect.width,bounds.height=clientRect.height},transformX:function(pageX){return(pageX-this.canvasBounds.left)*this.displayScale.x},transformY:function(pageY){return(pageY-this.canvasBounds.top)*this.displayScale.y},startFullscreen:function(fullscreenOptions){void 0===fullscreenOptions&&(fullscreenOptions={navigationUI:"hide"});var fsTarget,fullscreen=this.fullscreen;fullscreen.available?fullscreen.active||(fsTarget=this.getFullscreenTarget(),fullscreen.keyboard?fsTarget[fullscreen.request](Element.ALLOW_KEYBOARD_INPUT):fsTarget[fullscreen.request](fullscreenOptions)):this.emit(Events$z.FULLSCREEN_UNSUPPORTED)},fullscreenSuccessHandler:function(){this.getParentBounds(),this.refresh(),this.emit(Events$z.ENTER_FULLSCREEN)},fullscreenErrorHandler:function(error){this.removeFullscreenTarget(),this.emit(Events$z.FULLSCREEN_FAILED,error)},getFullscreenTarget:function(){var fsTarget;return this.fullscreenTarget||((fsTarget=document.createElement("div")).style.margin="0",fsTarget.style.padding="0",fsTarget.style.width="100%",fsTarget.style.height="100%",this.fullscreenTarget=fsTarget,this._createdFullscreenTarget=!0),this._createdFullscreenTarget&&(this.canvas.parentNode.insertBefore(this.fullscreenTarget,this.canvas),this.fullscreenTarget.appendChild(this.canvas)),this.fullscreenTarget},removeFullscreenTarget:function(){var fsTarget,parent;!this._createdFullscreenTarget||(fsTarget=this.fullscreenTarget)&&fsTarget.parentNode&&((parent=fsTarget.parentNode).insertBefore(this.canvas,fsTarget),parent.removeChild(fsTarget))},stopFullscreen:function(){var fullscreen=this.fullscreen;if(!fullscreen.available)return this.emit(Events$z.FULLSCREEN_UNSUPPORTED),!1;fullscreen.active&&document[fullscreen.cancel](),this.removeFullscreenTarget(),this.getParentBounds(),this.emit(Events$z.LEAVE_FULLSCREEN),this.refresh()},toggleFullscreen:function(fullscreenOptions){this.fullscreen.active?this.stopFullscreen():this.startFullscreen(fullscreenOptions)},startListeners:function(){var _this=this,listeners=this.listeners;listeners.orientationChange=function(){_this.updateBounds(),_this._checkOrientation=!0,_this.dirty=!0},listeners.windowResize=function(){_this.updateBounds(),_this.dirty=!0},window.addEventListener("orientationchange",listeners.orientationChange,!1),window.addEventListener("resize",listeners.windowResize,!1),this.fullscreen.available&&(listeners.fullScreenChange=function(event){return _this.onFullScreenChange(event)},listeners.fullScreenError=function(event){return _this.onFullScreenError(event)},["webkit","moz",""].forEach(function(prefix){document.addEventListener(prefix+"fullscreenchange",listeners.fullScreenChange,!1),document.addEventListener(prefix+"fullscreenerror",listeners.fullScreenError,!1)}),document.addEventListener("MSFullscreenChange",listeners.fullScreenChange,!1),document.addEventListener("MSFullscreenError",listeners.fullScreenError,!1))},onFullScreenChange:function(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement?this.fullscreenSuccessHandler():this.stopFullscreen()},onFullScreenError:function(){this.removeFullscreenTarget()},step:function(time,delta){this.parent&&(this._lastCheck+=delta,(this.dirty||this._lastCheck>this.resizeInterval)&&(this.getParentBounds()&&this.refresh(),this.dirty=!1,this._lastCheck=0))},stopListeners:function(){var listeners=this.listeners;window.removeEventListener("orientationchange",listeners.orientationChange,!1),window.removeEventListener("resize",listeners.windowResize,!1);["webkit","moz",""].forEach(function(prefix){document.removeEventListener(prefix+"fullscreenchange",listeners.fullScreenChange,!1),document.removeEventListener(prefix+"fullscreenerror",listeners.fullScreenError,!1)}),document.removeEventListener("MSFullscreenChange",listeners.fullScreenChange,!1),document.removeEventListener("MSFullscreenError",listeners.fullScreenError,!1)},destroy:function(){this.removeAllListeners(),this.stopListeners(),this.game=null,this.canvas=null,this.canvasBounds=null,this.parent=null,this.fullscreenTarget=null,this.parentSize.destroy(),this.gameSize.destroy(),this.baseSize.destroy(),this.displaySize.destroy()},isFullscreen:{get:function(){return this.fullscreen.active}},width:{get:function(){return this.gameSize.width}},height:{get:function(){return this.gameSize.height}},isPortrait:{get:function(){return this.orientation===CONST$$.ORIENTATION.PORTRAIT}},isLandscape:{get:function(){return this.orientation===CONST$$.ORIENTATION.LANDSCAPE}},isGamePortrait:{get:function(){return this.height>this.width}},isGameLandscape:{get:function(){return this.width>this.height}}}),GetTileToWorldXYFunction_1={PENDING:0,INIT:1,START:2,LOADING:3,CREATING:4,RUNNING:5,PAUSED:6,SLEEPING:7,SHUTDOWN:8,DESTROYED:9},Pairs_1={ADD:"addfile",COMPLETE:"complete",FILE_COMPLETE:"filecomplete",FILE_KEY_COMPLETE:"filecomplete-",FILE_LOAD_ERROR:"loaderror",FILE_LOAD:"load",FILE_PROGRESS:"fileprogress",POST_PROCESS:"postprocess",PROGRESS:"progress",START:"start"},UppercaseFirst_1=function(str){return str&&str[0].toUpperCase()+str.slice(1)},GetFastValue$11=GetFastValue_1,UppercaseFirst$1=UppercaseFirst_1,GetTileToWorldXFunction_1=function(sceneSystems){var defaultSystem=sceneSystems.game.config.defaultPhysicsSystem,sceneSystems=GetFastValue$11(sceneSystems.settings,"physics",!1);if(defaultSystem||sceneSystems){var output=[];if(defaultSystem&&output.push(UppercaseFirst$1(defaultSystem+"Physics")),sceneSystems)for(var key in sceneSystems)key=UppercaseFirst$1(key.concat("Physics")),-1===output.indexOf(key)&&output.push(key);return output}},GetFastValue$10=GetFastValue_1,HexagonalTileToWorldXY_1=function(scenePlugins){var defaultPlugins=scenePlugins.plugins.getDefaultScenePlugins(),scenePlugins=GetFastValue$10(scenePlugins.settings,"plugins",!1);return Array.isArray(scenePlugins)?scenePlugins:defaultPlugins||[]},Clone_1$7=function(obj){var key,clone={};for(key in obj)Array.isArray(obj[key])?clone[key]=obj[key].slice(0):clone[key]=obj[key];return clone},Clone$c=Clone_1$7,Merge_1=function(obj1,obj2){var key,clone=Clone$c(obj1);for(key in obj2)clone.hasOwnProperty(key)||(clone[key]=obj2[key]);return clone},CONST$Z=GetTileToWorldXYFunction_1,GetValue$q=GetValue_1,Merge$3=Merge_1,InjectionMap={game:"game",renderer:"renderer",anims:"anims",cache:"cache",plugins:"plugins",registry:"registry",scale:"scale",sound:"sound",textures:"textures",events:"events",cameras:"cameras",add:"add",make:"make",scenePlugin:"scene",displayList:"children",lights:"lights",data:"data",input:"input",load:"load",time:"time",tweens:"tweens",arcadePhysics:"physics",impactPhysics:"impact",matterPhysics:"matter"},ParseTileLayers_1={create:function(config){return"string"==typeof config?config={key:config}:void 0===config&&(config={}),{status:CONST$Z.PENDING,key:GetValue$q(config,"key",""),active:GetValue$q(config,"active",!1),visible:GetValue$q(config,"visible",!0),isBooted:!1,isTransition:!1,transitionFrom:null,transitionDuration:0,transitionAllowInput:!0,data:{},pack:GetValue$q(config,"pack",!1),cameras:GetValue$q(config,"cameras",null),map:GetValue$q(config,"map",Merge$3(InjectionMap,GetValue$q(config,"mapAdd",{}))),physics:GetValue$q(config,"physics",{}),loader:GetValue$q(config,"loader",{}),plugins:GetValue$q(config,"plugins",!1),input:GetValue$q(config,"input",{})}}},CONST$Y=GetTileToWorldXYFunction_1,DefaultPlugins=ParseCSV_1,Events$y=events$g,GetPhysicsPlugins=GetTileToWorldXFunction_1,GetScenePlugins=HexagonalTileToWorldXY_1,GLOBAL_CONST=Extend,NOOP$e=gameConfig,Settings=ParseTileLayers_1,ParseJSONTiled_1=new Class_1({initialize:function(scene,config){this.scene=scene,this.game,this.renderer,this.config=config,this.settings=Settings.create(config),this.canvas,this.context,this.anims,this.cache,this.plugins,this.registry,this.scale,this.sound,this.textures,this.add,this.cameras,this.displayList,this.events,this.make,this.scenePlugin,this.updateList,this.sceneUpdate=NOOP$e},init:function(pluginManager){this.settings.status=CONST$Y.INIT,this.sceneUpdate=NOOP$e,this.game=pluginManager,this.renderer=pluginManager.renderer,this.canvas=pluginManager.canvas,this.context=pluginManager.context;pluginManager=pluginManager.plugins;(this.plugins=pluginManager).addToScene(this,DefaultPlugins.Global,[DefaultPlugins.CoreScene,GetScenePlugins(this),GetPhysicsPlugins(this)]),this.events.emit(Events$y.BOOT,this),this.settings.isBooted=!0},step:function(time,delta){var events=this.events;events.emit(Events$y.PRE_UPDATE,time,delta),events.emit(Events$y.UPDATE,time,delta),this.sceneUpdate.call(this.scene,time,delta),events.emit(Events$y.POST_UPDATE,time,delta)},render:function(renderer){var displayList=this.displayList;displayList.depthSort(),this.events.emit(Events$y.PRE_RENDER,renderer),this.cameras.render(renderer,displayList),this.events.emit(Events$y.RENDER,renderer)},queueDepthSort:function(){this.displayList.queueDepthSort()},depthSort:function(){this.displayList.depthSort()},pause:function(data){var events=this.events,settings=this.settings;return this.settings.active&&(settings.status=CONST$Y.PAUSED,settings.active=!1,events.emit(Events$y.PAUSE,this,data)),this},resume:function(data){var events=this.events,settings=this.settings;return this.settings.active||(settings.status=CONST$Y.RUNNING,settings.active=!0,events.emit(Events$y.RESUME,this,data)),this},sleep:function(data){var events=this.events,settings=this.settings;return settings.status=CONST$Y.SLEEPING,settings.active=!1,settings.visible=!1,events.emit(Events$y.SLEEP,this,data),this},wake:function(data){var events=this.events,settings=this.settings;return settings.status=CONST$Y.RUNNING,settings.active=!0,settings.visible=!0,events.emit(Events$y.WAKE,this,data),settings.isTransition&&events.emit(Events$y.TRANSITION_WAKE,settings.transitionFrom,settings.transitionDuration),this},getData:function(){return this.settings.data},isSleeping:function(){return this.settings.status===CONST$Y.SLEEPING},isActive:function(){return this.settings.status===CONST$Y.RUNNING},isPaused:function(){return this.settings.status===CONST$Y.PAUSED},isTransitioning:function(){return this.settings.isTransition||null!==this.scenePlugin._target},isTransitionOut:function(){return null!==this.scenePlugin._target&&0<this.scenePlugin._duration},isTransitionIn:function(){return this.settings.isTransition},isVisible:function(){return this.settings.visible},setVisible:function(value){return this.settings.visible=value,this},setActive:function(value,data){return value?this.resume(data):this.pause(data)},start:function(data){var events=this.events,settings=this.settings;data&&(settings.data=data),settings.status=CONST$Y.START,settings.active=!0,settings.visible=!0,events.emit(Events$y.START,this),events.emit(Events$y.READY,this,data)},shutdown:function(data){var events=this.events,settings=this.settings;events.off(Events$y.TRANSITION_INIT),events.off(Events$y.TRANSITION_START),events.off(Events$y.TRANSITION_COMPLETE),events.off(Events$y.TRANSITION_OUT),settings.status=CONST$Y.SHUTDOWN,settings.active=!1,settings.visible=!1,this.renderer===GLOBAL_CONST.WEBGL&&this.renderer.resetTextures(!0),events.emit(Events$y.SHUTDOWN,this,data)},destroy:function(){var events=this.events,settings=this.settings;settings.status=CONST$Y.DESTROYED,settings.active=!1,settings.visible=!1,events.emit(Events$y.DESTROY,this),events.removeAllListeners();for(var props=["scene","game","anims","cache","plugins","registry","sound","textures","add","camera","displayList","events","make","scenePlugin","updateList"],i=0;i<props.length;i++)this[props[i]]=null}}),Systems$1=ParseJSONTiled_1,Scene_1=new Class_1({initialize:function(config){this.sys=new Systems$1(this,config),this.game,this.anims,this.cache,this.registry,this.sound,this.textures,this.events,this.cameras,this.add,this.make,this.scene,this.children,this.lights,this.data,this.input,this.load,this.time,this.tweens,this.physics,this.matter,this.scale,this.plugins,this.renderer},update:function(){}}),CONST$X=GetTileToWorldXYFunction_1,Events$x=events$g,GameEvents$7=ImageFile_1,GetValue$p=GetValue_1,LoaderEvents$1=Pairs_1,NOOP$d=gameConfig,Scene$1=Scene_1,Systems=ParseJSONTiled_1,FromOrientationString_1=new Class_1({initialize:function(game,sceneConfig){if(this.game=game,this.keys={},this.scenes=[],this._pending=[],this._start=[],this._queue=[],this._data={},this.isProcessing=!1,this.isBooted=!1,this.customViewports=0,sceneConfig){Array.isArray(sceneConfig)||(sceneConfig=[sceneConfig]);for(var i=0;i<sceneConfig.length;i++)this._pending.push({key:"default",scene:sceneConfig[i],autoStart:0===i,data:{}})}game.events.once(GameEvents$7.READY,this.bootQueue,this)},bootQueue:function(){if(!this.isBooted){for(var i=0;i<this._pending.length;i++){var newScene,entry,sceneConfig,key=(entry=this._pending[i]).key;(sceneConfig=entry.scene)instanceof Scene$1?newScene=this.createSceneFromInstance(key,sceneConfig):"object"==typeof sceneConfig?newScene=this.createSceneFromObject(key,sceneConfig):"function"==typeof sceneConfig&&(newScene=this.createSceneFromFunction(key,sceneConfig)),key=newScene.sys.settings.key,this.keys[key]=newScene,this.scenes.push(newScene),this._data[key]&&(newScene.sys.settings.data=this._data[key].data,this._data[key].autoStart&&(entry.autoStart=!0)),(entry.autoStart||newScene.sys.settings.active)&&this._start.push(key)}for(this._pending.length=0,this._data={},this.isBooted=!0,i=0;i<this._start.length;i++)entry=this._start[i],this.start(entry);this._start.length=0}},processQueue:function(){var i,entry,pendingLength=this._pending.length,queueLength=this._queue.length;if(0!==pendingLength||0!==queueLength){if(pendingLength){for(i=0;i<pendingLength;i++)entry=this._pending[i],this.add(entry.key,entry.scene,entry.autoStart,entry.data);for(i=0;i<this._start.length;i++)entry=this._start[i],this.start(entry);return this._start.length=0,void(this._pending.length=0)}for(i=0;i<this._queue.length;i++)this[(entry=this._queue[i]).op](entry.keyA,entry.keyB);this._queue.length=0}},add:function(key,sceneConfig,autoStart,data){return void 0===autoStart&&(autoStart=!1),void 0===data&&(data={}),this.isProcessing||!this.isBooted?(this._pending.push({key:key,scene:sceneConfig,autoStart:autoStart,data:data}),this.isBooted||(this._data[key]={data:data}),null):(key=this.getKey(key,sceneConfig),sceneConfig instanceof Scene$1?newScene=this.createSceneFromInstance(key,sceneConfig):"object"==typeof sceneConfig?(sceneConfig.key=key,newScene=this.createSceneFromObject(key,sceneConfig)):"function"==typeof sceneConfig&&(newScene=this.createSceneFromFunction(key,sceneConfig)),newScene.sys.settings.data=data,key=newScene.sys.settings.key,this.keys[key]=newScene,this.scenes.push(newScene),(autoStart||newScene.sys.settings.active)&&(this._pending.length?this._start.push(key):this.start(key)),newScene);var newScene},remove:function(sceneKey){if(this.isProcessing)this._queue.push({op:"remove",keyA:sceneKey,keyB:null});else{var sceneToRemove=this.getScene(sceneKey);if(!sceneToRemove||sceneToRemove.sys.isTransitioning())return this;var index=this.scenes.indexOf(sceneToRemove),sceneKey=sceneToRemove.sys.settings.key;-1<index&&(delete this.keys[sceneKey],this.scenes.splice(index,1),-1<this._start.indexOf(sceneKey)&&(index=this._start.indexOf(sceneKey),this._start.splice(index,1)),sceneToRemove.sys.destroy())}return this},bootScene:function(scene){var loader,sys=scene.sys,settings=sys.settings;sys.sceneUpdate=NOOP$d,scene.init&&(scene.init.call(scene,settings.data),settings.status=CONST$X.INIT,settings.isTransition&&sys.events.emit(Events$x.TRANSITION_INIT,settings.transitionFrom,settings.transitionDuration)),sys.load&&(loader=sys.load).reset(),loader&&scene.preload?(scene.preload.call(scene),0===loader.list.size?this.create(scene):(settings.status=CONST$X.LOADING,loader.once(LoaderEvents$1.COMPLETE,this.loadComplete,this),loader.start())):this.create(scene)},loadComplete:function(loader){this.create(loader.scene)},payloadComplete:function(loader){this.bootScene(loader.scene)},update:function(time,delta){this.processQueue(),this.isProcessing=!0;for(var i=this.scenes.length-1;0<=i;i--){var sys=this.scenes[i].sys;sys.settings.status>CONST$X.START&&sys.settings.status<=CONST$X.RUNNING&&sys.step(time,delta)}},render:function(renderer){for(var i=0;i<this.scenes.length;i++){var sys=this.scenes[i].sys;sys.settings.visible&&sys.settings.status>=CONST$X.LOADING&&sys.settings.status<CONST$X.SLEEPING&&sys.render(renderer)}this.isProcessing=!1},create:function(scene){var sys=scene.sys,settings=sys.settings;scene.create&&(settings.status=CONST$X.CREATING,scene.create.call(scene,settings.data),settings.status===CONST$X.DESTROYED)||(settings.isTransition&&sys.events.emit(Events$x.TRANSITION_START,settings.transitionFrom,settings.transitionDuration),scene.update&&(sys.sceneUpdate=scene.update),settings.status=CONST$X.RUNNING,sys.events.emit(Events$x.CREATE,scene))},createSceneFromFunction:function(key,configKey){var newScene=new configKey;if(newScene instanceof Scene$1){configKey=newScene.sys.settings.key;if(this.keys.hasOwnProperty(key=""!==configKey?configKey:key))throw new Error("Cannot add a Scene with duplicate key: "+key);return this.createSceneFromInstance(key,newScene)}return newScene.sys=new Systems(newScene),newScene.sys.settings.key=key,newScene.sys.init(this.game),newScene},createSceneFromInstance:function(key,newScene){return""===newScene.sys.settings.key&&(newScene.sys.settings.key=key),newScene.sys.init(this.game),newScene},createSceneFromObject:function(key,sceneConfig){var newScene=new Scene$1(sceneConfig),configKey=newScene.sys.settings.key;""!==configKey?key=configKey:newScene.sys.settings.key=key,newScene.sys.init(this.game);for(var value,defaults=["init","preload","create","update","render"],i=0;i<defaults.length;i++){var sceneCallback=GetValue$p(sceneConfig,defaults[i],null);sceneCallback&&(newScene[defaults[i]]=sceneCallback)}if(sceneConfig.hasOwnProperty("extend"))for(var propertyKey in sceneConfig.extend)sceneConfig.extend.hasOwnProperty(propertyKey)&&(value=sceneConfig.extend[propertyKey],"data"===propertyKey&&newScene.hasOwnProperty("data")&&"object"==typeof value?newScene.data.merge(value):"sys"!==propertyKey&&(newScene[propertyKey]=value));return newScene},getKey:function(key,sceneConfig){if(key=key||"default","function"==typeof sceneConfig)return key;if(sceneConfig instanceof Scene$1?key=sceneConfig.sys.settings.key:"object"==typeof sceneConfig&&sceneConfig.hasOwnProperty("key")&&(key=sceneConfig.key),this.keys.hasOwnProperty(key))throw new Error("Cannot add a Scene with duplicate key: "+key);return key},getScenes:function(isActive,inReverse){void 0===isActive&&(isActive=!0),void 0===inReverse&&(inReverse=!1);for(var out=[],scenes=this.scenes,i=0;i<scenes.length;i++){var scene=scenes[i];scene&&(!isActive||isActive&&scene.sys.isActive())&&out.push(scene)}return inReverse?out.reverse():out},getScene:function(key){if("string"==typeof key){if(this.keys[key])return this.keys[key]}else for(var i=0;i<this.scenes.length;i++)if(key===this.scenes[i])return key;return null},isActive:function(scene){scene=this.getScene(scene);return scene?scene.sys.isActive():null},isPaused:function(scene){scene=this.getScene(scene);return scene?scene.sys.isPaused():null},isVisible:function(scene){scene=this.getScene(scene);return scene?scene.sys.isVisible():null},isSleeping:function(scene){scene=this.getScene(scene);return scene?scene.sys.isSleeping():null},pause:function(scene,data){scene=this.getScene(scene);return scene&&scene.sys.pause(data),this},resume:function(scene,data){scene=this.getScene(scene);return scene&&scene.sys.resume(data),this},sleep:function(scene,data){scene=this.getScene(scene);return scene&&!scene.sys.isTransitioning()&&scene.sys.sleep(data),this},wake:function(scene,data){scene=this.getScene(scene);return scene&&scene.sys.wake(data),this},run:function(key,data){var scene=this.getScene(key);if(!scene){for(var i=0;i<this._pending.length;i++)if(this._pending[i].key===key){this.queueOp("start",key,data);break}return this}scene.sys.isSleeping()?scene.sys.wake(data):scene.sys.isPaused()?scene.sys.resume(data):this.start(key,data)},start:function(sys,data){if(!this.isBooted)return this._data[sys]={autoStart:!0,data:data},this;var scene=this.getScene(sys);if(scene){var loader,sys=scene.sys;if(sys.isActive()||sys.isPaused())sys.shutdown(),sys.sceneUpdate=NOOP$d,sys.start(data);else if(sys.sceneUpdate=NOOP$d,sys.start(data),(loader=sys.load?sys.load:loader)&&sys.settings.hasOwnProperty("pack")&&(loader.reset(),loader.addPack({payload:sys.settings.pack})))return sys.settings.status=CONST$X.LOADING,loader.once(LoaderEvents$1.COMPLETE,this.payloadComplete,this),loader.start(),this;this.bootScene(scene)}return this},stop:function(scene,data){scene=this.getScene(scene);return scene&&!scene.sys.isTransitioning()&&scene.sys.shutdown(data),this},switch:function(from,to){var sceneA=this.getScene(from),sceneB=this.getScene(to);return sceneA&&sceneB&&sceneA!==sceneB&&(this.sleep(from),this.isSleeping(to)?this.wake(to):this.start(to)),this},getAt:function(index){return this.scenes[index]},getIndex:function(scene){scene=this.getScene(scene);return this.scenes.indexOf(scene)},bringToTop:function(scene){var index;return this.isProcessing?this._queue.push({op:"bringToTop",keyA:scene,keyB:null}):-1!==(index=this.getIndex(scene))&&index<this.scenes.length&&(scene=this.getScene(scene),this.scenes.splice(index,1),this.scenes.push(scene)),this},sendToBack:function(scene){var index;return this.isProcessing?this._queue.push({op:"sendToBack",keyA:scene,keyB:null}):-1!==(index=this.getIndex(scene))&&0<index&&(scene=this.getScene(scene),this.scenes.splice(index,1),this.scenes.unshift(scene)),this},moveDown:function(sceneB){var indexA,indexB,sceneA;return this.isProcessing?this._queue.push({op:"moveDown",keyA:sceneB,keyB:null}):0<(indexA=this.getIndex(sceneB))&&(indexB=indexA-1,sceneA=this.getScene(sceneB),sceneB=this.getAt(indexB),this.scenes[indexA]=sceneB,this.scenes[indexB]=sceneA),this},moveUp:function(sceneB){var indexA,indexB,sceneA;return this.isProcessing?this._queue.push({op:"moveUp",keyA:sceneB,keyB:null}):(indexA=this.getIndex(sceneB))<this.scenes.length-1&&(indexB=indexA+1,sceneA=this.getScene(sceneB),sceneB=this.getAt(indexB),this.scenes[indexA]=sceneB,this.scenes[indexB]=sceneA),this},moveAbove:function(indexB,tempScene){return indexB===tempScene||(this.isProcessing?this._queue.push({op:"moveAbove",keyA:indexB,keyB:tempScene}):(indexA=this.getIndex(indexB),indexB=this.getIndex(tempScene),-1!==indexA&&-1!==indexB&&(tempScene=this.getAt(indexB),this.scenes.splice(indexB,1),this.scenes.splice(indexA+1,0,tempScene)))),this;var indexA},moveBelow:function(indexB,tempScene){return indexB===tempScene||(this.isProcessing?this._queue.push({op:"moveBelow",keyA:indexB,keyB:tempScene}):(indexA=this.getIndex(indexB),indexB=this.getIndex(tempScene),-1!==indexA&&-1!==indexB&&(tempScene=this.getAt(indexB),this.scenes.splice(indexB,1),0===indexA?this.scenes.unshift(tempScene):this.scenes.splice(indexA,0,tempScene)))),this;var indexA},queueOp:function(op,keyA,keyB){return this._queue.push({op:op,keyA:keyA,keyB:keyB}),this},swapPosition:function(indexB,tempScene){return indexB===tempScene||(this.isProcessing?this._queue.push({op:"swapPosition",keyA:indexB,keyB:tempScene}):(indexA=this.getIndex(indexB))!==(indexB=this.getIndex(tempScene))&&-1!==indexA&&-1!==indexB&&(tempScene=this.getAt(indexA),this.scenes[indexA]=this.scenes[indexB],this.scenes[indexB]=tempScene)),this;var indexA},dump:function(){for(var out=[],map=["pending","init","start","loading","creating","running","paused","sleeping","shutdown","destroyed"],i=0;i<this.scenes.length;i++){var sys=this.scenes[i].sys,key=!sys.settings.visible||sys.settings.status!==CONST$X.RUNNING&&sys.settings.status!==CONST$X.PAUSED?"[-] ":"[*] ";key+=sys.settings.key+" ("+map[sys.settings.status]+")",out.push(key)}console.log(out.join("\n"))},destroy:function(){for(var i=0;i<this.scenes.length;i++)this.scenes[i].sys.destroy();this.update=NOOP$d,this.scenes=[],this._pending=[],this._start=[],this._queue=[],this.game=null}}),Clamp$7=Character,Extend$j=Extend_1$1,Frame$4=new Class_1({initialize:function(texture,name,sourceIndex,x,y,width,height){this.texture=texture,this.name=name,this.source=texture.source[sourceIndex],this.sourceIndex=sourceIndex,this.glTexture=this.source.glTexture,this.cutX,this.cutY,this.cutWidth,this.cutHeight,this.x=0,this.y=0,this.width,this.height,this.halfWidth,this.halfHeight,this.centerX,this.centerY,this.pivotX=0,this.pivotY=0,this.customPivot=!1,this.rotated=!1,this.autoRound=-1,this.customData={},this.u0=0,this.v0=0,this.u1=0,this.v1=0,this.data={cut:{x:0,y:0,w:0,h:0,r:0,b:0},trim:!1,sourceSize:{w:0,h:0},spriteSourceSize:{x:0,y:0,w:0,h:0,r:0,b:0},radius:0,drawImage:{x:0,y:0,width:0,height:0}},this.setSize(width,height,x,y)},setSize:function(width,height,x,y){void 0===y&&(y=0),this.cutX=x=void 0===x?0:x,this.cutY=y,this.cutWidth=width,this.cutHeight=height,this.width=width,this.height=height,this.halfWidth=Math.floor(.5*width),this.halfHeight=Math.floor(.5*height),this.centerX=Math.floor(width/2),this.centerY=Math.floor(height/2);var drawImage=this.data,cut=drawImage.cut;cut.x=x,cut.y=y,cut.w=width,cut.h=height,cut.r=x+width,cut.b=y+height,drawImage.sourceSize.w=width,drawImage.sourceSize.h=height,drawImage.spriteSourceSize.w=width,drawImage.spriteSourceSize.h=height,drawImage.radius=.5*Math.sqrt(width*width+height*height);drawImage=drawImage.drawImage;return drawImage.x=x,drawImage.y=y,drawImage.width=width,drawImage.height=height,this.updateUVs()},setTrim:function(actualWidth,actualHeight,destX,destY,destWidth,destHeight){var data=this.data,ss=data.spriteSourceSize;return data.trim=!0,data.sourceSize.w=actualWidth,data.sourceSize.h=actualHeight,ss.x=destX,ss.y=destY,ss.w=destWidth,ss.h=destHeight,ss.r=destX+destWidth,ss.b=destY+destHeight,this.x=destX,this.y=destY,this.width=destWidth,this.height=destHeight,this.halfWidth=.5*destWidth,this.halfHeight=.5*destHeight,this.centerX=Math.floor(destWidth/2),this.centerY=Math.floor(destHeight/2),this.updateUVs()},setCropUVs:function(crop,x,y,width,height,flipX,flipY){var ss,iw,cx=this.cutX,tw=this.cutY,cw=this.cutWidth,th=this.cutHeight,ih=this.realWidth,ix=this.realHeight,ox=cx+(x=Clamp$7(x,0,ih)),oy=tw+(y=Clamp$7(y,0,ix)),ow=width=Clamp$7(width,0,ih-x),oh=height=Clamp$7(height,0,ix-y),iy=this.data;iy.trim?(ss=iy.spriteSourceSize,iw=x+(width=Clamp$7(width,0,cw-x)),ih=y+(height=Clamp$7(height,0,th-y)),!(ss.r<x||ss.b<y||ss.x>iw||ss.y>ih)?(ix=Math.max(ss.x,x),iy=Math.max(ss.y,y),iw=Math.min(ss.r,iw)-ix,ih=Math.min(ss.b,ih)-iy,ox=flipX?cx+(cw-(ix-ss.x)-iw):cx+(ix-ss.x),oy=flipY?tw+(th-(iy-ss.y)-ih):tw+(iy-ss.y),x=ix,y=iy,width=ow=iw,height=oh=ih):oh=ow=oy=ox=0):(flipX&&(ox=cx+(cw-x-width)),flipY&&(oy=tw+(th-y-height)));tw=this.source.width,th=this.source.height;return crop.u0=Math.max(0,ox/tw),crop.v0=Math.max(0,oy/th),crop.u1=Math.min(1,(ox+ow)/tw),crop.v1=Math.min(1,(oy+oh)/th),crop.x=x,crop.y=y,crop.cx=ox,crop.cy=oy,crop.cw=ow,crop.ch=oh,crop.width=width,crop.height=height,crop.flipX=flipX,crop.flipY=flipY,crop},updateCropUVs:function(crop,flipX,flipY){return this.setCropUVs(crop,crop.x,crop.y,crop.width,crop.height,flipX,flipY)},setUVs:function(width,height,u0,v0,u1,v1){var cd=this.data.drawImage;return cd.width=width,cd.height=height,this.u0=u0,this.v0=v0,this.u1=u1,this.v1=v1,this},updateUVs:function(){var cx=this.cutX,cy=this.cutY,cw=this.cutWidth,ch=this.cutHeight,th=this.data.drawImage;th.width=cw,th.height=ch;var tw=this.source.width,th=this.source.height;return this.u0=cx/tw,this.v0=cy/th,this.u1=(cx+cw)/tw,this.v1=(cy+ch)/th,this},updateUVsInverted:function(){var tw=this.source.width,th=this.source.height;return this.u0=(this.cutX+this.cutHeight)/tw,this.v0=this.cutY/th,this.u1=this.cutX/tw,this.v1=(this.cutY+this.cutWidth)/th,this},clone:function(){var clone=new Frame$4(this.texture,this.name,this.sourceIndex);return clone.cutX=this.cutX,clone.cutY=this.cutY,clone.cutWidth=this.cutWidth,clone.cutHeight=this.cutHeight,clone.x=this.x,clone.y=this.y,clone.width=this.width,clone.height=this.height,clone.halfWidth=this.halfWidth,clone.halfHeight=this.halfHeight,clone.centerX=this.centerX,clone.centerY=this.centerY,clone.rotated=this.rotated,clone.data=Extend$j(!0,clone.data,this.data),clone.updateUVs(),clone},destroy:function(){this.source=null,this.texture=null,this.glTexture=null,this.customData=null,this.data=null},realWidth:{get:function(){return this.data.sourceSize.w}},realHeight:{get:function(){return this.data.sourceSize.h}},radius:{get:function(){return this.data.radius}},trimmed:{get:function(){return this.data.trim}},canvasData:{get:function(){return this.data.drawImage}}}),ParseWeltmeister_1=Frame$4,CanvasPool$6=SetValue_1,IsSizePowerOfTwo$1=MatterGameObject_1,ScaleModes=ScaleModes_1,GetWorldToTileYFunction_1=new Class_1({initialize:function(texture,source,width,height,flipY){void 0===flipY&&(flipY=!1);var game=texture.manager.game;this.renderer=game.renderer,this.texture=texture,this.source=source,this.image=source,this.compressionAlgorithm=null,this.resolution=1,this.width=width||source.naturalWidth||source.videoWidth||source.width||0,this.height=height||source.naturalHeight||source.videoHeight||source.height||0,this.scaleMode=ScaleModes.DEFAULT,this.isCanvas=source instanceof HTMLCanvasElement,this.isVideo=window.hasOwnProperty("HTMLVideoElement")&&source instanceof HTMLVideoElement,this.isRenderTexture="RenderTexture"===source.type,this.isGLTexture=window.hasOwnProperty("WebGLTexture")&&source instanceof WebGLTexture,this.isPowerOf2=IsSizePowerOfTwo$1(this.width,this.height),this.glTexture=null,this.glIndex=0,this.glIndexCounter=-1,this.flipY=flipY,this.init(game)},init:function(game){var renderer=this.renderer;renderer&&(renderer.gl?this.isCanvas?this.glTexture=renderer.createCanvasTexture(this.image,!1,this.flipY):this.isVideo?this.glTexture=renderer.createVideoTexture(this.image,!1,this.flipY):this.isRenderTexture?(this.image=this.source.canvas,this.glTexture=renderer.createTextureFromSource(null,this.width,this.height,this.scaleMode)):this.isGLTexture?this.glTexture=this.source:this.glTexture=renderer.createTextureFromSource(this.image,this.width,this.height,this.scaleMode):this.isRenderTexture&&(this.image=this.source.canvas)),game.config.antialias||this.setFilter(1)},setFilter:function(filterMode){this.renderer.gl&&this.renderer.setTextureFilter(this.glTexture,filterMode),this.scaleMode=filterMode},setFlipY:function(value){return this.flipY=value=void 0===value?!0:value,this},update:function(){var gl=this.renderer.gl;gl&&this.isCanvas?this.glTexture=this.renderer.updateCanvasTexture(this.image,this.glTexture,this.flipY):gl&&this.isVideo&&(this.glTexture=this.renderer.updateVideoTexture(this.image,this.glTexture,this.flipY))},destroy:function(){this.glTexture&&this.renderer.deleteTexture(this.glTexture,!0),this.isCanvas&&CanvasPool$6.remove(this.image),this.renderer=null,this.texture=null,this.source=null,this.image=null,this.glTexture=null}}),CONST$W=Extend,Frame$3=ParseWeltmeister_1,TextureSource=GetWorldToTileYFunction_1,HexagonalWorldToTileY_1=new Class_1({initialize:function(manager,key,source,width,height){Array.isArray(source)||(source=[source]),this.manager=manager,this.key=key,this.source=[],this.dataSource=[],this.frames={},this.customData={},this.firstFrame="__BASE";for(var i=this.frameTotal=0;i<source.length;i++)this.source.push(new TextureSource(this,source[i],width,height))},add:function(name,sourceIndex,x,y,width,frame){if(this.has(name))return null;frame=new Frame$3(this,name,sourceIndex,x,y,width,frame);return this.frames[name]=frame,"__BASE"===this.firstFrame&&(this.firstFrame=name),this.frameTotal++,frame},remove:function(name){return!!this.has(name)&&(this.get(name).destroy(),delete this.frames[name],!0)},has:function(name){return this.frames[name]},get:function(name){name=name||this.firstFrame;var frame=this.frames[name];return frame||(console.warn("Texture.frame missing: "+name),frame=this.frames[this.firstFrame]),frame},getTextureSourceIndex:function(source){for(var i=0;i<this.source.length;i++)if(this.source[i]===source)return i;return-1},getFramesFromTextureSource:function(sourceIndex,includeBase){void 0===includeBase&&(includeBase=!1);var frameName,frame,out=[];for(frameName in this.frames)"__BASE"===frameName&&!includeBase||(frame=this.frames[frameName]).sourceIndex===sourceIndex&&out.push(frame);return out},getFrameNames:function(idx){void 0===idx&&(idx=!1);var out=Object.keys(this.frames);return idx||-1!==(idx=out.indexOf("__BASE"))&&out.splice(idx,1),out},getSourceImage:function(name){null!=name&&1!==this.frameTotal||(name="__BASE");var frame=this.frames[name];return frame?frame.source.image:(console.warn("Texture.frame missing: "+name),this.frames.__BASE.source.image)},getDataSourceImage:function(idx){null!=idx&&1!==this.frameTotal||(idx="__BASE");var frame=this.frames[idx],idx=frame?frame.sourceIndex:(console.warn("Texture.frame missing: "+idx),this.frames.__BASE.sourceIndex);return this.dataSource[idx].image},setDataSource:function(data){Array.isArray(data)||(data=[data]);for(var i=0;i<data.length;i++){var source=this.source[i];this.dataSource.push(new TextureSource(this,data[i],source.width,source.height))}},setFilter:function(filterMode){for(var i=0;i<this.source.length;i++)this.source[i].setFilter(filterMode);for(i=0;i<this.dataSource.length;i++)this.dataSource[i].setFilter(filterMode)},destroy:function(){for(var frameName,i=0;i<this.source.length;i++)this.source[i].destroy();for(i=0;i<this.dataSource.length;i++)this.dataSource[i].destroy();for(frameName in this.frames)this.frames[frameName].destroy();this.source=[],this.dataSource=[],this.frames={},this.manager.removeKey(this.key);var renderer=this.manager.game.renderer;renderer&&renderer.type===CONST$W.WEBGL&&renderer.resetTextures(!0),this.manager=null}}),Clamp$6=Character,Color$2=Container_1,CONST$V=Extend,IsSizePowerOfTwo=MatterGameObject_1,Texture$1=HexagonalWorldToTileY_1,ParseTileLayers_1$1=new Class_1({Extends:Texture$1,initialize:function(manager,key,source,width,height){Texture$1.call(this,manager,key,source,width,height),this.add("__BASE",0,0,0,width,height),this._source=this.frames.__BASE.source,this.canvas=this._source.image,this.context=this.canvas.getContext("2d"),this.width=width,this.height=height,this.imageData=this.context.getImageData(0,0,width,height),this.data=null,this.imageData&&(this.data=this.imageData.data),this.pixels=null,this.buffer,this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data)},update:function(){return this.imageData=this.context.getImageData(0,0,this.width,this.height),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this.manager.game.config.renderType===CONST$V.WEBGL&&this.refresh(),this},draw:function(x,y,source){return this.context.drawImage(source,x,y),this.update()},drawFrame:function(height,res,x,y){void 0===x&&(x=0),void 0===y&&(y=0);var textureFrame=this.manager.getFrame(height,res);if(textureFrame){var cd=textureFrame.canvasData,width=textureFrame.cutWidth,height=textureFrame.cutHeight,res=textureFrame.source.resolution;return this.context.drawImage(textureFrame.source.image,cd.x,cd.y,width,height,x,y,width/res,height/res),this.update()}return this},setPixel:function(x,y,red,green,blue,alpha){var imageData;return void 0===alpha&&(alpha=255),x=Math.abs(Math.floor(x)),y=Math.abs(Math.floor(y)),-1<this.getIndex(x,y)&&((imageData=this.context.getImageData(x,y,1,1)).data[0]=red,imageData.data[1]=green,imageData.data[2]=blue,imageData.data[3]=alpha,this.context.putImageData(imageData,x,y)),this},putData:function(imageData,x,y,dirtyX,dirtyY,dirtyWidth,dirtyHeight){return void 0===dirtyWidth&&(dirtyWidth=imageData.width),void 0===dirtyHeight&&(dirtyHeight=imageData.height),this.context.putImageData(imageData,x,y,dirtyX=void 0===dirtyX?0:dirtyX,dirtyY=void 0===dirtyY?0:dirtyY,dirtyWidth,dirtyHeight),this},getData:function(x,y,width,height){return x=Clamp$6(Math.floor(x),0,this.width-1),y=Clamp$6(Math.floor(y),0,this.height-1),width=Clamp$6(width,1,this.width-x),height=Clamp$6(height,1,this.height-y),this.context.getImageData(x,y,width,height)},getPixel:function(g,b,out){out=out||new Color$2;var data,r,a=this.getIndex(g,b);return-1<a&&(r=(data=this.data)[a+0],g=data[a+1],b=data[a+2],a=data[a+3],out.setTo(r,g,b,a)),out},getPixels:function(x,y,top,height){void 0===x&&(x=0),void 0===y&&(y=0),void 0===top&&(top=this.width),void 0===height&&(height=top),x=Math.abs(Math.round(x)),y=Math.abs(Math.round(y));for(var left=Clamp$6(x,0,this.width),right=Clamp$6(x+top,0,this.width),top=Clamp$6(y,0,this.height),bottom=Clamp$6(y+height,0,this.height),pixel=new Color$2,out=[],py=top;py<bottom;py++){for(var row=[],px=left;px<right;px++)pixel=this.getPixel(px,py,pixel),row.push({x:px,y:py,color:pixel.color,alpha:pixel.alphaGL});out.push(row)}return out},getIndex:function(x,y){return x=Math.abs(Math.round(x)),y=Math.abs(Math.round(y)),x<this.width&&y<this.height?4*(x+y*this.width):-1},refresh:function(){return this._source.update(),this},getCanvas:function(){return this.canvas},getContext:function(){return this.context},clear:function(x,y,width,height){return void 0===width&&(width=this.width),void 0===height&&(height=this.height),this.context.clearRect(x=void 0===x?0:x,y=void 0===y?0:y,width,height),this.update()},setSize:function(width,height){return void 0===height&&(height=width),width===this.width&&height===this.height||(this.canvas.width=width,this.canvas.height=height,this._source.width=width,this._source.height=height,this._source.isPowerOf2=IsSizePowerOfTwo(width,height),this.frames.__BASE.setSize(width,height,0,0),this.width=width,this.height=height,this.refresh()),this},destroy:function(){Texture$1.prototype.destroy.call(this),this._source=null,this.canvas=null,this.context=null,this.imageData=null,this.data=null,this.pixels=null,this.buffer=null}}),Clone$b=Clone_1$7,Clone$a=Clone_1$7,GetFastValue$$=GetFastValue_1,GetFastValue$_=GetFastValue_1,imageHeight=0,addFrame=function(texture,sourceIndex,name,frame){var y=imageHeight-frame.y-frame.height;texture.add(name,sourceIndex,frame.x,y,frame.width,frame.height)},GetWorldToTileXYFunction_1={AtlasXML:function(texture,sourceIndex,xml){if(xml.getElementsByTagName("TextureAtlas")){var source=texture.source[sourceIndex];texture.add("__BASE",sourceIndex,0,0,source.width,source.height);for(var frames=xml.getElementsByTagName("SubTexture"),i=0;i<frames.length;i++){var frameHeight=frames[i].attributes,frameX=frameHeight.name.value,frameY=parseInt(frameHeight.x.value,10),frameWidth=parseInt(frameHeight.y.value,10),width=parseInt(frameHeight.width.value,10),height=parseInt(frameHeight.height.value,10),newFrame=texture.add(frameX,sourceIndex,frameY,frameWidth,width,height);frameHeight.frameX&&(frameX=Math.abs(parseInt(frameHeight.frameX.value,10)),frameY=Math.abs(parseInt(frameHeight.frameY.value,10)),frameWidth=parseInt(frameHeight.frameWidth.value,10),frameHeight=parseInt(frameHeight.frameHeight.value,10),newFrame.setTrim(width,height,frameX,frameY,frameWidth,frameHeight))}return texture}console.warn("Invalid Texture Atlas XML given")},Canvas:function(texture,sourceIndex){var source=texture.source[sourceIndex];return texture.add("__BASE",sourceIndex,0,0,source.width,source.height),texture},Image:function(texture,sourceIndex){var source=texture.source[sourceIndex];return texture.add("__BASE",sourceIndex,0,0,source.width,source.height),texture},JSONArray:function(texture,sourceIndex,json){if(json.frames||json.textures){var source=texture.source[sourceIndex];texture.add("__BASE",sourceIndex,0,0,source.width,source.height);for(var dataKey,frames=(Array.isArray(json.textures)?json.textures[sourceIndex]:json).frames,i=0;i<frames.length;i++){var src=frames[i],newFrame=texture.add(src.filename,sourceIndex,src.frame.x,src.frame.y,src.frame.w,src.frame.h);src.trimmed&&newFrame.setTrim(src.sourceSize.w,src.sourceSize.h,src.spriteSourceSize.x,src.spriteSourceSize.y,src.spriteSourceSize.w,src.spriteSourceSize.h),src.rotated&&(newFrame.rotated=!0,newFrame.updateUVsInverted());var pivot=src.anchor||src.pivot;pivot&&(newFrame.customPivot=!0,newFrame.pivotX=pivot.x,newFrame.pivotY=pivot.y),newFrame.customData=Clone$b(src)}for(dataKey in json)"frames"!==dataKey&&(Array.isArray(json[dataKey])?texture.customData[dataKey]=json[dataKey].slice(0):texture.customData[dataKey]=json[dataKey]);return texture}console.warn("Invalid Texture Atlas JSON Array")},JSONHash:function(texture,sourceIndex,json){if(json.frames){var source=texture.source[sourceIndex];texture.add("__BASE",sourceIndex,0,0,source.width,source.height);var key,src,newFrame,pivot,dataKey,frames=json.frames;for(key in frames)frames.hasOwnProperty(key)&&(src=frames[key],newFrame=texture.add(key,sourceIndex,src.frame.x,src.frame.y,src.frame.w,src.frame.h),src.trimmed&&newFrame.setTrim(src.sourceSize.w,src.sourceSize.h,src.spriteSourceSize.x,src.spriteSourceSize.y,src.spriteSourceSize.w,src.spriteSourceSize.h),src.rotated&&(newFrame.rotated=!0,newFrame.updateUVsInverted()),(pivot=src.anchor||src.pivot)&&(newFrame.customPivot=!0,newFrame.pivotX=pivot.x,newFrame.pivotY=pivot.y),newFrame.customData=Clone$a(src));for(dataKey in json)"frames"!==dataKey&&(Array.isArray(json[dataKey])?texture.customData[dataKey]=json[dataKey].slice(0):texture.customData[dataKey]=json[dataKey]);return texture}console.warn("Invalid Texture Atlas JSON Hash given, missing 'frames' Object")},SpriteSheet:function(texture,sourceIndex,x,y,width,height,config){var frameWidth=GetFastValue$$(config,"frameWidth",null),frameHeight=GetFastValue$$(config,"frameHeight",frameWidth);if(null===frameWidth)throw new Error("TextureManager.SpriteSheet: Invalid frameWidth given.");var endFrame=texture.source[sourceIndex];texture.add("__BASE",sourceIndex,0,0,endFrame.width,endFrame.height);var startFrame=GetFastValue$$(config,"startFrame",0),endFrame=GetFastValue$$(config,"endFrame",-1),margin=GetFastValue$$(config,"margin",0),spacing=GetFastValue$$(config,"spacing",0),total=Math.floor((width-margin+spacing)/(frameWidth+spacing))*Math.floor((height-margin+spacing)/(frameHeight+spacing));0===total&&console.warn("SpriteSheet frame dimensions will result in zero frames for texture:",texture.key),(startFrame=total<startFrame||startFrame<-total?0:startFrame)<0&&(startFrame=total+startFrame),-1!==endFrame&&(total=startFrame+(endFrame+1));for(var fx=margin,fy=margin,ax=0,ay=0,i=0;i<total;i++){var ax=0,ay=0,w=fx+frameWidth,h=fy+frameHeight;texture.add(i,sourceIndex,x+fx,y+fy,frameWidth-(ax=width<w?w-width:ax),frameHeight-(ay=height<h?h-height:ay)),width<(fx+=frameWidth+spacing)+frameWidth&&(fx=margin,fy+=frameHeight+spacing)}return texture},SpriteSheetFromAtlas:function(texture,frame,sheetHeight){var frameWidth=GetFastValue$_(sheetHeight,"frameWidth",null),frameHeight=GetFastValue$_(sheetHeight,"frameHeight",frameWidth);if(!frameWidth)throw new Error("TextureManager.SpriteSheetFromAtlas: Invalid frameWidth given.");var sheetWidth=texture.source[0];texture.add("__BASE",0,0,0,sheetWidth.width,sheetWidth.height),GetFastValue$_(sheetHeight,"startFrame",0),GetFastValue$_(sheetHeight,"endFrame",-1);for(var margin=GetFastValue$_(sheetHeight,"margin",0),spacing=GetFastValue$_(sheetHeight,"spacing",0),x=frame.cutX,y=frame.cutY,cutWidth=frame.cutWidth,cutHeight=frame.cutHeight,sheetWidth=frame.realWidth,sheetHeight=frame.realHeight,row=Math.floor((sheetWidth-margin+spacing)/(frameWidth+spacing)),column=Math.floor((sheetHeight-margin+spacing)/(frameHeight+spacing)),leftPad=frame.x,leftWidth=frameWidth-leftPad,rightWidth=frameWidth-(sheetWidth-cutWidth-leftPad),topPad=frame.y,topHeight=frameHeight-topPad,bottomHeight=frameHeight-(sheetHeight-cutHeight-topPad),frameX=margin,frameY=margin,frameIndex=0,sourceIndex=frame.sourceIndex,sheetY=0;sheetY<column;sheetY++){for(var topRow=0===sheetY,bottomRow=sheetY===column-1,sheetX=0;sheetX<row;sheetX++){var destX,destY,destWidth,destHeight,leftRow=0===sheetX,rightRow=sheetX===row-1,sheetFrame=texture.add(frameIndex,sourceIndex,x+frameX,y+frameY,frameWidth,frameHeight);(leftRow||topRow||rightRow||bottomRow)&&(destX=leftRow?leftPad:0,destY=topRow?topPad:0,destHeight=destWidth=0,leftRow&&(destWidth+=frameWidth-leftWidth),rightRow&&(destWidth+=frameWidth-rightWidth),topRow&&(destHeight+=frameHeight-topHeight),bottomRow&&(destHeight+=frameHeight-bottomHeight),destHeight=frameHeight-destHeight,sheetFrame.cutWidth=destWidth=frameWidth-destWidth,sheetFrame.cutHeight=destHeight,sheetFrame.setTrim(frameWidth,frameHeight,destX,destY,destWidth,destHeight)),frameX+=spacing,frameX+=leftRow?leftWidth:rightRow?rightWidth:frameWidth,frameIndex++}frameX=margin,frameY+=spacing,frameY+=topRow?topHeight:bottomRow?bottomHeight:frameHeight}return texture},UnityYAML:function(texture,sourceIndex,yaml){var source=texture.source[sourceIndex];texture.add("__BASE",sourceIndex,0,0,source.width,source.height),imageHeight=source.height;for(var data=yaml.split("\n"),lineRegExp=/^[ ]*(- )*(\w+)+[: ]+(.*)/,prevSprite="",currentSprite="",rect={x:0,y:0,width:0,height:0},i=0;i<data.length;i++){var results=data[i].match(lineRegExp);if(results){var isList="- "===results[1],key=results[2],value=results[3];if(isList&&(currentSprite!==prevSprite&&(addFrame(texture,sourceIndex,currentSprite,rect),prevSprite=currentSprite),rect={x:0,y:0,width:0,height:0}),"name"!==key)switch(key){case"x":case"y":case"width":case"height":rect[key]=parseInt(value,10)}else currentSprite=value}}return currentSprite!==prevSprite&&addFrame(texture,sourceIndex,currentSprite,rect),texture}},CanvasPool$5=SetValue_1,CanvasTexture=ParseTileLayers_1$1,IsInLayerBounds_1=Class_1,Color$1=Container_1,CONST$U=Extend,EventEmitter$j=eventemitter3.exports,Events$w=TweenData_1,GameEvents$6=ImageFile_1,GenerateTexture=RetroFont_1,GetValue$o=GetValue_1,Parser=GetWorldToTileXYFunction_1,Texture=HexagonalWorldToTileY_1,NumberTweenBuilder_1=new IsInLayerBounds_1({Extends:EventEmitter$j,initialize:function(game){EventEmitter$j.call(this),this.game=game,this.name="TextureManager",this.list={},this._tempCanvas=CanvasPool$5.create2D(this,1,1),this._tempContext=this._tempCanvas.getContext("2d"),this._pending=0,game.events.once(GameEvents$6.BOOT,this.boot,this)},boot:function(){this._pending=3,this.on(Events$w.LOAD,this.updatePending,this),this.on(Events$w.ERROR,this.updatePending,this);var config=this.game.config;this.addBase64("__DEFAULT",config.defaultImage),this.addBase64("__MISSING",config.missingImage),this.addBase64("__WHITE",config.whiteImage),this.game.events.once(GameEvents$6.DESTROY,this.destroy,this)},updatePending:function(){this._pending--,0===this._pending&&(this.off(Events$w.LOAD),this.off(Events$w.ERROR),this.emit(Events$w.READY))},checkKey:function(key){return!this.exists(key)||(console.error("Texture key already in use: "+key),!1)},remove:function(key){if("string"==typeof key){if(!this.exists(key))return console.warn("No texture found matching key: "+key),this;key=this.get(key)}return this.list.hasOwnProperty(key.key)&&(key.destroy(),this.emit(Events$w.REMOVE,key.key)),this},removeKey:function(key){return this.list.hasOwnProperty(key)&&delete this.list[key],this},addBase64:function(key,data){var _this,image;return this.checkKey(key)&&(_this=this,(image=new Image).onerror=function(){_this.emit(Events$w.ERROR,key)},image.onload=function(){var texture=_this.create(key,image);Parser.Image(texture,0),_this.emit(Events$w.ADD,key,texture),_this.emit(Events$w.LOAD,key,texture)},image.src=data),this},getBase64:function(cd,canvas,type,encoderOptions){void 0===type&&(type="image/png"),void 0===encoderOptions&&(encoderOptions=.92);var data="",textureFrame=this.getFrame(cd,canvas);return textureFrame&&(textureFrame.source.isRenderTexture||textureFrame.source.isGLTexture)?console.warn("Cannot getBase64 from WebGL Texture"):textureFrame&&(cd=textureFrame.canvasData,(canvas=CanvasPool$5.create2D(this,cd.width,cd.height)).getContext("2d").drawImage(textureFrame.source.image,cd.x,cd.y,cd.width,cd.height,0,0,cd.width,cd.height),data=canvas.toDataURL(type,encoderOptions),CanvasPool$5.remove(canvas)),data},addImage:function(key,source,dataSource){var texture=null;return this.checkKey(key)&&(texture=this.create(key,source),Parser.Image(texture,0),dataSource&&texture.setDataSource(dataSource),this.emit(Events$w.ADD,key,texture)),texture},addGLTexture:function(key,glTexture,width,height){var texture=null;return this.checkKey(key)&&(void 0===width&&(width=glTexture.width),void 0===height&&(height=glTexture.height),(texture=this.create(key,glTexture,width,height)).add("__BASE",0,0,0,width,height),this.emit(Events$w.ADD,key,texture)),texture},addRenderTexture:function(key,renderTexture){var texture=null;return this.checkKey(key)&&((texture=this.create(key,renderTexture)).add("__BASE",0,0,0,renderTexture.width,renderTexture.height),this.emit(Events$w.ADD,key,texture)),texture},generate:function(key,config){if(this.checkKey(key)){var canvas=CanvasPool$5.create(this,1,1);return config.canvas=canvas,GenerateTexture(config),this.addCanvas(key,canvas)}return null},createCanvas:function(key,width,canvas){if(void 0===width&&(width=256),void 0===canvas&&(canvas=256),this.checkKey(key)){canvas=CanvasPool$5.create(this,width,canvas,CONST$U.CANVAS,!0);return this.addCanvas(key,canvas)}return null},addCanvas:function(key,source,skipCache){var texture=null;return(skipCache=void 0===skipCache?!1:skipCache)?texture=new CanvasTexture(this,key,source,source.width,source.height):this.checkKey(key)&&(texture=new CanvasTexture(this,key,source,source.width,source.height),this.list[key]=texture,this.emit(Events$w.ADD,key,texture)),texture},addAtlas:function(key,source,data,dataSource){return Array.isArray(data.textures)||Array.isArray(data.frames)?this.addAtlasJSONArray(key,source,data,dataSource):this.addAtlasJSONHash(key,source,data,dataSource)},addAtlasJSONArray:function(key,source,data,dataSource){var texture=null;if(this.checkKey(key)){if(texture=this.create(key,source),Array.isArray(data))for(var singleAtlasFile=1===data.length,i=0;i<texture.source.length;i++){var atlasData=singleAtlasFile?data[0]:data[i];Parser.JSONArray(texture,i,atlasData)}else Parser.JSONArray(texture,0,data);dataSource&&texture.setDataSource(dataSource),this.emit(Events$w.ADD,key,texture)}return texture},addAtlasJSONHash:function(key,source,data,dataSource){var texture=null;if(this.checkKey(key)){if(texture=this.create(key,source),Array.isArray(data))for(var i=0;i<data.length;i++)Parser.JSONHash(texture,i,data[i]);else Parser.JSONHash(texture,0,data);dataSource&&texture.setDataSource(dataSource),this.emit(Events$w.ADD,key,texture)}return texture},addAtlasXML:function(key,source,data,dataSource){var texture=null;return this.checkKey(key)&&(texture=this.create(key,source),Parser.AtlasXML(texture,0,data),dataSource&&texture.setDataSource(dataSource),this.emit(Events$w.ADD,key,texture)),texture},addUnityAtlas:function(key,source,data,dataSource){var texture=null;return this.checkKey(key)&&(texture=this.create(key,source),Parser.UnityYAML(texture,0,data),dataSource&&texture.setDataSource(dataSource),this.emit(Events$w.ADD,key,texture)),texture},addSpriteSheet:function(key,height,config){var width,texture=null;return this.checkKey(key)&&(width=(texture=this.create(key,height)).source[0].width,height=texture.source[0].height,Parser.SpriteSheet(texture,0,0,0,width,height,config),this.emit(Events$w.ADD,key,texture)),texture},addSpriteSheetFromAtlas:function(key,config){if(!this.checkKey(key))return null;var sheet=GetValue$o(config,"atlas",null),texture=GetValue$o(config,"frame",null);if(sheet&&texture){sheet=this.get(sheet).get(texture);if(sheet){texture=this.create(key,sheet.source.image);return sheet.trimmed?Parser.SpriteSheetFromAtlas(texture,sheet,config):Parser.SpriteSheet(texture,0,sheet.cutX,sheet.cutY,sheet.cutWidth,sheet.cutHeight,config),this.emit(Events$w.ADD,key,texture),texture}}},create:function(key,source,width,height){var texture=null;return this.checkKey(key)&&(texture=new Texture(this,key,source,width,height),this.list[key]=texture),texture},exists:function(key){return this.list.hasOwnProperty(key)},get:function(key){return this.list[key=void 0===key?"__DEFAULT":key]||(key instanceof Texture?key:this.list.__MISSING)},cloneFrame:function(key,frame){if(this.list[key])return this.list[key].get(frame).clone()},getFrame:function(key,frame){if(this.list[key])return this.list[key].get(frame)},getTextureKeys:function(){var key,output=[];for(key in this.list)"__DEFAULT"!==key&&"__MISSING"!==key&&output.push(key);return output},getPixel:function(x,y,textureFrame,rgb){textureFrame=this.getFrame(textureFrame,rgb);if(textureFrame){x-=textureFrame.x,y-=textureFrame.y;rgb=textureFrame.data.cut;if(x+=rgb.x,y+=rgb.y,x>=rgb.x&&x<rgb.r&&y>=rgb.y&&y<rgb.b){rgb=this._tempContext;rgb.clearRect(0,0,1,1),rgb.drawImage(textureFrame.source.image,x,y,1,1,0,0,1,1);rgb=rgb.getImageData(0,0,1,1);return new Color$1(rgb.data[0],rgb.data[1],rgb.data[2],rgb.data[3])}}return null},getPixelAlpha:function(x,y,textureFrame,ctx){textureFrame=this.getFrame(textureFrame,ctx);if(textureFrame){x-=textureFrame.x,y-=textureFrame.y;ctx=textureFrame.data.cut;if(x+=ctx.x,y+=ctx.y,x>=ctx.x&&x<ctx.r&&y>=ctx.y&&y<ctx.b){ctx=this._tempContext;return ctx.clearRect(0,0,1,1),ctx.drawImage(textureFrame.source.image,x,y,1,1,0,0,1,1),ctx.getImageData(0,0,1,1).data[3]}}return null},setTexture:function(gameObject,key,frame){return this.list[key]&&(gameObject.texture=this.list[key],gameObject.frame=gameObject.texture.get(frame)),gameObject},renameTexture:function(currentKey,newKey){var texture=this.get(currentKey);return!(!texture||currentKey===newKey)&&(texture.key=newKey,this.list[newKey]=texture,delete this.list[currentKey],!0)},each:function(callback,scope){for(var texture,args=[null],i=1;i<arguments.length;i++)args.push(arguments[i]);for(texture in this.list)args[0]=this.list[texture],callback.apply(scope,args)},destroy:function(){for(var texture in this.list)this.list[texture].destroy();this.list={},this.game=null,CanvasPool$5.remove(this._tempCanvas)}}),events$6={COMPLETE:"complete",DECODED:"decoded",DECODED_ALL:"decodedall",DESTROY:"destroy",DETUNE:"detune",GLOBAL_DETUNE:"detune",GLOBAL_MUTE:"mute",GLOBAL_RATE:"rate",GLOBAL_VOLUME:"volume",LOOP:"loop",LOOPED:"looped",MUTE:"mute",PAN:"pan",PAUSE_ALL:"pauseall",PAUSE:"pause",PLAY:"play",RATE:"rate",RESUME_ALL:"resumeall",RESUME:"resume",SEEK:"seek",STOP_ALL:"stopall",STOP:"stop",UNLOCKED:"unlocked",VOLUME:"volume"},BinaryFile_1=function(len,startIndex,endIndex,throwError){len=len.length;if(startIndex<0||len<startIndex||endIndex<=startIndex||len<endIndex||len<startIndex+endIndex){if(throwError)throw new Error("Range Error: Values outside acceptable range");return!1}return!0},SafeRange$5=BinaryFile_1,Parse2DArray_1=function(array,property,value,startIndex,endIndex){void 0===endIndex&&(endIndex=array.length);var output=[];if(SafeRange$5(array,startIndex=void 0===startIndex?0:startIndex,endIndex))for(var i=startIndex;i<endIndex;i++){var child=array[i];(!property||property&&void 0===value&&child.hasOwnProperty(property)||property&&void 0!==value&&child[property]===value)&&output.push(child)}return output},SafeRange$4=BinaryFile_1,Centroid_1=function(array,property,value,startIndex,endIndex){if(void 0===endIndex&&(endIndex=array.length),SafeRange$4(array,startIndex=void 0===startIndex?0:startIndex,endIndex))for(var i=startIndex;i<endIndex;i++){var child=array[i];if(!property||property&&void 0===value&&child.hasOwnProperty(property)||property&&void 0!==value&&child[property]===value)return child}return null},DOMElement_1=Class_1,Clone$9=Clone_1$7,EventEmitter$i=eventemitter3.exports,Events$v=events$6,GameEvents$5=ImageFile_1,GetAll$1=Parse2DArray_1,GetFirst=Centroid_1,BaseSoundManager_1=new DOMElement_1({Extends:EventEmitter$i,initialize:function(game){EventEmitter$i.call(this),this.game=game,this.jsonCache=game.cache.json,this.sounds=[],this.mute=!1,this.volume=1,this.pauseOnBlur=!0,this._rate=1,this._detune=0,this.locked=this.locked||!1,this.unlocked=!1,game.events.on(GameEvents$5.BLUR,this.onGameBlur,this),game.events.on(GameEvents$5.FOCUS,this.onGameFocus,this),game.events.on(GameEvents$5.PRE_STEP,this.update,this),game.events.once(GameEvents$5.DESTROY,this.destroy,this)},add:gameConfig,addAudioSprite:function(key,config){var markerName,markerConfig,marker,sound=this.add(key,config=void 0===config?{}:config);for(markerName in sound.spritemap=this.jsonCache.get(key).spritemap,sound.spritemap)sound.spritemap.hasOwnProperty(markerName)&&(markerConfig=Clone$9(config),marker=sound.spritemap[markerName],markerConfig.loop=!!marker.hasOwnProperty("loop")&&marker.loop,sound.addMarker({name:markerName,start:marker.start,duration:marker.end-marker.start,config:markerConfig}));return sound},get:function(key){return GetFirst(this.sounds,"key",key)},getAll:function(key){return GetAll$1(this.sounds,"key",key)},play:function(sound,extra){sound=this.add(sound);return sound.once(Events$v.COMPLETE,sound.destroy,sound),extra?extra.name?(sound.addMarker(extra),sound.play(extra.name)):sound.play(extra):sound.play()},playAudioSprite:function(sound,spriteName,config){sound=this.addAudioSprite(sound);return sound.once(Events$v.COMPLETE,sound.destroy,sound),sound.play(spriteName,config)},remove:function(sound){var index=this.sounds.indexOf(sound);return-1!==index&&(sound.destroy(),this.sounds.splice(index,1),!0)},removeAll:function(){this.sounds.forEach(function(sound){sound.destroy()}),this.sounds.length=0},removeByKey:function(key){for(var removed=0,i=this.sounds.length-1;0<=i;i--){var sound=this.sounds[i];sound.key===key&&(sound.destroy(),this.sounds.splice(i,1),removed++)}return removed},pauseAll:function(){this.forEachActiveSound(function(sound){sound.pause()}),this.emit(Events$v.PAUSE_ALL,this)},resumeAll:function(){this.forEachActiveSound(function(sound){sound.resume()}),this.emit(Events$v.RESUME_ALL,this)},stopAll:function(){this.forEachActiveSound(function(sound){sound.stop()}),this.emit(Events$v.STOP_ALL,this)},stopByKey:function(key){var stopped=0;return this.getAll(key).forEach(function(sound){sound.stop()&&stopped++}),stopped},unlock:gameConfig,onBlur:gameConfig,onFocus:gameConfig,onGameBlur:function(){this.pauseOnBlur&&this.onBlur()},onGameFocus:function(){this.pauseOnBlur&&this.onFocus()},update:function(time,delta){this.unlocked&&(this.unlocked=!1,this.locked=!1,this.emit(Events$v.UNLOCKED,this));for(var i=this.sounds.length-1;0<=i;i--)this.sounds[i].pendingRemove&&this.sounds.splice(i,1);this.sounds.forEach(function(sound){sound.update(time,delta)})},destroy:function(){this.game.events.off(GameEvents$5.BLUR,this.onGameBlur,this),this.game.events.off(GameEvents$5.FOCUS,this.onGameFocus,this),this.game.events.off(GameEvents$5.PRE_STEP,this.update,this),this.removeAllListeners(),this.removeAll(),this.sounds.length=0,this.sounds=null,this.game=null},forEachActiveSound:function(callback,scope){var _this=this;this.sounds.forEach(function(sound,index){sound&&!sound.pendingRemove&&callback.call(scope||_this,sound,index,_this.sounds)})},setRate:function(value){return this.rate=value,this},rate:{get:function(){return this._rate},set:function(value){this._rate=value,this.forEachActiveSound(function(sound){sound.calculateRate()}),this.emit(Events$v.GLOBAL_RATE,this,value)}},setDetune:function(value){return this.detune=value,this},detune:{get:function(){return this._detune},set:function(value){this._detune=value,this.forEachActiveSound(function(sound){sound.calculateRate()}),this.emit(Events$v.GLOBAL_DETUNE,this,value)}}}),DynamicBitmapText_1=Class_1,EventEmitter$h=eventemitter3.exports,Events$u=events$6,Extend$i=Extend_1$1,BaseSound_1=new DynamicBitmapText_1({Extends:EventEmitter$h,initialize:function(manager,key,config){EventEmitter$h.call(this),this.manager=manager,this.key=key,this.isPlaying=!1,this.isPaused=!1,this.totalRate=1,this.duration=this.duration||0,this.totalDuration=this.totalDuration||0,this.config={mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0},this.currentConfig=this.config,this.config=Extend$i(this.config,config),this.markers={},this.currentMarker=null,this.pendingRemove=!1},addMarker:function(marker){return!(!marker||!marker.name||"string"!=typeof marker.name)&&(this.markers[marker.name]?(console.error("addMarker "+marker.name+" already exists in Sound"),!1):(marker=Extend$i(!0,{name:"",start:0,duration:this.totalDuration-(marker.start||0),config:{mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0}},marker),this.markers[marker.name]=marker,!0))},updateMarker:function(marker){return!(!marker||!marker.name||"string"!=typeof marker.name)&&(this.markers[marker.name]?(this.markers[marker.name]=Extend$i(!0,this.markers[marker.name],marker),!0):(console.warn("Audio Marker: "+marker.name+" missing in Sound: "+this.key),!1))},removeMarker:function(markerName){var marker=this.markers[markerName];return marker?(this.markers[markerName]=null,marker):null},play:function(markerName,config){if("object"==typeof(markerName=void 0===markerName?"":markerName)&&(config=markerName,markerName=""),"string"!=typeof markerName)return!1;if(markerName){if(!this.markers[markerName])return console.warn("Marker: "+markerName+" missing in Sound: "+this.key),!1;this.currentMarker=this.markers[markerName],this.currentConfig=this.currentMarker.config,this.duration=this.currentMarker.duration}else this.currentMarker=null,this.currentConfig=this.config,this.duration=this.totalDuration;return this.resetConfig(),this.currentConfig=Extend$i(this.currentConfig,config),this.isPlaying=!0,!(this.isPaused=!1)},pause:function(){return!(this.isPaused||!this.isPlaying)&&(this.isPlaying=!1,this.isPaused=!0)},resume:function(){return!(!this.isPaused||this.isPlaying)&&(this.isPlaying=!0,!(this.isPaused=!1))},stop:function(){return!(!this.isPaused&&!this.isPlaying)&&(this.isPlaying=!1,this.isPaused=!1,this.resetConfig(),!0)},applyConfig:function(){this.mute=this.currentConfig.mute,this.volume=this.currentConfig.volume,this.rate=this.currentConfig.rate,this.detune=this.currentConfig.detune,this.loop=this.currentConfig.loop,this.pan=this.currentConfig.pan},resetConfig:function(){this.currentConfig.seek=0,this.currentConfig.delay=0},update:gameConfig,calculateRate:function(){var detuneRate=this.currentConfig.detune+this.manager.detune,detuneRate=Math.pow(1.0005777895065548,detuneRate);this.totalRate=this.currentConfig.rate*this.manager.rate*detuneRate},destroy:function(){this.pendingRemove||(this.emit(Events$u.DESTROY,this),this.pendingRemove=!0,this.manager=null,this.key="",this.removeAllListeners(),this.isPlaying=!1,this.isPaused=!1,this.config=null,this.currentConfig=null,this.markers=null,this.currentMarker=null)}}),BaseSound$2=BaseSound_1,Events$t=events$6,Clamp$5=Character,HTML5AudioSound_1=new Class_1({Extends:BaseSound$2,initialize:function(manager,key,config){if(void 0===config&&(config={}),this.tags=manager.game.cache.audio.get(key),!this.tags)throw new Error('There is no audio asset with key "'+key+'" in the audio cache');this.audio=null,this.startTime=0,this.previousTime=0,this.duration=this.tags[0].duration,this.totalDuration=this.tags[0].duration,BaseSound$2.call(this,manager,key,config)},play:function(markerName,config){return!this.manager.isLocked(this,"play",[markerName,config])&&(!!BaseSound$2.prototype.play.call(this,markerName,config)&&(!!this.pickAndPlayAudioTag()&&(this.emit(Events$t.PLAY,this),!0)))},pause:function(){return!this.manager.isLocked(this,"pause")&&(!(0<this.startTime)&&(!!BaseSound$2.prototype.pause.call(this)&&(this.currentConfig.seek=this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0),this.stopAndReleaseAudioTag(),this.emit(Events$t.PAUSE,this),!0)))},resume:function(){return!this.manager.isLocked(this,"resume")&&(!(0<this.startTime)&&(!!BaseSound$2.prototype.resume.call(this)&&(!!this.pickAndPlayAudioTag()&&(this.emit(Events$t.RESUME,this),!0))))},stop:function(){return!this.manager.isLocked(this,"stop")&&(!!BaseSound$2.prototype.stop.call(this)&&(this.stopAndReleaseAudioTag(),this.emit(Events$t.STOP,this),!0))},pickAndPlayAudioTag:function(){if(!this.pickAudioTag())return this.reset(),!1;var offset=this.currentConfig.seek,delay=this.currentConfig.delay,offset=(this.currentMarker?this.currentMarker.start:0)+offset;return this.previousTime=offset,this.audio.currentTime=offset,this.applyConfig(),0===delay?(this.startTime=0,this.audio.paused&&this.playCatchPromise()):(this.startTime=window.performance.now()+1e3*delay,this.audio.paused||this.audio.pause()),this.resetConfig(),!0},pickAudioTag:function(){if(this.audio)return!0;for(var i=0;i<this.tags.length;i++){var audio=this.tags[i];if("false"===audio.dataset.used)return audio.dataset.used="true",this.audio=audio,!0}if(!this.manager.override)return!1;var otherSounds=[];this.manager.forEachActiveSound(function(sound){sound.key===this.key&&sound.audio&&otherSounds.push(sound)},this),otherSounds.sort(function(a1,a2){return a1.loop===a2.loop?a2.seek/a2.duration-a1.seek/a1.duration:a1.loop?1:-1});var selectedSound=otherSounds[0];return this.audio=selectedSound.audio,selectedSound.reset(),selectedSound.audio=null,selectedSound.startTime=0,!(selectedSound.previousTime=0)},playCatchPromise:function(){var playPromise=this.audio.play();playPromise&&playPromise.catch(function(reason){console.warn(reason)})},stopAndReleaseAudioTag:function(){this.startTime=0,this.previousTime=0,this.audio&&(this.audio.pause(),this.audio.dataset.used="false",this.audio=null)},reset:function(){BaseSound$2.prototype.stop.call(this)},onBlur:function(){this.isPlaying=!1,this.isPaused=!0,this.currentConfig.seek=this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0),this.currentConfig.delay=Math.max(0,(this.startTime-window.performance.now())/1e3),this.stopAndReleaseAudioTag()},onFocus:function(){this.isPlaying=!0,this.isPaused=!1,this.pickAndPlayAudioTag()},update:function(currentTime){if(this.isPlaying)if(0<this.startTime)this.startTime<currentTime-this.manager.audioPlayDelay&&(this.audio.currentTime+=Math.max(0,currentTime-this.startTime)/1e3,this.startTime=0,this.previousTime=this.audio.currentTime,this.playCatchPromise());else{var startTime=this.currentMarker?this.currentMarker.start:0,endTime=startTime+this.duration,currentTime=this.audio.currentTime;if(this.currentConfig.loop)currentTime>=endTime-this.manager.loopEndOffset?(this.audio.currentTime=startTime+Math.max(0,currentTime-endTime),currentTime=this.audio.currentTime):currentTime<startTime&&(this.audio.currentTime+=startTime,currentTime=this.audio.currentTime),currentTime<this.previousTime&&this.emit(Events$t.LOOPED,this);else if(endTime<=currentTime)return this.reset(),this.stopAndReleaseAudioTag(),void this.emit(Events$t.COMPLETE,this);this.previousTime=currentTime}},destroy:function(){BaseSound$2.prototype.destroy.call(this),this.tags=null,this.audio&&this.stopAndReleaseAudioTag()},updateMute:function(){this.audio&&(this.audio.muted=this.currentConfig.mute||this.manager.mute)},updateVolume:function(){this.audio&&(this.audio.volume=Clamp$5(this.currentConfig.volume*this.manager.volume,0,1))},calculateRate:function(){BaseSound$2.prototype.calculateRate.call(this),this.audio&&(this.audio.playbackRate=this.totalRate)},mute:{get:function(){return this.currentConfig.mute},set:function(value){this.currentConfig.mute=value,this.manager.isLocked(this,"mute",value)||(this.updateMute(),this.emit(Events$t.MUTE,this,value))}},setMute:function(value){return this.mute=value,this},volume:{get:function(){return this.currentConfig.volume},set:function(value){this.currentConfig.volume=value,this.manager.isLocked(this,"volume",value)||(this.updateVolume(),this.emit(Events$t.VOLUME,this,value))}},setVolume:function(value){return this.volume=value,this},rate:{get:function(){return this.currentConfig.rate},set:function(value){this.currentConfig.rate=value,this.manager.isLocked(this,Events$t.RATE,value)||(this.calculateRate(),this.emit(Events$t.RATE,this,value))}},setRate:function(value){return this.rate=value,this},detune:{get:function(){return this.currentConfig.detune},set:function(value){this.currentConfig.detune=value,this.manager.isLocked(this,Events$t.DETUNE,value)||(this.calculateRate(),this.emit(Events$t.DETUNE,this,value))}},setDetune:function(value){return this.detune=value,this},seek:{get:function(){return this.isPlaying?this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0):this.isPaused?this.currentConfig.seek:0},set:function(value){this.manager.isLocked(this,"seek",value)||0<this.startTime||(this.isPlaying||this.isPaused)&&(value=Math.min(Math.max(0,value),this.duration),this.isPlaying?(this.previousTime=value,this.audio.currentTime=value):this.isPaused&&(this.currentConfig.seek=value),this.emit(Events$t.SEEK,this,value))}},setSeek:function(value){return this.seek=value,this},loop:{get:function(){return this.currentConfig.loop},set:function(value){this.currentConfig.loop=value,this.manager.isLocked(this,"loop",value)||(this.audio&&(this.audio.loop=value),this.emit(Events$t.LOOP,this,value))}},setLoop:function(value){return this.loop=value,this},pan:{get:function(){return this.currentConfig.pan},set:function(value){this.currentConfig.pan=value,this.emit(Events$t.PAN,this,value)}},setPan:function(value){return this.pan=value,this}}),BaseSoundManager$2=BaseSoundManager_1,Events$s=events$6,HTML5AudioSound=HTML5AudioSound_1,HTML5AudioSoundManager_1=new Class_1({Extends:BaseSoundManager$2,initialize:function(game){this.override=!0,this.audioPlayDelay=.1,this.loopEndOffset=.05,this.onBlurPausedSounds=[],this.locked="ontouchstart"in window,this.lockedActionsQueue=this.locked?[]:null,this._mute=!1,this._volume=1,BaseSoundManager$2.call(this,game)},add:function(key,sound){sound=new HTML5AudioSound(this,key,sound);return this.sounds.push(sound),sound},unlock:function(){this.locked=!1;var moved,detectMove,unlock,_this=this;this.game.cache.audio.entries.each(function(key,tags){for(var i=0;i<tags.length;i++)if("true"===tags[i].dataset.locked)return!(_this.locked=!0);return!0}),this.locked&&(moved=!1,detectMove=function(){moved=!0},unlock=function(){var lockedTags,lastTag;moved?moved=!1:(document.body.removeEventListener("touchmove",detectMove),document.body.removeEventListener("touchend",unlock),lockedTags=[],_this.game.cache.audio.entries.each(function(key,tags){for(var i=0;i<tags.length;i++){var tag=tags[i];"true"===tag.dataset.locked&&lockedTags.push(tag)}return!0}),0!==lockedTags.length&&((lastTag=lockedTags[lockedTags.length-1]).oncanplaythrough=function(){lastTag.oncanplaythrough=null,lockedTags.forEach(function(tag){tag.dataset.locked="false"}),_this.unlocked=!0},lockedTags.forEach(function(tag){tag.load()})))},this.once(Events$s.UNLOCKED,function(){for(this.forEachActiveSound(function(sound){null===sound.currentMarker&&0===sound.duration&&(sound.duration=sound.tags[0].duration),sound.totalDuration=sound.tags[0].duration});this.lockedActionsQueue.length;){var lockedAction=this.lockedActionsQueue.shift();lockedAction.sound[lockedAction.prop].apply?lockedAction.sound[lockedAction.prop].apply(lockedAction.sound,lockedAction.value||[]):lockedAction.sound[lockedAction.prop]=lockedAction.value}},this),document.body.addEventListener("touchmove",detectMove,!1),document.body.addEventListener("touchend",unlock,!1))},onBlur:function(){this.forEachActiveSound(function(sound){sound.isPlaying&&(this.onBlurPausedSounds.push(sound),sound.onBlur())})},onFocus:function(){this.onBlurPausedSounds.forEach(function(sound){sound.onFocus()}),this.onBlurPausedSounds.length=0},destroy:function(){BaseSoundManager$2.prototype.destroy.call(this),this.onBlurPausedSounds.length=0,this.onBlurPausedSounds=null},isLocked:function(sound,prop,value){return"true"===sound.tags[0].dataset.locked&&(this.lockedActionsQueue.push({sound:sound,prop:prop,value:value}),!0)},setMute:function(value){return this.mute=value,this},mute:{get:function(){return this._mute},set:function(value){this._mute=value,this.forEachActiveSound(function(sound){sound.updateMute()}),this.emit(Events$s.GLOBAL_MUTE,this,value)}},setVolume:function(value){return this.volume=value,this},volume:{get:function(){return this._volume},set:function(value){this._volume=value,this.forEachActiveSound(function(sound){sound.updateVolume()}),this.emit(Events$s.GLOBAL_VOLUME,this,value)}}}),BaseSound$1=BaseSound_1,Extern_1=Class_1,EventEmitter$g=eventemitter3.exports,Extend$h=Extend_1$1,GetTextSize_1=function(){return!1},Composites_1=function(){return this},NoAudioSound_1=new Extern_1({Extends:EventEmitter$g,initialize:function(manager,key,config){void 0===config&&(config={}),EventEmitter$g.call(this),this.manager=manager,this.key=key,this.isPlaying=!1,this.isPaused=!1,this.totalRate=1,this.duration=0,this.totalDuration=0,this.config=Extend$h({mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0},config),this.currentConfig=this.config,this.mute=!1,this.volume=1,this.rate=1,this.detune=0,this.seek=0,this.loop=!1,this.pan=0,this.markers={},this.currentMarker=null,this.pendingRemove=!1},addMarker:GetTextSize_1,updateMarker:GetTextSize_1,removeMarker:function(){return null},play:GetTextSize_1,pause:GetTextSize_1,resume:GetTextSize_1,stop:GetTextSize_1,destroy:function(){BaseSound$1.prototype.destroy.call(this)},setMute:Composites_1,setVolume:Composites_1,setRate:Composites_1,setDetune:Composites_1,setSeek:Composites_1,setLoop:Composites_1,setPan:Composites_1}),BaseSoundManager$1=BaseSoundManager_1,CopyFrom_1$1=Class_1,EventEmitter$f=eventemitter3.exports,NoAudioSound=NoAudioSound_1,NoAudioSoundManager_1=new CopyFrom_1$1({Extends:EventEmitter$f,initialize:function(game){EventEmitter$f.call(this),this.game=game,this.sounds=[],this.mute=!1,this.volume=1,this.rate=1,this.detune=0,this.pauseOnBlur=!0,this.locked=!1},add:function(key,sound){sound=new NoAudioSound(this,key,sound);return this.sounds.push(sound),sound},addAudioSprite:function(key,sound){sound=this.add(key,sound);return sound.spritemap={},sound},play:function(key,extra){return!1},playAudioSprite:function(key,spriteName,config){return!1},remove:function(sound){return BaseSoundManager$1.prototype.remove.call(this,sound)},removeByKey:function(key){return BaseSoundManager$1.prototype.removeByKey.call(this,key)},pauseAll:gameConfig,resumeAll:gameConfig,stopAll:gameConfig,update:gameConfig,setRate:gameConfig,setDetune:gameConfig,setMute:gameConfig,setVolume:gameConfig,forEachActiveSound:function(callbackfn,scope){BaseSoundManager$1.prototype.forEachActiveSound.call(this,callbackfn,scope)},destroy:function(){BaseSoundManager$1.prototype.destroy.call(this)}}),chars$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256),i=0;i<chars$1.length;i++)lookup[chars$1.charCodeAt(i)]=i;var Base64ToArrayBuffer_1=function(base64){var encoded1,encoded2,encoded3,encoded4,len=(base64=base64.substr(base64.indexOf(",")+1)).length,arrayBuffer=.75*len,p=0;"="===base64[len-1]&&(arrayBuffer--,"="===base64[len-2]&&arrayBuffer--);for(var arrayBuffer=new ArrayBuffer(arrayBuffer),bytes=new Uint8Array(arrayBuffer),i=0;i<len;i+=4)encoded1=lookup[base64.charCodeAt(i)],encoded2=lookup[base64.charCodeAt(i+1)],encoded3=lookup[base64.charCodeAt(i+2)],encoded4=lookup[base64.charCodeAt(i+3)],bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(15&encoded2)<<4|encoded3>>2,bytes[p++]=(3&encoded3)<<6|63&encoded4;return arrayBuffer},BaseSound=BaseSound_1,Events$r=events$6,WebAudioSound_1=new Class_1({Extends:BaseSound,initialize:function(manager,key,config){if(void 0===config&&(config={}),this.audioBuffer=manager.game.cache.audio.get(key),!this.audioBuffer)throw new Error('Audio key "'+key+'" missing from cache');this.source=null,this.loopSource=null,this.muteNode=manager.context.createGain(),this.volumeNode=manager.context.createGain(),this.pannerNode=null,this.playTime=0,this.startTime=0,this.loopTime=0,this.rateUpdates=[],this.hasEnded=!1,this.hasLooped=!1,this.muteNode.connect(this.volumeNode),manager.context.createStereoPanner?(this.pannerNode=manager.context.createStereoPanner(),this.volumeNode.connect(this.pannerNode),this.pannerNode.connect(manager.destination)):this.volumeNode.connect(manager.destination),this.duration=this.audioBuffer.duration,this.totalDuration=this.audioBuffer.duration,BaseSound.call(this,manager,key,config)},play:function(markerName,config){return!!BaseSound.prototype.play.call(this,markerName,config)&&(this.stopAndRemoveBufferSource(),this.createAndStartBufferSource(),this.emit(Events$r.PLAY,this),!0)},pause:function(){return!(this.manager.context.currentTime<this.startTime)&&(!!BaseSound.prototype.pause.call(this)&&(this.currentConfig.seek=this.getCurrentTime(),this.stopAndRemoveBufferSource(),this.emit(Events$r.PAUSE,this),!0))},resume:function(){return!(this.manager.context.currentTime<this.startTime)&&(!!BaseSound.prototype.resume.call(this)&&(this.createAndStartBufferSource(),this.emit(Events$r.RESUME,this),!0))},stop:function(){return!!BaseSound.prototype.stop.call(this)&&(this.stopAndRemoveBufferSource(),this.emit(Events$r.STOP,this),!0)},createAndStartBufferSource:function(){var seek=this.currentConfig.seek,duration=this.currentConfig.delay,when=this.manager.context.currentTime+duration,offset=(this.currentMarker?this.currentMarker.start:0)+seek,duration=this.duration-seek;this.playTime=when-seek,this.startTime=when,this.source=this.createBufferSource(),this.applyConfig(),this.source.start(Math.max(0,when),Math.max(0,offset),Math.max(0,duration)),this.resetConfig()},createAndStartLoopBufferSource:function(){var when=this.getLoopTime(),offset=this.currentMarker?this.currentMarker.start:0,duration=this.duration;this.loopTime=when,this.loopSource=this.createBufferSource(),this.loopSource.playbackRate.setValueAtTime(this.totalRate,0),this.loopSource.start(Math.max(0,when),Math.max(0,offset),Math.max(0,duration))},createBufferSource:function(){var _this=this,source=this.manager.context.createBufferSource();return source.buffer=this.audioBuffer,source.connect(this.muteNode),source.onended=function(ev){ev.target===_this.source&&(_this.currentConfig.loop?_this.hasLooped=!0:_this.hasEnded=!0)},source},stopAndRemoveBufferSource:function(){this.source&&(this.source.stop(),this.source.disconnect(),this.source=null),this.playTime=0,this.startTime=0,this.stopAndRemoveLoopBufferSource()},stopAndRemoveLoopBufferSource:function(){this.loopSource&&(this.loopSource.stop(),this.loopSource.disconnect(),this.loopSource=null),this.loopTime=0},applyConfig:function(){this.rateUpdates.length=0,this.rateUpdates.push({time:0,rate:1}),BaseSound.prototype.applyConfig.call(this)},update:function(){this.hasEnded?(this.hasEnded=!1,BaseSound.prototype.stop.call(this),this.stopAndRemoveBufferSource(),this.emit(Events$r.COMPLETE,this)):this.hasLooped&&(this.hasLooped=!1,this.source=this.loopSource,this.loopSource=null,this.playTime=this.startTime=this.loopTime,this.rateUpdates.length=0,this.rateUpdates.push({time:0,rate:this.totalRate}),this.createAndStartLoopBufferSource(),this.emit(Events$r.LOOPED,this))},destroy:function(){BaseSound.prototype.destroy.call(this),this.audioBuffer=null,this.stopAndRemoveBufferSource(),this.muteNode.disconnect(),this.muteNode=null,this.volumeNode.disconnect(),this.volumeNode=null,this.pannerNode&&(this.pannerNode.disconnect(),this.pannerNode=null),this.rateUpdates.length=0,this.rateUpdates=null},calculateRate:function(){BaseSound.prototype.calculateRate.call(this);var now=this.manager.context.currentTime;this.source&&"number"==typeof this.totalRate&&this.source.playbackRate.setValueAtTime(this.totalRate,now),this.isPlaying&&(this.rateUpdates.push({time:Math.max(this.startTime,now)-this.playTime,rate:this.totalRate}),this.loopSource&&(this.stopAndRemoveLoopBufferSource(),this.createAndStartLoopBufferSource()))},getCurrentTime:function(){for(var currentTime=0,i=0;i<this.rateUpdates.length;i++)currentTime+=((i<this.rateUpdates.length-1?this.rateUpdates[i+1].time:this.manager.context.currentTime-this.playTime)-this.rateUpdates[i].time)*this.rateUpdates[i].rate;return currentTime},getLoopTime:function(){for(var lastRateUpdateCurrentTime=0,i=0;i<this.rateUpdates.length-1;i++)lastRateUpdateCurrentTime+=(this.rateUpdates[i+1].time-this.rateUpdates[i].time)*this.rateUpdates[i].rate;var lastRateUpdate=this.rateUpdates[this.rateUpdates.length-1];return this.playTime+lastRateUpdate.time+(this.duration-lastRateUpdateCurrentTime)/lastRateUpdate.rate},rate:{get:function(){return this.currentConfig.rate},set:function(value){this.currentConfig.rate=value,this.calculateRate(),this.emit(Events$r.RATE,this,value)}},setRate:function(value){return this.rate=value,this},detune:{get:function(){return this.currentConfig.detune},set:function(value){this.currentConfig.detune=value,this.calculateRate(),this.emit(Events$r.DETUNE,this,value)}},setDetune:function(value){return this.detune=value,this},mute:{get:function(){return 0===this.muteNode.gain.value},set:function(value){this.currentConfig.mute=value,this.muteNode.gain.setValueAtTime(value?0:1,0),this.emit(Events$r.MUTE,this,value)}},setMute:function(value){return this.mute=value,this},volume:{get:function(){return this.volumeNode.gain.value},set:function(value){this.currentConfig.volume=value,this.volumeNode.gain.setValueAtTime(value,0),this.emit(Events$r.VOLUME,this,value)}},setVolume:function(value){return this.volume=value,this},seek:{get:function(){return this.isPlaying?this.manager.context.currentTime<this.startTime?this.startTime-this.playTime:this.getCurrentTime():this.isPaused?this.currentConfig.seek:0},set:function(value){this.manager.context.currentTime<this.startTime||(this.isPlaying||this.isPaused)&&(value=Math.min(Math.max(0,value),this.duration),this.currentConfig.seek=value,this.isPlaying&&(this.stopAndRemoveBufferSource(),this.createAndStartBufferSource()),this.emit(Events$r.SEEK,this,value))}},setSeek:function(value){return this.seek=value,this},loop:{get:function(){return this.currentConfig.loop},set:function(value){this.currentConfig.loop=value,this.isPlaying&&(this.stopAndRemoveLoopBufferSource(),value&&this.createAndStartLoopBufferSource()),this.emit(Events$r.LOOP,this,value)}},setLoop:function(value){return this.loop=value,this},pan:{get:function(){return this.pannerNode?this.pannerNode.pan.value:0},set:function(value){this.currentConfig.pan=value,this.pannerNode&&this.pannerNode.pan.setValueAtTime(value,this.manager.context.currentTime),this.emit(Events$r.PAN,this,value)}},setPan:function(value){return this.pan=value,this}}),Base64ToArrayBuffer=Base64ToArrayBuffer_1,BaseSoundManager=BaseSoundManager_1,Events$q=events$6,GameEvents$4=ImageFile_1,WebAudioSound=WebAudioSound_1,WebAudioSoundManager_1=new Class_1({Extends:BaseSoundManager,initialize:function(game){this.context=this.createAudioContext(game),this.masterMuteNode=this.context.createGain(),this.masterVolumeNode=this.context.createGain(),this.masterMuteNode.connect(this.masterVolumeNode),this.masterVolumeNode.connect(this.context.destination),this.destination=this.masterMuteNode,this.locked="suspended"===this.context.state&&("ontouchstart"in window||"onclick"in window),BaseSoundManager.call(this,game),this.locked&&game.isBooted?this.unlock():game.events.once(GameEvents$4.BOOT,this.unlock,this)},createAudioContext:function(audioConfig){audioConfig=audioConfig.config.audio;return audioConfig.context?(audioConfig.context.resume(),audioConfig.context):window.hasOwnProperty("AudioContext")?new AudioContext:window.hasOwnProperty("webkitAudioContext")?new window.webkitAudioContext:void 0},setAudioContext:function(context){return this.context&&this.context.close(),this.masterMuteNode&&this.masterMuteNode.disconnect(),this.masterVolumeNode&&this.masterVolumeNode.disconnect(),this.context=context,this.masterMuteNode=context.createGain(),this.masterVolumeNode=context.createGain(),this.masterMuteNode.connect(this.masterVolumeNode),this.masterVolumeNode.connect(context.destination),this.destination=this.masterMuteNode,this},add:function(key,sound){sound=new WebAudioSound(this,key,sound);return this.sounds.push(sound),sound},decodeAudio:function(audioKey,audioData){for(var audioFiles=Array.isArray(audioKey)?audioKey:[{key:audioKey,data:audioData}],cache=this.game.cache.audio,remaining=audioFiles.length,i=0;i<audioFiles.length;i++){var success=audioFiles[i],failure=success.key,data=success.data;"string"==typeof data&&(data=Base64ToArrayBuffer(data));success=function(key,audioBuffer){cache.add(key,audioBuffer),this.emit(Events$q.DECODED,key),0===--remaining&&this.emit(Events$q.DECODED_ALL)}.bind(this,failure),failure=function(key,error){console.error("Error decoding audio: "+key+" - ",error?error.message:""),0===--remaining&&this.emit(Events$q.DECODED_ALL)}.bind(this,failure);this.context.decodeAudioData(data,success,failure)}},unlock:function(){function unlockHandler(){var bodyRemove;_this.context&&body&&(bodyRemove=body.removeEventListener,_this.context.resume().then(function(){bodyRemove("touchstart",unlockHandler),bodyRemove("touchend",unlockHandler),bodyRemove("click",unlockHandler),bodyRemove("keydown",unlockHandler),_this.unlocked=!0},function(){bodyRemove("touchstart",unlockHandler),bodyRemove("touchend",unlockHandler),bodyRemove("click",unlockHandler),bodyRemove("keydown",unlockHandler)}))}var _this=this,body=document.body;body&&(body.addEventListener("touchstart",unlockHandler,!1),body.addEventListener("touchend",unlockHandler,!1),body.addEventListener("click",unlockHandler,!1),body.addEventListener("keydown",unlockHandler,!1))},onBlur:function(){this.locked||this.context.suspend()},onFocus:function(){var context=this.context;"suspended"!==context.state&&"interrupted"!==context.state||this.locked||context.resume()},update:function(time,context){BaseSoundManager.prototype.update.call(this,time,context);context=this.context;context&&"interrupted"===context.state&&context.resume()},destroy:function(){var _this;this.destination=null,this.masterVolumeNode.disconnect(),this.masterVolumeNode=null,this.masterMuteNode.disconnect(),this.masterMuteNode=null,this.game.config.audio.context?this.context.suspend():(_this=this).context.close().then(function(){_this.context=null}),BaseSoundManager.prototype.destroy.call(this)},setMute:function(value){return this.mute=value,this},mute:{get:function(){return 0===this.masterMuteNode.gain.value},set:function(value){this.masterMuteNode.gain.setValueAtTime(value?0:1,0),this.emit(Events$q.GLOBAL_MUTE,this,value)}},setVolume:function(value){return this.volume=value,this},volume:{get:function(){return this.masterVolumeNode.gain.value},set:function(value){this.masterVolumeNode.gain.setValueAtTime(value,0),this.emit(Events$q.GLOBAL_VOLUME,this,value)}}}),HTML5AudioSoundManager=HTML5AudioSoundManager_1,NoAudioSoundManager=NoAudioSoundManager_1,WebAudioSoundManager=WebAudioSoundManager_1,SoundManagerCreator_1={create:function(game){var audioConfig=game.config.audio,deviceAudio=game.device.audio;return new(audioConfig.noAudio||!deviceAudio.webAudio&&!deviceAudio.audioData?NoAudioSoundManager:deviceAudio.webAudio&&!audioConfig.disableWebAudio?WebAudioSoundManager:HTML5AudioSoundManager)(game)}},AddToDOM$1=Engine_1,AnimationManager=Angle_1,CacheManager=ContainsRect_1,CanvasPool$4=SetValue_1,events$1=Class_1,Config=CenterOn_1$1,CreateDOMContainer=Constraint_1,CreateRenderer=CircumCenter_1,DataManager$1=CustomMain,DebugHeader=Clone_1$4,Device=Graphics_1,DOMContentLoaded=HexagonalWorldToTileXY_1,EventEmitter$e=eventemitter3.exports,Events$p=ImageFile_1,InputManager=SAT_1,PluginCache$a=PluginCache,PluginManager=GetTilesWithinShape_1,ScaleManager=ParseObject_1,SceneManager=FromOrientationString_1,TextureEvents=TweenData_1,TextureManager=NumberTweenBuilder_1,TimeStep=time,VisibilityHandler=GetNearestPoint_1,SoundManagerCreator=SoundManagerCreator_1,Game_1=new events$1({initialize:function(config){this.config=new Config(config),this.renderer=null,this.domContainer=null,this.canvas=null,this.context=null,this.isBooted=!1,this.isRunning=!1,this.events=new EventEmitter$e,this.anims=new AnimationManager(this),this.textures=new TextureManager(this),this.cache=new CacheManager(this),this.registry=new DataManager$1(this),this.input=new InputManager(this,this.config),this.scene=new SceneManager(this,this.config.sceneConfig),this.device=Device,this.scale=new ScaleManager(this,this.config),this.sound=null,this.sound=SoundManagerCreator.create(this),this.loop=new TimeStep(this,this.config.fps),this.plugins=new PluginManager(this,this.config),this.pendingDestroy=!1,this.removeCanvas=!1,this.noReturn=!1,this.hasFocus=!1,DOMContentLoaded(this.boot.bind(this))},boot:function(){PluginCache$a.hasCore("EventEmitter")?(this.isBooted=!0,this.config.preBoot(this),this.scale.preBoot(),CreateRenderer(this),CreateDOMContainer(this),DebugHeader(this),AddToDOM$1(this.canvas,this.config.parent),this.textures.once(TextureEvents.READY,this.texturesReady,this),this.events.emit(Events$p.BOOT)):console.warn("Aborting. Core Plugins missing.")},texturesReady:function(){this.events.emit(Events$p.READY),this.start()},start:function(){this.isRunning=!0,this.config.postBoot(this),this.renderer?this.loop.start(this.step.bind(this)):this.loop.start(this.headlessStep.bind(this)),VisibilityHandler(this);var eventEmitter=this.events;eventEmitter.on(Events$p.HIDDEN,this.onHidden,this),eventEmitter.on(Events$p.VISIBLE,this.onVisible,this),eventEmitter.on(Events$p.BLUR,this.onBlur,this),eventEmitter.on(Events$p.FOCUS,this.onFocus,this)},step:function(time,delta){if(this.pendingDestroy)return this.runDestroy();var eventEmitter=this.events;eventEmitter.emit(Events$p.PRE_STEP,time,delta),eventEmitter.emit(Events$p.STEP,time,delta),this.scene.update(time,delta),eventEmitter.emit(Events$p.POST_STEP,time,delta);var renderer=this.renderer;renderer.preRender(),eventEmitter.emit(Events$p.PRE_RENDER,renderer,time,delta),this.scene.render(renderer),renderer.postRender(),eventEmitter.emit(Events$p.POST_RENDER,renderer,time,delta)},headlessStep:function(time,delta){if(this.pendingDestroy)return this.runDestroy();var eventEmitter=this.events;eventEmitter.emit(Events$p.PRE_STEP,time,delta),eventEmitter.emit(Events$p.STEP,time,delta),this.scene.update(time,delta),eventEmitter.emit(Events$p.POST_STEP,time,delta),eventEmitter.emit(Events$p.PRE_RENDER),eventEmitter.emit(Events$p.POST_RENDER)},onHidden:function(){this.loop.pause(),this.events.emit(Events$p.PAUSE)},onVisible:function(){this.loop.resume(),this.events.emit(Events$p.RESUME)},onBlur:function(){this.hasFocus=!1,this.loop.blur()},onFocus:function(){this.hasFocus=!0,this.loop.focus()},getFrame:function(){return this.loop.frame},getTime:function(){return this.loop.now},destroy:function(removeCanvas,noReturn){void 0===noReturn&&(noReturn=!1),this.pendingDestroy=!0,this.removeCanvas=removeCanvas,this.noReturn=noReturn},runDestroy:function(){this.scene.destroy(),this.events.emit(Events$p.DESTROY),this.events.removeAllListeners(),this.renderer&&this.renderer.destroy(),this.removeCanvas&&this.canvas&&(CanvasPool$4.remove(this.canvas),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)),this.domContainer&&this.domContainer.parentNode.removeChild(this.domContainer),this.loop.destroy(),this.pendingDestroy=!1}}),BitmapFontFile_1=function(matrix){if(!Array.isArray(matrix)||matrix.length<2||!Array.isArray(matrix[0]))return!1;for(var size=matrix[0].length,i=1;i<matrix.length;i++)if(matrix[i].length!==size)return!1;return!0},Pad=Pad_1,CheckMatrix$1=BitmapFontFile_1,Layer_1=function(array){for(var sourceRowCount=array.length,sourceColCount=array[0].length,result=new Array(sourceColCount),i=0;i<sourceColCount;i++){result[i]=new Array(sourceRowCount);for(var j=sourceRowCount-1;-1<j;j--)result[i][j]=array[j][i]}return result},CheckMatrix=BitmapFontFile_1,TransposeMatrix=Layer_1,HTMLTextureFile_1=function(matrix,direction){if(void 0===direction&&(direction=90),!CheckMatrix(matrix))return null;if(90===(direction="string"!=typeof direction?(direction%360+360)%360:direction)||-270===direction||"rotateLeft"===direction)(matrix=TransposeMatrix(matrix)).reverse();else if(-90===direction||270===direction||"rotateRight"===direction)matrix.reverse(),matrix=TransposeMatrix(matrix);else if(180===Math.abs(direction)||"rotate180"===direction){for(var i=0;i<matrix.length;i++)matrix[i].reverse();matrix.reverse()}return matrix},RotateMatrix$2=HTMLTextureFile_1,RotateMatrix$1=HTMLTextureFile_1,RotateMatrix=HTMLTextureFile_1,RotateLeft=AsepriteFile_1,RotateRight=GetAspectRatio_1,SafeRange$3=BinaryFile_1,SafeRange$2=BinaryFile_1,GetNewValue_1=function(array,startIndex,randomIndex){void 0===randomIndex&&(randomIndex=array.length);randomIndex=(startIndex=void 0===startIndex?0:startIndex)+Math.floor(Math.random()*randomIndex);return void 0===array[randomIndex]?null:array[randomIndex]},RoundAwayFromZero=Resolver_1;function swap(arr,i,j){var tmp=arr[i];arr[i]=arr[j],arr[j]=tmp}function defaultCompare(a,b){return a<b?-1:b<a?1:0}var QuickSelect=function(arr,k,left,right,compare){for(void 0===left&&(left=0),void 0===right&&(right=arr.length-1),void 0===compare&&(compare=defaultCompare);left<right;){var n,m,s,newLeft,newRight;600<right-left&&(n=right-left+1,m=k-left+1,newLeft=Math.log(n),s=.5*Math.exp(2*newLeft/3),newRight=.5*Math.sqrt(newLeft*s*(n-s)/n)*(m-n/2<0?-1:1),newLeft=Math.max(left,Math.floor(k-m*s/n+newRight)),newRight=Math.min(right,Math.floor(k+(n-m)*s/n+newRight)),QuickSelect(arr,k,newLeft,newRight,compare));var t=arr[k],i=left,j=right;for(swap(arr,left,k),0<compare(arr[right],t)&&swap(arr,left,right);i<j;){for(swap(arr,i,j),i++,j--;compare(arr[i],t)<0;)i++;for(;0<compare(arr[j],t);)j--}0===compare(arr[left],t)?swap(arr,left,j):swap(arr,++j,right),j<=k&&(left=j+1),k<=j&&(right=j-1)}},MatterWrap_1=QuickSelect,GetValue$n=GetValue_1,Shuffle$1=Shuffle_1$2,CenterOn_1=function(a,b,options){var max=GetValue$n(options,"max",0),qty=GetValue$n(options,"qty",1),random=GetValue$n(options,"random",!1),total=GetValue$n(options,"randomB",!1),repeat=GetValue$n(options,"repeat",0),yoyo=GetValue$n(options,"yoyo",!1),out=[];total&&Shuffle$1(b),-1===repeat&&(repeat=0===max?0:(total=a.length*b.length*qty,yoyo&&(total*=2),Math.ceil(max/total)));for(var i=0;i<=repeat;i++){var chunk=function(a,b,qty){for(var out=[],aIndex=0;aIndex<a.length;aIndex++)for(var bIndex=0;bIndex<b.length;bIndex++)for(var i=0;i<qty;i++)out.push({a:a[aIndex],b:b[bIndex]});return out}(a,b,qty);random&&Shuffle$1(chunk),out=out.concat(chunk),yoyo&&(chunk.reverse(),out=out.concat(chunk))}return max&&out.splice(max),out},SpliceOne$3=SpliceOne_1,SafeRange$1=BinaryFile_1,SpliceOne$2=SpliceOne_1,SafeRange=BinaryFile_1;function Compare(a,b){return String(a).localeCompare(b)}function RunPass(arr,comp,chk,result){for(var r,e,li,ri,len=arr.length,i=0,dbl=2*chk,l=0;l<len;l+=dbl)for(len<(e=(r=l+chk)+chk)&&(e=len),li=l,ri=r=len<r?len:r;;)if(li<r&&ri<e)comp(arr[li],arr[ri])<=0?result[i++]=arr[li++]:result[i++]=arr[ri++];else if(li<r)result[i++]=arr[li++];else{if(!(ri<e))break;result[i++]=arr[ri++]}}var Extend_1=function(array,result){result=function(array,compare){var len=array.length;if(len<=1)return array;for(var buffer=new Array(len),chk=1;chk<len;chk*=2){RunPass(array,compare,chk,buffer);var tmp=array;array=buffer,buffer=tmp}return array}(array,result=void 0===result?Compare:result);return result!==array&&RunPass(result,null,array.length,array),array},array={Matrix:{CheckMatrix:BitmapFontFile_1,MatrixToString:function(matrix){var str="";if(!CheckMatrix$1(matrix))return str;for(var r=0;r<matrix.length;r++){for(var c=0;c<matrix[r].length;c++){var cell=matrix[r][c].toString();str+="undefined"!==cell?Pad(cell,2):"?",c<matrix[r].length-1&&(str+=" |")}if(r<matrix.length-1){str+="\n";for(var i=0;i<matrix[r].length;i++)str+="---",i<matrix[r].length-1&&(str+="+");str+="\n"}}return str},ReverseColumns:function(matrix){return matrix.reverse()},ReverseRows:function(matrix){for(var i=0;i<matrix.length;i++)matrix[i].reverse();return matrix},Rotate180:function(matrix){return RotateMatrix$2(matrix,180)},RotateLeft:function(matrix){return RotateMatrix$1(matrix,90)},RotateMatrix:HTMLTextureFile_1,RotateRight:function(matrix){return RotateMatrix(matrix,-90)},Translate:function(matrix,x,y){if(void 0===x&&(x=0),0!==(y=void 0===y?0:y)&&(y<0?RotateLeft(matrix,Math.abs(y)):RotateRight(matrix,y)),0!==x)for(var i=0;i<matrix.length;i++){var row=matrix[i];x<0?RotateLeft(row,Math.abs(x)):RotateRight(row,x)}return matrix},TransposeMatrix:Layer_1},Add:function(array,item,limit,callback,context){if(void 0===context&&(context=array),0<limit){var remaining=limit-array.length;if(remaining<=0)return null}if(!Array.isArray(item))return-1===array.indexOf(item)?(array.push(item),callback&&callback.call(context,item),item):null;for(var itemLength=item.length-1;0<=itemLength;)-1!==array.indexOf(item[itemLength])&&item.splice(itemLength,1),itemLength--;if(0===(itemLength=item.length))return null;0<limit&&remaining<itemLength&&(item.splice(remaining),itemLength=remaining);for(var i=0;i<itemLength;i++){var entry=item[i];array.push(entry),callback&&callback.call(context,entry)}return item},AddAt:function(array,item,index,limit,callback,context){if(void 0===index&&(index=0),void 0===context&&(context=array),0<limit){var remaining=limit-array.length;if(remaining<=0)return null}if(!Array.isArray(item))return-1===array.indexOf(item)?(array.splice(index,0,item),callback&&callback.call(context,item),item):null;for(var itemLength=item.length-1;0<=itemLength;)-1!==array.indexOf(item[itemLength])&&item.pop(),itemLength--;if(0===(itemLength=item.length))return null;0<limit&&remaining<itemLength&&(item.splice(remaining),itemLength=remaining);for(var i=itemLength-1;0<=i;i--){var entry=item[i];array.splice(index,0,entry),callback&&callback.call(context,entry)}return item},BringToTop:function(array,item){var currentIndex=array.indexOf(item);return-1!==currentIndex&&currentIndex<array.length&&(array.splice(currentIndex,1),array.push(item)),item},CountAllMatching:function(array,property,value,startIndex,endIndex){void 0===endIndex&&(endIndex=array.length);var total=0;if(SafeRange$3(array,startIndex=void 0===startIndex?0:startIndex,endIndex))for(var i=startIndex;i<endIndex;i++)array[i][property]===value&&total++;return total},Each:function(array,callback,context){for(var args=[null],i=3;i<arguments.length;i++)args.push(arguments[i]);for(i=0;i<array.length;i++)args[0]=array[i],callback.apply(context,args);return array},EachInRange:function(array,callback,context,startIndex,endIndex){if(void 0===endIndex&&(endIndex=array.length),SafeRange$2(array,startIndex=void 0===startIndex?0:startIndex,endIndex)){for(var args=[null],i=5;i<arguments.length;i++)args.push(arguments[i]);for(i=startIndex;i<endIndex;i++)args[0]=array[i],callback.apply(context,args)}return array},FindClosestInSorted:GetEaseFunction_1,GetAll:Parse2DArray_1,GetFirst:Centroid_1,GetRandom:GetNewValue_1,MoveDown:function(array,item){var item2,index2,currentIndex=array.indexOf(item);return 0<currentIndex&&(item2=array[currentIndex-1],index2=array.indexOf(item2),array[currentIndex]=item2,array[index2]=item),array},MoveTo:function(array,item,index){var currentIndex=array.indexOf(item);if(-1===currentIndex||index<0||index>=array.length)throw new Error("Supplied index out of bounds");return currentIndex!==index&&(array.splice(currentIndex,1),array.splice(index,0,item)),item},MoveUp:function(array,item){var item2,index2,currentIndex=array.indexOf(item);return-1!==currentIndex&&currentIndex<array.length-1&&(item2=array[currentIndex+1],index2=array.indexOf(item2),array[currentIndex]=item2,array[index2]=item),array},MoveAbove:function(array,item1,baseIndex){if(item1===baseIndex)return array;var currentIndex=array.indexOf(item1),baseIndex=array.indexOf(baseIndex);if(currentIndex<0||baseIndex<0)throw new Error("Supplied items must be elements of the same array");return baseIndex<currentIndex||(array.splice(currentIndex,1),baseIndex===array.length-1?array.push(item1):array.splice(baseIndex,0,item1)),array},MoveBelow:function(array,item1,baseIndex){if(item1===baseIndex)return array;var currentIndex=array.indexOf(item1),baseIndex=array.indexOf(baseIndex);if(currentIndex<0||baseIndex<0)throw new Error("Supplied items must be elements of the same array");return currentIndex<baseIndex||(array.splice(currentIndex,1),0===baseIndex?array.unshift(item1):array.splice(baseIndex,0,item1)),array},NumberArray:GetCenter_1,NumberArrayStep:function(start,end,step){void 0===start&&(start=0),void 0===step&&(step=1),null===(end=void 0===end?null:end)&&(end=start,start=0);for(var result=[],total=Math.max(RoundAwayFromZero((end-start)/(step||1)),0),i=0;i<total;i++)result.push(start),start+=step;return result},QuickSelect:MatterWrap_1,Range:CenterOn_1,Remove:Remove_1,RemoveAt:function(array,item,callback,context){if(void 0===context&&(context=array),item<0||item>array.length-1)throw new Error("Index out of bounds");item=SpliceOne$3(array,item);return callback&&callback.call(context,item),item},RemoveBetween:function(array,startIndex,endIndex,callback,context){if(void 0===endIndex&&(endIndex=array.length),void 0===context&&(context=array),SafeRange$1(array,startIndex=void 0===startIndex?0:startIndex,endIndex)){var removed=array.splice(startIndex,endIndex-startIndex);if(callback)for(var i=0;i<removed.length;i++){var entry=removed[i];callback.call(context,entry)}return removed}return[]},RemoveRandomElement:function(array,start,randomIndex){void 0===randomIndex&&(randomIndex=array.length);randomIndex=(start=void 0===start?0:start)+Math.floor(Math.random()*randomIndex);return SpliceOne$2(array,randomIndex)},Replace:function(array,index2,newChild){var index1=array.indexOf(index2),index2=array.indexOf(newChild);return-1!==index1&&-1===index2&&(array[index1]=newChild,!0)},RotateLeft:AsepriteFile_1,RotateRight:GetAspectRatio_1,SafeRange:BinaryFile_1,SendToBack:function(array,item){var currentIndex=array.indexOf(item);return-1!==currentIndex&&0<currentIndex&&(array.splice(currentIndex,1),array.unshift(item)),item},SetAll:function(array,property,value,startIndex,endIndex){if(void 0===endIndex&&(endIndex=array.length),SafeRange(array,startIndex=void 0===startIndex?0:startIndex,endIndex))for(var i=startIndex;i<endIndex;i++){var entry=array[i];entry.hasOwnProperty(property)&&(entry[property]=value)}return array},Shuffle:Shuffle_1$2,SortByDigits:HasAny_1,SpliceOne:SpliceOne_1,StableSort:Extend_1,Swap:function(array,item1,item2){if(item1===item2)return array;var index1=array.indexOf(item1),index2=array.indexOf(item2);if(index1<0||index2<0)throw new Error("Supplied items must be elements of the same array");return array[index1]=item2,array[index2]=item1,array}},ArrayUtils$1=array,NOOP$9=gameConfig,StableSort$5=Extend_1,Base64Decode_1=new Class_1({initialize:function(parent){this.parent=parent,this.list=[],this.position=0,this.addCallback=NOOP$9,this.removeCallback=NOOP$9,this._sortKey=""},add:function(child,skipCallback){return skipCallback?ArrayUtils$1.Add(this.list,child):ArrayUtils$1.Add(this.list,child,0,this.addCallback,this)},addAt:function(child,index,skipCallback){return skipCallback?ArrayUtils$1.AddAt(this.list,child,index):ArrayUtils$1.AddAt(this.list,child,index,0,this.addCallback,this)},getAt:function(index){return this.list[index]},getIndex:function(child){return this.list.indexOf(child)},sort:function(property,handler){return property&&StableSort$5(this.list,handler=void 0===handler?function(childA,childB){return childA[property]-childB[property]}:handler),this},getByName:function(name){return ArrayUtils$1.GetFirst(this.list,"name",name)},getRandom:function(startIndex,length){return ArrayUtils$1.GetRandom(this.list,startIndex,length)},getFirst:function(property,value,startIndex,endIndex){return ArrayUtils$1.GetFirst(this.list,property,value,startIndex,endIndex)},getAll:function(property,value,startIndex,endIndex){return ArrayUtils$1.GetAll(this.list,property,value,startIndex,endIndex)},count:function(property,value){return ArrayUtils$1.CountAllMatching(this.list,property,value)},swap:function(child1,child2){ArrayUtils$1.Swap(this.list,child1,child2)},moveTo:function(child,index){return ArrayUtils$1.MoveTo(this.list,child,index)},moveAbove:function(child1,child2){return ArrayUtils$1.MoveAbove(this.list,child1,child2)},moveBelow:function(child1,child2){return ArrayUtils$1.MoveBelow(this.list,child1,child2)},remove:function(child,skipCallback){return skipCallback?ArrayUtils$1.Remove(this.list,child):ArrayUtils$1.Remove(this.list,child,this.removeCallback,this)},removeAt:function(index,skipCallback){return skipCallback?ArrayUtils$1.RemoveAt(this.list,index):ArrayUtils$1.RemoveAt(this.list,index,this.removeCallback,this)},removeBetween:function(startIndex,endIndex,skipCallback){return skipCallback?ArrayUtils$1.RemoveBetween(this.list,startIndex,endIndex):ArrayUtils$1.RemoveBetween(this.list,startIndex,endIndex,this.removeCallback,this)},removeAll:function(skipCallback){for(var i=this.list.length;i--;)this.remove(this.list[i],skipCallback);return this},bringToTop:function(child){return ArrayUtils$1.BringToTop(this.list,child)},sendToBack:function(child){return ArrayUtils$1.SendToBack(this.list,child)},moveUp:function(child){return ArrayUtils$1.MoveUp(this.list,child),child},moveDown:function(child){return ArrayUtils$1.MoveDown(this.list,child),child},reverse:function(){return this.list.reverse(),this},shuffle:function(){return ArrayUtils$1.Shuffle(this.list),this},replace:function(oldChild,newChild){return ArrayUtils$1.Replace(this.list,oldChild,newChild)},exists:function(child){return-1<this.list.indexOf(child)},setAll:function(property,value,startIndex,endIndex){return ArrayUtils$1.SetAll(this.list,property,value,startIndex,endIndex),this},each:function(callback,context){for(var args=[null],i=2;i<arguments.length;i++)args.push(arguments[i]);for(i=0;i<this.list.length;i++)args[0]=this.list[i],callback.apply(context,args)},shutdown:function(){this.removeAll(),this.list=[]},destroy:function(){this.removeAll(),this.parent=null,this.addCallback=null,this.removeCallback=null},length:{get:function(){return this.list.length}},first:{get:function(){return(this.position=0)<this.list.length?this.list[0]:null}},last:{get:function(){return 0<this.list.length?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return 0<this.position?(this.position--,this.list[this.position]):null}}}),List$3=Base64Decode_1,HasValue_1=PluginCache,GameObjectEvents$1=events$h,SceneEvents$b=events$g,StableSort$4=Extend_1,HTMLFile_1=new Class_1({Extends:List$3,initialize:function(scene){List$3.call(this,scene),this.sortChildrenFlag=!1,this.scene=scene,this.systems=scene.sys,this.events=scene.sys.events,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.events.once(SceneEvents$b.BOOT,this.boot,this),this.events.on(SceneEvents$b.START,this.start,this)},boot:function(){this.events.once(SceneEvents$b.DESTROY,this.destroy,this)},addChildCallback:function(gameObject){gameObject.displayList&&gameObject.displayList!==this&&gameObject.removeFromDisplayList(),gameObject.displayList||(this.queueDepthSort(),gameObject.displayList=this,gameObject.emit(GameObjectEvents$1.ADDED_TO_SCENE,gameObject,this.scene),this.events.emit(SceneEvents$b.ADDED_TO_SCENE,gameObject,this.scene))},removeChildCallback:function(gameObject){this.queueDepthSort(),gameObject.displayList=null,gameObject.emit(GameObjectEvents$1.REMOVED_FROM_SCENE,gameObject,this.scene),this.events.emit(SceneEvents$b.REMOVED_FROM_SCENE,gameObject,this.scene)},start:function(){this.events.once(SceneEvents$b.SHUTDOWN,this.shutdown,this)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&(StableSort$4(this.list,this.sortByDepth),this.sortChildrenFlag=!1)},sortByDepth:function(childA,childB){return childA._depth-childB._depth},getChildren:function(){return this.list},shutdown:function(){for(var list=this.list,i=list.length;i--;)list[i].destroy(!0);list.length=0,this.events.off(SceneEvents$b.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(SceneEvents$b.START,this.start,this),this.scene=null,this.systems=null,this.events=null}});HasValue_1.register("DisplayList",HTMLFile_1,"displayList");var DisplayList_1=HTMLFile_1,HexagonalTileToWorldY_1={PROCESS_QUEUE_ADD:"add",PROCESS_QUEUE_REMOVE:"remove"},AnimationJSONFile_1=Class_1,EventEmitter$d=eventemitter3.exports,Events$o=HexagonalTileToWorldY_1,ParseTilesets_1=new AnimationJSONFile_1({Extends:EventEmitter$d,initialize:function(){EventEmitter$d.call(this),this._pending=[],this._active=[],this._destroy=[],this._toProcess=0,this.checkQueue=!1},add:function(item){return this._pending.push(item),this._toProcess++,item},remove:function(item){return this._destroy.push(item),this._toProcess++,item},removeAll:function(){for(var list=this._active,destroy=this._destroy,i=list.length;i--;)destroy.push(list[i]),this._toProcess++;return this},update:function(){if(0===this._toProcess)return this._active;for(var list=this._destroy,active=this._active,i=0;i<list.length;i++){var item=list[i],idx=active.indexOf(item);-1!==idx&&(active.splice(idx,1),this.emit(Events$o.PROCESS_QUEUE_REMOVE,item))}for(list.length=0,list=this._pending,i=0;i<list.length;i++)item=list[i],(!this.checkQueue||this.checkQueue&&-1===active.indexOf(item))&&(active.push(item),this.emit(Events$o.PROCESS_QUEUE_ADD,item));return list.length=0,this._toProcess=0,active},getActive:function(){return this._active},length:{get:function(){return this._active.length}},destroy:function(){this._toProcess=0,this._pending=[],this._active=[],this._destroy=[]}}),ProcessQueue$1=ParseTilesets_1,GetTileAtWorldXY_1=PluginCache,SceneEvents$a=events$g,Inflate_1=new Class_1({Extends:ProcessQueue$1,initialize:function(scene){ProcessQueue$1.call(this),this.checkQueue=!0,this.scene=scene,this.systems=scene.sys,scene.sys.events.once(SceneEvents$a.BOOT,this.boot,this),scene.sys.events.on(SceneEvents$a.START,this.start,this)},boot:function(){this.systems.events.once(SceneEvents$a.DESTROY,this.destroy,this)},start:function(){var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents$a.PRE_UPDATE,this.update,this),eventEmitter.on(SceneEvents$a.UPDATE,this.sceneUpdate,this),eventEmitter.once(SceneEvents$a.SHUTDOWN,this.shutdown,this)},sceneUpdate:function(time,delta){for(var list=this._active,length=list.length,i=0;i<length;i++){var gameObject=list[i];gameObject.active&&gameObject.preUpdate.call(gameObject,time,delta)}},shutdown:function(){for(var i=this._active.length;i--;)this._active[i].destroy(!0);for(i=this._pending.length;i--;)this._pending[i].destroy(!0);for(i=this._destroy.length;i--;)this._destroy[i].destroy(!0);this._toProcess=0,this._pending=[],this._active=[],this._destroy=[],this.removeAllListeners();var eventEmitter=this.systems.events;eventEmitter.off(SceneEvents$a.PRE_UPDATE,this.update,this),eventEmitter.off(SceneEvents$a.UPDATE,this.sceneUpdate,this),eventEmitter.off(SceneEvents$a.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.systems.events.off(SceneEvents$a.START,this.start,this),this.scene=null,this.systems=null}});GetTileAtWorldXY_1.register("UpdateList",Inflate_1,"updateList");var UpdateList_1=Inflate_1,BuildFromPolygon_1=TransformMatrix,tempMatrix1$4=new BuildFromPolygon_1,tempMatrix2$4=new BuildFromPolygon_1,tempMatrix3$4=new BuildFromPolygon_1,result={camera:tempMatrix1$4,sprite:tempMatrix2$4,calc:tempMatrix3$4},GetCalcMatrix_1=function(src,camera,parentMatrix){var camMatrix=tempMatrix1$4,spriteMatrix=tempMatrix2$4,calcMatrix=tempMatrix3$4;return spriteMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY),camMatrix.copyFrom(camera.matrix),parentMatrix?(camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY),spriteMatrix.e=src.x,spriteMatrix.f=src.y):(spriteMatrix.e-=camera.scrollX*src.scrollFactorX,spriteMatrix.f-=camera.scrollY*src.scrollFactorY),camMatrix.multiply(spriteMatrix,calcMatrix),result},MATH=math,GetValue$m=GetValue_1,GetAdvancedValue_1=function(value,key,defaultValue){value=GetValue$m(value,key,null);if(null===value)return defaultValue;if(Array.isArray(value))return MATH.RND.pick(value);if("object"==typeof value){if(value.hasOwnProperty("randInt"))return MATH.RND.integerInRange(value.randInt[0],value.randInt[1]);if(value.hasOwnProperty("randFloat"))return MATH.RND.realInRange(value.randFloat[0],value.randFloat[1])}else if("function"==typeof value)return value(key);return value},BlendModes$4=BlendModes$8,GetAdvancedValue$m=GetAdvancedValue_1,BuildGameObject_1=function(scene,gameObject,config){gameObject.x=GetAdvancedValue$m(config,"x",0),gameObject.y=GetAdvancedValue$m(config,"y",0),gameObject.depth=GetAdvancedValue$m(config,"depth",0),gameObject.flipX=GetAdvancedValue$m(config,"flipX",!1),gameObject.flipY=GetAdvancedValue$m(config,"flipY",!1);var ox=GetAdvancedValue$m(config,"scale",null);"number"==typeof ox?gameObject.setScale(ox):null!==ox&&(gameObject.scaleX=GetAdvancedValue$m(ox,"x",1),gameObject.scaleY=GetAdvancedValue$m(ox,"y",1));var oy=GetAdvancedValue$m(config,"scrollFactor",null);"number"==typeof oy?gameObject.setScrollFactor(oy):null!==oy&&(gameObject.scrollFactorX=GetAdvancedValue$m(oy,"x",1),gameObject.scrollFactorY=GetAdvancedValue$m(oy,"y",1)),gameObject.rotation=GetAdvancedValue$m(config,"rotation",0);ox=GetAdvancedValue$m(config,"angle",null);null!==ox&&(gameObject.angle=ox),gameObject.alpha=GetAdvancedValue$m(config,"alpha",1);oy=GetAdvancedValue$m(config,"origin",null);return"number"==typeof oy?gameObject.setOrigin(oy):null!==oy&&(ox=GetAdvancedValue$m(oy,"x",.5),oy=GetAdvancedValue$m(oy,"y",.5),gameObject.setOrigin(ox,oy)),gameObject.blendMode=GetAdvancedValue$m(config,"blendMode",BlendModes$4.NORMAL),gameObject.visible=GetAdvancedValue$m(config,"visible",!0),GetAdvancedValue$m(config,"add",!0)&&scene.sys.displayList.add(gameObject),gameObject.preUpdate&&scene.sys.updateList.add(gameObject),gameObject},GetAdvancedValue$l=GetAdvancedValue_1,BuildGameObjectAnimation_1=function(sprite,play){var anims,key,delay,repeat,repeatDelay,yoyo,playConfig,delayedPlay=GetAdvancedValue$l(play,"anims",null);return null===delayedPlay||("string"==typeof delayedPlay?sprite.anims.play(delayedPlay):"object"==typeof delayedPlay&&(anims=sprite.anims,(key=GetAdvancedValue$l(delayedPlay,"key",void 0))&&(playConfig=GetAdvancedValue$l(delayedPlay,"startFrame",void 0),delay=GetAdvancedValue$l(delayedPlay,"delay",0),repeat=GetAdvancedValue$l(delayedPlay,"repeat",0),repeatDelay=GetAdvancedValue$l(delayedPlay,"repeatDelay",0),yoyo=GetAdvancedValue$l(delayedPlay,"yoyo",!1),play=GetAdvancedValue$l(delayedPlay,"play",!1),delayedPlay=GetAdvancedValue$l(delayedPlay,"delayedPlay",0),playConfig={key:key,delay:delay,repeat:repeat,repeatDelay:repeatDelay,yoyo:yoyo,startFrame:playConfig},play?anims.play(playConfig):0<delayedPlay?anims.playAfterDelay(playConfig,delayedPlay):anims.load(playConfig)))),sprite};function getValue(node,attribute){return parseInt(node.getAttribute(attribute),10)}var GetTargets_1=function(xml,frame,xSpacing,ySpacing,texture){void 0===xSpacing&&(xSpacing=0),void 0===ySpacing&&(ySpacing=0);var textureX=frame.cutX,textureY=frame.cutY,textureWidth=frame.source.width,textureHeight=frame.source.height,sourceIndex=frame.sourceIndex,data={},info=xml.getElementsByTagName("info")[0],common=xml.getElementsByTagName("common")[0];data.font=info.getAttribute("face"),data.size=getValue(info,"size"),data.lineHeight=getValue(common,"lineHeight")+ySpacing,data.chars={};var top,left,letters=xml.getElementsByTagName("char"),adjustForTrim=void 0!==frame&&frame.trimmed;adjustForTrim&&(top=frame.height,left=frame.width);for(var i=0;i<letters.length;i++){var node=letters[i],charCode=getValue(node,"id"),letter=String.fromCharCode(charCode),gx=getValue(node,"x"),charFrame=getValue(node,"y"),gw=getValue(node,"width"),gh=getValue(node,"height");adjustForTrim&&(gx<left&&(left=gx),charFrame<top&&(top=charFrame)),adjustForTrim&&0!==top&&0!==left&&(gx-=frame.x,charFrame-=frame.y);var u0=(textureX+gx)/textureWidth,v0=(textureY+charFrame)/textureHeight,u1=(textureX+gx+gw)/textureWidth,v1=(textureY+charFrame+gh)/textureHeight;data.chars[charCode]={x:gx,y:charFrame,width:gw,height:gh,centerX:Math.floor(gw/2),centerY:Math.floor(gh/2),xOffset:getValue(node,"xoffset"),yOffset:getValue(node,"yoffset"),xAdvance:getValue(node,"xadvance")+xSpacing,data:{},kerning:{},u0:u0,v0:v0,u1:u1,v1:v1},!texture||0===gw||0===gh||(charFrame=texture.add(letter,sourceIndex,gx,charFrame,gw,gh))&&charFrame.setUVs(gw,gh,u0,v0,u1,v1)}for(var kernings=xml.getElementsByTagName("kerning"),i=0;i<kernings.length;i++){var amount=kernings[i],first=getValue(amount,"first"),second=getValue(amount,"second"),amount=getValue(amount,"amount");data.chars[second].kerning[first]=amount}return data},ParseXMLBitmapFont$2=GetTargets_1,BatchChar=function(pipeline,src,tx2,glyph,tx1,ty1,calcMatrix,ty3,tintTL,tintTR,tintBL,tintBR,tintEffect,texture,textureUnit){var ty2=tx2.x-src.displayOriginX+tx1,y=tx2.y-src.displayOriginY+ty1,xw=ty2+tx2.w,tx3=y+tx2.h,tx0=calcMatrix.getXRound(ty2,y,ty3),ty0=calcMatrix.getYRound(ty2,y,ty3),tx1=calcMatrix.getXRound(ty2,tx3,ty3),ty1=calcMatrix.getYRound(ty2,tx3,ty3),tx2=calcMatrix.getXRound(xw,tx3,ty3),ty2=calcMatrix.getYRound(xw,tx3,ty3),tx3=calcMatrix.getXRound(xw,y,ty3),ty3=calcMatrix.getYRound(xw,y,ty3);pipeline.batchQuad(src,tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,glyph.u0,glyph.v0,glyph.u1,glyph.v1,tintTL,tintTR,tintBL,tintBR,tintEffect,texture,textureUnit)},GetCalcMatrix$k=GetCalcMatrix_1,Utils$l=GetProps_1,plugins=function(renderer,src,srcShadowColor,srcShadowAlpha){if(0!==src._text.length){srcShadowColor.addToRenderList(src);var char,pipeline=renderer.pipelines.set(src.pipeline,src),calcMatrix=GetCalcMatrix$k(src,srcShadowColor,srcShadowAlpha).calc,roundPixels=srcShadowColor.roundPixels,cameraAlpha=srcShadowColor.alpha,charColors=src.charColors,tintEffect=src.tintFill,getTint=Utils$l.getTintAppendFloatAlpha,tintTL=getTint(src.tintTopLeft,cameraAlpha*src._alphaTL),tintTR=getTint(src.tintTopRight,cameraAlpha*src._alphaTR),tintBL=getTint(src.tintBottomLeft,cameraAlpha*src._alphaBL),tintBR=getTint(src.tintBottomRight,cameraAlpha*src._alphaBR),texture=src.frame.glTexture,textureUnit=pipeline.setGameObject(src),characters=src.getTextBounds(!1).characters,dropShadowX=src.dropShadowX,dropShadowY=src.dropShadowY,srcShadowAlpha=0!==dropShadowX||0!==dropShadowY;if(renderer.pipelines.preBatch(src),srcShadowAlpha)for(var srcShadowColor=src.dropShadowColor,srcShadowAlpha=src.dropShadowAlpha,shadowTL=getTint(srcShadowColor,cameraAlpha*srcShadowAlpha*src._alphaTL),shadowTR=getTint(srcShadowColor,cameraAlpha*srcShadowAlpha*src._alphaTR),shadowBL=getTint(srcShadowColor,cameraAlpha*srcShadowAlpha*src._alphaBL),shadowBR=getTint(srcShadowColor,cameraAlpha*srcShadowAlpha*src._alphaBR),i=0;i<characters.length;i++)glyph=(char=characters[i]).glyph,32!==char.code&&0!==glyph.width&&0!==glyph.height&&BatchChar(pipeline,src,char,glyph,dropShadowX,dropShadowY,calcMatrix,roundPixels,shadowTL,shadowTR,shadowBL,shadowBR,1,texture,textureUnit);for(i=0;i<characters.length;i++){var charTintEffect,charTintTL,charTintTR,charTintBL,charTintBR,glyph=(char=characters[i]).glyph;32!==char.code&&0!==glyph.width&&0!==glyph.height&&(charColors[char.i]?(charTintEffect=(charTintBR=charColors[char.i]).tintEffect,charTintTL=getTint(charTintBR.tintTL,cameraAlpha*src._alphaTL),charTintTR=getTint(charTintBR.tintTR,cameraAlpha*src._alphaTR),charTintBL=getTint(charTintBR.tintBL,cameraAlpha*src._alphaBL),charTintBR=getTint(charTintBR.tintBR,cameraAlpha*src._alphaBR),BatchChar(pipeline,src,char,glyph,0,0,calcMatrix,roundPixels,charTintTL,charTintTR,charTintBL,charTintBR,charTintEffect,texture,textureUnit)):BatchChar(pipeline,src,char,glyph,0,0,calcMatrix,roundPixels,tintTL,tintTR,tintBL,tintBR,tintEffect,texture,textureUnit))}renderer.pipelines.postBatch(src)}},GetCalcMatrix$j=GetCalcMatrix_1,parsers=function(renderer,ctx,src,camera,calcMatrix){var alpha=camera.alpha*src.alpha;if(alpha<=0)return!1;calcMatrix=GetCalcMatrix$j(src,camera,calcMatrix).calc;return ctx.globalCompositeOperation=renderer.blendModes[src.blendMode],ctx.globalAlpha=alpha,ctx.save(),calcMatrix.setToContext(ctx),ctx.imageSmoothingEnabled=!(!renderer.antialias||src.frame&&src.frame.source.scaleMode),!0},SetTransform$d=parsers,Equals_1$1=function(renderer,src,camera,bounds){var text=src._text,textLength=text.length,ctx=renderer.currentContext;if(0!==textLength&&SetTransform$d(renderer,ctx,src,camera,bounds)){camera.addToRenderList(src);var bounds=src.fromAtlas?src.frame:src.texture.frames.__BASE,chars=src.fontData.chars,lineHeight=src.fontData.lineHeight,letterSpacing=src._letterSpacing,xAdvance=0,yAdvance=0,charCode=0,glyph=null,glyphX=0,glyphY=0,glyphW=0,glyphH=0,x=0,y=0,lastGlyph=null,lastCharCode=0,image=bounds.source.image,textureX=bounds.cutX,textureY=bounds.cutY,scale=src._fontSize/src.fontData.size,align=src._align,currentLine=0,lineOffsetX=0,bounds=src.getTextBounds(!1);0<src.maxWidth&&(textLength=(text=bounds.wrappedText).length);var lineData=src._bounds.lines;1===align?lineOffsetX=(lineData.longest-lineData.lengths[0])/2:2===align&&(lineOffsetX=lineData.longest-lineData.lengths[0]),ctx.translate(-src.displayOriginX,-src.displayOriginY);for(var kerningOffset,roundPixels=camera.roundPixels,i=0;i<textLength;i++)10!==(charCode=text.charCodeAt(i))?(glyph=chars[charCode])&&(glyphX=textureX+glyph.x,glyphY=textureY+glyph.y,glyphW=glyph.width,glyphH=glyph.height,x=glyph.xOffset+xAdvance,y=glyph.yOffset+yAdvance,null!==lastGlyph&&(x+=void 0!==(kerningOffset=glyph.kerning[lastCharCode])?kerningOffset:0),x*=scale,y*=scale,x+=lineOffsetX,xAdvance+=glyph.xAdvance+letterSpacing,lastGlyph=glyph,lastCharCode=charCode,0!==glyphW&&0!==glyphH&&32!==charCode&&(roundPixels&&(x=Math.round(x),y=Math.round(y)),ctx.save(),ctx.translate(x,y),ctx.scale(scale,scale),ctx.drawImage(image,glyphX,glyphY,glyphW,glyphH,0,0,glyphW,glyphH),ctx.restore())):(currentLine++,1===align?lineOffsetX=(lineData.longest-lineData.lengths[currentLine])/2:2===align&&(lineOffsetX=lineData.longest-lineData.lengths[currentLine]),xAdvance=0,yAdvance+=lineHeight,lastGlyph=null);ctx.restore()}},Clamp$4=Character,Components$s=components$3,GameObject$l=GameObject_1,GetBitmapTextSize=function(src,round,updateOrigin,out){if(void 0===updateOrigin&&(updateOrigin=!1),void 0===out)return out={local:{x:0,y:0,width:0,height:0},global:{x:0,y:0,width:0,height:0},lines:{shortest:0,longest:0,lengths:null,height:0},wrappedText:"",words:[],characters:[],scaleX:0,scaleY:0};var glyphKerningOffset,str,index,value,text=src.text,textLength=text.length,maxWidth=src.maxWidth,wordWrapCharCode=src.wordWrapCharCode,bx=Number.MAX_VALUE,by=Number.MAX_VALUE,bw=0,bh=0,chars=src.fontData.chars,lineHeight=src.fontData.lineHeight,letterSpacing=src.letterSpacing,xAdvance=0,yAdvance=0,charCode=0,glyph=null,align=src._align,x=0,y=0,scale=src.fontSize/src.fontData.size,sx=scale*src.scaleX,sy=scale*src.scaleY,lastGlyph=null,lastCharCode=0,lineWidths=[],shortestLine=Number.MAX_VALUE,longestLine=0,currentLine=0,currentLineWidth=0,words=[],characters=[],current=null;if(0<maxWidth){for(i=0;i<textLength;i++)10!==(charCode=text.charCodeAt(i))?(glyph=chars[charCode])&&(null!==lastGlyph&&(glyphKerningOffset=glyph.kerning[lastCharCode]),charCode===wordWrapCharCode?null!==current&&(words.push({word:current.word,i:current.i,x:current.x*sx,y:current.y*sy,w:current.w*sx,h:current.h*sy,cr:!1}),current=null):((current=null===current?{word:"",i:i,x:xAdvance,y:yAdvance,w:0,h:lineHeight,cr:!1}:current).word=current.word.concat(text[i]),current.w+=glyph.xOffset+glyph.xAdvance+(void 0!==glyphKerningOffset?glyphKerningOffset:0)),xAdvance+=glyph.xAdvance+letterSpacing,lastGlyph=glyph,lastCharCode=charCode):(null!==current&&(words.push({word:current.word,i:current.i,x:current.x*sx,y:current.y*sy,w:current.w*sx,h:current.h*sy,cr:!0}),current=null),xAdvance=0,yAdvance+=lineHeight,lastGlyph=null);null!==current&&words.push({word:current.word,i:current.i,x:current.x*sx,y:current.y*sy,w:current.w*sx,h:current.h*sy,cr:!1});for(var xAdvance=0,yAdvance=0,lastGlyph=null,lastCharCode=0,offset=0,crs=[],i=0;i<words.length;i++){var prev,entry=words[i],left=entry.x,right=entry.x+entry.w;prev&&(offset=left-(left-(prev.x+prev.w)+prev.w),prev=null),maxWidth<left-offset||maxWidth<right-offset?(crs.push(entry.i-1),prev=entry.cr?(crs.push(entry.i+entry.word.length),offset=0,null):entry):entry.cr&&(crs.push(entry.i+entry.word.length),offset=0,prev=null)}for(i=crs.length-1;0<=i;i--)str=text,index=crs[i],value="\n",text=str.substr(0,index)+value+str.substr(index+1);textLength=(out.wrappedText=text).length,words=[],current=null}var kerningOffset,gw,charWidth,charIndex=0;for(i=0;i<textLength;i++)10!==(charCode=text.charCodeAt(i))?(glyph=chars[charCode])&&(x=xAdvance,y=yAdvance,null!==lastGlyph&&(x+=void 0!==(kerningOffset=glyph.kerning[lastCharCode])?kerningOffset:0),x<bx&&(bx=x),y<by&&(by=y),bw<(gw=x+glyph.xAdvance)&&(bw=gw),bh<(charWidth=y+lineHeight)&&(bh=charWidth),charWidth=glyph.xOffset+glyph.xAdvance+(void 0!==kerningOffset?kerningOffset:0),charCode===wordWrapCharCode?null!==current&&(words.push({word:current.word,i:current.i,x:current.x*sx,y:current.y*sy,w:current.w*sx,h:current.h*sy}),current=null):((current=null===current?{word:"",i:charIndex,x:xAdvance,y:yAdvance,w:0,h:lineHeight}:current).word=current.word.concat(text[i]),current.w+=charWidth),characters.push({i:charIndex,char:text[i],code:charCode,x:(glyph.xOffset+xAdvance)*scale,y:(glyph.yOffset+yAdvance)*scale,w:glyph.width*scale,h:glyph.height*scale,t:yAdvance*scale,r:gw*scale,b:lineHeight*scale,line:currentLine,glyph:glyph}),xAdvance+=glyph.xAdvance+letterSpacing,lastGlyph=glyph,lastCharCode=charCode,currentLineWidth=gw*scale,charIndex++):(null!==current&&(words.push({word:current.word,i:current.i,x:current.x*sx,y:current.y*sy,w:current.w*sx,h:current.h*sy}),current=null),xAdvance=0,yAdvance+=lineHeight,lastGlyph=null,longestLine<(lineWidths[currentLine]=currentLineWidth)&&(longestLine=currentLineWidth),currentLineWidth<shortestLine&&(shortestLine=currentLineWidth),currentLine++,currentLineWidth=0);if(null!==current&&words.push({word:current.word,i:current.i,x:current.x*sx,y:current.y*sy,w:current.w*sx,h:current.h*sy}),longestLine<(lineWidths[currentLine]=currentLineWidth)&&(longestLine=currentLineWidth),currentLineWidth<shortestLine&&(shortestLine=currentLineWidth),0<align)for(var c=0;c<characters.length;c++){var ax2,currentChar=characters[c];1===align?(ax2=(longestLine-lineWidths[currentChar.line])/2,currentChar.x+=ax2,currentChar.r+=ax2):2===align&&(ax2=longestLine-lineWidths[currentChar.line],currentChar.x+=ax2,currentChar.r+=ax2)}var local=out.local,global=out.global,lines=out.lines;return local.x=bx*scale,local.y=by*scale,local.width=bw*scale,local.height=bh*scale,global.x=src.x-src._displayOriginX+bx*sx,global.y=src.y-src._displayOriginY+by*sy,global.width=bw*sx,global.height=bh*sy,lines.shortest=shortestLine,lines.longest=longestLine,lines.lengths=lineWidths,round&&(local.x=Math.ceil(local.x),local.y=Math.ceil(local.y),local.width=Math.ceil(local.width),local.height=Math.ceil(local.height),global.x=Math.ceil(global.x),global.y=Math.ceil(global.y),global.width=Math.ceil(global.width),global.height=Math.ceil(global.height),lines.shortest=Math.ceil(shortestLine),lines.longest=Math.ceil(longestLine)),updateOrigin&&(src._displayOriginX=src.originX*local.width,src._displayOriginY=src.originY*local.height,global.x=src.x-src._displayOriginX*src.scaleX,global.y=src.y-src._displayOriginY*src.scaleY,round&&(global.x=Math.ceil(global.x),global.y=Math.ceil(global.y))),out.words=words,out.characters=characters,out.lines.height=lineHeight,out.scale=scale,out.scaleX=src.scaleX,out.scaleY=src.scaleY,out},particles=function(scene,fontName,textureKey,frameKey,xml,xSpacing,ySpacing){var data=scene.sys.textures.get(textureKey),frame=data.get(frameKey),xml=scene.sys.cache.xml.get(xml);if(frame&&xml){data=ParseXMLBitmapFont$2(xml,frame,xSpacing,ySpacing,data);return scene.sys.cache.bitmapFont.add(fontName,{data:data,texture:textureKey,frame:frameKey,fromAtlas:!0}),!0}return!1},PathFollower_1=GetTargets_1,Rectangle$l=HasTileAtWorldXY_1,BitmapText$4=new Class_1({Extends:GameObject$l,Mixins:[Components$s.Alpha,Components$s.BlendMode,Components$s.Depth,Components$s.Mask,Components$s.Origin,Components$s.Pipeline,Components$s.ScrollFactor,Components$s.Texture,Components$s.Tint,Components$s.Transform,Components$s.Visible,{renderWebGL:plugins,renderCanvas:Equals_1$1}],initialize:function(entry,x,y,font,text,size,align){void 0===text&&(text=""),void 0===align&&(align=0),GameObject$l.call(this,entry,"BitmapText"),this.font=font;entry=this.scene.sys.cache.bitmapFont.get(font);entry||console.warn("Invalid BitmapText key: "+font),this.fontData=entry.data,this._text="",this._fontSize=size||this.fontData.size,this._letterSpacing=0,this._align=align,this._bounds=GetBitmapTextSize(),this._dirty=!0,this._maxWidth=0,this.wordWrapCharCode=32,this.charColors=[],this.dropShadowX=0,this.dropShadowY=0,this.dropShadowColor=0,this.dropShadowAlpha=.5,this.fromAtlas=entry.fromAtlas,this.setTexture(entry.texture,entry.frame),this.setPosition(x,y),this.setOrigin(0,0),this.initPipeline(),this.setText(text)},setLeftAlign:function(){return this._align=BitmapText$4.ALIGN_LEFT,this._dirty=!0,this},setCenterAlign:function(){return this._align=BitmapText$4.ALIGN_CENTER,this._dirty=!0,this},setRightAlign:function(){return this._align=BitmapText$4.ALIGN_RIGHT,this._dirty=!0,this},setFontSize:function(size){return this._fontSize=size,this._dirty=!0,this},setLetterSpacing:function(spacing){return this._letterSpacing=spacing=void 0===spacing?0:spacing,this._dirty=!0,this},setText:function(value){return value||0===value||(value=""),(value=Array.isArray(value)?value.join("\n"):value)!==this.text&&(this._text=value.toString(),this._dirty=!0,this.updateDisplayOrigin()),this},setDropShadow:function(x,y,color,alpha){return void 0===y&&(y=0),void 0===color&&(color=0),void 0===alpha&&(alpha=.5),this.dropShadowX=x=void 0===x?0:x,this.dropShadowY=y,this.dropShadowColor=color,this.dropShadowAlpha=alpha,this},setCharacterTint:function(start,length,tintFill,topLeft,topRight,bottomLeft,bottomRight){void 0===tintFill&&(tintFill=!1),void 0===topLeft&&(topLeft=-1),void 0===topRight&&(bottomRight=bottomLeft=topRight=topLeft);var len=this.text.length;-1===(length=void 0===length?1:length)&&(length=len),start=Clamp$4(start=(start=void 0===start?0:start)<0?len+start:start,0,len-1);for(var end=Clamp$4(start+length,start,len),charColors=this.charColors,i=start;i<end;i++){var tintEffect,color=charColors[i];-1===topLeft?charColors[i]=null:(tintEffect=tintFill?1:0,color?(color.tintEffect=tintEffect,color.tintTL=topLeft,color.tintTR=topRight,color.tintBL=bottomLeft,color.tintBR=bottomRight):charColors[i]={tintEffect:tintEffect,tintTL:topLeft,tintTR:topRight,tintBL:bottomLeft,tintBR:bottomRight})}return this},setWordTint:function(word,count,tintFill,topLeft,topRight,bottomLeft,bottomRight){void 0===count&&(count=1);for(var words=this.getTextBounds().words,wordIsNumber="number"==typeof word,total=0,i=0;i<words.length;i++){var lineword=words[i];if((wordIsNumber&&i===word||!wordIsNumber&&lineword.word===word)&&(this.setCharacterTint(lineword.i,lineword.word.length,tintFill,topLeft,topRight,bottomLeft,bottomRight),++total===count))return this}return this},getTextBounds:function(round){var bounds=this._bounds;return(this._dirty||round||this.scaleX!==bounds.scaleX||this.scaleY!==bounds.scaleY)&&(GetBitmapTextSize(this,round,!0,bounds),this._dirty=!1),bounds},getCharacterAt:function(x,y,camera){for(var point=this.getLocalPoint(x,y,null,camera),chars=this.getTextBounds().characters,tempRect=new Rectangle$l,i=0;i<chars.length;i++){var char=chars[i];if(tempRect.setTo(char.x,char.t,char.r-char.x,char.b),tempRect.contains(point.x,point.y))return char}return null},updateDisplayOrigin:function(){return this._dirty=!0,this.getTextBounds(!1),this},setFont:function(key,size,align){var entry;return void 0===size&&(size=this._fontSize),void 0===align&&(align=this._align),key===this.font||(entry=this.scene.sys.cache.bitmapFont.get(key))&&(this.font=key,this.fontData=entry.data,this._fontSize=size,this._align=align,this.fromAtlas=!0===entry.fromAtlas,this.setTexture(entry.texture,entry.frame),GetBitmapTextSize(this,!1,!0,this._bounds)),this},setMaxWidth:function(value,wordWrapCharCode){return this._maxWidth=value,this._dirty=!0,void 0!==wordWrapCharCode&&(this.wordWrapCharCode=wordWrapCharCode),this},align:{set:function(value){this._align=value,this._dirty=!0},get:function(){return this._align}},text:{set:function(value){this.setText(value)},get:function(){return this._text}},fontSize:{set:function(value){this._fontSize=value,this._dirty=!0},get:function(){return this._fontSize}},letterSpacing:{set:function(value){this._letterSpacing=value,this._dirty=!0},get:function(){return this._letterSpacing}},maxWidth:{set:function(value){this._maxWidth=value,this._dirty=!0},get:function(){return this._maxWidth}},width:{get:function(){return this.getTextBounds(!1),this._bounds.global.width}},height:{get:function(){return this.getTextBounds(!1),this._bounds.global.height}},toJSON:function(){var out=Components$s.ToJSON(this),data={font:this.font,text:this.text,fontSize:this.fontSize,letterSpacing:this.letterSpacing,align:this.align};return out.data=data,out},preDestroy:function(){this.charColors.length=0,this._bounds=null,this.fontData=null}});BitmapText$4.ALIGN_LEFT=0,BitmapText$4.ALIGN_CENTER=1,BitmapText$4.ALIGN_RIGHT=2,BitmapText$4.ParseFromAtlas=particles,BitmapText$4.ParseXMLBitmapFont=PathFollower_1;function Point$p(x,y,width){this.x=x,this.y=y,this.width=width}function Path(x,y,width){this.points=[],this.pointsLength=1,this.points[0]=new Point$p(x,y,width)}var BitmapText_1=BitmapText$4,Utils$k=GetProps_1,tempMatrix$4=new TransformMatrix,UUID_1={renderWebGL:function(renderer,src,camera,parentMatrix){var list=src.getRenderList();if(0!==list.length){var alpha=camera.alpha*src.alpha;if(0!=alpha){camera.addToRenderList(src);var pipeline=renderer.pipelines.set(this.pipeline,src),cameraScrollX=camera.scrollX*src.scrollFactorX,cameraScrollY=camera.scrollY*src.scrollFactorY,calcMatrix=tempMatrix$4.copyFrom(camera.matrix);parentMatrix&&(calcMatrix.multiplyWithOffset(parentMatrix,-cameraScrollX,-cameraScrollY),cameraScrollY=cameraScrollX=0);var blitterX=src.x-cameraScrollX,blitterY=src.y-cameraScrollY,prevTextureSourceIndex=-1,roundPixels=camera.roundPixels;renderer.pipelines.preBatch(src);for(var index=0;index<list.length;index++){var xw,tx0,ty0,tx1,ty1,textureUnit,bob=list[index],frame=bob.frame,tint=bob.alpha*alpha;0!=tint&&(ty1=frame.width,tx0=frame.height,ty0=blitterX+bob.x+frame.x,tx1=blitterY+bob.y+frame.y,bob.flipX&&(ty1*=-1,ty0+=frame.width),bob.flipY&&(tx0*=-1,tx1+=frame.height),xw=ty0+ty1,ty1=tx1+tx0,tx0=calcMatrix.getX(ty0,tx1),ty0=calcMatrix.getY(ty0,tx1),tx1=calcMatrix.getX(xw,ty1),ty1=calcMatrix.getY(xw,ty1),tint=Utils$k.getTintAppendFloatAlpha(bob.tint,tint),frame.sourceIndex!==prevTextureSourceIndex&&(textureUnit=pipeline.setGameObject(src,frame),prevTextureSourceIndex=frame.sourceIndex),roundPixels&&(tx0=Math.round(tx0),ty0=Math.round(ty0),tx1=Math.round(tx1),ty1=Math.round(ty1)),pipeline.batchQuad(src,tx0,ty0,tx0,ty1,tx1,ty1,tx1,ty0,frame.u0,frame.v0,frame.u1,frame.v1,tint,tint,tint,tint,!1,frame.glTexture,textureUnit)&&(prevTextureSourceIndex=-1))}renderer.pipelines.postBatch(src)}}},renderCanvas:function(renderer,src,camera,parentMatrix){var list=src.getRenderList();if(0!==list.length){var ctx=renderer.currentContext,alpha=camera.alpha*src.alpha;if(0!=alpha){camera.addToRenderList(src),ctx.globalCompositeOperation=renderer.blendModes[src.blendMode],ctx.imageSmoothingEnabled=!(!renderer.antialias||src.frame.source.scaleMode);var cameraScrollX=src.x-camera.scrollX*src.scrollFactorX,cameraScrollY=src.y-camera.scrollY*src.scrollFactorY;ctx.save(),parentMatrix&&parentMatrix.copyToContext(ctx);for(var roundPixels=camera.roundPixels,i=0;i<list.length;i++){var bob=list[i],flip=bob.flipX||bob.flipY,frame=bob.frame,cd=frame.canvasData,dx=frame.x,dy=frame.y,fx=1,fy=1,bobAlpha=bob.alpha*alpha;0!=bobAlpha&&(ctx.globalAlpha=bobAlpha,flip?(bob.flipX&&(fx=-1,dx-=cd.width),bob.flipY&&(fy=-1,dy-=cd.height),ctx.save(),ctx.translate(bob.x+cameraScrollX,bob.y+cameraScrollY),ctx.scale(fx,fy),ctx.drawImage(frame.source.image,cd.x,cd.y,cd.width,cd.height,dx,dy,cd.width,cd.height),ctx.restore()):(roundPixels&&(dx=Math.round(dx),dy=Math.round(dy)),ctx.drawImage(frame.source.image,cd.x,cd.y,cd.width,cd.height,dx+bob.x+cameraScrollX,dy+bob.y+cameraScrollY,cd.width,cd.height)))}ctx.restore()}}}},Frame$2=ParseWeltmeister_1,Bob_1=new Class_1({initialize:function(blitter,x,y,frame,visible){this.parent=blitter,this.x=x,this.y=y,this.frame=frame,this.data={},this.tint=16777215,this._visible=visible,this._alpha=1,this.flipX=!1,this.flipY=!1},setFrame:function(frame){return void 0===frame?this.frame=this.parent.frame:frame instanceof Frame$2&&frame.texture===this.parent.texture?this.frame=frame:this.frame=this.parent.texture.get(frame),this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this},reset:function(x,y,frame){return this.x=x,this.y=y,this.flipX=!1,this.flipY=!1,this._alpha=1,this._visible=!0,this.parent.dirty=!0,frame&&this.setFrame(frame),this},setPosition:function(x,y){return this.x=x,this.y=y,this},setFlipX:function(value){return this.flipX=value,this},setFlipY:function(value){return this.flipY=value,this},setFlip:function(x,y){return this.flipX=x,this.flipY=y,this},setVisible:function(value){return this.visible=value,this},setAlpha:function(value){return this.alpha=value,this},setTint:function(value){return this.tint=value,this},destroy:function(){this.parent.dirty=!0,this.parent.children.remove(this),this.parent=void 0,this.frame=void 0,this.data=void 0},visible:{get:function(){return this._visible},set:function(value){this.parent.dirty|=this._visible!==value,this._visible=value}},alpha:{get:function(){return this._alpha},set:function(value){this.parent.dirty|=0<this._alpha!=0<value,this._alpha=value}}}),Bob=Bob_1,Frame$1=ParseWeltmeister_1,GameObject$k=GameObject_1,List$2=Base64Decode_1,Blitter_1=new Class_1({Extends:GameObject$k,Mixins:[components$3.Alpha,components$3.BlendMode,components$3.Depth,components$3.Mask,components$3.Pipeline,components$3.ScrollFactor,components$3.Size,components$3.Texture,components$3.Transform,components$3.Visible,UUID_1],initialize:function(scene,x,y,texture,frame){GameObject$k.call(this,scene,"Blitter"),this.setTexture(texture,frame),this.setPosition(x,y),this.initPipeline(),this.children=new List$2,this.renderList=[],this.dirty=!1},create:function(x,y,frame,bob,index){void 0===bob&&(bob=!0),void 0===index&&(index=this.children.length),void 0===frame?frame=this.frame:frame instanceof Frame$1||(frame=this.texture.get(frame));bob=new Bob(this,x,y,frame,bob);return this.children.addAt(bob,index,!1),this.dirty=!0,bob},createFromCallback:function(callback,quantity,frame,visible){for(var bobs=this.createMultiple(quantity,frame,visible),i=0;i<bobs.length;i++){var bob=bobs[i];callback.call(this,bob,i)}return bobs},createMultiple:function(quantity,frame,visible){void 0===frame&&(frame=this.frame.name),void 0===visible&&(visible=!0),Array.isArray(frame)||(frame=[frame]);var bobs=[],_this=this;return frame.forEach(function(singleFrame){for(var i=0;i<quantity;i++)bobs.push(_this.create(0,0,singleFrame,visible))}),bobs},childCanRender:function(child){return child.visible&&0<child.alpha},getRenderList:function(){return this.dirty&&(this.renderList=this.children.list.filter(this.childCanRender,this),this.dirty=!1),this.renderList},clear:function(){this.children.removeAll(),this.dirty=!0},preDestroy:function(){this.children.destroy(),this.renderList=[]}}),RenderTexture_1=function(renderer,container,camera,parentMatrix){camera.addToRenderList(container);var children=container.list,childCount=children.length;if(0!==childCount){var transformMatrix=container.localTransform;parentMatrix?(transformMatrix.loadIdentity(),transformMatrix.multiply(parentMatrix),transformMatrix.translate(container.x,container.y),transformMatrix.rotate(container.rotation),transformMatrix.scale(container.scaleX,container.scaleY)):transformMatrix.applyITRS(container.x,container.y,container.rotation,container.scaleX,container.scaleY),renderer.pipelines.preBatch(container);var containerHasBlendMode=-1!==container.blendMode;containerHasBlendMode||renderer.setBlendMode(0);for(var alpha=container.alpha,scrollFactorX=container.scrollFactorX,scrollFactorY=container.scrollFactorY,i=0;i<childCount;i++){var childAlphaTopLeft,childAlphaTopRight,childAlphaBottomLeft,childAlphaBottomRight,childScrollFactorX,childScrollFactorY,mask,type,child=children[i];child.willRender(camera)&&(childAlphaBottomRight=void 0!==child.alphaTopLeft?(childAlphaTopLeft=child.alphaTopLeft,childAlphaTopRight=child.alphaTopRight,childAlphaBottomLeft=child.alphaBottomLeft,child.alphaBottomRight):childAlphaBottomLeft=childAlphaTopRight=childAlphaTopLeft=child.alpha,childScrollFactorX=child.scrollFactorX,childScrollFactorY=child.scrollFactorY,containerHasBlendMode||child.blendMode===renderer.currentBlendMode||renderer.setBlendMode(child.blendMode),(mask=child.mask)&&mask.preRenderWebGL(renderer,child,camera),(type=child.type)!==renderer.currentType&&(renderer.newType=!0,renderer.currentType=type),renderer.nextTypeMatch=i<childCount-1&&children[i+1].type===renderer.currentType,child.setScrollFactor(childScrollFactorX*scrollFactorX,childScrollFactorY*scrollFactorY),child.setAlpha(childAlphaTopLeft*alpha,childAlphaTopRight*alpha,childAlphaBottomLeft*alpha,childAlphaBottomRight*alpha),child.renderWebGL(renderer,child,camera,transformMatrix),child.setAlpha(childAlphaTopLeft,childAlphaTopRight,childAlphaBottomLeft,childAlphaBottomRight),child.setScrollFactor(childScrollFactorX,childScrollFactorY),mask&&mask.postRenderWebGL(renderer,camera),renderer.newType=!1)}renderer.pipelines.postBatch(container)}},Rectangle$k=HasTileAtWorldXY_1,MatterGameObject_1=function(rectA,h,out){void 0===out&&(out=new Rectangle$k);var x=Math.min(rectA.x,h.x),y=Math.min(rectA.y,h.y),w=Math.max(rectA.right,h.right)-x,h=Math.max(rectA.bottom,h.bottom)-y;return out.setTo(x,y,w,h)},ArrayUtils=array,BlendModes$3=BlendModes$8,Components$q=components$3,Events$n=events$h,GameObject$j=GameObject_1,Rectangle$j=HasTileAtWorldXY_1,Union=MatterGameObject_1,Vector2$w=BuildTilesetIndex_1,Container_1=new Class_1({Extends:GameObject$j,Mixins:[Components$q.AlphaSingle,Components$q.BlendMode,Components$q.ComputedSize,Components$q.Depth,Components$q.Mask,Components$q.Pipeline,Components$q.Transform,Components$q.Visible,{renderWebGL:RenderTexture_1,renderCanvas:function(renderer,container,camera,parentMatrix){camera.addToRenderList(container);var children=container.list;if(0!==children.length){var transformMatrix=container.localTransform;parentMatrix?(transformMatrix.loadIdentity(),transformMatrix.multiply(parentMatrix),transformMatrix.translate(container.x,container.y),transformMatrix.rotate(container.rotation),transformMatrix.scale(container.scaleX,container.scaleY)):transformMatrix.applyITRS(container.x,container.y,container.rotation,container.scaleX,container.scaleY);var containerHasBlendMode=-1!==container.blendMode;containerHasBlendMode||renderer.setBlendMode(0);var alpha=container._alpha,scrollFactorX=container.scrollFactorX,scrollFactorY=container.scrollFactorY;container.mask&&container.mask.preRenderCanvas(renderer,null,camera);for(var i=0;i<children.length;i++){var childAlpha,childScrollFactorX,childScrollFactorY,child=children[i];child.willRender(camera)&&(childAlpha=child.alpha,childScrollFactorX=child.scrollFactorX,childScrollFactorY=child.scrollFactorY,containerHasBlendMode||child.blendMode===renderer.currentBlendMode||renderer.setBlendMode(child.blendMode),child.setScrollFactor(childScrollFactorX*scrollFactorX,childScrollFactorY*scrollFactorY),child.setAlpha(childAlpha*alpha),child.renderCanvas(renderer,child,camera,transformMatrix),child.setAlpha(childAlpha),child.setScrollFactor(childScrollFactorX,childScrollFactorY))}container.mask&&container.mask.postRenderCanvas(renderer)}}}],initialize:function(scene,x,y,children){GameObject$j.call(this,scene,"Container"),this.list=[],this.exclusive=!0,this.maxSize=-1,this.position=0,this.localTransform=new Components$q.TransformMatrix,this.tempTransformMatrix=new Components$q.TransformMatrix,this._sortKey="",this._sysEvents=scene.sys.events,this.scrollFactorX=1,this.scrollFactorY=1,this.initPipeline(),this.setPosition(x,y),this.clearAlpha(),this.setBlendMode(BlendModes$3.SKIP_CHECK),children&&this.add(children)},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return.5*this.width}},displayOriginY:{get:function(){return.5*this.height}},setExclusive:function(value){return this.exclusive=value=void 0===value?!0:value,this},getBounds:function(output){var transformedPosition;if((output=void 0===output?new Rectangle$j:output).setTo(this.x,this.y,0,0),this.parentContainer&&(transformedPosition=this.parentContainer.getBoundsTransformMatrix().transformPoint(this.x,this.y),output.setTo(transformedPosition.x,transformedPosition.y,0,0)),0<this.list.length){var children=this.list,tempRect=new Rectangle$j,hasSetFirst=!1;output.setEmpty();for(var i=0;i<children.length;i++){var entry=children[i];entry.getBounds&&(entry.getBounds(tempRect),hasSetFirst?Union(tempRect,output,output):(output.setTo(tempRect.x,tempRect.y,tempRect.width,tempRect.height),hasSetFirst=!0))}}return output},addHandler:function(gameObject){gameObject.once(Events$n.DESTROY,this.remove,this),this.exclusive&&(gameObject.parentContainer&&gameObject.parentContainer.remove(gameObject),gameObject.removeFromDisplayList(),gameObject.parentContainer=this)},removeHandler:function(gameObject){gameObject.off(Events$n.DESTROY,this.remove),this.exclusive&&(gameObject.parentContainer=null,gameObject.addToDisplayList())},pointToContainer:function(source,output){void 0===output&&(output=new Vector2$w),this.parentContainer?this.parentContainer.pointToContainer(source,output):output=new Vector2$w(source.x,source.y);var tempMatrix=this.tempTransformMatrix;return tempMatrix.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY),tempMatrix.invert(),tempMatrix.transformPoint(source.x,source.y,output),output},getBoundsTransformMatrix:function(){return this.getWorldTransformMatrix(this.tempTransformMatrix,this.localTransform)},add:function(child){return ArrayUtils.Add(this.list,child,this.maxSize,this.addHandler,this),this},addAt:function(child,index){return ArrayUtils.AddAt(this.list,child,index,this.maxSize,this.addHandler,this),this},getAt:function(index){return this.list[index]},getIndex:function(child){return this.list.indexOf(child)},sort:function(property,handler){return property&&ArrayUtils.StableSort(this.list,handler=void 0===handler?function(childA,childB){return childA[property]-childB[property]}:handler),this},getByName:function(name){return ArrayUtils.GetFirst(this.list,"name",name)},getRandom:function(startIndex,length){return ArrayUtils.GetRandom(this.list,startIndex,length)},getFirst:function(property,value,startIndex,endIndex){return ArrayUtils.GetFirst(this.list,property,value,startIndex,endIndex)},getAll:function(property,value,startIndex,endIndex){return ArrayUtils.GetAll(this.list,property,value,startIndex,endIndex)},count:function(property,value,startIndex,endIndex){return ArrayUtils.CountAllMatching(this.list,property,value,startIndex,endIndex)},swap:function(child1,child2){return ArrayUtils.Swap(this.list,child1,child2),this},moveTo:function(child,index){return ArrayUtils.MoveTo(this.list,child,index),this},moveAbove:function(child1,child2){return ArrayUtils.MoveAbove(this.list,child1,child2),this},moveBelow:function(child1,child2){return ArrayUtils.MoveBelow(this.list,child1,child2),this},remove:function(child,destroyChild){var removed=ArrayUtils.Remove(this.list,child,this.removeHandler,this);if(destroyChild&&removed){Array.isArray(removed)||(removed=[removed]);for(var i=0;i<removed.length;i++)removed[i].destroy()}return this},removeAt:function(removed,destroyChild){removed=ArrayUtils.RemoveAt(this.list,removed,this.removeHandler,this);return destroyChild&&removed&&removed.destroy(),this},removeBetween:function(startIndex,endIndex,destroyChild){var removed=ArrayUtils.RemoveBetween(this.list,startIndex,endIndex,this.removeHandler,this);if(destroyChild)for(var i=0;i<removed.length;i++)removed[i].destroy();return this},removeAll:function(destroyChild){var removed=ArrayUtils.RemoveBetween(this.list,0,this.list.length,this.removeHandler,this);if(destroyChild)for(var i=0;i<removed.length;i++)removed[i].destroy();return this},bringToTop:function(child){return ArrayUtils.BringToTop(this.list,child),this},sendToBack:function(child){return ArrayUtils.SendToBack(this.list,child),this},moveUp:function(child){return ArrayUtils.MoveUp(this.list,child),this},moveDown:function(child){return ArrayUtils.MoveDown(this.list,child),this},reverse:function(){return this.list.reverse(),this},shuffle:function(){return ArrayUtils.Shuffle(this.list),this},replace:function(oldChild,newChild,destroyChild){return ArrayUtils.Replace(this.list,oldChild,newChild)&&(this.addHandler(newChild),this.removeHandler(oldChild),destroyChild&&oldChild.destroy()),this},exists:function(child){return-1<this.list.indexOf(child)},setAll:function(property,value,startIndex,endIndex){return ArrayUtils.SetAll(this.list,property,value,startIndex,endIndex),this},each:function(callback,context){for(var args=[null],temp=this.list.slice(),len=temp.length,i=2;i<arguments.length;i++)args.push(arguments[i]);for(i=0;i<len;i++)args[0]=temp[i],callback.apply(context,args);return this},iterate:function(callback,context){for(var args=[null],i=2;i<arguments.length;i++)args.push(arguments[i]);for(i=0;i<this.list.length;i++)args[0]=this.list[i],callback.apply(context,args);return this},setScrollFactor:function(x,y,updateChildren){return void 0===y&&(y=x),void 0===updateChildren&&(updateChildren=!1),this.scrollFactorX=x,this.scrollFactorY=y,updateChildren&&(ArrayUtils.SetAll(this.list,"scrollFactorX",x),ArrayUtils.SetAll(this.list,"scrollFactorY",y)),this},length:{get:function(){return this.list.length}},first:{get:function(){return(this.position=0)<this.list.length?this.list[0]:null}},last:{get:function(){return 0<this.list.length?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return 0<this.position?(this.position--,this.list[this.position]):null}},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.tempTransformMatrix.destroy(),this.list=[]}}),CSSBlendModes=["normal","multiply","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],GameObject$i=GameObject_1,RetroFont_1=TransformMatrix,tempMatrix1$3=new RetroFont_1,tempMatrix2$3=new RetroFont_1,tempMatrix3$3=new RetroFont_1,IsInLayerBounds_1=function(renderer,src,camera,parentMatrix){var style,alpha,camMatrix,srcMatrix,calcMatrix,dx,dy,tx,ty;src.node&&(style=src.node.style,tx=src.scene.sys.settings,!style||!tx.visible||GameObject$i.RENDER_MASK!==src.renderFlags||0!==src.cameraFilter&&src.cameraFilter&camera.id||src.parentContainer&&!src.parentContainer.willRender()?style.display="none":(ty=src.parentContainer,alpha=camera.alpha*src.alpha,ty&&(alpha*=ty.alpha),camMatrix=tempMatrix1$3,srcMatrix=tempMatrix2$3,calcMatrix=tempMatrix3$3,dy=dx=0,ty=tx="0%",parentMatrix?(dx=src.width*src.scaleX*src.originX,dy=src.height*src.scaleY*src.originY,srcMatrix.applyITRS(src.x-dx,src.y-dy,src.rotation,src.scaleX,src.scaleY),camMatrix.copyFrom(camera.matrix),camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY),srcMatrix.e=src.x-dx,srcMatrix.f=src.y-dy):(dx=src.width*src.originX,dy=src.height*src.originY,srcMatrix.applyITRS(src.x-dx,src.y-dy,src.rotation,src.scaleX,src.scaleY),camMatrix.copyFrom(camera.matrix),tx=100*src.originX+"%",ty=100*src.originY+"%",srcMatrix.e-=camera.scrollX*src.scrollFactorX,srcMatrix.f-=camera.scrollY*src.scrollFactorY),camMatrix.multiply(srcMatrix,calcMatrix),src.transformOnly||(style.display="block",style.opacity=alpha,style.zIndex=src._depth,style.pointerEvents=src.pointerEvents,style.mixBlendMode=CSSBlendModes[src._blendMode]),style.transform=calcMatrix.getCSSMatrix()+" skew("+src.skewX+"rad, "+src.skewY+"rad) rotate3d("+src.rotate3d.x+","+src.rotate3d.y+","+src.rotate3d.z+","+src.rotate3d.w+src.rotate3dAngle+")",style.transformOrigin=tx+" "+ty))},GameObject$h=GameObject_1,IsPlainObject$v=IsPlainObject_1,RemoveFromDOM$1=input,SCENE_EVENTS=events$g,Vector4$2=GetEasedPoints_1,DOMElement_1=new Class_1({Extends:GameObject$h,Mixins:[components$3.AlphaSingle,components$3.BlendMode,components$3.Depth,components$3.Origin,components$3.ScrollFactor,components$3.Transform,components$3.Visible,{renderWebGL:IsInLayerBounds_1,renderCanvas:IsInLayerBounds_1}],initialize:function(scene,x,y,element,style,innerText){GameObject$h.call(this,scene,"DOMElement"),this.parent=scene.sys.game.domContainer,this.cache=scene.sys.cache.html,this.node,this.transformOnly=!1,this.skewX=0,this.skewY=0,this.rotate3d=new Vector4$2,this.rotate3dAngle="deg",this.pointerEvents="auto",this.width=0,this.height=0,this.displayWidth=0,this.displayHeight=0,this.handler=this.dispatchNativeEvent.bind(this),this.setPosition(x,y),"string"==typeof element?"#"===element[0]?this.setElement(element.substr(1),style,innerText):this.createElement(element,style,innerText):element&&this.setElement(element,style,innerText),scene.sys.events.on(SCENE_EVENTS.SLEEP,this.handleSceneEvent,this),scene.sys.events.on(SCENE_EVENTS.WAKE,this.handleSceneEvent,this)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},handleSceneEvent:function(sys){var node=this.node,style=node.style;node&&(style.display=sys.settings.visible?"block":"none")},setSkew:function(x,y){return void 0===x&&(x=0),void 0===y&&(y=x),this.skewX=x,this.skewY=y,this},setPerspective:function(value){return this.parent.style.perspective=value+"px",this},perspective:{get:function(){return parseFloat(this.parent.style.perspective)},set:function(value){this.parent.style.perspective=value+"px"}},addListener:function(events){if(this.node){events=events.split(" ");for(var i=0;i<events.length;i++)this.node.addEventListener(events[i],this.handler,!1)}return this},removeListener:function(events){if(this.node){events=events.split(" ");for(var i=0;i<events.length;i++)this.node.removeEventListener(events[i],this.handler)}return this},dispatchNativeEvent:function(event){this.emit(event.type,event)},createElement:function(tagName,style,innerText){return this.setElement(document.createElement(tagName),style,innerText)},setElement:function(element,style,innerText){var target;if(this.removeElement(),"string"==typeof element?("#"===element[0]&&(element=element.substr(1)),target=document.getElementById(element)):"object"==typeof element&&1===element.nodeType&&(target=element),!target)return this;if(this.node=target,style&&IsPlainObject$v(style))for(var key in style)target.style[key]=style[key];else"string"==typeof style&&(target.style=style);return target.style.zIndex="0",target.style.display="inline",target.style.position="absolute",(target.phaser=this).parent&&this.parent.appendChild(target),innerText&&(target.innerText=innerText),this.updateSize()},createFromCache:function(html,tagName){html=this.cache.get(html);return html&&this.createFromHTML(html,tagName),this},createFromHTML:function(html,element){void 0===element&&(element="div"),this.removeElement();element=document.createElement(element);return(this.node=element).style.zIndex="0",element.style.display="inline",element.style.position="absolute",(element.phaser=this).parent&&this.parent.appendChild(element),element.innerHTML=html,this.updateSize()},removeElement:function(){return this.node&&(RemoveFromDOM$1(this.node),this.node=null),this},updateSize:function(){var node=this.node,nodeBounds=node.getBoundingClientRect();return this.width=node.clientWidth,this.height=node.clientHeight,this.displayWidth=nodeBounds.width||0,this.displayHeight=nodeBounds.height||0,this},getChildByProperty:function(property,value){if(this.node)for(var children=this.node.querySelectorAll("*"),i=0;i<children.length;i++)if(children[i][property]===value)return children[i];return null},getChildByID:function(id){return this.getChildByProperty("id",id)},getChildByName:function(name){return this.getChildByProperty("name",name)},setClassName:function(className){return this.node&&(this.node.className=className,this.updateSize()),this},setText:function(text){return this.node&&(this.node.innerText=text,this.updateSize()),this},setHTML:function(html){return this.node&&(this.node.innerHTML=html,this.updateSize()),this},preUpdate:function(){var parent=this.parentContainer,node=this.node;node&&parent&&!parent.willRender()&&(node.style.display="none")},willRender:function(){return!0},preDestroy:function(){this.removeElement(),this.scene.sys.events.off(SCENE_EVENTS.SLEEP,this.handleSceneEvent,this),this.scene.sys.events.off(SCENE_EVENTS.WAKE,this.handleSceneEvent,this)}}),GetCalcMatrix$i=GetCalcMatrix_1,Utils$j=GetProps_1,tempMatrix$3=new TransformMatrix,SetTransform$c=parsers,BitmapText$3=BitmapText_1,DynamicBitmapText_1=new Class_1({Extends:BitmapText$3,Mixins:[{renderWebGL:function(renderer,src,camera,crop){var text=src.text,textLength=text.length;if(0!==textLength){camera.addToRenderList(src);var pipeline=renderer.pipelines.set(src.pipeline,src),bounds=GetCalcMatrix$i(src,camera,crop),spriteMatrix=bounds.sprite,calcMatrix=bounds.calc,fontMatrix=tempMatrix$3,crop=0<src.cropWidth||0<src.cropHeight;crop&&(pipeline.flush(),renderer.pushScissor(calcMatrix.tx,calcMatrix.ty,src.cropWidth*calcMatrix.scaleX,src.cropHeight*calcMatrix.scaleY));var lastGlyph,texture=src.frame.glTexture,tintEffect=src.tintFill,tintTL=Utils$j.getTintAppendFloatAlpha(src.tintTopLeft,camera.alpha*src._alphaTL),tintTR=Utils$j.getTintAppendFloatAlpha(src.tintTopRight,camera.alpha*src._alphaTR),tintBL=Utils$j.getTintAppendFloatAlpha(src.tintBottomLeft,camera.alpha*src._alphaBL),tintBR=Utils$j.getTintAppendFloatAlpha(src.tintBottomRight,camera.alpha*src._alphaBR),textureUnit=pipeline.setGameObject(src),xAdvance=0,yAdvance=0,charCode=0,lastCharCode=0,letterSpacing=src.letterSpacing,glyphW=0,glyphH=0,scrollX=src.scrollX,scrollY=src.scrollY,bounds=src.fontData,chars=bounds.chars,lineHeight=bounds.lineHeight,scale=src.fontSize/bounds.size,rotation=0,align=src._align,currentLine=0,lineOffsetX=0,bounds=src.getTextBounds(!1);0<src.maxWidth&&(textLength=(text=bounds.wrappedText).length);var lineData=src._bounds.lines;1===align?lineOffsetX=(lineData.longest-lineData.lengths[0])/2:2===align&&(lineOffsetX=lineData.longest-lineData.lengths[0]);var roundPixels=camera.roundPixels,displayCallback=src.displayCallback,callbackData=src.callbackData;renderer.pipelines.preBatch(src);for(var u0,v0,u1,v1,tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,i=0;i<textLength;i++)10!==(charCode=text.charCodeAt(i))?(ty3=chars[charCode])&&(glyphW=ty3.width,glyphH=ty3.height,ty2=ty3.xOffset+xAdvance-scrollX,tx3=ty3.yOffset+yAdvance-scrollY,null!==lastGlyph&&(ty2+=void 0!==(ty1=ty3.kerning[lastCharCode])?ty1:0),xAdvance+=ty3.xAdvance+letterSpacing,lastGlyph=ty3,lastCharCode=charCode,0!==glyphW&&0!==glyphH&&32!==charCode&&(scale=src.fontSize/src.fontData.size,rotation=0,displayCallback&&(callbackData.color=0,callbackData.tint.topLeft=tintTL,callbackData.tint.topRight=tintTR,callbackData.tint.bottomLeft=tintBL,callbackData.tint.bottomRight=tintBR,callbackData.index=i,callbackData.charCode=charCode,callbackData.x=ty2,callbackData.y=tx3,callbackData.scale=scale,callbackData.rotation=rotation,callbackData.data=ty3.data,ty2=(tx2=displayCallback(callbackData)).x,tx3=tx2.y,scale=tx2.scale,rotation=tx2.rotation,tintBR=tx2.color?(tintTL=tx2.color,tintTR=tx2.color,tintBL=tx2.color,tx2.color):(tintTL=tx2.tint.topLeft,tintTR=tx2.tint.topRight,tintBL=tx2.tint.bottomLeft,tx2.tint.bottomRight),tintTL=Utils$j.getTintAppendFloatAlpha(tintTL,camera.alpha*src._alphaTL),tintTR=Utils$j.getTintAppendFloatAlpha(tintTR,camera.alpha*src._alphaTR),tintBL=Utils$j.getTintAppendFloatAlpha(tintBL,camera.alpha*src._alphaBL),tintBR=Utils$j.getTintAppendFloatAlpha(tintBR,camera.alpha*src._alphaBR)),ty2*=scale,tx3*=scale,ty2-=src.displayOriginX,tx3-=src.displayOriginY,ty2+=lineOffsetX,fontMatrix.applyITRS(ty2,tx3,rotation,scale,scale),calcMatrix.multiply(fontMatrix,spriteMatrix),u0=ty3.u0,v0=ty3.v0,u1=ty3.u1,v1=ty3.v1,tx0=spriteMatrix.e,ty0=spriteMatrix.f,tx1=glyphH*spriteMatrix.c+spriteMatrix.e,ty1=glyphH*spriteMatrix.d+spriteMatrix.f,tx2=glyphW*spriteMatrix.a+glyphH*spriteMatrix.c+spriteMatrix.e,ty2=glyphW*spriteMatrix.b+glyphH*spriteMatrix.d+spriteMatrix.f,tx3=glyphW*spriteMatrix.a+spriteMatrix.e,ty3=glyphW*spriteMatrix.b+spriteMatrix.f,roundPixels&&(tx0=Math.round(tx0),ty0=Math.round(ty0),tx1=Math.round(tx1),ty1=Math.round(ty1),tx2=Math.round(tx2),ty2=Math.round(ty2),tx3=Math.round(tx3),ty3=Math.round(ty3)),pipeline.batchQuad(src,tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintBR,tintEffect,texture,textureUnit))):(currentLine++,1===align?lineOffsetX=(lineData.longest-lineData.lengths[currentLine])/2:2===align&&(lineOffsetX=lineData.longest-lineData.lengths[currentLine]),xAdvance=0,yAdvance+=lineHeight,lastGlyph=null);crop&&(pipeline.flush(),renderer.popScissor()),renderer.pipelines.postBatch(src)}},renderCanvas:function(renderer,src,camera,textureFrame){var text=src._text,textLength=text.length,ctx=renderer.currentContext;if(0!==textLength&&SetTransform$c(renderer,ctx,src,camera,textureFrame)){camera.addToRenderList(src);var charCode,textureFrame=src.fromAtlas?src.frame:src.texture.frames.__BASE,displayCallback=src.displayCallback,callbackData=src.callbackData,chars=src.fontData.chars,lineHeight=src.fontData.lineHeight,letterSpacing=src._letterSpacing,xAdvance=0,yAdvance=0,glyph=null,glyphX=0,glyphY=0,glyphW=0,glyphH=0,x=0,y=0,lastGlyph=null,lastCharCode=0,image=src.frame.source.image,textureX=textureFrame.cutX,textureY=textureFrame.cutY,rotation=0,scale=0,baseScale=src._fontSize/src.fontData.size,align=src._align,currentLine=0,lineOffsetX=0;src.getTextBounds(!1);var lineData=src._bounds.lines;1===align?lineOffsetX=(lineData.longest-lineData.lengths[0])/2:2===align&&(lineOffsetX=lineData.longest-lineData.lengths[0]),ctx.translate(-src.displayOriginX,-src.displayOriginY);var roundPixels=camera.roundPixels;0<src.cropWidth&&0<src.cropHeight&&(ctx.beginPath(),ctx.rect(0,0,src.cropWidth,src.cropHeight),ctx.clip());for(var output,i=0;i<textLength;i++)scale=baseScale,rotation=0,10!==(charCode=text.charCodeAt(i))?(glyph=chars[charCode])&&(glyphX=textureX+glyph.x,glyphY=textureY+glyph.y,glyphW=glyph.width,glyphH=glyph.height,x=glyph.xOffset+xAdvance-src.scrollX,y=glyph.yOffset+yAdvance-src.scrollY,null!==lastGlyph&&(x+=void 0!==(output=glyph.kerning[lastCharCode])?output:0),displayCallback&&(callbackData.index=i,callbackData.charCode=charCode,callbackData.x=x,callbackData.y=y,callbackData.scale=scale,callbackData.rotation=rotation,callbackData.data=glyph.data,x=(output=displayCallback(callbackData)).x,y=output.y,scale=output.scale,rotation=output.rotation),x*=scale,y*=scale,x+=lineOffsetX,xAdvance+=glyph.xAdvance+letterSpacing,lastGlyph=glyph,lastCharCode=charCode,0!==glyphW&&0!==glyphH&&32!==charCode&&(roundPixels&&(x=Math.round(x),y=Math.round(y)),ctx.save(),ctx.translate(x,y),ctx.rotate(rotation),ctx.scale(scale,scale),ctx.drawImage(image,glyphX,glyphY,glyphW,glyphH,0,0,glyphW,glyphH),ctx.restore())):(currentLine++,1===align?lineOffsetX=(lineData.longest-lineData.lengths[currentLine])/2:2===align&&(lineOffsetX=lineData.longest-lineData.lengths[currentLine]),xAdvance=0,yAdvance+=lineHeight,lastGlyph=null);ctx.restore()}}}],initialize:function(scene,x,y,font,text,size,align){BitmapText$3.call(this,scene,x,y,font,text,size,align),this.type="DynamicBitmapText",this.scrollX=0,this.scrollY=0,this.cropWidth=0,this.cropHeight=0,this.displayCallback,this.callbackData={parent:this,color:0,tint:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},index:0,charCode:0,x:0,y:0,scale:0,rotation:0,data:0}},setSize:function(width,height){return this.cropWidth=width,this.cropHeight=height,this},setDisplayCallback:function(callback){return this.displayCallback=callback,this},setScrollX:function(value){return this.scrollX=value,this},setScrollY:function(value){return this.scrollY=value,this}}),GetCalcMatrix$h=GetCalcMatrix_1,GameObject$g=GameObject_1,Extern_1=new Class_1({Extends:GameObject$g,Mixins:[components$3.Alpha,components$3.BlendMode,components$3.Depth,components$3.Flip,components$3.Origin,components$3.ScrollFactor,components$3.Size,components$3.Texture,components$3.Tint,components$3.Transform,components$3.Visible,{renderWebGL:function(renderer,src,camera,calcMatrix){renderer.pipelines.clear();calcMatrix=GetCalcMatrix$h(src,camera,calcMatrix).calc;src.render.call(src,renderer,camera,calcMatrix),renderer.pipelines.rebind()},renderCanvas:getAugmentedNamespace(Object.freeze({__proto__:null}))}],initialize:function(scene){GameObject$g.call(this,scene,"Extern")},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(){},render:function(){}}),GetTextSize_1={ARC:0,BEGIN_PATH:1,CLOSE_PATH:2,FILL_RECT:3,LINE_TO:4,MOVE_TO:5,LINE_STYLE:6,FILL_STYLE:7,FILL_PATH:8,STROKE_PATH:9,FILL_TRIANGLE:10,STROKE_TRIANGLE:11,SAVE:14,RESTORE:15,TRANSLATE:16,SCALE:17,ROTATE:18,GRADIENT_FILL_STYLE:21,GRADIENT_LINE_STYLE:22},Composites_1=function(normy,normx,y){if(normy.width<=0||normy.height<=0)return!1;normx=(normx-normy.x)/normy.width,normy=(y-normy.y)/normy.height;return(normx*=normx)+(normy*=normy)<.25},Point$r=JSONFile_1,CopyFrom_1$1=function(ellipse,angle,out){void 0===out&&(out=new Point$r);var halfWidth=ellipse.width/2,halfHeight=ellipse.height/2;return out.x=ellipse.x+halfWidth*Math.cos(angle),out.y=ellipse.y+halfHeight*Math.sin(angle),out},CircumferencePoint$1=CopyFrom_1$1,FromPercent$1=Rope_1,MATH_CONST$c=Tweens,Point$q=JSONFile_1,Angle_1=function(ellipse,angle,out){void 0===out&&(out=new Point$q);angle=FromPercent$1(angle,0,MATH_CONST$c.PI2);return CircumferencePoint$1(ellipse,angle,out)},ContainsRect_1=function(h){var rx=h.width/2,ry=h.height/2,h=Math.pow(rx-ry,2)/Math.pow(rx+ry,2);return Math.PI*(rx+ry)*(1+3*h/(10+Math.sqrt(4-3*h)))},Circumference=ContainsRect_1,CircumferencePoint=CopyFrom_1$1,FromPercent=Rope_1,MATH_CONST$b=Tweens,CenterOn_1$1=function(ellipse,quantity,stepRate,out){void 0===out&&(out=[]),!quantity&&0<stepRate&&(quantity=Circumference(ellipse)/stepRate);for(var i=0;i<quantity;i++){var angle=FromPercent(i/quantity,0,MATH_CONST$b.PI2);out.push(CircumferencePoint(ellipse,angle))}return out},Contains$e=Composites_1,GetPoint$2=Angle_1,GetPoints$4=CenterOn_1$1,GEOM_CONST$3=loader,Random$1=Equals_1$3,Constraint_1=new Class_1({initialize:function(x,y,width,height){void 0===x&&(x=0),void 0===y&&(y=0),void 0===width&&(width=0),void 0===height&&(height=0),this.type=GEOM_CONST$3.ELLIPSE,this.x=x,this.y=y,this.width=width,this.height=height},contains:function(x,y){return Contains$e(this,x,y)},getPoint:function(position,point){return GetPoint$2(this,position,point)},getPoints:function(quantity,stepRate,output){return GetPoints$4(this,quantity,stepRate,output)},getRandomPoint:function(point){return Random$1(this,point)},setTo:function(x,y,width,height){return this.x=x,this.y=y,this.width=width,this.height=height,this},setEmpty:function(){return this.width=0,this.height=0,this},setPosition:function(x,y){return void 0===y&&(y=x),this.x=x,this.y=y,this},setSize:function(width,height){return void 0===height&&(height=width),this.width=width,this.height=height,this},isEmpty:function(){return this.width<=0||this.height<=0},getMinorRadius:function(){return Math.min(this.width,this.height)/2},getMajorRadius:function(){return Math.max(this.width,this.height)/2},left:{get:function(){return this.x-this.width/2},set:function(value){this.x=value+this.width/2}},right:{get:function(){return this.x+this.width/2},set:function(value){this.x=value-this.width/2}},top:{get:function(){return this.y-this.height/2},set:function(value){this.y=value+this.height/2}},bottom:{get:function(){return this.y+this.height/2},set:function(value){this.y=value-this.height/2}}}),Commands$2=GetTextSize_1,GetCalcMatrix$g=GetCalcMatrix_1,Utils$i=GetProps_1,matrixStack=[],tempMatrix$2=new TransformMatrix,Commands$1=GetTextSize_1,SetTransform$b=parsers,CircumCenter_1=function(renderer,src,camera,parentMatrix,renderTargetCtx,allowClip){var commandBuffer=src.commandBuffer,commandBufferLength=commandBuffer.length,ctx=renderTargetCtx||renderer.currentContext;if(0!==commandBufferLength&&SetTransform$b(renderer,ctx,src,camera,parentMatrix)){camera.addToRenderList(src);var lineAlpha,fillAlpha,lineColor,fillColor,lineWidth;ctx.beginPath();for(var index=0;index<commandBufferLength;++index)switch(commandBuffer[index]){case Commands$1.ARC:ctx.arc(commandBuffer[index+1],commandBuffer[index+2],commandBuffer[index+3],commandBuffer[index+4],commandBuffer[index+5],commandBuffer[index+6]),index+=7;break;case Commands$1.LINE_STYLE:lineWidth=commandBuffer[index+1],lineColor=commandBuffer[index+2],lineAlpha=commandBuffer[index+3],ctx.strokeStyle="rgba("+((16711680&lineColor)>>>16)+","+((65280&lineColor)>>>8)+","+(255&lineColor)+","+lineAlpha+")",ctx.lineWidth=lineWidth,index+=3;break;case Commands$1.FILL_STYLE:fillColor=commandBuffer[index+1],fillAlpha=commandBuffer[index+2],ctx.fillStyle="rgba("+((16711680&fillColor)>>>16)+","+((65280&fillColor)>>>8)+","+(255&fillColor)+","+fillAlpha+")",index+=2;break;case Commands$1.BEGIN_PATH:ctx.beginPath();break;case Commands$1.CLOSE_PATH:ctx.closePath();break;case Commands$1.FILL_PATH:allowClip||ctx.fill();break;case Commands$1.STROKE_PATH:allowClip||ctx.stroke();break;case Commands$1.FILL_RECT:allowClip?ctx.rect(commandBuffer[index+1],commandBuffer[index+2],commandBuffer[index+3],commandBuffer[index+4]):ctx.fillRect(commandBuffer[index+1],commandBuffer[index+2],commandBuffer[index+3],commandBuffer[index+4]),index+=4;break;case Commands$1.FILL_TRIANGLE:ctx.beginPath(),ctx.moveTo(commandBuffer[index+1],commandBuffer[index+2]),ctx.lineTo(commandBuffer[index+3],commandBuffer[index+4]),ctx.lineTo(commandBuffer[index+5],commandBuffer[index+6]),ctx.closePath(),allowClip||ctx.fill(),index+=6;break;case Commands$1.STROKE_TRIANGLE:ctx.beginPath(),ctx.moveTo(commandBuffer[index+1],commandBuffer[index+2]),ctx.lineTo(commandBuffer[index+3],commandBuffer[index+4]),ctx.lineTo(commandBuffer[index+5],commandBuffer[index+6]),ctx.closePath(),allowClip||ctx.stroke(),index+=6;break;case Commands$1.LINE_TO:ctx.lineTo(commandBuffer[index+1],commandBuffer[index+2]),index+=2;break;case Commands$1.MOVE_TO:ctx.moveTo(commandBuffer[index+1],commandBuffer[index+2]),index+=2;break;case Commands$1.LINE_FX_TO:ctx.lineTo(commandBuffer[index+1],commandBuffer[index+2]),index+=5;break;case Commands$1.MOVE_FX_TO:ctx.moveTo(commandBuffer[index+1],commandBuffer[index+2]),index+=5;break;case Commands$1.SAVE:ctx.save();break;case Commands$1.RESTORE:ctx.restore();break;case Commands$1.TRANSLATE:ctx.translate(commandBuffer[index+1],commandBuffer[index+2]),index+=2;break;case Commands$1.SCALE:ctx.scale(commandBuffer[index+1],commandBuffer[index+2]),index+=2;break;case Commands$1.ROTATE:ctx.rotate(commandBuffer[index+1]),index+=1;break;case Commands$1.GRADIENT_FILL_STYLE:index+=5;break;case Commands$1.GRADIENT_LINE_STYLE:index+=6}ctx.restore()}},Clone_1$4=Composite_1,Commands=GetTextSize_1,Ellipse$5=Constraint_1,GameObject$f=GameObject_1,GetFastValue$Z=GetFastValue_1,GetValue$l=GetValue_1,MATH_CONST$a=Tweens,Graphics$2=new Class_1({Extends:GameObject$f,Mixins:[physics,MeasureText_1,TextStyle_1,Text_1,MatterCollisionEvents_1,Pair_1,Ceil_1,AtlasXMLFile_1,{renderWebGL:function(renderer,src,camera,parentMatrix){if(0!==src.commandBuffer.length){camera.addToRenderList(src);var pipeline=renderer.pipelines.set(src.pipeline,src);renderer.pipelines.preBatch(src);for(var calcMatrix=GetCalcMatrix$g(src,camera,parentMatrix).calc,currentMatrix=tempMatrix$2.loadIdentity(),commands=src.commandBuffer,alpha=camera.alpha*src.alpha,lineWidth=1,fillTint=pipeline.fillTint,strokeTint=pipeline.strokeTint,tx=0,ty=0,ta=0,PI2=2*Math.PI,path=[],pathIndex=0,pathOpen=!0,lastPath=null,getTint=Utils$i.getTintAppendFloatAlpha,cmdIndex=0;cmdIndex<commands.length;cmdIndex++)switch(commands[cmdIndex]){case Commands$2.BEGIN_PATH:path.length=0,pathOpen=!(lastPath=null);break;case Commands$2.CLOSE_PATH:pathOpen=!1,lastPath&&lastPath.points.length&&lastPath.points.push(lastPath.points[0]);break;case Commands$2.FILL_PATH:for(pathIndex=0;pathIndex<path.length;pathIndex++)pipeline.batchFillPath(path[pathIndex].points,currentMatrix,calcMatrix);break;case Commands$2.STROKE_PATH:for(pathIndex=0;pathIndex<path.length;pathIndex++)pipeline.batchStrokePath(path[pathIndex].points,lineWidth,pathOpen,currentMatrix,calcMatrix);break;case Commands$2.LINE_STYLE:var lineWidth=commands[++cmdIndex],alphaBL=getTint(commands[++cmdIndex],commands[++cmdIndex]*alpha);strokeTint.TL=alphaBL,strokeTint.TR=alphaBL,strokeTint.BL=alphaBL,strokeTint.BR=alphaBL;break;case Commands$2.FILL_STYLE:var alphaBR=getTint(commands[++cmdIndex],commands[++cmdIndex]*alpha);fillTint.TL=alphaBR,fillTint.TR=alphaBR,fillTint.BL=alphaBR,fillTint.BR=alphaBR;break;case Commands$2.GRADIENT_FILL_STYLE:var alphaTL=commands[++cmdIndex]*alpha,alphaTR=commands[++cmdIndex]*alpha,alphaBL=commands[++cmdIndex]*alpha,alphaBR=commands[++cmdIndex]*alpha;fillTint.TL=getTint(commands[++cmdIndex],alphaTL),fillTint.TR=getTint(commands[++cmdIndex],alphaTR),fillTint.BL=getTint(commands[++cmdIndex],alphaBL),fillTint.BR=getTint(commands[++cmdIndex],alphaBR);break;case Commands$2.GRADIENT_LINE_STYLE:lineWidth=commands[++cmdIndex];var anticlockwise=commands[++cmdIndex]*alpha;strokeTint.TL=getTint(commands[++cmdIndex],anticlockwise),strokeTint.TR=getTint(commands[++cmdIndex],anticlockwise),strokeTint.BL=getTint(commands[++cmdIndex],anticlockwise),strokeTint.BR=getTint(commands[++cmdIndex],anticlockwise);break;case Commands$2.ARC:var iteration=0,x=commands[++cmdIndex],y=commands[++cmdIndex],radius=commands[++cmdIndex],startAngle=commands[++cmdIndex],endAngle=commands[++cmdIndex],anticlockwise=commands[++cmdIndex],overshoot=commands[++cmdIndex];for(endAngle-=startAngle,anticlockwise?endAngle<-PI2?endAngle=-PI2:0<endAngle&&(endAngle=endAngle%PI2-PI2):PI2<endAngle?endAngle=PI2:endAngle<0&&(endAngle=PI2+endAngle%PI2),null===lastPath&&(lastPath=new Path(x+Math.cos(startAngle)*radius,y+Math.sin(startAngle)*radius,lineWidth),path.push(lastPath),iteration+=.01);iteration<1+overshoot;)ta=endAngle*iteration+startAngle,tx=x+Math.cos(ta)*radius,ty=y+Math.sin(ta)*radius,lastPath.points.push(new Point$p(tx,ty,lineWidth)),iteration+=.01;ta=endAngle+startAngle,tx=x+Math.cos(ta)*radius,ty=y+Math.sin(ta)*radius,lastPath.points.push(new Point$p(tx,ty,lineWidth));break;case Commands$2.FILL_RECT:pipeline.batchFillRect(commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],currentMatrix,calcMatrix);break;case Commands$2.FILL_TRIANGLE:pipeline.batchFillTriangle(commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],currentMatrix,calcMatrix);break;case Commands$2.STROKE_TRIANGLE:pipeline.batchStrokeTriangle(commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],lineWidth,currentMatrix,calcMatrix);break;case Commands$2.LINE_TO:null!==lastPath?lastPath.points.push(new Point$p(commands[++cmdIndex],commands[++cmdIndex],lineWidth)):(lastPath=new Path(commands[++cmdIndex],commands[++cmdIndex],lineWidth),path.push(lastPath));break;case Commands$2.MOVE_TO:lastPath=new Path(commands[++cmdIndex],commands[++cmdIndex],lineWidth),path.push(lastPath);break;case Commands$2.SAVE:matrixStack.push(currentMatrix.copyToArray());break;case Commands$2.RESTORE:currentMatrix.copyFromArray(matrixStack.pop());break;case Commands$2.TRANSLATE:x=commands[++cmdIndex],y=commands[++cmdIndex],currentMatrix.translate(x,y);break;case Commands$2.SCALE:x=commands[++cmdIndex],y=commands[++cmdIndex],currentMatrix.scale(x,y);break;case Commands$2.ROTATE:currentMatrix.rotate(commands[++cmdIndex])}renderer.pipelines.postBatch(src)}},renderCanvas:CircumCenter_1}],initialize:function(scene,options){var x=GetValue$l(options,"x",0),y=GetValue$l(options,"y",0);GameObject$f.call(this,scene,"Graphics"),this.setPosition(x,y),this.initPipeline(),this.displayOriginX=0,this.displayOriginY=0,this.commandBuffer=[],this.defaultFillColor=-1,this.defaultFillAlpha=1,this.defaultStrokeWidth=1,this.defaultStrokeColor=-1,this.defaultStrokeAlpha=1,this._lineWidth=1,this.setDefaultStyles(options)},setDefaultStyles:function(options){return GetValue$l(options,"lineStyle",null)&&(this.defaultStrokeWidth=GetValue$l(options,"lineStyle.width",1),this.defaultStrokeColor=GetValue$l(options,"lineStyle.color",16777215),this.defaultStrokeAlpha=GetValue$l(options,"lineStyle.alpha",1),this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha)),GetValue$l(options,"fillStyle",null)&&(this.defaultFillColor=GetValue$l(options,"fillStyle.color",16777215),this.defaultFillAlpha=GetValue$l(options,"fillStyle.alpha",1),this.fillStyle(this.defaultFillColor,this.defaultFillAlpha)),this},lineStyle:function(lineWidth,color,alpha){return this.commandBuffer.push(Commands.LINE_STYLE,lineWidth,color,alpha=void 0===alpha?1:alpha),this._lineWidth=lineWidth,this},fillStyle:function(color,alpha){return this.commandBuffer.push(Commands.FILL_STYLE,color,alpha=void 0===alpha?1:alpha),this},fillGradientStyle:function(topLeft,topRight,bottomLeft,bottomRight,alphaTopLeft,alphaTopRight,alphaBottomLeft,alphaBottomRight){return void 0===alphaTopLeft&&(alphaTopLeft=1),void 0===alphaTopRight&&(alphaTopRight=alphaTopLeft),void 0===alphaBottomLeft&&(alphaBottomLeft=alphaTopLeft),void 0===alphaBottomRight&&(alphaBottomRight=alphaTopLeft),this.commandBuffer.push(Commands.GRADIENT_FILL_STYLE,alphaTopLeft,alphaTopRight,alphaBottomLeft,alphaBottomRight,topLeft,topRight,bottomLeft,bottomRight),this},lineGradientStyle:function(lineWidth,topLeft,topRight,bottomLeft,bottomRight,alpha){return this.commandBuffer.push(Commands.GRADIENT_LINE_STYLE,lineWidth,alpha=void 0===alpha?1:alpha,topLeft,topRight,bottomLeft,bottomRight),this},beginPath:function(){return this.commandBuffer.push(Commands.BEGIN_PATH),this},closePath:function(){return this.commandBuffer.push(Commands.CLOSE_PATH),this},fillPath:function(){return this.commandBuffer.push(Commands.FILL_PATH),this},fill:function(){return this.commandBuffer.push(Commands.FILL_PATH),this},strokePath:function(){return this.commandBuffer.push(Commands.STROKE_PATH),this},stroke:function(){return this.commandBuffer.push(Commands.STROKE_PATH),this},fillCircleShape:function(circle){return this.fillCircle(circle.x,circle.y,circle.radius)},strokeCircleShape:function(circle){return this.strokeCircle(circle.x,circle.y,circle.radius)},fillCircle:function(x,y,radius){return this.beginPath(),this.arc(x,y,radius,0,MATH_CONST$a.PI2),this.fillPath(),this},strokeCircle:function(x,y,radius){return this.beginPath(),this.arc(x,y,radius,0,MATH_CONST$a.PI2),this.strokePath(),this},fillRectShape:function(rect){return this.fillRect(rect.x,rect.y,rect.width,rect.height)},strokeRectShape:function(rect){return this.strokeRect(rect.x,rect.y,rect.width,rect.height)},fillRect:function(x,y,width,height){return this.commandBuffer.push(Commands.FILL_RECT,x,y,width,height),this},strokeRect:function(x,y,width,height){var maxx=this._lineWidth/2,minx=x-maxx,maxx=x+maxx;return this.beginPath(),this.moveTo(x,y),this.lineTo(x,y+height),this.strokePath(),this.beginPath(),this.moveTo(x+width,y),this.lineTo(x+width,y+height),this.strokePath(),this.beginPath(),this.moveTo(minx,y),this.lineTo(maxx+width,y),this.strokePath(),this.beginPath(),this.moveTo(minx,y+height),this.lineTo(maxx+width,y+height),this.strokePath(),this},fillRoundedRect:function(x,y,width,height,radius){var tl=radius=void 0===radius?20:radius,tr=radius,bl=radius,br=radius;return"number"!=typeof radius&&(tl=GetFastValue$Z(radius,"tl",20),tr=GetFastValue$Z(radius,"tr",20),bl=GetFastValue$Z(radius,"bl",20),br=GetFastValue$Z(radius,"br",20)),this.beginPath(),this.moveTo(x+tl,y),this.lineTo(x+width-tr,y),this.arc(x+width-tr,y+tr,tr,-MATH_CONST$a.TAU,0),this.lineTo(x+width,y+height-br),this.arc(x+width-br,y+height-br,br,0,MATH_CONST$a.TAU),this.lineTo(x+bl,y+height),this.arc(x+bl,y+height-bl,bl,MATH_CONST$a.TAU,Math.PI),this.lineTo(x,y+tl),this.arc(x+tl,y+tl,tl,-Math.PI,-MATH_CONST$a.TAU),this.fillPath(),this},strokeRoundedRect:function(x,y,width,height,radius){var tl=radius=void 0===radius?20:radius,tr=radius,bl=radius,br=radius;return"number"!=typeof radius&&(tl=GetFastValue$Z(radius,"tl",20),tr=GetFastValue$Z(radius,"tr",20),bl=GetFastValue$Z(radius,"bl",20),br=GetFastValue$Z(radius,"br",20)),this.beginPath(),this.moveTo(x+tl,y),this.lineTo(x+width-tr,y),this.moveTo(x+width-tr,y),this.arc(x+width-tr,y+tr,tr,-MATH_CONST$a.TAU,0),this.lineTo(x+width,y+height-br),this.moveTo(x+width,y+height-br),this.arc(x+width-br,y+height-br,br,0,MATH_CONST$a.TAU),this.lineTo(x+bl,y+height),this.moveTo(x+bl,y+height),this.arc(x+bl,y+height-bl,bl,MATH_CONST$a.TAU,Math.PI),this.lineTo(x,y+tl),this.moveTo(x,y+tl),this.arc(x+tl,y+tl,tl,-Math.PI,-MATH_CONST$a.TAU),this.strokePath(),this},fillPointShape:function(point,size){return this.fillPoint(point.x,point.y,size)},fillPoint:function(x,y,size){return!size||size<1?size=1:(x-=size/2,y-=size/2),this.commandBuffer.push(Commands.FILL_RECT,x,y,size,size),this},fillTriangleShape:function(triangle){return this.fillTriangle(triangle.x1,triangle.y1,triangle.x2,triangle.y2,triangle.x3,triangle.y3)},strokeTriangleShape:function(triangle){return this.strokeTriangle(triangle.x1,triangle.y1,triangle.x2,triangle.y2,triangle.x3,triangle.y3)},fillTriangle:function(x0,y0,x1,y1,x2,y2){return this.commandBuffer.push(Commands.FILL_TRIANGLE,x0,y0,x1,y1,x2,y2),this},strokeTriangle:function(x0,y0,x1,y1,x2,y2){return this.commandBuffer.push(Commands.STROKE_TRIANGLE,x0,y0,x1,y1,x2,y2),this},strokeLineShape:function(line){return this.lineBetween(line.x1,line.y1,line.x2,line.y2)},lineBetween:function(x1,y1,x2,y2){return this.beginPath(),this.moveTo(x1,y1),this.lineTo(x2,y2),this.strokePath(),this},lineTo:function(x,y){return this.commandBuffer.push(Commands.LINE_TO,x,y),this},moveTo:function(x,y){return this.commandBuffer.push(Commands.MOVE_TO,x,y),this},strokePoints:function(points,closeShape,closePath,endIndex){void 0===closeShape&&(closeShape=!1),void 0===closePath&&(closePath=!1),void 0===endIndex&&(endIndex=points.length),this.beginPath(),this.moveTo(points[0].x,points[0].y);for(var i=1;i<endIndex;i++)this.lineTo(points[i].x,points[i].y);return closeShape&&this.lineTo(points[0].x,points[0].y),closePath&&this.closePath(),this.strokePath(),this},fillPoints:function(points,closeShape,closePath,endIndex){void 0===closeShape&&(closeShape=!1),void 0===closePath&&(closePath=!1),void 0===endIndex&&(endIndex=points.length),this.beginPath(),this.moveTo(points[0].x,points[0].y);for(var i=1;i<endIndex;i++)this.lineTo(points[i].x,points[i].y);return closeShape&&this.lineTo(points[0].x,points[0].y),closePath&&this.closePath(),this.fillPath(),this},strokeEllipseShape:function(ellipse,points){points=ellipse.getPoints(points=void 0===points?32:points);return this.strokePoints(points,!0)},strokeEllipse:function(x,y,width,height,points){void 0===points&&(points=32);points=new Ellipse$5(x,y,width,height).getPoints(points);return this.strokePoints(points,!0)},fillEllipseShape:function(ellipse,points){points=ellipse.getPoints(points=void 0===points?32:points);return this.fillPoints(points,!0)},fillEllipse:function(x,y,width,height,points){void 0===points&&(points=32);points=new Ellipse$5(x,y,width,height).getPoints(points);return this.fillPoints(points,!0)},arc:function(x,y,radius,startAngle,endAngle,anticlockwise,overshoot){return this.commandBuffer.push(Commands.ARC,x,y,radius,startAngle,endAngle,anticlockwise=void 0===anticlockwise?!1:anticlockwise,overshoot=void 0===overshoot?0:overshoot),this},slice:function(x,y,radius,startAngle,endAngle,anticlockwise,overshoot){return void 0===anticlockwise&&(anticlockwise=!1),void 0===overshoot&&(overshoot=0),this.commandBuffer.push(Commands.BEGIN_PATH),this.commandBuffer.push(Commands.MOVE_TO,x,y),this.commandBuffer.push(Commands.ARC,x,y,radius,startAngle,endAngle,anticlockwise,overshoot),this.commandBuffer.push(Commands.CLOSE_PATH),this},save:function(){return this.commandBuffer.push(Commands.SAVE),this},restore:function(){return this.commandBuffer.push(Commands.RESTORE),this},translateCanvas:function(x,y){return this.commandBuffer.push(Commands.TRANSLATE,x,y),this},scaleCanvas:function(x,y){return this.commandBuffer.push(Commands.SCALE,x,y),this},rotateCanvas:function(radians){return this.commandBuffer.push(Commands.ROTATE,radians),this},clear:function(){return this.commandBuffer.length=0,-1<this.defaultFillColor&&this.fillStyle(this.defaultFillColor,this.defaultFillAlpha),-1<this.defaultStrokeColor&&this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha),this},generateTexture:function(key,width,height){var ctx,texture,src,sys=this.scene.sys,renderer=sys.game.renderer;return void 0===width&&(width=sys.scale.width),void 0===height&&(height=sys.scale.height),Graphics$2.TargetCamera.setScene(this.scene),Graphics$2.TargetCamera.setViewport(0,0,width,height),Graphics$2.TargetCamera.scrollX=this.x,Graphics$2.TargetCamera.scrollY=this.y,"string"==typeof key?sys.textures.exists(key)?(src=(texture=sys.textures.get(key)).getSourceImage())instanceof HTMLCanvasElement&&(ctx=src.getContext("2d")):ctx=(texture=sys.textures.createCanvas(key,width,height)).getSourceImage().getContext("2d"):key instanceof HTMLCanvasElement&&(ctx=key.getContext("2d")),ctx&&(this.renderCanvas(renderer,this,Graphics$2.TargetCamera,null,ctx,!1),texture&&texture.refresh()),this},preDestroy:function(){this.commandBuffer=[]}});Graphics$2.TargetCamera=new Clone_1$4;function copy(out,a){return out[0]=a[0],out[1]=a[1],out}var Graphics_1=Graphics$2,Set$4=new Class_1({initialize:function(elements){if(this.entries=[],Array.isArray(elements))for(var i=0;i<elements.length;i++)this.set(elements[i])},set:function(value){return-1===this.entries.indexOf(value)&&this.entries.push(value),this},get:function(property,value){for(var i=0;i<this.entries.length;i++){var entry=this.entries[i];if(entry[property]===value)return entry}},getArray:function(){return this.entries.slice(0)},delete:function(index){index=this.entries.indexOf(index);return-1<index&&this.entries.splice(index,1),this},dump:function(){console.group("Set");for(var i=0;i<this.entries.length;i++){var entry=this.entries[i];console.log(entry)}console.groupEnd()},each:function(callback,callbackScope){var i,temp=this.entries.slice(),len=temp.length;if(callbackScope)for(i=0;i<len&&!1!==callback.call(callbackScope,temp[i],i);i++);else for(i=0;i<len&&!1!==callback(temp[i],i);i++);return this},iterate:function(callback,callbackScope){var i,len=this.entries.length;if(callbackScope)for(i=0;i<len&&!1!==callback.call(callbackScope,this.entries[i],i);i++);else for(i=0;i<len&&!1!==callback(this.entries[i],i);i++);return this},iterateLocal:function(callbackKey){for(var args=[],i=1;i<arguments.length;i++)args.push(arguments[i]);var len=this.entries.length;for(i=0;i<len;i++){var entry=this.entries[i];entry[callbackKey].apply(entry,args)}return this},clear:function(){return this.entries.length=0,this},contains:function(value){return-1<this.entries.indexOf(value)},union:function(set){var newSet=new Set$4;return set.entries.forEach(function(value){newSet.set(value)}),this.entries.forEach(function(value){newSet.set(value)}),newSet},intersect:function(set){var newSet=new Set$4;return this.entries.forEach(function(value){set.contains(value)&&newSet.set(value)}),newSet},difference:function(set){var newSet=new Set$4;return this.entries.forEach(function(value){set.contains(value)||newSet.set(value)}),newSet},size:{get:function(){return this.entries.length},set:function(value){return value<this.entries.length?this.entries.length=value:this.entries.length}}}),HexagonalWorldToTileXY_1=Set$4,AnimationState$2=MatterAttractors_1,Components$n=components$3,GameObject$e=GameObject_1,time=new Class_1({Extends:GameObject$e,Mixins:[Components$n.Alpha,Components$n.BlendMode,Components$n.Depth,Components$n.Flip,Components$n.GetBounds,Components$n.Mask,Components$n.Origin,Components$n.Pipeline,Components$n.ScrollFactor,Components$n.Size,Components$n.TextureCrop,Components$n.Tint,Components$n.Transform,Components$n.Visible,{renderWebGL:function(renderer,src,camera,parentMatrix){camera.addToRenderList(src),src.pipeline.batchSprite(src,camera,parentMatrix)},renderCanvas:function(renderer,src,camera,parentMatrix){camera.addToRenderList(src),renderer.batchSprite(src,src.frame,camera,parentMatrix)}}],initialize:function(scene,x,y,texture,frame){GameObject$e.call(this,scene,"Sprite"),this._crop=this.resetCropObject(),this.anims=new AnimationState$2(this),this.setTexture(texture,frame),this.setPosition(x,y),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline()},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(time,delta){this.anims.update(time,delta)},play:function(key,ignoreIfPlaying){return this.anims.play(key,ignoreIfPlaying)},playReverse:function(key,ignoreIfPlaying){return this.anims.playReverse(key,ignoreIfPlaying)},playAfterDelay:function(key,delay){return this.anims.playAfterDelay(key,delay)},playAfterRepeat:function(key,repeatCount){return this.anims.playAfterRepeat(key,repeatCount)},chain:function(key){return this.anims.chain(key)},stop:function(){return this.anims.stop()},stopAfterDelay:function(delay){return this.anims.stopAfterDelay(delay)},stopAfterRepeat:function(repeatCount){return this.anims.stopAfterRepeat(repeatCount)},stopOnFrame:function(frame){return this.anims.stopOnFrame(frame)},toJSON:function(){return Components$n.ToJSON(this)},preDestroy:function(){this.anims.destroy(),this.anims=void 0}}),Actions=actions,GetNearestPoint_1=Class_1,Events$m=events$h,EventEmitter$c=eventemitter3.exports,GetAll=Parse2DArray_1,GetFastValue$Y=GetFastValue_1,GetValue$k=GetValue_1,IsPlainObject$u=IsPlainObject_1,Range=CenterOn_1,Set$3=HexagonalWorldToTileXY_1,Sprite$6=time,events$1=new GetNearestPoint_1({Extends:EventEmitter$c,initialize:function(scene,children,config){EventEmitter$c.call(this),config?children&&!Array.isArray(children)&&(children=[children]):Array.isArray(children)?IsPlainObject$u(children[0])&&(config=children,children=null):IsPlainObject$u(children)&&(config=children,children=null),this.scene=scene,this.children=new Set$3,this.isParent=!0,this.type="Group",this.classType=GetFastValue$Y(config,"classType",Sprite$6),this.name=GetFastValue$Y(config,"name",""),this.active=GetFastValue$Y(config,"active",!0),this.maxSize=GetFastValue$Y(config,"maxSize",-1),this.defaultKey=GetFastValue$Y(config,"defaultKey",null),this.defaultFrame=GetFastValue$Y(config,"defaultFrame",null),this.runChildUpdate=GetFastValue$Y(config,"runChildUpdate",!1),this.createCallback=GetFastValue$Y(config,"createCallback",null),this.removeCallback=GetFastValue$Y(config,"removeCallback",null),this.createMultipleCallback=GetFastValue$Y(config,"createMultipleCallback",null),this.internalCreateCallback=GetFastValue$Y(config,"internalCreateCallback",null),this.internalRemoveCallback=GetFastValue$Y(config,"internalRemoveCallback",null),children&&this.addMultiple(children),config&&this.createMultiple(config),this.on(Events$m.ADDED_TO_SCENE,this.addedToScene,this),this.on(Events$m.REMOVED_FROM_SCENE,this.removedFromScene,this)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},create:function(x,y,key,child,visible,active){if(void 0===x&&(x=0),void 0===y&&(y=0),void 0===key&&(key=this.defaultKey),void 0===child&&(child=this.defaultFrame),void 0===visible&&(visible=!0),void 0===active&&(active=!0),this.isFull())return null;child=new this.classType(this.scene,x,y,key,child);return child.addToDisplayList(this.scene.sys.displayList),child.addToUpdateList(),child.visible=visible,child.setActive(active),this.add(child),child},createMultiple:function(config){if(this.isFull())return[];var output=[];if((config=!Array.isArray(config)?[config]:config)[0].key)for(var i=0;i<config.length;i++)var entries=this.createFromConfig(config[i]),output=output.concat(entries);return output},createFromConfig:function(grid){if(this.isFull())return[];this.classType=GetFastValue$Y(grid,"classType",this.classType);var key=GetFastValue$Y(grid,"key",void 0),frame=GetFastValue$Y(grid,"frame",null),visible=GetFastValue$Y(grid,"visible",!0),active=GetFastValue$Y(grid,"active",!0),entries=[];if(void 0===key)return entries;Array.isArray(key)||(key=[key]),Array.isArray(frame)||(frame=[frame]);var scrollFactorX=GetFastValue$Y(grid,"repeat",0),hitArea=GetFastValue$Y(grid,"randomKey",!1),hitAreaCallback=GetFastValue$Y(grid,"randomFrame",!1),scrollFactorY=GetFastValue$Y(grid,"yoyo",!1),quantity=GetFastValue$Y(grid,"quantity",!1),frameQuantity=GetFastValue$Y(grid,"frameQuantity",1),max=GetFastValue$Y(grid,"max",0),range=Range(key,frame,{max:max,qty:quantity||frameQuantity,random:hitArea,randomB:hitAreaCallback,repeat:scrollFactorX,yoyo:scrollFactorY});grid.createCallback&&(this.createCallback=grid.createCallback),grid.removeCallback&&(this.removeCallback=grid.removeCallback);for(var c=0;c<range.length;c++){var created=this.create(0,0,range[c].a,range[c].b,visible,active);if(!created)break;entries.push(created)}hitArea=GetValue$k(grid,"setXY.x",0),hitAreaCallback=GetValue$k(grid,"setXY.y",0),scrollFactorX=GetValue$k(grid,"setXY.stepX",0),scrollFactorY=GetValue$k(grid,"setXY.stepY",0);Actions.SetXY(entries,hitArea,hitAreaCallback,scrollFactorX,scrollFactorY);hitArea=GetValue$k(grid,"setRotation.value",0),hitAreaCallback=GetValue$k(grid,"setRotation.step",0);Actions.SetRotation(entries,hitArea,hitAreaCallback);scrollFactorX=GetValue$k(grid,"setScale.x",1),scrollFactorY=GetValue$k(grid,"setScale.y",scrollFactorX),hitArea=GetValue$k(grid,"setScale.stepX",0),hitAreaCallback=GetValue$k(grid,"setScale.stepY",0);Actions.SetScale(entries,scrollFactorX,scrollFactorY,hitArea,hitAreaCallback);scrollFactorX=GetValue$k(grid,"setOrigin.x",.5),scrollFactorY=GetValue$k(grid,"setOrigin.y",scrollFactorX),hitArea=GetValue$k(grid,"setOrigin.stepX",0),hitAreaCallback=GetValue$k(grid,"setOrigin.stepY",0);Actions.SetOrigin(entries,scrollFactorX,scrollFactorY,hitArea,hitAreaCallback);scrollFactorX=GetValue$k(grid,"setAlpha.value",1),scrollFactorY=GetValue$k(grid,"setAlpha.step",0);Actions.SetAlpha(entries,scrollFactorX,scrollFactorY);hitArea=GetValue$k(grid,"setDepth.value",0),hitAreaCallback=GetValue$k(grid,"setDepth.step",0);Actions.SetDepth(entries,hitArea,hitAreaCallback);scrollFactorX=GetValue$k(grid,"setScrollFactor.x",1),scrollFactorY=GetValue$k(grid,"setScrollFactor.y",scrollFactorX),hitArea=GetValue$k(grid,"setScrollFactor.stepX",0),hitAreaCallback=GetValue$k(grid,"setScrollFactor.stepY",0);Actions.SetScrollFactor(entries,scrollFactorX,scrollFactorY,hitArea,hitAreaCallback);hitArea=GetFastValue$Y(grid,"hitArea",null),hitAreaCallback=GetFastValue$Y(grid,"hitAreaCallback",null);hitArea&&Actions.SetHitArea(entries,hitArea,hitAreaCallback);grid=GetFastValue$Y(grid,"gridAlign",!1);return grid&&Actions.GridAlign(entries,grid),this.createMultipleCallback&&this.createMultipleCallback.call(this,entries),entries},preUpdate:function(time,delta){if(this.runChildUpdate&&0!==this.children.size)for(var temp=this.children.entries.slice(),i=0;i<temp.length;i++){var item=temp[i];item.active&&item.update(time,delta)}},add:function(child,addToScene){return void 0===addToScene&&(addToScene=!1),this.isFull()||(this.children.set(child),this.internalCreateCallback&&this.internalCreateCallback.call(this,child),this.createCallback&&this.createCallback.call(this,child),addToScene&&(child.addToDisplayList(this.scene.sys.displayList),child.addToUpdateList()),child.on(Events$m.DESTROY,this.remove,this)),this},addMultiple:function(children,addToScene){if(void 0===addToScene&&(addToScene=!1),Array.isArray(children))for(var i=0;i<children.length;i++)this.add(children[i],addToScene);return this},remove:function(child,removeFromScene,destroyChild){return void 0===removeFromScene&&(removeFromScene=!1),void 0===destroyChild&&(destroyChild=!1),this.children.contains(child)&&(this.children.delete(child),this.internalRemoveCallback&&this.internalRemoveCallback.call(this,child),this.removeCallback&&this.removeCallback.call(this,child),child.off(Events$m.DESTROY,this.remove,this),destroyChild?child.destroy():removeFromScene&&(child.removeFromDisplayList(),child.removeFromUpdateList())),this},clear:function(removeFromScene,destroyChild){void 0===removeFromScene&&(removeFromScene=!1),void 0===destroyChild&&(destroyChild=!1);for(var children=this.children,i=0;i<children.size;i++){var gameObject=children.entries[i];gameObject.off(Events$m.DESTROY,this.remove,this),destroyChild?gameObject.destroy():removeFromScene&&(gameObject.removeFromDisplayList(),gameObject.removeFromUpdateList())}return this.children.clear(),this},contains:function(child){return this.children.contains(child)},getChildren:function(){return this.children.entries},getLength:function(){return this.children.size},getMatching:function(property,value,startIndex,endIndex){return GetAll(this.children.entries,property,value,startIndex,endIndex)},getFirst:function(state,createIfNull,x,y,key,frame,visible){return this.getHandler(!0,1,state,createIfNull,x,y,key,frame,visible)},getFirstNth:function(nth,state,createIfNull,x,y,key,frame,visible){return this.getHandler(!0,nth,state,createIfNull,x,y,key,frame,visible)},getLast:function(state,createIfNull,x,y,key,frame,visible){return this.getHandler(!1,1,state,createIfNull,x,y,key,frame,visible)},getLastNth:function(nth,state,createIfNull,x,y,key,frame,visible){return this.getHandler(!1,nth,state,createIfNull,x,y,key,frame,visible)},getHandler:function(forwards,nth,state,createIfNull,x,y,key,frame,visible){var gameObject,i;void 0===state&&(state=!1),void 0===createIfNull&&(createIfNull=!1);var total=0,children=this.children.entries;if(forwards)for(i=0;i<children.length;i++)if((gameObject=children[i]).active===state){if(++total===nth)break}else gameObject=null;else for(i=children.length-1;0<=i;i--)if((gameObject=children[i]).active===state){if(++total===nth)break}else gameObject=null;return gameObject?("number"==typeof x&&(gameObject.x=x),"number"==typeof y&&(gameObject.y=y),gameObject):createIfNull?this.create(x,y,key,frame,visible):null},get:function(x,y,key,frame,visible){return this.getFirst(!1,!0,x,y,key,frame,visible)},getFirstAlive:function(createIfNull,x,y,key,frame,visible){return this.getFirst(!0,createIfNull,x,y,key,frame,visible)},getFirstDead:function(createIfNull,x,y,key,frame,visible){return this.getFirst(!1,createIfNull,x,y,key,frame,visible)},playAnimation:function(key,startFrame){return Actions.PlayAnimation(this.children.entries,key,startFrame),this},isFull:function(){return-1!==this.maxSize&&this.children.size>=this.maxSize},countActive:function(value){void 0===value&&(value=!0);for(var total=0,i=0;i<this.children.size;i++)this.children.entries[i].active===value&&total++;return total},getTotalUsed:function(){return this.countActive()},getTotalFree:function(){var used=this.getTotalUsed();return(-1===this.maxSize?999999999999:this.maxSize)-used},setActive:function(value){return this.active=value,this},setName:function(value){return this.name=value,this},propertyValueSet:function(key,value,step,index,direction){return Actions.PropertyValueSet(this.children.entries,key,value,step,index,direction),this},propertyValueInc:function(key,value,step,index,direction){return Actions.PropertyValueInc(this.children.entries,key,value,step,index,direction),this},setX:function(value,step){return Actions.SetX(this.children.entries,value,step),this},setY:function(value,step){return Actions.SetY(this.children.entries,value,step),this},setXY:function(x,y,stepX,stepY){return Actions.SetXY(this.children.entries,x,y,stepX,stepY),this},incX:function(value,step){return Actions.IncX(this.children.entries,value,step),this},incY:function(value,step){return Actions.IncY(this.children.entries,value,step),this},incXY:function(x,y,stepX,stepY){return Actions.IncXY(this.children.entries,x,y,stepX,stepY),this},shiftPosition:function(x,y,direction){return Actions.ShiftPosition(this.children.entries,x,y,direction),this},angle:function(value,step){return Actions.Angle(this.children.entries,value,step),this},rotate:function(value,step){return Actions.Rotate(this.children.entries,value,step),this},rotateAround:function(point,angle){return Actions.RotateAround(this.children.entries,point,angle),this},rotateAroundDistance:function(point,angle,distance){return Actions.RotateAroundDistance(this.children.entries,point,angle,distance),this},setAlpha:function(value,step){return Actions.SetAlpha(this.children.entries,value,step),this},setTint:function(topLeft,topRight,bottomLeft,bottomRight){return Actions.SetTint(this.children.entries,topLeft,topRight,bottomLeft,bottomRight),this},setOrigin:function(originX,originY,stepX,stepY){return Actions.SetOrigin(this.children.entries,originX,originY,stepX,stepY),this},scaleX:function(value,step){return Actions.ScaleX(this.children.entries,value,step),this},scaleY:function(value,step){return Actions.ScaleY(this.children.entries,value,step),this},scaleXY:function(scaleX,scaleY,stepX,stepY){return Actions.ScaleXY(this.children.entries,scaleX,scaleY,stepX,stepY),this},setDepth:function(value,step){return Actions.SetDepth(this.children.entries,value,step),this},setBlendMode:function(value){return Actions.SetBlendMode(this.children.entries,value),this},setHitArea:function(hitArea,hitAreaCallback){return Actions.SetHitArea(this.children.entries,hitArea,hitAreaCallback),this},shuffle:function(){return Actions.Shuffle(this.children.entries),this},kill:function(gameObject){this.children.contains(gameObject)&&gameObject.setActive(!1)},killAndHide:function(gameObject){this.children.contains(gameObject)&&(gameObject.setActive(!1),gameObject.setVisible(!1))},setVisible:function(value,index,direction){return Actions.SetVisible(this.children.entries,value,index,direction),this},toggleVisible:function(){return Actions.ToggleVisible(this.children.entries),this},destroy:function(destroyChildren,removeFromScene){void 0===destroyChildren&&(destroyChildren=!1),void 0===removeFromScene&&(removeFromScene=!1),this.scene&&!this.ignoreDestroy&&(this.emit(Events$m.DESTROY,this),this.removeAllListeners(),this.scene.sys.updateList.remove(this),this.clear(removeFromScene,destroyChildren),this.scene=void 0,this.children=void 0)}}),GameObject$d=GameObject_1,Resolver_1=new Class_1({Extends:GameObject$d,Mixins:[components$3.Alpha,components$3.BlendMode,components$3.Depth,components$3.Flip,components$3.GetBounds,components$3.Mask,components$3.Origin,components$3.Pipeline,components$3.ScrollFactor,components$3.Size,components$3.TextureCrop,components$3.Tint,components$3.Transform,components$3.Visible,{renderWebGL:function(renderer,src,camera,parentMatrix){camera.addToRenderList(src),this.pipeline.batchSprite(src,camera,parentMatrix)},renderCanvas:function(renderer,src,camera,parentMatrix){camera.addToRenderList(src),renderer.batchSprite(src,src.frame,camera,parentMatrix)}}],initialize:function(scene,x,y,texture,frame){GameObject$d.call(this,scene,"Image"),this._crop=this.resetCropObject(),this.setTexture(texture,frame),this.setPosition(x,y),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline()}}),BitmapFontFile_1=function(renderer,layer,camera){var children=layer.list,childCount=children.length;if(0!==childCount){layer.depthSort(),renderer.pipelines.preBatch(layer);var layerHasBlendMode=-1!==layer.blendMode;layerHasBlendMode||renderer.setBlendMode(0);for(var alpha=layer.alpha,i=0;i<childCount;i++){var childAlphaTopLeft,childAlphaTopRight,childAlphaBottomLeft,childAlphaBottomRight,mask,type,child=children[i];child.willRender(camera)&&(childAlphaBottomRight=void 0!==child.alphaTopLeft?(childAlphaTopLeft=child.alphaTopLeft,childAlphaTopRight=child.alphaTopRight,childAlphaBottomLeft=child.alphaBottomLeft,child.alphaBottomRight):childAlphaBottomLeft=childAlphaTopRight=childAlphaTopLeft=child.alpha,layerHasBlendMode||child.blendMode===renderer.currentBlendMode||renderer.setBlendMode(child.blendMode),(mask=child.mask)&&mask.preRenderWebGL(renderer,child,camera),(type=child.type)!==renderer.currentType&&(renderer.newType=!0,renderer.currentType=type),renderer.nextTypeMatch=i<childCount-1&&children[i+1].type===renderer.currentType,child.setAlpha(childAlphaTopLeft*alpha,childAlphaTopRight*alpha,childAlphaBottomLeft*alpha,childAlphaBottomRight*alpha),child.renderWebGL(renderer,child,camera),child.setAlpha(childAlphaTopLeft,childAlphaTopRight,childAlphaBottomLeft,childAlphaBottomRight),mask&&mask.postRenderWebGL(renderer,camera),renderer.newType=!1)}renderer.pipelines.postBatch(layer)}},BlendModes$2=BlendModes$8,HTMLTextureFile_1=Class_1,ComponentsToJSON=Body_1,DataManager=CustomMain,EventEmitter$b=eventemitter3.exports,GameObjectEvents=events$h,List$1=Base64Decode_1,SceneEvents$9=events$g,StableSort$3=Extend_1,Layer_1=new HTMLTextureFile_1({Extends:List$1,Mixins:[components$3.AlphaSingle,components$3.BlendMode,components$3.Depth,components$3.Mask,components$3.Pipeline,components$3.Visible,EventEmitter$b,{renderWebGL:BitmapFontFile_1,renderCanvas:function(renderer,layer,camera){var children=layer.list;if(0!==children.length){layer.depthSort();var layerHasBlendMode=-1!==layer.blendMode;layerHasBlendMode||renderer.setBlendMode(0);var alpha=layer._alpha;layer.mask&&layer.mask.preRenderCanvas(renderer,null,camera);for(var i=0;i<children.length;i++){var childAlpha,child=children[i];child.willRender(camera)&&(childAlpha=child.alpha,layerHasBlendMode||child.blendMode===renderer.currentBlendMode||renderer.setBlendMode(child.blendMode),child.setAlpha(childAlpha*alpha),child.renderCanvas(renderer,child,camera),child.setAlpha(childAlpha))}layer.mask&&layer.mask.postRenderCanvas(renderer)}}}],initialize:function(scene,children){List$1.call(this,scene),EventEmitter$b.call(this),this.scene=scene,this.displayList=null,this.type="Layer",this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.systems=scene.sys,this.events=scene.sys.events,this.sortChildrenFlag=!1,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.initPipeline(),this.clearAlpha(),this.setBlendMode(BlendModes$2.SKIP_CHECK),children&&this.add(children),scene.sys.queueDepthSort()},setActive:function(value){return this.active=value,this},setName:function(value){return this.name=value,this},setState:function(value){return this.state=value,this},setDataEnabled:function(){return this.data||(this.data=new DataManager(this)),this},setData:function(key,value){return this.data||(this.data=new DataManager(this)),this.data.set(key,value),this},incData:function(key,value){return this.data||(this.data=new DataManager(this)),this.data.inc(key,value),this},toggleData:function(key){return this.data||(this.data=new DataManager(this)),this.data.toggle(key),this},getData:function(key){return this.data||(this.data=new DataManager(this)),this.data.get(key)},setInteractive:function(){return this},disableInteractive:function(){return this},removeInteractive:function(){return this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return ComponentsToJSON(this)},willRender:function(camera){return!(15!==this.renderFlags||0===this.list.length||0!==this.cameraFilter&&this.cameraFilter&camera.id)},getIndexList:function(){for(var child=this,parent=this.parentContainer,indexes=[];parent&&(indexes.unshift(parent.getIndex(child)),(child=parent).parentContainer);)parent=parent.parentContainer;return indexes.unshift(this.displayList.getIndex(child)),indexes},addChildCallback:function(gameObject){gameObject.displayList&&gameObject.displayList!==this&&gameObject.removeFromDisplayList(),gameObject.displayList||(this.queueDepthSort(),gameObject.displayList=this,gameObject.emit(GameObjectEvents.ADDED_TO_SCENE,gameObject,this.scene),this.events.emit(SceneEvents$9.ADDED_TO_SCENE,gameObject,this.scene))},removeChildCallback:function(gameObject){this.queueDepthSort(),gameObject.displayList=null,gameObject.emit(GameObjectEvents.REMOVED_FROM_SCENE,gameObject,this.scene),this.events.emit(SceneEvents$9.REMOVED_FROM_SCENE,gameObject,this.scene)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&(StableSort$3(this.list,this.sortByDepth),this.sortChildrenFlag=!1)},sortByDepth:function(childA,childB){return childA._depth-childB._depth},getChildren:function(){return this.list},destroy:function(){if(this.scene&&!this.ignoreDestroy){this.emit(GameObjectEvents.DESTROY,this);for(var i=this.list.length;i--;)this.list[i].destroy();this.removeAllListeners(),this.resetPostPipeline(!0),this.displayList&&(this.displayList.remove(this,!0),this.displayList.queueDepthSort()),this.data&&(this.data.destroy(),this.data=void 0),this.active=!1,this.visible=!1,this.list=void 0,this.scene=void 0,this.displayList=void 0,this.systems=void 0,this.events=void 0}}}),EaseMap=Events_1,UppercaseFirst=UppercaseFirst_1,GetEaseFunction_1=function(ease,easeParams){var direction,easeFunction=EaseMap.Power0;if("string"==typeof ease?EaseMap.hasOwnProperty(ease)?easeFunction=EaseMap[ease]:(direction="",ease.indexOf(".")&&("in"===(direction=ease.substr(ease.indexOf(".")+1)).toLowerCase()?direction="easeIn":"out"===direction.toLowerCase()?direction="easeOut":"inout"===direction.toLowerCase()&&(direction="easeInOut")),ease=UppercaseFirst(ease.substr(0,ease.indexOf(".")+1)+direction),EaseMap.hasOwnProperty(ease)&&(easeFunction=EaseMap[ease])):"function"==typeof ease?easeFunction=ease:Array.isArray(ease)&&ease.length,!easeParams)return easeFunction;var cloneParams=easeParams.slice(0);return cloneParams.unshift(0),function(v){return cloneParams[0]=v,easeFunction.apply(this,cloneParams)}},FloatBetween=Decompose_1$1,GetEaseFunction$5=GetEaseFunction_1,GetFastValue$X=GetFastValue_1,Wrap$3=Vector_1,Centroid_1=new Class_1({initialize:function(config,key,defaultValue,emitOnly){void 0===emitOnly&&(emitOnly=!1),this.propertyKey=key,this.propertyValue=defaultValue,this.defaultValue=defaultValue,this.steps=0,this.counter=0,this.start=0,this.end=0,this.ease,this.emitOnly=emitOnly,this.onEmit=this.defaultEmit,this.onUpdate=this.defaultUpdate,this.loadConfig(config)},loadConfig:function(config,newKey){void 0===config&&(config={}),newKey&&(this.propertyKey=newKey),this.propertyValue=GetFastValue$X(config,this.propertyKey,this.defaultValue),this.setMethods(),this.emitOnly&&(this.onUpdate=this.defaultUpdate)},toJSON:function(){return this.propertyValue},onChange:function(value){return this.propertyValue=value,this.setMethods()},setMethods:function(){var easeType,rnd,value=this.propertyValue,t=typeof value;return this.onEmit=this.defaultEmit,this.onUpdate=this.defaultUpdate,"number"==t?(this.onEmit=this.staticValueEmit,this.onUpdate=this.staticValueUpdate):Array.isArray(value)?this.onEmit=this.randomStaticValueEmit:"function"==t?this.emitOnly?this.onEmit=value:this.onUpdate=value:"object"==t&&this.hasBoth(value,"start","end")?(this.start=value.start,this.end=value.end,(rnd=this.has(value,"random"))&&(this.onEmit=this.randomRangedValueEmit),this.has(value,"steps")?(this.steps=value.steps,this.counter=this.start,this.onEmit=this.steppedEmit):(easeType=this.has(value,"ease")?value.ease:"Linear",this.ease=GetEaseFunction$5(easeType,value.easeParams),rnd||(this.onEmit=this.easedValueEmit),this.onUpdate=this.easeValueUpdate)):"object"==t&&this.hasBoth(value,"min","max")?(this.start=value.min,this.end=value.max,this.onEmit=this.randomRangedValueEmit):"object"==t&&this.has(value,"random")?(rnd=value.random,Array.isArray(rnd)&&(this.start=rnd[0],this.end=rnd[1]),this.onEmit=this.randomRangedValueEmit):"object"==t&&this.hasEither(value,"onEmit","onUpdate")&&(this.has(value,"onEmit")&&(this.onEmit=value.onEmit),this.has(value,"onUpdate")&&(this.onUpdate=value.onUpdate)),this},has:function(object,key){return object.hasOwnProperty(key)},hasBoth:function(object,key1,key2){return object.hasOwnProperty(key1)&&object.hasOwnProperty(key2)},hasEither:function(object,key1,key2){return object.hasOwnProperty(key1)||object.hasOwnProperty(key2)},defaultEmit:function(particle,key,value){return value},defaultUpdate:function(particle,key,t,value){return value},staticValueEmit:function(){return this.propertyValue},staticValueUpdate:function(){return this.propertyValue},randomStaticValueEmit:function(){var randomIndex=Math.floor(Math.random()*this.propertyValue.length);return this.propertyValue[randomIndex]},randomRangedValueEmit:function(particle,key){var value=FloatBetween(this.start,this.end);return particle&&particle.data[key]&&(particle.data[key].min=value),value},steppedEmit:function(){var current=this.counter,next=this.counter+(this.end-this.start)/this.steps;return this.counter=Wrap$3(next,this.start,this.end),current},easedValueEmit:function(particle,data){return particle&&particle.data[data]&&((data=particle.data[data]).min=this.start,data.max=this.end),this.start},easeValueUpdate:function(particle,data,t){data=particle.data[data];return(data.max-data.min)*this.ease(t)+data.min}}),GetFastValue$W=GetFastValue_1,GetCenter_1=new Class_1({initialize:function(x,y,power,epsilon,gravity){var config;"object"==typeof x?(x=GetFastValue$W(config=x,"x",0),y=GetFastValue$W(config,"y",0),power=GetFastValue$W(config,"power",0),epsilon=GetFastValue$W(config,"epsilon",100),gravity=GetFastValue$W(config,"gravity",50)):(void 0===x&&(x=0),void 0===y&&(y=0),void 0===power&&(power=0),void 0===epsilon&&(epsilon=100),void 0===gravity&&(gravity=50)),this.x=x,this.y=y,this.active=!0,this._gravity=gravity,this._power=0,this._epsilon=0,this.power=power,this.epsilon=epsilon},update:function(particle,delta){var factor,x=this.x-particle.x,y=this.y-particle.y,dSq=x*x+y*y;0!==dSq&&(factor=Math.sqrt(dSq),dSq<this._epsilon&&(dSq=this._epsilon),factor=this._power*delta/(dSq*factor)*100,particle.velocityX+=x*factor,particle.velocityY+=y*factor)},epsilon:{get:function(){return Math.sqrt(this._epsilon)},set:function(value){this._epsilon=value*value}},power:{get:function(){return this._power/this._gravity},set:function(value){this._power=value*this._gravity}},gravity:{get:function(){return this._gravity},set:function(value){var pwr=this.power;this._gravity=value,this.power=pwr}}}),DegToRad$6=DegToRad_1,DistanceBetween$6=DistanceBetween_1,AsepriteFile_1=new Class_1({initialize:function(emitter){this.emitter=emitter,this.frame=null,this.x=0,this.y=0,this.velocityX=0,this.velocityY=0,this.accelerationX=0,this.accelerationY=0,this.maxVelocityX=1e4,this.maxVelocityY=1e4,this.bounce=0,this.scaleX=1,this.scaleY=1,this.alpha=1,this.angle=0,this.rotation=0,this.tint=16777215,this.life=1e3,this.lifeCurrent=1e3,this.delayCurrent=0,this.lifeT=0,this.data={tint:{min:16777215,max:16777215,current:16777215},alpha:{min:1,max:1},rotate:{min:0,max:0},scaleX:{min:1,max:1},scaleY:{min:1,max:1}}},isAlive:function(){return 0<this.lifeCurrent},resetPosition:function(){this.x=0,this.y=0},fire:function(mx,speed){var emitter=this.emitter;this.frame=emitter.getFrame(),emitter.emitZone&&emitter.emitZone.getPoint(this),this.x+=void 0===mx?emitter.x.onEmit(this,"x"):mx,this.y+=void 0===speed?emitter.y.onEmit(this,"y"):speed,this.life=emitter.lifespan.onEmit(this,"lifespan"),this.lifeCurrent=this.life,this.lifeT=0;var angle,sx=emitter.speedX.onEmit(this,"speedX"),sy=emitter.speedY?emitter.speedY.onEmit(this,"speedY"):sx;emitter.radial?(angle=DegToRad$6(emitter.angle.onEmit(this,"angle")),this.velocityX=Math.cos(angle)*Math.abs(sx),this.velocityY=Math.sin(angle)*Math.abs(sy)):emitter.moveTo?(mx=emitter.moveToX.onEmit(this,"moveToX"),speed=emitter.moveToY?emitter.moveToY.onEmit(this,"moveToY"):mx,angle=Math.atan2(speed-this.y,mx-this.x),speed=DistanceBetween$6(this.x,this.y,mx,speed)/(this.life/1e3),this.velocityX=Math.cos(angle)*speed,this.velocityY=Math.sin(angle)*speed):(this.velocityX=sx,this.velocityY=sy),emitter.acceleration&&(this.accelerationX=emitter.accelerationX.onEmit(this,"accelerationX"),this.accelerationY=emitter.accelerationY.onEmit(this,"accelerationY")),this.maxVelocityX=emitter.maxVelocityX.onEmit(this,"maxVelocityX"),this.maxVelocityY=emitter.maxVelocityY.onEmit(this,"maxVelocityY"),this.delayCurrent=emitter.delay.onEmit(this,"delay"),this.scaleX=emitter.scaleX.onEmit(this,"scaleX"),this.scaleY=emitter.scaleY?emitter.scaleY.onEmit(this,"scaleY"):this.scaleX,this.angle=emitter.rotate.onEmit(this,"rotate"),this.rotation=DegToRad$6(this.angle),this.bounce=emitter.bounce.onEmit(this,"bounce"),this.alpha=emitter.alpha.onEmit(this,"alpha"),this.tint=emitter.tint.onEmit(this,"tint")},computeVelocity:function(emitter,delta,step,processors){var vx=this.velocityX,vy=this.velocityY,ax=this.accelerationX,ay=this.accelerationY,mx=this.maxVelocityX,my=this.maxVelocityY;vx+=emitter.gravityX*step,vy+=emitter.gravityY*step,ax&&(vx+=ax*step),ay&&(vy+=ay*step),mx<vx?vx=mx:vx<-mx&&(vx=-mx),my<vy?vy=my:vy<-my&&(vy=-my),this.velocityX=vx,this.velocityY=vy;for(var i=0;i<processors.length;i++)processors[i].update(this,delta,step)},checkBounds:function(emitter){var bounds=emitter.bounds,bounce=-this.bounce;this.x<bounds.x&&emitter.collideLeft?(this.x=bounds.x,this.velocityX*=bounce):this.x>bounds.right&&emitter.collideRight&&(this.x=bounds.right,this.velocityX*=bounce),this.y<bounds.y&&emitter.collideTop?(this.y=bounds.y,this.velocityY*=bounce):this.y>bounds.bottom&&emitter.collideBottom&&(this.y=bounds.bottom,this.velocityY*=bounce)},update:function(delta,step,processors){if(0<this.delayCurrent)return this.delayCurrent-=delta,!1;var emitter=this.emitter,t=1-this.lifeCurrent/this.life;return this.lifeT=t,this.computeVelocity(emitter,delta,step,processors),this.x+=this.velocityX*step,this.y+=this.velocityY*step,emitter.bounds&&this.checkBounds(emitter),emitter.deathZone&&emitter.deathZone.willKill(this)?!(this.lifeCurrent=0):(this.scaleX=emitter.scaleX.onUpdate(this,"scaleX",t,this.scaleX),emitter.scaleY?this.scaleY=emitter.scaleY.onUpdate(this,"scaleY",t,this.scaleY):this.scaleY=this.scaleX,this.angle=emitter.rotate.onUpdate(this,"rotate",t,this.angle),this.rotation=DegToRad$6(this.angle),this.alpha=emitter.alpha.onUpdate(this,"alpha",t,this.alpha),this.tint=emitter.tint.onUpdate(this,"tint",t,this.tint),this.lifeCurrent-=delta,this.lifeCurrent<=0)}}),GetAspectRatio_1=new Class_1({initialize:function(source,killOnEnter){this.source=source,this.killOnEnter=killOnEnter},willKill:function(withinZone){withinZone=this.source.contains(withinZone.x,withinZone.y);return withinZone&&this.killOnEnter||!withinZone&&!this.killOnEnter}}),BinaryFile_1=new Class_1({initialize:function(source,quantity,stepRate,yoyo,seamless){void 0===yoyo&&(yoyo=!1),void 0===seamless&&(seamless=!0),this.source=source,this.points=[],this.quantity=quantity,this.stepRate=stepRate,this.yoyo=yoyo,this.counter=-1,this.seamless=seamless,this._length=0,this._direction=0,this.updateSource()},updateSource:function(){var a;this.points=this.source.getPoints(this.quantity,this.stepRate),this.seamless&&(a=this.points[0],oldLength=this.points[this.points.length-1],a.x===oldLength.x&&a.y===oldLength.y&&this.points.pop());var oldLength=this._length;return this._length=this.points.length,this._length<oldLength&&this.counter>this._length&&(this.counter=this._length-1),this},changeSource:function(source){return this.source=source,this.updateSource()},getPoint:function(particle){0===this._direction?(this.counter++,this.counter>=this._length&&(this.yoyo?(this._direction=1,this.counter=this._length-1):this.counter=0)):(this.counter--,-1===this.counter&&(this.yoyo?(this._direction=0,this.counter=0):this.counter=this._length-1));var point=this.points[this.counter];point&&(particle.x=point.x,particle.y=point.y)}}),HasAny_1=function(source,keys){for(var i=0;i<keys.length;i++)if(source.hasOwnProperty(keys[i]))return!0;return!1},HasValue_1=function(source,key){return source.hasOwnProperty(key)},Vector2$v=BuildTilesetIndex_1,HTMLFile_1=new Class_1({initialize:function(source){this.source=source,this._tempVec=new Vector2$v},getPoint:function(particle){var vec=this._tempVec;this.source.getRandomPoint(vec),particle.x=vec.x,particle.y=vec.y}}),BlendModes$1=BlendModes$8,DeathZone=GetAspectRatio_1,EdgeZone=BinaryFile_1,EmitterOp=Centroid_1,GetFastValue$V=GetFastValue_1,GetRandom$1=GetNewValue_1,HasAny=HasAny_1,HasValue$3=HasValue_1,Particle=AsepriteFile_1,RandomZone=HTMLFile_1,Rectangle$i=HasTileAtWorldXY_1,StableSort$2=Extend_1,Vector2$u=BuildTilesetIndex_1,Wrap$2=Vector_1,AnimationJSONFile_1=new Class_1({Mixins:[components$3.BlendMode,components$3.Mask,components$3.ScrollFactor,components$3.Visible],initialize:function(manager,config){this.manager=manager,this.texture=manager.texture,this.frames=[manager.defaultFrame],this.defaultFrame=manager.defaultFrame,this.configFastMap=["active","blendMode","collideBottom","collideLeft","collideRight","collideTop","deathCallback","deathCallbackScope","emitCallback","emitCallbackScope","follow","frequency","gravityX","gravityY","maxParticles","name","on","particleBringToTop","particleClass","radial","timeScale","trackVisible","visible"],this.configOpMap=["accelerationX","accelerationY","angle","alpha","bounce","delay","lifespan","maxVelocityX","maxVelocityY","moveToX","moveToY","quantity","rotate","scaleX","scaleY","speedX","speedY","tint","x","y"],this.name="",this.particleClass=Particle,this.x=new EmitterOp(config,"x",0,!0),this.y=new EmitterOp(config,"y",0,!0),this.radial=!0,this.gravityX=0,this.gravityY=0,this.acceleration=!1,this.accelerationX=new EmitterOp(config,"accelerationX",0,!0),this.accelerationY=new EmitterOp(config,"accelerationY",0,!0),this.maxVelocityX=new EmitterOp(config,"maxVelocityX",1e4,!0),this.maxVelocityY=new EmitterOp(config,"maxVelocityY",1e4,!0),this.speedX=new EmitterOp(config,"speedX",0,!0),this.speedY=new EmitterOp(config,"speedY",0,!0),this.moveTo=!1,this.moveToX=new EmitterOp(config,"moveToX",0,!0),this.moveToY=new EmitterOp(config,"moveToY",0,!0),this.bounce=new EmitterOp(config,"bounce",0,!0),this.scaleX=new EmitterOp(config,"scaleX",1),this.scaleY=new EmitterOp(config,"scaleY",1),this.tint=new EmitterOp(config,"tint",16777215),this.alpha=new EmitterOp(config,"alpha",1),this.lifespan=new EmitterOp(config,"lifespan",1e3,!0),this.angle=new EmitterOp(config,"angle",{min:0,max:360},!0),this.rotate=new EmitterOp(config,"rotate",0),this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.maxParticles=0,this.quantity=new EmitterOp(config,"quantity",1,!0),this.delay=new EmitterOp(config,"delay",0,!0),this.frequency=0,this.on=!0,this.particleBringToTop=!0,this.timeScale=1,this.emitZone=null,this.deathZone=null,this.bounds=null,this.collideLeft=!0,this.collideRight=!0,this.collideTop=!0,this.collideBottom=!0,this.active=!0,this.visible=!0,this.blendMode=BlendModes$1.NORMAL,this.follow=null,this.followOffset=new Vector2$u,this.trackVisible=!1,this.currentFrame=0,this.randomFrame=!0,this.frameQuantity=1,this.dead=[],this.alive=[],this._counter=0,this._frameCounter=0,config&&this.fromJSON(config)},fromJSON:function(config){if(!config)return this;for(var callbackScope,i=0,key="",i=0;i<this.configFastMap.length;i++)key=this.configFastMap[i],HasValue$3(config,key)&&(this[key]=GetFastValue$V(config,key));for(i=0;i<this.configOpMap.length;i++)key=this.configOpMap[i],HasValue$3(config,key)&&this[key].loadConfig(config);return this.acceleration=0!==this.accelerationX.propertyValue||0!==this.accelerationY.propertyValue,this.moveTo=0!==this.moveToX.propertyValue||0!==this.moveToY.propertyValue,HasValue$3(config,"speed")&&(this.speedX.loadConfig(config,"speed"),this.speedY=null),(HasAny(config,["speedX","speedY"])||this.moveTo)&&(this.radial=!1),HasValue$3(config,"scale")&&(this.scaleX.loadConfig(config,"scale"),this.scaleY=null),HasValue$3(config,"callbackScope")&&(callbackScope=GetFastValue$V(config,"callbackScope",null),this.emitCallbackScope=callbackScope,this.deathCallbackScope=callbackScope),HasValue$3(config,"emitZone")&&this.setEmitZone(config.emitZone),HasValue$3(config,"deathZone")&&this.setDeathZone(config.deathZone),HasValue$3(config,"bounds")&&this.setBounds(config.bounds),HasValue$3(config,"followOffset")&&this.followOffset.setFromObject(GetFastValue$V(config,"followOffset",0)),HasValue$3(config,"frame")&&this.setFrame(config.frame),HasValue$3(config,"reserve")&&this.reserve(config.reserve),this},toJSON:function(output){void 0===output&&(output={});for(var i=0,key="",i=0;i<this.configFastMap.length;i++)output[key=this.configFastMap[i]]=this[key];for(i=0;i<this.configOpMap.length;i++)this[key=this.configOpMap[i]]&&(output[key]=this[key].toJSON());return this.speedY||(delete output.speedX,output.speed=this.speedX.toJSON()),this.scaleY||(delete output.scaleX,output.scale=this.scaleX.toJSON()),output},startFollow:function(target,offsetX,offsetY,trackVisible){return void 0===offsetX&&(offsetX=0),void 0===offsetY&&(offsetY=0),void 0===trackVisible&&(trackVisible=!1),this.follow=target,this.followOffset.set(offsetX,offsetY),this.trackVisible=trackVisible,this},stopFollow:function(){return this.follow=null,this.followOffset.set(0,0),this.trackVisible=!1,this},getFrame:function(){if(1===this.frames.length)return this.defaultFrame;if(this.randomFrame)return GetRandom$1(this.frames);var frame=this.frames[this.currentFrame];return this._frameCounter++,this._frameCounter===this.frameQuantity&&(this._frameCounter=0,this.currentFrame=Wrap$2(this.currentFrame+1,0,this._frameLength)),frame},setFrame:function(isCycle,frameConfig,quantity){void 0===quantity&&(quantity=1),this.randomFrame=frameConfig=void 0===frameConfig?!0:frameConfig,this.frameQuantity=quantity,this.currentFrame=0,this._frameCounter=0;frameConfig=typeof isCycle;return Array.isArray(isCycle)||"string"==frameConfig||"number"==frameConfig?this.manager.setEmitterFrames(isCycle,this):"object"==frameConfig&&((isCycle=GetFastValue$V(frameConfig=isCycle,"frames",null))&&this.manager.setEmitterFrames(isCycle,this),isCycle=GetFastValue$V(frameConfig,"cycle",!1),this.randomFrame=!isCycle,this.frameQuantity=GetFastValue$V(frameConfig,"quantity",quantity)),this._frameLength=this.frames.length,1===this._frameLength&&(this.frameQuantity=1,this.randomFrame=!1),this},setRadial:function(value){return this.radial=value=void 0===value?!0:value,this},setPosition:function(x,y){return this.x.onChange(x),this.y.onChange(y),this},setBounds:function(x,y,width,height){var obj;return"object"==typeof x&&(x=(obj=x).x,y=obj.y,width=HasValue$3(obj,"w")?obj.w:obj.width,height=HasValue$3(obj,"h")?obj.h:obj.height),this.bounds?this.bounds.setTo(x,y,width,height):this.bounds=new Rectangle$i(x,y,width,height),this},setSpeedX:function(value){return this.speedX.onChange(value),this.radial=!1,this},setSpeedY:function(value){return this.speedY&&(this.speedY.onChange(value),this.radial=!1),this},setSpeed:function(value){return this.speedX.onChange(value),this.speedY=null,this.radial=!0,this},setScaleX:function(value){return this.scaleX.onChange(value),this},setScaleY:function(value){return this.scaleY.onChange(value),this},setScale:function(value){return this.scaleX.onChange(value),this.scaleY=null,this},setGravityX:function(value){return this.gravityX=value,this},setGravityY:function(value){return this.gravityY=value,this},setGravity:function(x,y){return this.gravityX=x,this.gravityY=y,this},setAlpha:function(value){return this.alpha.onChange(value),this},setTint:function(value){return this.tint.onChange(value),this},setEmitterAngle:function(value){return this.angle.onChange(value),this},setAngle:function(value){return this.angle.onChange(value),this},setLifespan:function(value){return this.lifespan.onChange(value),this},setQuantity:function(quantity){return this.quantity.onChange(quantity),this},setFrequency:function(frequency,quantity){return this.frequency=frequency,this._counter=0,quantity&&this.quantity.onChange(quantity),this},setEmitZone:function(zoneConfig){if(void 0===zoneConfig)this.emitZone=null;else{var type=GetFastValue$V(zoneConfig,"type","random"),source=GetFastValue$V(zoneConfig,"source",null);switch(type){case"random":this.emitZone=new RandomZone(source);break;case"edge":var quantity=GetFastValue$V(zoneConfig,"quantity",1),stepRate=GetFastValue$V(zoneConfig,"stepRate",0),yoyo=GetFastValue$V(zoneConfig,"yoyo",!1),seamless=GetFastValue$V(zoneConfig,"seamless",!0);this.emitZone=new EdgeZone(source,quantity,stepRate,yoyo,seamless)}}return this},setDeathZone:function(source){var type;return void 0===source?this.deathZone=null:(type=GetFastValue$V(source,"type","onEnter"),(source=GetFastValue$V(source,"source",null))&&"function"==typeof source.contains&&(this.deathZone=new DeathZone(source,"onEnter"===type))),this},reserve:function(particleCount){for(var dead=this.dead,i=0;i<particleCount;i++)dead.push(new this.particleClass(this));return this},getAliveParticleCount:function(){return this.alive.length},getDeadParticleCount:function(){return this.dead.length},getParticleCount:function(){return this.getAliveParticleCount()+this.getDeadParticleCount()},atLimit:function(){return 0<this.maxParticles&&this.getParticleCount()===this.maxParticles},onParticleEmit:function(callback,context){return void 0===callback?(this.emitCallback=null,this.emitCallbackScope=null):"function"==typeof callback&&(this.emitCallback=callback,context&&(this.emitCallbackScope=context)),this},onParticleDeath:function(callback,context){return void 0===callback?(this.deathCallback=null,this.deathCallbackScope=null):"function"==typeof callback&&(this.deathCallback=callback,context&&(this.deathCallbackScope=context)),this},killAll:function(){for(var dead=this.dead,alive=this.alive;0<alive.length;)dead.push(alive.pop());return this},forEachAlive:function(callback,context){for(var alive=this.alive,length=alive.length,index=0;index<length;++index)callback.call(context,alive[index],this);return this},forEachDead:function(callback,context){for(var dead=this.dead,length=dead.length,index=0;index<length;++index)callback.call(context,dead[index],this);return this},start:function(){return this.on=!0,this._counter=0,this},stop:function(){return this.on=!1,this},pause:function(){return this.active=!1,this},resume:function(){return this.active=!0,this},remove:function(){return this.manager.removeEmitter(this),this},depthSort:function(){return StableSort$2(this.alive,this.depthSortCallback),this},flow:function(frequency,count){return void 0===count&&(count=1),this.frequency=frequency,this.quantity.onChange(count),this.start()},explode:function(count,x,y){return this.frequency=-1,this.emitParticle(count,x,y)},emitParticleAt:function(x,y,count){return this.emitParticle(count,x,y)},emitParticle:function(count,x,y){if(!this.atLimit()){void 0===count&&(count=this.quantity.onEmit());for(var dead=this.dead,followX=this.follow?this.follow.x+this.followOffset.x:x,followY=this.follow?this.follow.y+this.followOffset.y:y,i=0;i<count;i++){var particle=dead.pop();if((particle=particle||new this.particleClass(this)).fire(followX,followY),this.particleBringToTop?this.alive.push(particle):this.alive.unshift(particle),this.emitCallback&&this.emitCallback.call(this.emitCallbackScope,particle,this),this.atLimit())break}return particle}},preUpdate:function(time,delta){var step=(delta*=this.timeScale)/1e3;this.trackVisible&&(this.visible=this.follow.visible);var processors=this.manager.getProcessors(),particles=this.alive,dead=this.dead,i=0,rip=[],length=particles.length;for(i=0;i<length;i++){var particle=particles[i];particle.update(delta,step,processors)&&rip.push({index:i,particle:particle})}if(0<(length=rip.length))for(var deathCallback=this.deathCallback,deathCallbackScope=this.deathCallbackScope,i=length-1;0<=i;i--){var entry=rip[i];particles.splice(entry.index,1),dead.push(entry.particle),deathCallback&&deathCallback.call(deathCallbackScope,entry.particle),entry.particle.resetPosition()}this.on&&(0===this.frequency?this.emitParticle():0<this.frequency&&(this._counter-=delta,this._counter<=0&&(this.emitParticle(),this._counter=this.frequency-Math.abs(this._counter))))},depthSortCallback:function(a,b){return a.y-b.y}}),GetTileAtWorldXY_1=TransformMatrix,Utils$h=GetProps_1,tempMatrix1$2=new GetTileAtWorldXY_1,tempMatrix2$2=new GetTileAtWorldXY_1,tempMatrix3$2=new GetTileAtWorldXY_1,tempMatrix4$1=new GetTileAtWorldXY_1,Inflate_1=function(renderer,emitterManager,camera,parentMatrix){var emitters=emitterManager.emitters.list,emittersLength=emitters.length;if(0!==emittersLength){var pipeline=renderer.pipelines.set(emitterManager.pipeline),camMatrix=tempMatrix1$2,calcMatrix=tempMatrix2$2,particleMatrix=tempMatrix3$2,managerMatrix=tempMatrix4$1;parentMatrix?(managerMatrix.loadIdentity(),managerMatrix.multiply(parentMatrix),managerMatrix.translate(emitterManager.x,emitterManager.y),managerMatrix.rotate(emitterManager.rotation),managerMatrix.scale(emitterManager.scaleX,emitterManager.scaleY)):managerMatrix.applyITRS(emitterManager.x,emitterManager.y,emitterManager.rotation,emitterManager.scaleX,emitterManager.scaleY);var roundPixels=camera.roundPixels,texture=emitterManager.defaultFrame.glTexture,getTint=Utils$h.getTintAppendFloatAlpha,textureUnit=pipeline.setGameObject(emitterManager,emitterManager.defaultFrame);renderer.pipelines.preBatch(emitterManager);for(var e=0;e<emittersLength;e++){var emitter=emitters[e],particles=emitter.alive,particleCount=particles.length;if(emitter.visible&&0!==particleCount){camera.addToRenderList(emitter);var scrollFactorX=emitter.scrollFactorX,scrollFactorY=emitter.scrollFactorY;renderer.setBlendMode(emitter.blendMode),emitter.mask&&(emitter.mask.preRenderWebGL(renderer,emitter,camera),renderer.pipelines.set(emitterManager.pipeline));for(var i=0;i<particleCount;i++){var frame,xw,tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,particle=particles[i],tint=particle.alpha*camera.alpha;tint<=0||(particleMatrix.applyITRS(particle.x,particle.y,particle.rotation,particle.scaleX,particle.scaleY),camMatrix.copyFrom(camera.matrix),camMatrix.multiplyWithOffset(managerMatrix,-camera.scrollX*scrollFactorX,-camera.scrollY*scrollFactorY),particleMatrix.e=particle.x,particleMatrix.f=particle.y,camMatrix.multiply(particleMatrix,calcMatrix),ty2=-(frame=particle.frame).halfWidth,ty3=-frame.halfHeight,xw=ty2+frame.width,tx3=ty3+frame.height,tx0=calcMatrix.getXRound(ty2,ty3,roundPixels),ty0=calcMatrix.getYRound(ty2,ty3,roundPixels),tx1=calcMatrix.getXRound(ty2,tx3,roundPixels),ty1=calcMatrix.getYRound(ty2,tx3,roundPixels),tx2=calcMatrix.getXRound(xw,tx3,roundPixels),ty2=calcMatrix.getYRound(xw,tx3,roundPixels),tx3=calcMatrix.getXRound(xw,ty3,roundPixels),ty3=calcMatrix.getYRound(xw,ty3,roundPixels),tint=getTint(particle.tint,tint),pipeline.batchQuad(emitter,tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,frame.u0,frame.v0,frame.u1,frame.v1,tint,tint,tint,tint,0,texture,textureUnit))}emitter.mask&&emitter.mask.postRenderWebGL(renderer,camera)}}renderer.pipelines.postBatch(emitterManager)}},BuildFromPolygon_1=TransformMatrix,tempMatrix1$1=new BuildFromPolygon_1,tempMatrix2$1=new BuildFromPolygon_1,tempMatrix3$1=new BuildFromPolygon_1,tempMatrix4=new BuildFromPolygon_1,plugins=function(renderer,emitterManager,camera,parentMatrix){var emitters=emitterManager.emitters.list,emittersLength=emitters.length;if(0!==emittersLength){var camMatrix=tempMatrix1$1.copyFrom(camera.matrix),calcMatrix=tempMatrix2$1,particleMatrix=tempMatrix3$1,managerMatrix=tempMatrix4;parentMatrix?(managerMatrix.loadIdentity(),managerMatrix.multiply(parentMatrix),managerMatrix.translate(emitterManager.x,emitterManager.y),managerMatrix.rotate(emitterManager.rotation),managerMatrix.scale(emitterManager.scaleX,emitterManager.scaleY)):managerMatrix.applyITRS(emitterManager.x,emitterManager.y,emitterManager.rotation,emitterManager.scaleX,emitterManager.scaleY);for(var ctx=renderer.currentContext,roundPixels=camera.roundPixels,e=0;e<emittersLength;e++){var emitter=emitters[e],particles=emitter.alive,particleCount=particles.length;if(emitter.visible&&0!==particleCount){camera.addToRenderList(emitter);var scrollFactorX=emitter.scrollFactorX,scrollFactorY=emitter.scrollFactorY;ctx.save(),ctx.globalCompositeOperation=renderer.blendModes[emitter.blendMode];for(var i=0;i<particleCount;i++){var frame,cd,x,y=particles[i],alpha=y.alpha*camera.alpha;alpha<=0||(particleMatrix.applyITRS(y.x,y.y,y.rotation,y.scaleX,y.scaleY),camMatrix.copyFrom(camera.matrix),camMatrix.multiplyWithOffset(managerMatrix,-camera.scrollX*scrollFactorX,-camera.scrollY*scrollFactorY),particleMatrix.e=y.x,particleMatrix.f=y.y,camMatrix.multiply(particleMatrix,calcMatrix),cd=(frame=y.frame).canvasData,x=-frame.halfWidth,y=-frame.halfHeight,ctx.globalAlpha=alpha,ctx.save(),calcMatrix.setToContext(ctx),roundPixels&&(x=Math.round(x),y=Math.round(y)),ctx.imageSmoothingEnabled=!(!renderer.antialias||frame.source.scaleMode),ctx.drawImage(frame.source.image,cd.x,cd.y,cd.width,cd.height,x,y,cd.width,cd.height),ctx.restore())}ctx.restore()}}}},GameObject$c=GameObject_1,GravityWell=GetCenter_1,List=Base64Decode_1,ParticleEmitter=AnimationJSONFile_1,Equals_1$1=new Class_1({Extends:GameObject$c,Mixins:[components$3.Depth,components$3.Mask,components$3.Pipeline,components$3.Transform,components$3.Visible,{renderWebGL:Inflate_1,renderCanvas:plugins}],initialize:function(scene,texture,frame,emitters){if(GameObject$c.call(this,scene,"ParticleEmitterManager"),this.blendMode=-1,this.timeScale=1,this.texture=null,this.frame=null,this.frameNames=[],null===frame||"object"!=typeof frame&&!Array.isArray(frame)||(emitters=frame,frame=null),this.setTexture(texture,frame),this.initPipeline(),this.emitters=new List(this),this.wells=new List(this),emitters){Array.isArray(emitters)||(emitters=[emitters]);for(var i=0;i<emitters.length;i++)this.createEmitter(emitters[i])}},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},setTexture:function(key,frame){return this.texture=this.scene.sys.textures.get(key),this.setFrame(frame)},setFrame:function(frames){this.frame=this.texture.get(frames);var frames=this.texture.getFramesFromTextureSource(this.frame.sourceIndex),names=[];return frames.forEach(function(sourceFrame){names.push(sourceFrame.name)}),this.frameNames=names,this.defaultFrame=this.frame,this},setEmitterFrames:function(frames,emitter){Array.isArray(frames)||(frames=[frames]);for(var out=emitter.frames,i=out.length=0;i<frames.length;i++){var frame=frames[i];-1!==this.frameNames.indexOf(frame)&&out.push(this.texture.get(frame))}return 0<out.length?emitter.defaultFrame=out[0]:emitter.defaultFrame=this.defaultFrame,this},addEmitter:function(emitter){return this.emitters.add(emitter)},createEmitter:function(config){return this.addEmitter(new ParticleEmitter(this,config))},removeEmitter:function(emitter){return this.emitters.remove(emitter,!0)},addGravityWell:function(well){return this.wells.add(well)},createGravityWell:function(config){return this.addGravityWell(new GravityWell(config))},emitParticle:function(count,x,y){for(var emitters=this.emitters.list,i=0;i<emitters.length;i++){var emitter=emitters[i];emitter.active&&emitter.emitParticle(count,x,y)}return this},emitParticleAt:function(x,y,count){return this.emitParticle(count,x,y)},pause:function(){return this.active=!1,this},resume:function(){return this.active=!0,this},getProcessors:function(){return this.wells.getAll("active",!0)},preUpdate:function(time,delta){delta*=this.timeScale;for(var emitters=this.emitters.list,i=0;i<emitters.length;i++){var emitter=emitters[i];emitter.active&&emitter.preUpdate(time,delta)}},setAlpha:function(){},setScrollFactor:function(){},setBlendMode:function(){}}),particles={EmitterOp:Centroid_1,GravityWell:GetCenter_1,Particle:AsepriteFile_1,ParticleEmitter:AnimationJSONFile_1,ParticleEmitterManager:Equals_1$1,Zones:{DeathZone:GetAspectRatio_1,EdgeZone:BinaryFile_1,RandomZone:HTMLFile_1}},Sprite$5=time,PathFollower_1=new Class_1({Extends:Sprite$5,Mixins:[components$3.PathFollower],initialize:function(scene,path,x,y,texture,frame){Sprite$5.call(this,scene,x,y,texture,frame),this.path=path},preUpdate:function(time,delta){this.anims.update(time,delta),this.pathUpdate(time)}}),Utils$g=GetProps_1,UUID_1=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0;return("x"===c?r:3&r|8).toString(16)})},BlendModes=BlendModes$8,Camera=Composite_1,CanvasPool$3=SetValue_1,CONST$T=Extend,Frame=ParseWeltmeister_1,GameObject$b=GameObject_1,NOOP$8=gameConfig,PIPELINE_CONST$1=ParseGID_1,RenderTarget=Fill_1,Utils$f=GetProps_1,UUID$1=UUID_1,RenderTexture_1=new Class_1({Extends:GameObject$b,Mixins:[components$3.Alpha,components$3.BlendMode,components$3.ComputedSize,components$3.Crop,components$3.Depth,components$3.Flip,components$3.GetBounds,components$3.Mask,components$3.Origin,components$3.Pipeline,components$3.ScrollFactor,components$3.Tint,components$3.Transform,components$3.Visible,{renderWebGL:function(renderer,src,camera,parentMatrix){camera.addToRenderList(src);var cameraAlpha=camera.alpha,renderTarget=src.renderTarget,width=renderTarget.width,height=renderTarget.height,getTint=Utils$g.getTintAppendFloatAlpha,pipeline=renderer.pipelines.set(src.pipeline),textureUnit=pipeline.setTexture2D(renderTarget.texture);renderer.pipelines.preBatch(src),pipeline.batchTexture(src,renderTarget.texture,width,height,src.x,src.y,width,height,src.scaleX,src.scaleY,src.rotation,src.flipX,!src.flipY,src.scrollFactorX,src.scrollFactorY,src.displayOriginX,src.displayOriginY,0,0,width,height,getTint(src.tintTopLeft,cameraAlpha*src._alphaTL),getTint(src.tintTopRight,cameraAlpha*src._alphaTR),getTint(src.tintBottomLeft,cameraAlpha*src._alphaBL),getTint(src.tintBottomRight,cameraAlpha*src._alphaBR),src.tintFill,0,0,camera,parentMatrix,!0,textureUnit),renderer.resetTextures(),renderer.pipelines.postBatch(src)},renderCanvas:function(renderer,src,camera,parentMatrix){camera.addToRenderList(src),renderer.batchSprite(src,src.frame,camera,parentMatrix)}}],initialize:function(scene,x,y,width,height,key,renderer){void 0===x&&(x=0),void 0===y&&(y=0),void 0===width&&(width=32),void 0===height&&(height=32),GameObject$b.call(this,scene,"RenderTexture"),this.renderer=scene.sys.renderer,this.textureManager=scene.sys.textures,this.globalTint=16777215,this.globalAlpha=1,this.canvas=null,this.dirty=!1,this._crop=this.resetCropObject(),this.texture=null,this.frame=null,this._saved=!1,void 0===key?(this.canvas=CanvasPool$3.create2D(this,width,height),this.texture=scene.sys.textures.addCanvas(UUID$1(),this.canvas),this.frame=this.texture.get()):(this.texture=scene.sys.textures.get(key),this.frame=this.texture.get(renderer),this.canvas=this.frame.source.image,this._saved=!0,this.dirty=!0,this.width=this.frame.cutWidth,this.height=this.frame.cutHeight),this.context=this.canvas.getContext("2d"),this._eraseMode=!1,this.camera=new Camera(0,0,width,height),this.renderTarget=null;renderer=this.renderer;renderer?renderer.type===CONST$T.WEBGL?(this.drawGameObject=this.batchGameObjectWebGL,this.renderTarget=new RenderTarget(renderer,width,height,1,0,!1)):renderer.type===CONST$T.CANVAS&&(this.drawGameObject=this.batchGameObjectCanvas):this.drawGameObject=NOOP$8,this.camera.setScene(scene),this.setPosition(x,y),void 0===key&&this.setSize(width,height),this.setOrigin(0,0),this.initPipeline(PIPELINE_CONST$1.SINGLE_PIPELINE)},setSize:function(width,height){return this.resize(width,height)},resize:function(width,height){void 0===height&&(height=width);var baseFrame,input=this.frame;width!==this.width||height!==this.height?"__BASE"===input.name&&(this.canvas.width=width,this.canvas.height=height,this.texture.width=width,this.texture.height=height,(baseFrame=this.renderTarget)&&(baseFrame.resize(width,height),input.glTexture=baseFrame.texture,input.source.isRenderTexture=!0,input.source.isGLTexture=!0,input.source.glTexture=baseFrame.texture),this.camera.setSize(width,height),input.source.width=width,input.source.height=height,input.setSize(width,height),this.width=width,this.height=height):(baseFrame=this.texture.getSourceImage(),input.cutX+width>baseFrame.width&&(width=baseFrame.width-input.cutX),input.cutY+height>baseFrame.height&&(height=baseFrame.height-input.cutY),input.setSize(width,height,input.cutX,input.cutY)),this.updateDisplayOrigin();input=this.input;return input&&!input.customHitArea&&(input.hitArea.width=width,input.hitArea.height=height),this},setGlobalTint:function(tint){return this.globalTint=tint,this},setGlobalAlpha:function(alpha){return this.globalAlpha=alpha,this},saveTexture:function(key){return this.textureManager.renameTexture(this.texture.key,key),this._saved=!0,this.texture},fill:function(sx,alpha,x,y,width,height){var frame=this.frame,sy=this.camera,renderer=this.renderer;void 0===alpha&&(alpha=1),void 0===x&&(x=0),void 0===y&&(y=0),void 0===width&&(width=frame.cutWidth),void 0===height&&(height=frame.cutHeight);var pipeline,r=(sx>>16&255)/255,g=(sx>>8&255)/255,b=(255&sx)/255,ctx=this.renderTarget;return sy.preRender(),ctx?(ctx.bind(!0),(pipeline=this.pipeline).manager.set(pipeline),sx=ctx.width,sy=ctx.height,sx=renderer.width/sx,sy=renderer.height/sy,pipeline.drawFillRect(x*sx,y*sy,width*sx,height*sy,Utils$f.getTintFromFloats(b,g,r,1),alpha),ctx.unbind(!0)):(ctx=this.context,renderer.setContext(ctx),ctx.fillStyle="rgba("+r+","+g+","+b+","+alpha+")",ctx.fillRect(x+frame.cutX,y+frame.cutY,width,height),renderer.setContext()),this.dirty=!0,this},clear:function(){var ctx;return this.dirty&&((ctx=this.renderTarget)?ctx.clear():((ctx=this.context).save(),ctx.setTransform(1,0,0,1,0,0),ctx.clearRect(this.frame.cutX,this.frame.cutY,this.frame.cutWidth,this.frame.cutHeight),ctx.restore()),this.dirty=!1),this},erase:function(entries,x,y){return this._eraseMode=!0,this.draw(entries,x,y,1,16777215),this._eraseMode=!1,this},draw:function(entries,x,y,alpha,tint){return this.beginDraw(),this.batchDraw(entries,x,y,alpha,tint),this.endDraw(),this},drawFrame:function(key,frame,x,y,alpha,tint){return this.beginDraw(),this.batchDrawFrame(key,frame,x,y,alpha,tint),this.endDraw(),this},beginDraw:function(){var camera=this.camera,renderer=this.renderer,renderTarget=this.renderTarget;return camera.preRender(),renderTarget?renderer.beginCapture(renderTarget.width,renderTarget.height):renderer.setContext(this.context),this},batchDraw:function(entries,x,y,alpha,tint){return void 0===alpha&&(alpha=this.globalAlpha),tint=void 0===tint?(this.globalTint>>16)+(65280&this.globalTint)+((255&this.globalTint)<<16):(tint>>16)+(65280&tint)+((255&tint)<<16),Array.isArray(entries)||(entries=[entries]),this.batchList(entries,x,y,alpha,tint),this},batchDrawFrame:function(key,textureFrame,x,y,alpha,tint){void 0===x&&(x=0),void 0===y&&(y=0),void 0===alpha&&(alpha=this.globalAlpha),tint=void 0===tint?(this.globalTint>>16)+(65280&this.globalTint)+((255&this.globalTint)<<16):(tint>>16)+(65280&tint)+((255&tint)<<16);textureFrame=this.textureManager.getFrame(key,textureFrame);return textureFrame&&(this.renderTarget?this.pipeline.batchTextureFrame(textureFrame,x,y,tint,alpha,this.camera.matrix,null):this.batchTextureFrame(textureFrame,x+this.frame.cutX,y+this.frame.cutY,alpha,tint)),this},endDraw:function(erase){void 0===erase&&(erase=this._eraseMode);var canvasTarget,renderer=this.renderer,renderTarget=this.renderTarget;return renderTarget?(canvasTarget=renderer.endCapture(),renderer.pipelines.setUtility().blitFrame(canvasTarget,renderTarget,1,!1,!1,erase),renderer.resetScissor(),renderer.resetViewport()):renderer.setContext(),this.dirty=!0,this},batchList:function(children,x,y,alpha,tint){for(var i=0;i<children.length;i++){var entry=children[i];entry&&entry!==this&&(entry.renderWebGL||entry.renderCanvas?this.drawGameObject(entry,x,y):entry.isParent||entry.list?this.batchGroup(entry.getChildren(),x,y):"string"==typeof entry?this.batchTextureFrameKey(entry,null,x,y,alpha,tint):entry instanceof Frame?this.batchTextureFrame(entry,x,y,alpha,tint):Array.isArray(entry)&&this.batchList(entry,x,y,alpha,tint))}},batchGroup:function(children,x,y){void 0===x&&(x=0),void 0===y&&(y=0),x+=this.frame.cutX,y+=this.frame.cutY;for(var i=0;i<children.length;i++){var tx,ty,entry=children[i];entry.willRender(this.camera)&&(tx=entry.x+x,ty=entry.y+y,this.drawGameObject(entry,tx,ty))}},batchGameObjectWebGL:function(gameObject,x,y){void 0===x&&(x=gameObject.x),void 0===y&&(y=gameObject.y);var prevX=gameObject.x,prevY=gameObject.y;gameObject.setPosition(x+this.frame.cutX,y+this.frame.cutY),gameObject.renderDirect?gameObject.renderDirect(this.renderer,gameObject,this.camera):gameObject.renderWebGL(this.renderer,gameObject,this.camera),gameObject.setPosition(prevX,prevY)},batchGameObjectCanvas:function(gameObject,x,y){void 0===x&&(x=gameObject.x),void 0===y&&(y=gameObject.y);var blendMode,prevX=gameObject.x,prevY=gameObject.y;this._eraseMode&&(blendMode=gameObject.blendMode,gameObject.blendMode=BlendModes.ERASE),gameObject.setPosition(x+this.frame.cutX,y+this.frame.cutY),gameObject.renderCanvas(this.renderer,gameObject,this.camera,null),gameObject.setPosition(prevX,prevY),this._eraseMode&&(gameObject.blendMode=blendMode)},batchTextureFrameKey:function(key,textureFrame,x,y,alpha,tint){textureFrame=this.textureManager.getFrame(key,textureFrame);textureFrame&&this.batchTextureFrame(textureFrame,x,y,alpha,tint)},batchTextureFrame:function(matrix,x,y,alpha,source){var ctx,cd;void 0===x&&(x=0),void 0===y&&(y=0),x+=this.frame.cutX,y+=this.frame.cutY,this.renderTarget?this.pipeline.batchTextureFrame(matrix,x,y,source,alpha,this.camera.matrix,null):(ctx=this.context,cd=matrix.canvasData,source=matrix.source.image,matrix=this.camera.matrix,ctx.save(),ctx.globalCompositeOperation=this._eraseMode?"destination-out":"source-over",ctx.globalAlpha=alpha,matrix.setToContext(ctx),ctx.drawImage(source,cd.x,cd.y,cd.width,cd.height,x,y,cd.width,cd.height),ctx.restore())},snapshotArea:function(x,y,width,height,callback,type,encoderOptions){return this.renderTarget?this.renderer.snapshotFramebuffer(this.renderTarget.framebuffer,this.width,this.height,callback,!1,x,y,width,height,type,encoderOptions):this.renderer.snapshotCanvas(this.canvas,callback,!1,x,y,width,height,type,encoderOptions),this},snapshot:function(callback,type,encoderOptions){return this.renderTarget?this.renderer.snapshotFramebuffer(this.renderTarget.framebuffer,this.width,this.height,callback,!1,0,0,this.width,this.height,type,encoderOptions):this.renderer.snapshotCanvas(this.canvas,callback,!1,0,0,this.width,this.height,type,encoderOptions),this},snapshotPixel:function(x,y,callback){return this.renderTarget?this.renderer.snapshotFramebuffer(this.renderTarget.framebuffer,this.width,this.height,callback,!0,x,y):this.renderer.snapshotCanvas(this.canvas,callback,!0,x,y),this},preDestroy:function(){this._saved||(CanvasPool$3.remove(this.canvas),this.renderTarget&&this.renderTarget.destroy(),this.texture.destroy(),this.camera.destroy(),this.canvas=null,this.context=null,this.texture=null)}}),GetValue$j=GetValue_1,RetroFont_1=Extend_1$1(!1,{Parse:function(offsetY,config){var w=config.width,h=config.height,cx=Math.floor(w/2),cy=Math.floor(h/2),letters=GetValue$j(config,"chars","");if(""!==letters){var key=GetValue$j(config,"image",""),lineSpacing=offsetY.sys.textures.getFrame(key),textureX=lineSpacing.cutX,textureY=lineSpacing.cutY,textureWidth=lineSpacing.source.width,textureHeight=lineSpacing.source.height,offsetX=GetValue$j(config,"offset.x",0),offsetY=GetValue$j(config,"offset.y",0),spacingX=GetValue$j(config,"spacing.x",0),spacingY=GetValue$j(config,"spacing.y",0),lineSpacing=GetValue$j(config,"lineSpacing",0),charsPerRow=GetValue$j(config,"charsPerRow",null);null===charsPerRow&&(charsPerRow=textureWidth/w)>letters.length&&(charsPerRow=letters.length);for(var x=offsetX,y=offsetY,data={retroFont:!0,font:key,size:w,lineHeight:h+lineSpacing,chars:{}},r=0,i=0;i<letters.length;i++){var charCode=letters.charCodeAt(i);data.chars[charCode]={x:x,y:y,width:w,height:h,centerX:cx,centerY:cy,xOffset:0,yOffset:0,xAdvance:w,data:{},kerning:{},u0:(textureX+x)/textureWidth,v0:(textureY+y)/textureHeight,u1:(textureX+x+w)/textureWidth,v1:(textureY+y+h)/textureHeight},++r===charsPerRow?(r=0,x=offsetX,y+=h+spacingY):x+=w+spacingX}return{data:data,frame:null,texture:key}}}},{TEXT_SET1:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",TEXT_SET2:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET3:"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",TEXT_SET4:"ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789",TEXT_SET5:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789",TEXT_SET6:"ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ",TEXT_SET7:"AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39",TEXT_SET8:"0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET9:"ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!",TEXT_SET10:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET11:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789"}),GetCalcMatrix$f=GetCalcMatrix_1,Utils$e=GetProps_1,IsInLayerBounds_1=function(renderer,src,camera,vertexCount){camera.addToRenderList(src);var pipeline=renderer.pipelines.set(src.pipeline,src),calcMatrix=GetCalcMatrix$f(src,camera,vertexCount).calc,vertices=src.vertices,uvs=src.uv,colors=src.colors,alphas=src.alphas,alpha=src.alpha,getTint=Utils$e.getTintAppendFloatAlpha,roundPixels=camera.roundPixels,meshVerticesLength=vertices.length,vertexCount=Math.floor(.5*meshVerticesLength);pipeline.flush(),renderer.pipelines.preBatch(src);var textureUnit=pipeline.setGameObject(src),vertexViewF32=pipeline.vertexViewF32,vertexViewU32=pipeline.vertexViewU32,vertexOffset=pipeline.vertexCount*pipeline.currentShader.vertexComponentCount-1,colorIndex=0,tintEffect=src.tintFill;src.dirty&&src.updateVertices();for(var debugCallback=src.debugCallback,debugVerts=[],i=0;i<meshVerticesLength;i+=2){var x=vertices[i+0],ty=vertices[i+1],tx=x*calcMatrix.a+ty*calcMatrix.c+calcMatrix.e,ty=x*calcMatrix.b+ty*calcMatrix.d+calcMatrix.f;roundPixels&&(tx=Math.round(tx),ty=Math.round(ty)),vertexViewF32[++vertexOffset]=tx,vertexViewF32[++vertexOffset]=ty,vertexViewF32[++vertexOffset]=uvs[i+0],vertexViewF32[++vertexOffset]=uvs[i+1],vertexViewF32[++vertexOffset]=textureUnit,vertexViewF32[++vertexOffset]=tintEffect,vertexViewU32[++vertexOffset]=getTint(colors[colorIndex],camera.alpha*(alphas[colorIndex]*alpha)),colorIndex++,debugCallback&&(debugVerts[i+0]=tx,debugVerts[i+1]=ty)}debugCallback&&debugCallback.call(src,src,meshVerticesLength,debugVerts),pipeline.vertexCount+=vertexCount,renderer.pipelines.postBatch(src)},AnimationState$1=MatterAttractors_1,GameObject$a=GameObject_1,PIPELINE_CONST=ParseGID_1,Vector2$t=BuildTilesetIndex_1,Rope_1=new Class_1({Extends:GameObject$a,Mixins:[components$3.AlphaSingle,components$3.BlendMode,components$3.Depth,components$3.Flip,components$3.Mask,components$3.Pipeline,components$3.Size,components$3.Texture,components$3.Transform,components$3.Visible,components$3.ScrollFactor,{renderWebGL:IsInLayerBounds_1,renderCanvas:function(){}}],initialize:function(scene,x,y,texture,frame,points,horizontal,colors,alphas){void 0===texture&&(texture="__DEFAULT"),void 0===points&&(points=2),void 0===horizontal&&(horizontal=!0),GameObject$a.call(this,scene,"Rope"),this.anims=new AnimationState$1(this),this.points=points,this.vertices,this.uv,this.colors,this.alphas,this.tintFill="__DEFAULT"===texture,this.dirty=!1,this.horizontal=horizontal,this._flipX=!1,this._flipY=!1,this._perp=new Vector2$t,this.debugCallback=null,this.debugGraphic=null,this.setTexture(texture,frame),this.setPosition(x,y),this.setSizeToFrame(),this.initPipeline(PIPELINE_CONST.ROPE_PIPELINE),Array.isArray(points)&&this.resizeArrays(points.length),this.setPoints(points,colors,alphas),this.updateVertices()},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(time,delta){var prevFrame=this.anims.currentFrame;this.anims.update(time,delta),this.anims.currentFrame!==prevFrame&&(this.updateUVs(),this.updateVertices())},play:function(key,ignoreIfPlaying,startFrame){return this.anims.play(key,ignoreIfPlaying,startFrame),this},setDirty:function(){return this.dirty=!0,this},setHorizontal:function(points,colors,alphas){return void 0===points&&(points=this.points.length),this.horizontal?this:(this.horizontal=!0,this.setPoints(points,colors,alphas))},setVertical:function(points,colors,alphas){return void 0===points&&(points=this.points.length),this.horizontal?(this.horizontal=!1,this.setPoints(points,colors,alphas)):this},setTintFill:function(value){return this.tintFill=value=void 0===value?!1:value,this},setAlphas:function(alphas,bottomAlpha){var total=this.points.length;if(total<1)return this;var currentAlphas=this.alphas;void 0===alphas?alphas=[1]:Array.isArray(alphas)||void 0!==bottomAlpha||(alphas=[alphas]);var index=0;if(void 0!==bottomAlpha)for(i=0;i<total;i++)currentAlphas[index=2*i]=alphas,currentAlphas[index+1]=bottomAlpha;else if(alphas.length===total)for(i=0;i<total;i++)currentAlphas[index=2*i]=alphas[i],currentAlphas[index+1]=alphas[i];else for(var prevAlpha=alphas[0],i=0;i<total;i++)alphas.length>(index=2*i)&&(prevAlpha=alphas[index]),currentAlphas[index]=prevAlpha,alphas.length>index+1&&(prevAlpha=alphas[index+1]),currentAlphas[index+1]=prevAlpha;return this},setColors:function(colors){var total=this.points.length;if(total<1)return this;var currentColors=this.colors;void 0===colors?colors=[16777215]:Array.isArray(colors)||(colors=[colors]);var index=0;if(colors.length===total)for(i=0;i<total;i++)currentColors[index=2*i]=colors[i],currentColors[index+1]=colors[i];else for(var prevColor=colors[0],i=0;i<total;i++)colors.length>(index=2*i)&&(prevColor=colors[index]),currentColors[index]=prevColor,colors.length>index+1&&(prevColor=colors[index+1]),currentColors[index+1]=prevColor;return this},setPoints:function(points,colors,alphas){if("number"==typeof(points=void 0===points?2:points)){var s,frameSegment,offset,segments=points;if(segments<2&&(segments=2),points=[],this.horizontal)for(offset=-this.frame.halfWidth,frameSegment=this.frame.width/(segments-1),s=0;s<segments;s++)points.push({x:offset+s*frameSegment,y:0});else for(offset=-this.frame.halfHeight,frameSegment=this.frame.height/(segments-1),s=0;s<segments;s++)points.push({x:0,y:offset+s*frameSegment})}var total=points.length,currentTotal=this.points.length;return total<1?console.warn("Rope: Not enough points given"):(1===total&&(points.unshift({x:0,y:0}),total++),currentTotal!==total&&this.resizeArrays(total),this.points=points,this.updateUVs(),null!=colors&&this.setColors(colors),null!=alphas&&this.setAlphas(alphas)),this},updateUVs:function(){for(var currentUVs=this.uv,total=this.points.length,u0=this.frame.u0,v0=this.frame.v0,u1=this.frame.u1,v1=this.frame.v1,partH=(u1-u0)/(total-1),partV=(v1-v0)/(total-1),i=0;i<total;i++){var uv0,uv1,uv2,index=4*i,uv3=this.horizontal?(uv2=uv0=this._flipX?u1-i*partH:u0+i*partH,this._flipY?(uv1=v1,v0):(uv1=v0,v1)):(uv2=this._flipX?(uv0=u0,u1):(uv0=u1,u0),uv1=this._flipY?v1-i*partV:v0+i*partV);currentUVs[0+index]=uv0,currentUVs[1+index]=uv1,currentUVs[2+index]=uv2,currentUVs[3+index]=uv3}return this},resizeArrays:function(newSize){var colors=this.colors,alphas=this.alphas;this.vertices=new Float32Array(4*newSize),this.uv=new Float32Array(4*newSize);for(var colors=new Uint32Array(2*newSize),alphas=new Float32Array(2*newSize),i=0;i<2*newSize;i++)colors[i]=16777215,alphas[i]=1;return this.colors=colors,this.alphas=alphas,this.dirty=!0,this},updateVertices:function(){var perp=this._perp,points=this.points,vertices=this.vertices,total=points.length;if(this.dirty=!1,!(total<1)){for(var lastPoint=points[0],frameSize=this.horizontal?this.frame.halfHeight:this.frame.halfWidth,i=0;i<total;i++){var point=points[i],index=4*i,perpLength=i<total-1?points[i+1]:point;perp.x=perpLength.y-lastPoint.y,perp.y=-(perpLength.x-lastPoint.x);perpLength=perp.length();perp.x/=perpLength,perp.y/=perpLength,perp.x*=frameSize,perp.y*=frameSize,vertices[index]=point.x+perp.x,vertices[1+index]=point.y+perp.y,vertices[2+index]=point.x-perp.x,vertices[3+index]=point.y-perp.y,lastPoint=point}return this}},setDebug:function(graphic,callback){return this.debugGraphic=graphic,this.debugCallback=graphic||callback?callback||this.renderDebugVerts:null,this},renderDebugVerts:function(src,meshLength,verts){var graphic=src.debugGraphic,px0=verts[0],py0=verts[1],px1=verts[2],py1=verts[3];graphic.lineBetween(px0,py0,px1,py1);for(var i=4;i<meshLength;i+=4){var x0=verts[i+0],y0=verts[i+1],x1=verts[i+2],y1=verts[i+3];graphic.lineBetween(px0,py0,x0,y0),graphic.lineBetween(px1,py1,x1,y1),graphic.lineBetween(px1,py1,x0,y0),graphic.lineBetween(x0,y0,x1,y1),px0=x0,py0=y0,px1=x1,py1=y1}},preDestroy:function(){this.anims.destroy(),this.anims=void 0,this.points=null,this.vertices=null,this.uv=null,this.colors=null,this.alphas=null,this.debugCallback=null,this.debugGraphic=null},flipX:{get:function(){return this._flipX},set:function(value){return this._flipX=value,this.updateUVs()}},flipY:{get:function(){return this._flipY},set:function(value){return this._flipY=value,this.updateUVs()}}}),GetTextSize_1=function(lineSpacing,height,lines){var lineHeight=lineSpacing.canvas,context=lineSpacing.context,style=lineSpacing.style,lineWidths=[],maxLineWidth=0,drawnLines=lines.length;0<style.maxLines&&style.maxLines<lines.length&&(drawnLines=style.maxLines),style.syncFont(lineHeight,context);for(var i=0;i<drawnLines;i++){var lineWidth=style.strokeThickness;lineWidth+=context.measureText(lines[i]).width,style.wordWrap&&(lineWidth-=context.measureText(" ").width),lineWidths[i]=Math.ceil(lineWidth),maxLineWidth=Math.max(maxLineWidth,lineWidths[i])}lineHeight=height.fontSize+style.strokeThickness,height=lineHeight*drawnLines,lineSpacing=lineSpacing.lineSpacing;return 1<drawnLines&&(height+=lineSpacing*(drawnLines-1)),{width:maxLineWidth,height:height,lines:drawnLines,lineWidths:lineWidths,lineSpacing:lineSpacing,lineHeight:lineHeight}},Utils$d=GetProps_1,physics={renderWebGL:function(renderer,src,camera,parentMatrix){var frame,width,height,getTint,pipeline,textureUnit;0!==src.width&&0!==src.height&&(camera.addToRenderList(src),width=(frame=src.frame).width,height=frame.height,getTint=Utils$d.getTintAppendFloatAlpha,textureUnit=(pipeline=renderer.pipelines.set(src.pipeline,src)).setTexture2D(frame.glTexture,src),renderer.pipelines.preBatch(src),pipeline.batchTexture(src,frame.glTexture,width,height,src.x,src.y,width/src.style.resolution,height/src.style.resolution,src.scaleX,src.scaleY,src.rotation,src.flipX,src.flipY,src.scrollFactorX,src.scrollFactorY,src.displayOriginX,src.displayOriginY,0,0,width,height,getTint(src.tintTopLeft,camera.alpha*src._alphaTL),getTint(src.tintTopRight,camera.alpha*src._alphaTR),getTint(src.tintBottomLeft,camera.alpha*src._alphaBL),getTint(src.tintBottomRight,camera.alpha*src._alphaBR),src.tintFill,0,0,camera,parentMatrix,!1,textureUnit),renderer.pipelines.postBatch(src))},renderCanvas:function(renderer,src,camera,parentMatrix){0!==src.width&&0!==src.height&&(camera.addToRenderList(src),renderer.batchSprite(src,src.frame,camera,parentMatrix))}},CanvasPool$2=SetValue_1,MeasureText_1=function(output){var canvas=CanvasPool$2.create(this),numPixels=canvas.getContext("2d");output.syncFont(canvas,numPixels);var height=numPixels.measureText(output.testString);if("actualBoundingBoxAscent"in height){var ascent=height.actualBoundingBoxAscent,width=height.actualBoundingBoxDescent;return CanvasPool$2.remove(canvas),{ascent:ascent,descent:width,fontSize:ascent+width}}var width=Math.ceil(height.width*output.baselineX),height=2*width,baseline=width*output.baselineY|0;canvas.width=width,canvas.height=height,numPixels.fillStyle="#f00",numPixels.fillRect(0,0,width,height),numPixels.font=output._font,numPixels.textBaseline="alphabetic",numPixels.fillStyle="#000",numPixels.fillText(output.testString,0,baseline);output={ascent:0,descent:0,fontSize:0},numPixels=numPixels.getImageData(0,0,width,height);if(!numPixels)return output.ascent=baseline,output.descent=6+baseline,output.fontSize=output.ascent+output.descent,CanvasPool$2.remove(canvas),output;for(var j,pixels=numPixels.data,numPixels=pixels.length,line=4*width,idx=0,stop=!1,i=0;i<baseline;i++){for(j=0;j<line;j+=4)if(255!==pixels[idx+j]){stop=!0;break}if(stop)break;idx+=line}for(output.ascent=baseline-i,idx=numPixels-line,stop=!1,i=height;baseline<i;i--){for(j=0;j<line;j+=4)if(255!==pixels[idx+j]){stop=!0;break}if(stop)break;idx-=line}return output.descent=i-baseline,output.fontSize=output.ascent+output.descent,CanvasPool$2.remove(canvas),output},GetAdvancedValue$k=GetAdvancedValue_1,GetValue$i=GetValue_1,MeasureText=MeasureText_1,propertyMap={fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],backgroundColor:["backgroundColor",null],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],align:["align","left"],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],rtl:["rtl",!1],testString:["testString","|MÃ‰qgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wordWrapWidth:["wordWrap.width",null],wordWrapCallback:["wordWrap.callback",null],wordWrapCallbackScope:["wordWrap.callbackScope",null],wordWrapUseAdvanced:["wordWrap.useAdvancedWrap",!1]},TextStyle_1=new Class_1({initialize:function(text,metrics){this.parent=text,this.fontFamily,this.fontSize,this.fontStyle,this.backgroundColor,this.color,this.stroke,this.strokeThickness,this.shadowOffsetX,this.shadowOffsetY,this.shadowColor,this.shadowBlur,this.shadowStroke,this.shadowFill,this.align,this.maxLines,this.fixedWidth,this.fixedHeight,this.resolution,this.rtl,this.testString,this.baselineX,this.baselineY,this.wordWrapWidth,this.wordWrapCallback,this.wordWrapCallbackScope,this.wordWrapUseAdvanced,this._font,this.setStyle(metrics,!1,!0);metrics=GetValue$i(metrics,"metrics",!1);this.metrics=metrics?{ascent:GetValue$i(metrics,"ascent",0),descent:GetValue$i(metrics,"descent",0),fontSize:GetValue$i(metrics,"fontSize",0)}:MeasureText(this)},setStyle:function(style,updateText,setDefaults){for(var key in void 0===updateText&&(updateText=!0),void 0===setDefaults&&(setDefaults=!1),style&&style.hasOwnProperty("fontSize")&&"number"==typeof style.fontSize&&(style.fontSize=style.fontSize.toString()+"px"),propertyMap){var value=setDefaults?propertyMap[key][1]:this[key];this[key]=("wordWrapCallback"===key||"wordWrapCallbackScope"===key?GetValue$i:GetAdvancedValue$k)(style,propertyMap[key][0],value)}var fill=GetValue$i(style,"font",null);null!==fill&&this.setFont(fill,!1),this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim();fill=GetValue$i(style,"fill",null);return null!==fill&&(this.color=fill),updateText?this.update(!0):this.parent},syncFont:function(canvas,context){context.font=this._font},syncStyle:function(canvas,context){context.textBaseline="alphabetic",context.fillStyle=this.color,context.strokeStyle=this.stroke,context.lineWidth=this.strokeThickness,context.lineCap="round",context.lineJoin="round"},syncShadow:function(context,enabled){enabled?(context.shadowOffsetX=this.shadowOffsetX,context.shadowOffsetY=this.shadowOffsetY,context.shadowColor=this.shadowColor,context.shadowBlur=this.shadowBlur):(context.shadowOffsetX=0,context.shadowOffsetY=0,context.shadowColor=0,context.shadowBlur=0)},update:function(recalculateMetrics){return recalculateMetrics&&(this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim(),this.metrics=MeasureText(this)),this.parent.updateText()},setFont:function(fontSplit,updateText){void 0===updateText&&(updateText=!0);var i,fontFamily=fontSplit,fontSize="",fontStyle="";return"string"!=typeof fontSplit?(fontFamily=GetValue$i(fontSplit,"fontFamily","Courier"),fontSize=GetValue$i(fontSplit,"fontSize","16px"),fontStyle=GetValue$i(fontSplit,"fontStyle","")):(i=0,fontStyle=2<(fontSplit=fontSplit.split(" ")).length?fontSplit[i++]:"",fontSize=fontSplit[i++]||"16px",fontFamily=fontSplit[i++]||"Courier"),fontFamily===this.fontFamily&&fontSize===this.fontSize&&fontStyle===this.fontStyle||(this.fontFamily=fontFamily,this.fontSize=fontSize,this.fontStyle=fontStyle,updateText&&this.update(!0)),this.parent},setFontFamily:function(family){return this.fontFamily!==family&&(this.fontFamily=family,this.update(!0)),this.parent},setFontStyle:function(style){return this.fontStyle!==style&&(this.fontStyle=style,this.update(!0)),this.parent},setFontSize:function(size){return"number"==typeof size&&(size=size.toString()+"px"),this.fontSize!==size&&(this.fontSize=size,this.update(!0)),this.parent},setTestString:function(string){return this.testString=string,this.update(!0)},setFixedSize:function(width,height){return this.fixedWidth=width,this.fixedHeight=height,width&&(this.parent.width=width),height&&(this.parent.height=height),this.update(!1)},setBackgroundColor:function(color){return this.backgroundColor=color,this.update(!1)},setFill:function(color){return this.color=color,this.update(!1)},setColor:function(color){return this.color=color,this.update(!1)},setResolution:function(value){return this.resolution=value,this.update(!1)},setStroke:function(color,thickness){return void 0===thickness&&(thickness=this.strokeThickness),void 0===color&&0!==this.strokeThickness?(this.strokeThickness=0,this.update(!0)):this.stroke===color&&this.strokeThickness===thickness||(this.stroke=color,this.strokeThickness=thickness,this.update(!0)),this.parent},setShadow:function(x,y,color,blur,shadowStroke,shadowFill){return void 0===y&&(y=0),void 0===color&&(color="#000"),void 0===blur&&(blur=0),void 0===shadowStroke&&(shadowStroke=!1),void 0===shadowFill&&(shadowFill=!0),this.shadowOffsetX=x=void 0===x?0:x,this.shadowOffsetY=y,this.shadowColor=color,this.shadowBlur=blur,this.shadowStroke=shadowStroke,this.shadowFill=shadowFill,this.update(!1)},setShadowOffset:function(x,y){return void 0===x&&(x=0),void 0===y&&(y=x),this.shadowOffsetX=x,this.shadowOffsetY=y,this.update(!1)},setShadowColor:function(color){return this.shadowColor=color=void 0===color?"#000":color,this.update(!1)},setShadowBlur:function(blur){return this.shadowBlur=blur=void 0===blur?0:blur,this.update(!1)},setShadowStroke:function(enabled){return this.shadowStroke=enabled,this.update(!1)},setShadowFill:function(enabled){return this.shadowFill=enabled,this.update(!1)},setWordWrapWidth:function(width,useAdvancedWrap){return void 0===useAdvancedWrap&&(useAdvancedWrap=!1),this.wordWrapWidth=width,this.wordWrapUseAdvanced=useAdvancedWrap,this.update(!1)},setWordWrapCallback:function(callback,scope){return void 0===scope&&(scope=null),this.wordWrapCallback=callback,this.wordWrapCallbackScope=scope,this.update(!1)},setAlign:function(align){return this.align=align=void 0===align?"left":align,this.update(!1)},setMaxLines:function(max){return this.maxLines=max=void 0===max?0:max,this.update(!1)},getTextMetrics:function(){var metrics=this.metrics;return{ascent:metrics.ascent,descent:metrics.descent,fontSize:metrics.fontSize}},toJSON:function(){var key,output={};for(key in propertyMap)output[key]=this[key];return output.metrics=this.getTextMetrics(),output},destroy:function(){this.parent=void 0}}),AddToDOM=Engine_1,CanvasPool$1=SetValue_1,Components$f=components$3,GameEvents$3=ImageFile_1,GameObject$9=GameObject_1,GetTextSize=GetTextSize_1,GetValue$h=GetValue_1,RemoveFromDOM=input,TextStyle=TextStyle_1,Text_1=new Class_1({Extends:GameObject$9,Mixins:[Components$f.Alpha,Components$f.BlendMode,Components$f.ComputedSize,Components$f.Crop,Components$f.Depth,Components$f.Flip,Components$f.GetBounds,Components$f.Mask,Components$f.Origin,Components$f.Pipeline,Components$f.ScrollFactor,Components$f.Tint,Components$f.Transform,Components$f.Visible,physics],initialize:function(scene,x,y,text,style){void 0===x&&(x=0),void 0===y&&(y=0),GameObject$9.call(this,scene,"Text"),this.renderer=scene.sys.renderer,this.setPosition(x,y),this.setOrigin(0,0),this.initPipeline(),this.canvas=CanvasPool$1.create(this),this.context=this.canvas.getContext("2d"),this.style=new TextStyle(this,style),this.autoRound=!0,this.splitRegExp=/(?:\r\n|\r|\n)/,this._text=void 0,this.padding={left:0,right:0,top:0,bottom:0},this.width=1,this.height=1,this.lineSpacing=0,this.dirty=!1,0===this.style.resolution&&(this.style.resolution=1),this._crop=this.resetCropObject(),this.texture=scene.sys.textures.addCanvas(null,this.canvas,!0),this.frame=this.texture.get(),this.frame.source.resolution=this.style.resolution,this.renderer&&this.renderer.gl&&(this.renderer.deleteTexture(this.frame.source.glTexture),this.frame.source.glTexture=null),this.initRTL(),this.setText(text),style&&style.padding&&this.setPadding(style.padding),style&&style.lineSpacing&&this.setLineSpacing(style.lineSpacing),scene.sys.game.events.on(GameEvents$3.CONTEXT_RESTORED,function(){this.dirty=!0},this)},initRTL:function(){this.style.rtl&&(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",AddToDOM(this.canvas,this.scene.sys.canvas),this.originX=1)},runWordWrap:function(text){var style=this.style;if(style.wordWrapCallback){var wrappedLines=style.wordWrapCallback.call(style.wordWrapCallbackScope,text,this);return wrappedLines=Array.isArray(wrappedLines)?wrappedLines.join("\n"):wrappedLines}return style.wordWrapWidth?style.wordWrapUseAdvanced?this.advancedWordWrap(text,this.context,this.style.wordWrapWidth):this.basicWordWrap(text,this.context,this.style.wordWrapWidth):text},advancedWordWrap:function(text,context,wordWrapWidth){for(var output="",lines=text.replace(/ +/gi," ").split(this.splitRegExp),linesCount=lines.length,i=0;i<linesCount;i++){var out="",line=(line=lines[i]).replace(/^ *|\s*$/gi,"");if(context.measureText(line).width<wordWrapWidth)output+=line+"\n";else{for(var currentLineWidth=wordWrapWidth,words=line.split(" "),j=0;j<words.length;j++){var word=words[j],wordWithSpace=word+" ",wordWidth=context.measureText(wordWithSpace).width;if(currentLineWidth<wordWidth){if(0===j){for(var newWord=wordWithSpace;newWord.length&&(newWord=newWord.slice(0,-1),!((wordWidth=context.measureText(newWord).width)<=currentLineWidth)););if(!newWord.length)throw new Error("This text's wordWrapWidth setting is less than a single character!");var remainder=word.substr(newWord.length);words[j]=remainder,out+=newWord}remainder=words[j].length?j:j+1,remainder=words.slice(remainder).join(" ").replace(/[ \n]*$/gi,"");lines[i+1]=remainder+" "+(lines[i+1]||""),linesCount=lines.length;break}out+=wordWithSpace,currentLineWidth-=wordWidth}output+=out.replace(/[ \n]*$/gi,"")+"\n"}}return output=output.replace(/[\s|\n]*$/gi,"")},basicWordWrap:function(text,context,wordWrapWidth){for(var result="",lines=text.split(this.splitRegExp),lastLineIndex=lines.length-1,whiteSpaceWidth=context.measureText(" ").width,i=0;i<=lastLineIndex;i++){for(var spaceLeft=wordWrapWidth,words=lines[i].split(" "),lastWordIndex=words.length-1,j=0;j<=lastWordIndex;j++){var word=words[j],wordWidth=context.measureText(word).width,wordWidthWithSpace=wordWidth;j<lastWordIndex&&(wordWidthWithSpace+=whiteSpaceWidth),spaceLeft<wordWidthWithSpace&&0<j&&(result+="\n",spaceLeft=wordWrapWidth),result+=word,j<lastWordIndex?(result+=" ",spaceLeft-=wordWidthWithSpace):spaceLeft-=wordWidth}i<lastLineIndex&&(result+="\n")}return result},getWrappedText:function(text){return void 0===text&&(text=this._text),this.style.syncFont(this.canvas,this.context),this.runWordWrap(text).split(this.splitRegExp)},setText:function(value){return value||0===value||(value=""),(value=Array.isArray(value)?value.join("\n"):value)!==this._text&&(this._text=value.toString(),this.updateText()),this},setStyle:function(style){return this.style.setStyle(style)},setFont:function(font){return this.style.setFont(font)},setFontFamily:function(family){return this.style.setFontFamily(family)},setFontSize:function(size){return this.style.setFontSize(size)},setFontStyle:function(style){return this.style.setFontStyle(style)},setFixedSize:function(width,height){return this.style.setFixedSize(width,height)},setBackgroundColor:function(color){return this.style.setBackgroundColor(color)},setFill:function(fillStyle){return this.style.setFill(fillStyle)},setColor:function(color){return this.style.setColor(color)},setStroke:function(color,thickness){return this.style.setStroke(color,thickness)},setShadow:function(x,y,color,blur,shadowStroke,shadowFill){return this.style.setShadow(x,y,color,blur,shadowStroke,shadowFill)},setShadowOffset:function(x,y){return this.style.setShadowOffset(x,y)},setShadowColor:function(color){return this.style.setShadowColor(color)},setShadowBlur:function(blur){return this.style.setShadowBlur(blur)},setShadowStroke:function(enabled){return this.style.setShadowStroke(enabled)},setShadowFill:function(enabled){return this.style.setShadowFill(enabled)},setWordWrapWidth:function(width,useAdvancedWrap){return this.style.setWordWrapWidth(width,useAdvancedWrap)},setWordWrapCallback:function(callback,scope){return this.style.setWordWrapCallback(callback,scope)},setAlign:function(align){return this.style.setAlign(align)},setResolution:function(value){return this.style.setResolution(value)},setLineSpacing:function(value){return this.lineSpacing=value,this.updateText()},setPadding:function(left,top,right,bottom){var config,y;return"object"==typeof left?(right=null!==(y=GetValue$h(config=left,"x",null))?left=y:(left=GetValue$h(config,"left",0),GetValue$h(config,"right",left)),bottom=null!==(y=GetValue$h(config,"y",null))?top=y:(top=GetValue$h(config,"top",0),GetValue$h(config,"bottom",top))):(void 0===left&&(left=0),void 0===top&&(top=left),void 0===right&&(right=left),void 0===bottom&&(bottom=top)),this.padding.left=left,this.padding.top=top,this.padding.right=right,this.padding.bottom=bottom,this.updateText()},setMaxLines:function(max){return this.style.setMaxLines(max)},updateText:function(){var input=this.canvas,context=this.context,style=this.style,resolution=style.resolution,size=style.metrics;style.syncFont(input,context);var textWidth,h=this._text,lines=(h=style.wordWrapWidth||style.wordWrapCallback?this.runWordWrap(this._text):h).split(this.splitRegExp),textSize=GetTextSize(this,size,lines),padding=this.padding;0===style.fixedWidth?(this.width=textSize.width+padding.left+padding.right,textWidth=textSize.width):(this.width=style.fixedWidth,(textWidth=this.width-padding.left-padding.right)<textSize.width&&(textWidth=textSize.width)),0===style.fixedHeight?this.height=textSize.height+padding.top+padding.bottom:this.height=style.fixedHeight;var linePositionX,linePositionY,w=this.width,h=this.height;this.updateDisplayOrigin(),w*=resolution,h*=resolution,w=Math.max(w,1),h=Math.max(h,1),input.width!==w||input.height!==h?(input.width=w,input.height=h,this.frame.setSize(w,h),style.syncFont(input,context)):context.clearRect(0,0,w,h),context.save(),context.scale(resolution,resolution),style.backgroundColor&&(context.fillStyle=style.backgroundColor,context.fillRect(0,0,w,h)),style.syncStyle(input,context),context.textBaseline="alphabetic",context.translate(padding.left,padding.top);for(var i=0;i<textSize.lines;i++){if(linePositionX=style.strokeThickness/2,linePositionY=style.strokeThickness/2+i*textSize.lineHeight+size.ascent,0<i&&(linePositionY+=textSize.lineSpacing*i),style.rtl)linePositionX=w-linePositionX;else if("right"===style.align)linePositionX+=textWidth-textSize.lineWidths[i];else if("center"===style.align)linePositionX+=(textWidth-textSize.lineWidths[i])/2;else if("justify"===style.align)if(.85<=textSize.lineWidths[i]/textSize.width){var extraSpace=textSize.width-textSize.lineWidths[i],spaceSize=context.measureText(" ").width,trimmedLine=lines[i].trim(),array=trimmedLine.split(" ");extraSpace+=(lines[i].length-trimmedLine.length)*spaceSize;for(var extraSpaceCharacters=Math.floor(extraSpace/spaceSize),idx=0;0<extraSpaceCharacters;)array[idx]+=" ",idx=(idx+1)%(array.length-1||1),--extraSpaceCharacters;lines[i]=array.join(" ")}this.autoRound&&(linePositionX=Math.round(linePositionX),linePositionY=Math.round(linePositionY)),style.strokeThickness&&(this.style.syncShadow(context,style.shadowStroke),context.strokeText(lines[i],linePositionX,linePositionY)),style.color&&(this.style.syncShadow(context,style.shadowFill),context.fillText(lines[i],linePositionX,linePositionY))}context.restore(),this.renderer&&this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(input,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture),this.dirty=!0;input=this.input;return input&&!input.customHitArea&&(input.hitArea.width=this.width,input.hitArea.height=this.height),this},getTextMetrics:function(){return this.style.getTextMetrics()},text:{get:function(){return this._text},set:function(value){this.setText(value)}},toJSON:function(){var out=Components$f.ToJSON(this),data={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return out.data=data,out},preDestroy:function(){this.style.rtl&&RemoveFromDOM(this.canvas),CanvasPool$1.remove(this.canvas),this.texture.destroy()}}),Utils$c=GetProps_1,CanvasPool=SetValue_1,GameEvents$2=ImageFile_1,GameObject$8=GameObject_1,GetPowerOfTwo=FitInside_1,Smoothing=BuildRight_1,Vector2$s=BuildTilesetIndex_1,Pair_1=new Class_1({Extends:GameObject$8,Mixins:[components$3.Alpha,components$3.BlendMode,components$3.ComputedSize,components$3.Crop,components$3.Depth,components$3.Flip,components$3.GetBounds,components$3.Mask,components$3.Origin,components$3.Pipeline,components$3.ScrollFactor,components$3.Tint,components$3.Transform,components$3.Visible,{renderWebGL:function(renderer,src,camera,parentMatrix){src.updateCanvas();var getTint,pipeline,textureUnit,width=src.width,height=src.height;0!==width&&0!==height&&(camera.addToRenderList(src),renderer.pipelines.preBatch(src),getTint=Utils$c.getTintAppendFloatAlpha,textureUnit=(pipeline=renderer.pipelines.set(src.pipeline,src)).setTexture2D(src.fillPattern,src),pipeline.batchTexture(src,src.fillPattern,src.displayFrame.width*src.tileScaleX,src.displayFrame.height*src.tileScaleY,src.x,src.y,width,height,src.scaleX,src.scaleY,src.rotation,src.flipX,src.flipY,src.scrollFactorX,src.scrollFactorY,src.originX*width,src.originY*height,0,0,width,height,getTint(src.tintTopLeft,camera.alpha*src._alphaTL),getTint(src.tintTopRight,camera.alpha*src._alphaTR),getTint(src.tintBottomLeft,camera.alpha*src._alphaBL),getTint(src.tintBottomRight,camera.alpha*src._alphaBR),src.tintFill,src.tilePositionX%src.displayFrame.width/src.displayFrame.width,src.tilePositionY%src.displayFrame.height/src.displayFrame.height,camera,parentMatrix,!1,textureUnit),renderer.pipelines.postBatch(src))},renderCanvas:function(renderer,src,camera,parentMatrix){src.updateCanvas(),camera.addToRenderList(src),renderer.batchSprite(src,src.frame,camera,parentMatrix)}}],initialize:function(scene,x,y,width,height,displayFrame,frameKey){var renderer=scene.sys.renderer;GameObject$8.call(this,scene,"TileSprite");var displayTexture=scene.sys.textures.get(displayFrame),displayFrame=displayTexture.get(frameKey);height=width&&height?(width=Math.floor(width),Math.floor(height)):(width=displayFrame.width,displayFrame.height),this._tilePosition=new Vector2$s,this._tileScale=new Vector2$s(1,1),this.dirty=!1,this.renderer=renderer,this.canvas=CanvasPool.create(this,width,height),this.context=this.canvas.getContext("2d"),this.displayTexture=displayTexture,this.displayFrame=displayFrame,this._crop=this.resetCropObject(),this.texture=scene.sys.textures.addCanvas(null,this.canvas,!0),this.frame=this.texture.get(),this.potWidth=GetPowerOfTwo(displayFrame.width),this.potHeight=GetPowerOfTwo(displayFrame.height),this.fillCanvas=CanvasPool.create2D(this,this.potWidth,this.potHeight),this.fillContext=this.fillCanvas.getContext("2d"),this.fillPattern=null,this.setPosition(x,y),this.setSize(width,height),this.setFrame(frameKey),this.setOriginFromFrame(),this.initPipeline(),scene.sys.game.events.on(GameEvents$2.CONTEXT_RESTORED,function(renderer){var gl;renderer&&(gl=renderer.gl,this.dirty=!0,this.fillPattern=null,this.fillPattern=renderer.createTexture2D(0,gl.LINEAR,gl.LINEAR,gl.REPEAT,gl.REPEAT,gl.RGBA,this.fillCanvas,this.potWidth,this.potHeight))},this)},setTexture:function(key,frame){return this.displayTexture=this.scene.sys.textures.get(key),this.setFrame(frame)},setFrame:function(newFrame){newFrame=this.displayTexture.get(newFrame);return this.potWidth=GetPowerOfTwo(newFrame.width),this.potHeight=GetPowerOfTwo(newFrame.height),this.canvas.width=0,newFrame.cutWidth&&newFrame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this.displayFrame=newFrame,this.dirty=!0,this.updateTileTexture(),this},setTilePosition:function(x,y){return void 0!==x&&(this.tilePositionX=x),void 0!==y&&(this.tilePositionY=y),this},setTileScale:function(x,y){return void 0===x&&(x=this.tileScaleX),void 0===y&&(y=x),this.tileScaleX=x,this.tileScaleY=y,this},updateTileTexture:function(){if(this.dirty&&this.renderer){var frame=this.displayFrame;if(frame.source.isRenderTexture||frame.source.isGLTexture)return console.warn("TileSprites can only use Image or Canvas based textures"),void(this.dirty=!1);var ctx=this.fillContext,canvas=this.fillCanvas,fw=this.potWidth,fh=this.potHeight;this.renderer&&this.renderer.gl||(fw=frame.cutWidth,fh=frame.cutHeight),ctx.clearRect(0,0,fw,fh),canvas.width=fw,canvas.height=fh,ctx.drawImage(frame.source.image,frame.cutX,frame.cutY,frame.cutWidth,frame.cutHeight,0,0,fw,fh),this.renderer&&this.renderer.gl?this.fillPattern=this.renderer.canvasToTexture(canvas,this.fillPattern):this.fillPattern=ctx.createPattern(canvas,"repeat"),this.updateCanvas(),this.dirty=!1}},updateCanvas:function(){var ctx,scaleX,scaleY,positionX,positionY=this.canvas;positionY.width===this.width&&positionY.height===this.height||(positionY.width=this.width,positionY.height=this.height,this.frame.setSize(this.width,this.height),this.updateDisplayOrigin(),this.dirty=!0),!this.dirty||this.renderer&&this.renderer.gl||(ctx=this.context,this.scene.sys.game.config.antialias||Smoothing.disable(ctx),scaleX=this._tileScale.x,scaleY=this._tileScale.y,positionX=this._tilePosition.x,positionY=this._tilePosition.y,ctx.clearRect(0,0,this.width,this.height),ctx.save(),ctx.scale(scaleX,scaleY),ctx.translate(-positionX,-positionY),ctx.fillStyle=this.fillPattern,ctx.fillRect(positionX,positionY,this.width/scaleX,this.height/scaleY),ctx.restore()),this.dirty=!1},preDestroy:function(){this.renderer&&this.renderer.gl&&this.renderer.deleteTexture(this.fillPattern),CanvasPool.remove(this.canvas),CanvasPool.remove(this.fillCanvas),this.fillPattern=null,this.fillContext=null,this.fillCanvas=null,this.displayTexture=null,this.displayFrame=null,this.texture.destroy(),this.renderer=null},tilePositionX:{get:function(){return this._tilePosition.x},set:function(value){this._tilePosition.x=value,this.dirty=!0}},tilePositionY:{get:function(){return this._tilePosition.y},set:function(value){this._tilePosition.y=value,this.dirty=!0}},tileScaleX:{get:function(){return this._tileScale.x},set:function(value){this._tileScale.x=value,this.dirty=!0}},tileScaleY:{get:function(){return this._tileScale.y},set:function(value){this._tileScale.y=value,this.dirty=!0}}}),Clamp$3=Character,Events$l=events$h,GameEvents$1=ImageFile_1,InputEvents$3=renderer,GameObject$7=GameObject_1,SoundEvents=events$6,UUID=UUID_1,MATH_CONST$9=Tweens,Ceil_1=new Class_1({Extends:GameObject$7,Mixins:[components$3.Alpha,components$3.BlendMode,components$3.Depth,components$3.Flip,components$3.GetBounds,components$3.Mask,components$3.Origin,components$3.Pipeline,components$3.ScrollFactor,components$3.Size,components$3.TextureCrop,components$3.Tint,components$3.Transform,components$3.Visible,{renderWebGL:function(renderer,src,camera,parentMatrix){src.videoTexture&&(camera.addToRenderList(src),src.pipeline.batchSprite(src,camera,parentMatrix))},renderCanvas:function(renderer,src,camera,parentMatrix){src.videoTexture&&(camera.addToRenderList(src),renderer.batchSprite(src,src.frame,camera,parentMatrix))}}],initialize:function(sound,x,y,game){GameObject$7.call(this,sound,"Video"),this.video=null,this.videoTexture=null,this.videoTextureSource=null,this.snapshotTexture=null,this.flipY=!1,this._key=UUID(),this.touchLocked=!0,this.playWhenUnlocked=!1,this.retryLimit=20,this.retry=0,this.retryInterval=500,this._retryID=null,this._systemMuted=!1,this._codeMuted=!1,this._systemPaused=!1,this._codePaused=!1,this._callbacks={play:this.playHandler.bind(this),error:this.loadErrorHandler.bind(this),end:this.completeHandler.bind(this),time:this.timeUpdateHandler.bind(this),seeking:this.seekingHandler.bind(this),seeked:this.seekedHandler.bind(this)},this._crop=this.resetCropObject(),this.markers={},this._markerIn=-1,this._markerOut=MATH_CONST$9.MAX_SAFE_INTEGER,this._lastUpdate=0,this._cacheKey="",this._isSeeking=!1,this.removeVideoElementOnDestroy=!1,this.setPosition(x,y),this.initPipeline(),game&&this.changeSource(game,!1);game=sound.sys.game.events;game.on(GameEvents$1.PAUSE,this.globalPause,this),game.on(GameEvents$1.RESUME,this.globalResume,this);sound=sound.sys.sound;sound&&sound.on(SoundEvents.GLOBAL_MUTE,this.globalMute,this)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},play:function(playPromise,markerIn,callbacks){if(this.touchLocked&&this.playWhenUnlocked||this.isPlaying())return this;var video=this.video;if(!video)return console.warn("Video not loaded"),this;void 0===playPromise&&(playPromise=video.loop);var sound=this.scene.sys.sound;sound&&sound.mute&&this.setMute(!0),isNaN(markerIn)||(this._markerIn=markerIn),!isNaN(callbacks)&&markerIn<callbacks&&(this._markerOut=callbacks),video.loop=playPromise;callbacks=this._callbacks,playPromise=video.play();return void 0!==playPromise?playPromise.then(this.playPromiseSuccessHandler.bind(this)).catch(this.playPromiseErrorHandler.bind(this)):(video.addEventListener("playing",callbacks.play,!0),video.readyState<2&&(this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval))),video.addEventListener("ended",callbacks.end,!0),video.addEventListener("timeupdate",callbacks.time,!0),video.addEventListener("seeking",callbacks.seeking,!0),video.addEventListener("seeked",callbacks.seeked,!0),this},changeSource:function(key,autoplay,loop,markerIn,markerOut){void 0===autoplay&&(autoplay=!0),this.video&&this.stop();var newVideo=this.scene.sys.cache.video.get(key);return newVideo?(this.video=newVideo,this._cacheKey=key,this._codePaused=newVideo.paused,this._codeMuted=newVideo.muted,this.videoTexture?(this.scene.sys.textures.remove(this._key),this.videoTexture=this.scene.sys.textures.create(this._key,newVideo,newVideo.videoWidth,newVideo.videoHeight),this.videoTextureSource=this.videoTexture.source[0],this.videoTexture.add("__BASE",0,0,0,newVideo.videoWidth,newVideo.videoHeight),this.setTexture(this.videoTexture),this.setSizeToFrame(),this.updateDisplayOrigin(),this.emit(Events$l.VIDEO_CREATED,this,newVideo.videoWidth,newVideo.videoHeight)):this.updateTexture(),newVideo.currentTime=0,this._lastUpdate=0,autoplay&&this.play(loop,markerIn,markerOut)):this.video=null,this},addMarker:function(key,markerIn,markerOut){return!isNaN(markerIn)&&0<=markerIn&&!isNaN(markerOut)&&(this.markers[key]=[markerIn,markerOut]),this},playMarker:function(marker,loop){marker=this.markers[marker];return marker&&this.play(loop,marker[0],marker[1]),this},removeMarker:function(key){return delete this.markers[key],this},snapshot:function(width,height){return void 0===width&&(width=this.width),void 0===height&&(height=this.height),this.snapshotArea(0,0,this.width,this.height,width,height)},snapshotArea:function(x,y,srcWidth,srcHeight,destWidth,destHeight){void 0===x&&(x=0),void 0===y&&(y=0),void 0===srcWidth&&(srcWidth=this.width),void 0===srcHeight&&(srcHeight=this.height),void 0===destWidth&&(destWidth=srcWidth),void 0===destHeight&&(destHeight=srcHeight);var video=this.video,snap=this.snapshotTexture;return snap?snap.setSize(destWidth,destHeight):(snap=this.scene.sys.textures.createCanvas(UUID(),destWidth,destHeight),this.snapshotTexture=snap),video&&snap.context.drawImage(video,x,y,srcWidth,srcHeight,0,0,destWidth,destHeight),snap.update()},saveSnapshotTexture:function(key){return this.snapshotTexture?this.scene.sys.textures.renameTexture(this.snapshotTexture.key,key):this.snapshotTexture=this.scene.sys.textures.createCanvas(key,this.width,this.height),this.snapshotTexture},loadURL:function(url,loadEvent,noAudio){void 0===noAudio&&(noAudio=!1),this.video&&this.stop(),this.videoTexture&&this.scene.sys.textures.remove(this._key);var video=document.createElement("video");return video.controls=!1,noAudio&&(video.muted=!0,video.defaultMuted=!0,video.setAttribute("autoplay","autoplay")),video.setAttribute("playsinline","playsinline"),video.setAttribute("preload","auto"),video.addEventListener("error",this._callbacks.error,!0),video.src=url,video.load(),this.video=video,this},loadMediaStream:function(stream,loadEvent,noAudio){void 0===noAudio&&(noAudio=!1),this.video&&this.stop(),this.videoTexture&&this.scene.sys.textures.remove(this._key);var video=document.createElement("video");video.controls=!1,noAudio&&(video.muted=!0,video.defaultMuted=!0,video.setAttribute("autoplay","autoplay")),video.setAttribute("playsinline","playsinline"),video.setAttribute("preload","auto"),video.addEventListener("error",this._callbacks.error,!0);try{video.srcObject=stream}catch(error){video.src=window.URL.createObjectURL(stream)}return video.load(),this.video=video,this},playPromiseSuccessHandler:function(){this._codePaused=!1,this.touchLocked=!1,this.emit(Events$l.VIDEO_PLAY,this),-1<this._markerIn&&(this.video.currentTime=this._markerIn)},playPromiseErrorHandler:function(error){this.scene.sys.input.once(InputEvents$3.POINTER_DOWN,this.unlockHandler,this),this.touchLocked=!0,this.playWhenUnlocked=!0,this.emit(Events$l.VIDEO_ERROR,this,error)},playHandler:function(){this._codePaused=!1,this.touchLocked=!1,this.emit(Events$l.VIDEO_PLAY,this),this.video.removeEventListener("playing",this._callbacks.play,!0)},loadErrorHandler:function(event){this.stop(),this.emit(Events$l.VIDEO_ERROR,this,event)},unlockHandler:function(){this.touchLocked=!1,this.playWhenUnlocked=!1,this.emit(Events$l.VIDEO_UNLOCKED,this),-1<this._markerIn&&(this.video.currentTime=this._markerIn),this.video.play(),this.emit(Events$l.VIDEO_PLAY,this)},completeHandler:function(){this.emit(Events$l.VIDEO_COMPLETE,this)},timeUpdateHandler:function(){this.video&&this.video.currentTime<this._lastUpdate&&(this.emit(Events$l.VIDEO_LOOP,this),this._lastUpdate=0)},preUpdate:function(){var currentTime,video=this.video;!video||(currentTime=video.currentTime)!==this._lastUpdate&&(this._lastUpdate=currentTime,this.updateTexture(),currentTime>=this._markerOut&&(video.loop?(video.currentTime=this._markerIn,this.updateTexture(),this._lastUpdate=currentTime,this.emit(Events$l.VIDEO_LOOP,this)):(this.emit(Events$l.VIDEO_COMPLETE,this),this.stop())))},checkVideoProgress:function(){2<=this.video.readyState?this.updateTexture():(this.retry--,0<this.retry?this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval):this.emit(Events$l.VIDEO_TIMEOUT,this))},updateTexture:function(){var textureSource,video=this.video,width=video.videoWidth,height=video.videoHeight;this.videoTexture?((textureSource=this.videoTextureSource).source!==video&&(textureSource.source=video,textureSource.width=width,textureSource.height=height),textureSource.update()):(this.videoTexture=this.scene.sys.textures.create(this._key,video,width,height),this.videoTextureSource=this.videoTexture.source[0],this.videoTexture.add("__BASE",0,0,0,width,height),this.setTexture(this.videoTexture),this.setSizeToFrame(),this.updateDisplayOrigin(),this.emit(Events$l.VIDEO_CREATED,this,width,height))},getVideoKey:function(){return this._cacheKey},seekTo:function(value){var duration=this.video;return duration&&((duration=duration.duration)===1/0||isNaN(duration)||this.setCurrentTime(duration*value)),this},getCurrentTime:function(){return this.video?this.video.currentTime:0},setCurrentTime:function(value){var op,num,video=this.video;return video&&("string"==typeof value&&(op=value[0],num=parseFloat(value.substr(1)),"+"===op?value=video.currentTime+num:"-"===op&&(value=video.currentTime-num)),video.currentTime=value,this._lastUpdate=value),this},isSeeking:function(){return this._isSeeking},seekingHandler:function(){this._isSeeking=!0,this.emit(Events$l.VIDEO_SEEKING,this)},seekedHandler:function(){this._isSeeking=!1,this.emit(Events$l.VIDEO_SEEKED,this),this.video&&this.updateTexture()},getProgress:function(){var duration=this.video;if(duration){var now=duration.currentTime,duration=duration.duration;if(duration!==1/0&&!isNaN(duration))return now/duration}return 0},getDuration:function(){return this.video?this.video.duration:0},setMute:function(value){this._codeMuted=value=void 0===value?!0:value;var video=this.video;return video&&(video.muted=!!this._systemMuted||value),this},isMuted:function(){return this._codeMuted},globalMute:function(soundManager,value){this._systemMuted=value;var video=this.video;video&&(video.muted=!!this._codeMuted||value)},globalPause:function(){this._systemPaused=!0,this.video&&this.video.pause()},globalResume:function(){this._systemPaused=!1,this.video&&!this._codePaused&&this.video.play()},setPaused:function(value){var video=this.video;return this._codePaused=value=void 0===value?!0:value,video&&(value?video.paused||video.pause():video.paused&&!this._systemPaused&&video.play()),this},getVolume:function(){return this.video?this.video.volume:1},setVolume:function(value){return void 0===value&&(value=1),this.video&&(this.video.volume=Clamp$3(value,0,1)),this},getPlaybackRate:function(){return this.video?this.video.playbackRate:1},setPlaybackRate:function(rate){return this.video&&(this.video.playbackRate=rate),this},getLoop:function(){return!!this.video&&this.video.loop},setLoop:function(value){return void 0===value&&(value=!0),this.video&&(this.video.loop=value),this},isPlaying:function(){return!!this.video&&!(this.video.paused||this.video.ended)},isPaused:function(){return this.video&&this.video.paused||this._codePaused||this._systemPaused},saveTexture:function(key,flipY){return void 0===flipY&&(flipY=!1),this.videoTexture&&this.scene.sys.textures.renameTexture(this._key,key),this._key=key,this.flipY=flipY,this.videoTextureSource&&this.videoTextureSource.setFlipY(flipY),this.videoTexture},stop:function(){var video=this.video;if(video){var callback,callbacks=this._callbacks;for(callback in callbacks)video.removeEventListener(callback,callbacks[callback],!0);video.pause()}return this._retryID&&window.clearTimeout(this._retryID),this.emit(Events$l.VIDEO_STOP,this),this},removeVideoElement:function(){var video=this.video;if(video){for(video.parentNode&&video.parentNode.removeChild(video);video.hasChildNodes();)video.removeChild(video.firstChild);video.removeAttribute("autoplay"),video.removeAttribute("src"),this.video=null}},preDestroy:function(){this.stop(),this.removeVideoElementOnDestroy&&this.removeVideoElement();var sound=this.scene.sys.game.events;sound.off(GameEvents$1.PAUSE,this.globalPause,this),sound.off(GameEvents$1.RESUME,this.globalResume,this);sound=this.scene.sys.sound;sound&&sound.off(SoundEvents.GLOBAL_MUTE,this.globalMute,this),this._retryID&&window.clearTimeout(this._retryID)}}),GameObject$6=GameObject_1,Line$9=Floor_1,AtlasXMLFile_1=new Class_1({Extends:GameObject$6,Mixins:[components$3.AlphaSingle,components$3.BlendMode,components$3.Depth,components$3.GetBounds,components$3.Mask,components$3.Origin,components$3.Pipeline,components$3.ScrollFactor,components$3.Transform,components$3.Visible],initialize:function(scene,type,data){GameObject$6.call(this,scene,type=void 0===type?"Shape":type),this.geom=data,this.pathData=[],this.pathIndexes=[],this.fillColor=16777215,this.fillAlpha=1,this.strokeColor=16777215,this.strokeAlpha=1,this.lineWidth=1,this.isFilled=!1,this.isStroked=!1,this.closePath=!0,this._tempLine=new Line$9,this.width=0,this.height=0,this.initPipeline()},setFillStyle:function(color,alpha){return void 0===alpha&&(alpha=1),void 0===color?this.isFilled=!1:(this.fillColor=color,this.fillAlpha=alpha,this.isFilled=!0),this},setStrokeStyle:function(lineWidth,color,alpha){return void 0===alpha&&(alpha=1),void 0===lineWidth?this.isStroked=!1:(this.lineWidth=lineWidth,this.strokeColor=color,this.strokeAlpha=alpha,this.isStroked=!0),this},setClosePath:function(value){return this.closePath=value,this},setSize:function(width,height){return this.width=width,this.height=height,this},setDisplaySize:function(width,height){return this.displayWidth=width,this.displayHeight=height,this},preDestroy:function(){this.geom=null,this._tempLine=null,this.pathData=[],this.pathIndexes=[]},displayWidth:{get:function(){return this.scaleX*this.width},set:function(value){this.scaleX=value/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(value){this.scaleY=value/this.height}}}),Utils$b=GetProps_1,CircumCenter_1=function(pipeline,calcMatrix,src,alpha,dx,dy){for(var fillTintColor=Utils$b.getTintAppendFloatAlpha(src.fillColor,src.fillAlpha*alpha),path=src.pathData,pathIndexes=src.pathIndexes,i=0;i<pathIndexes.length;i+=3){var x2=2*pathIndexes[i],ty2=2*pathIndexes[i+1],tx0=2*pathIndexes[i+2],ty0=path[0+x2]-dx,tx1=path[1+x2]-dy,ty1=path[0+ty2]-dx,tx2=path[1+ty2]-dy,x2=path[0+tx0]-dx,ty2=path[1+tx0]-dy,tx0=calcMatrix.getX(ty0,tx1),ty0=calcMatrix.getY(ty0,tx1),tx1=calcMatrix.getX(ty1,tx2),ty1=calcMatrix.getY(ty1,tx2),tx2=calcMatrix.getX(x2,ty2),ty2=calcMatrix.getY(x2,ty2);pipeline.batchTri(src,tx0,ty0,tx1,ty1,tx2,ty2,0,0,1,1,fillTintColor,fillTintColor,fillTintColor,2)}},Utils$a=GetProps_1,Clone_1$4=function(pipeline,src,strokeTintColor,dx,dy){var strokeTint=pipeline.strokeTint,strokeTintColor=Utils$a.getTintAppendFloatAlpha(src.strokeColor,src.strokeAlpha*strokeTintColor);strokeTint.TL=strokeTintColor,strokeTint.TR=strokeTintColor,strokeTint.BL=strokeTintColor,strokeTint.BR=strokeTintColor;var path=src.pathData,pathLength=path.length-1,lineWidth=src.lineWidth,halfLineWidth=lineWidth/2,px1=path[0]-dx,py1=path[1]-dy;src.closePath||(pathLength-=2);for(var i=2;i<pathLength;i+=2){var px2=path[i]-dx,py2=path[i+1]-dy;pipeline.batchLine(px1,py1,px2,py2,halfLineWidth,halfLineWidth,lineWidth,i-2,!!src.closePath&&i===pathLength-1),px1=px2,py1=py2}},GetCalcMatrix$e=GetCalcMatrix_1,FillPathWebGL$4=CircumCenter_1,StrokePathWebGL$6=Clone_1$4,Parse2DArray_1=function(ctx,fillAlpha,fillColor,altAlpha){fillColor=fillColor||fillAlpha.fillColor,fillAlpha=altAlpha||fillAlpha.fillAlpha;ctx.fillStyle="rgba("+((16711680&fillColor)>>>16)+","+((65280&fillColor)>>>8)+","+(255&fillColor)+","+fillAlpha+")"},CenterOn_1=function(ctx,src,strokeColor,strokeAlpha){strokeColor=strokeColor||src.strokeColor,strokeAlpha=strokeAlpha||src.strokeAlpha;ctx.strokeStyle="rgba("+((16711680&strokeColor)>>>16)+","+((65280&strokeColor)>>>8)+","+(255&strokeColor)+","+strokeAlpha+")",ctx.lineWidth=src.lineWidth},DegToRad$5=DegToRad_1,FillStyleCanvas$9=Parse2DArray_1,LineStyleCanvas$8=CenterOn_1,SetTransform$a=parsers,DegToRad$4=DegToRad_1,Earcut$4=AtlasJSONFile_1,GeomCircle=Svg_1,MATH_CONST$8=Tweens,Shape$a=AtlasXMLFile_1,GetNearestPoint_1=new Class_1({Extends:Shape$a,Mixins:[{renderWebGL:function(renderer,src,alpha,dx){alpha.addToRenderList(src);var pipeline=renderer.pipelines.set(src.pipeline),dy=GetCalcMatrix$e(src,alpha,dx),calcMatrix=pipeline.calcMatrix.copyFrom(dy.calc),dx=src._displayOriginX,dy=src._displayOriginY,alpha=alpha.alpha*src.alpha;renderer.pipelines.preBatch(src),src.isFilled&&FillPathWebGL$4(pipeline,calcMatrix,src,alpha,dx,dy),src.isStroked&&StrokePathWebGL$6(pipeline,src,alpha,dx,dy),renderer.pipelines.postBatch(src)},renderCanvas:function(renderer,src,camera,radius){camera.addToRenderList(src);var ctx=renderer.currentContext;SetTransform$a(renderer,ctx,src,camera,radius)&&(radius=src.radius,ctx.beginPath(),ctx.arc(radius-src.originX*(2*radius),radius-src.originY*(2*radius),radius,DegToRad$5(src._startAngle),DegToRad$5(src._endAngle),src.anticlockwise),src.closePath&&ctx.closePath(),src.isFilled&&(FillStyleCanvas$9(ctx,src),ctx.fill()),src.isStroked&&(LineStyleCanvas$8(ctx,src),ctx.stroke()),ctx.restore())}}],initialize:function(scene,x,diameter,radius,startAngle,endAngle,anticlockwise,fillColor,fillAlpha){void 0===x&&(x=0),void 0===diameter&&(diameter=0),void 0===startAngle&&(startAngle=0),void 0===endAngle&&(endAngle=360),void 0===anticlockwise&&(anticlockwise=!1),Shape$a.call(this,scene,"Arc",new GeomCircle(0,0,radius=void 0===radius?128:radius)),this._startAngle=startAngle,this._endAngle=endAngle,this._anticlockwise=anticlockwise,this._iterations=.01,this.setPosition(x,diameter);diameter=2*this.geom.radius;this.setSize(diameter,diameter),void 0!==fillColor&&this.setFillStyle(fillColor,fillAlpha),this.updateDisplayOrigin(),this.updateData()},iterations:{get:function(){return this._iterations},set:function(value){this._iterations=value,this.updateData()}},radius:{get:function(){return this.geom.radius},set:function(diameter){diameter=2*(this.geom.radius=diameter);this.setSize(diameter,diameter),this.updateDisplayOrigin(),this.updateData()}},startAngle:{get:function(){return this._startAngle},set:function(value){this._startAngle=value,this.updateData()}},endAngle:{get:function(){return this._endAngle},set:function(value){this._endAngle=value,this.updateData()}},anticlockwise:{get:function(){return this._anticlockwise},set:function(value){this._anticlockwise=value,this.updateData()}},setRadius:function(value){return this.radius=value,this},setIterations:function(value){return this.iterations=value=void 0===value?.01:value,this},setStartAngle:function(angle,anticlockwise){return this._startAngle=angle,void 0!==anticlockwise&&(this._anticlockwise=anticlockwise),this.updateData()},setEndAngle:function(angle,anticlockwise){return this._endAngle=angle,void 0!==anticlockwise&&(this._anticlockwise=anticlockwise),this.updateData()},updateData:function(){var step=this._iterations,iteration=step,radius=this.geom.radius,startAngle=DegToRad$4(this._startAngle),endAngle=DegToRad$4(this._endAngle),x=radius,y=radius;endAngle-=startAngle,this._anticlockwise?endAngle<-MATH_CONST$8.PI2?endAngle=-MATH_CONST$8.PI2:0<endAngle&&(endAngle=endAngle%MATH_CONST$8.PI2-MATH_CONST$8.PI2):MATH_CONST$8.PI2<endAngle?endAngle=MATH_CONST$8.PI2:endAngle<0&&(endAngle=MATH_CONST$8.PI2+endAngle%MATH_CONST$8.PI2);for(var ta,path=[x+Math.cos(startAngle)*radius,y+Math.sin(startAngle)*radius];iteration<1;)ta=endAngle*iteration+startAngle,path.push(x+Math.cos(ta)*radius,y+Math.sin(ta)*radius),iteration+=step;return ta=endAngle+startAngle,path.push(x+Math.cos(ta)*radius,y+Math.sin(ta)*radius),path.push(x+Math.cos(startAngle)*radius,y+Math.sin(startAngle)*radius),this.pathIndexes=Earcut$4(path),this.pathData=path,this}}),FillPathWebGL$3=CircumCenter_1,GetCalcMatrix$d=GetCalcMatrix_1,StrokePathWebGL$5=Clone_1$4,FillStyleCanvas$8=Parse2DArray_1,LineStyleCanvas$7=CenterOn_1,SetTransform$9=parsers,Earcut$3=AtlasJSONFile_1,Rectangle$h=HasTileAtWorldXY_1,Shape$9=AtlasXMLFile_1,Body_1=new Class_1({Extends:Shape$9,Mixins:[{renderWebGL:function(renderer,src,alpha,dx){alpha.addToRenderList(src);var pipeline=renderer.pipelines.set(src.pipeline),dy=GetCalcMatrix$d(src,alpha,dx),calcMatrix=pipeline.calcMatrix.copyFrom(dy.calc),dx=src._displayOriginX+src._curveBounds.x,dy=src._displayOriginY+src._curveBounds.y,alpha=alpha.alpha*src.alpha;renderer.pipelines.preBatch(src),src.isFilled&&FillPathWebGL$3(pipeline,calcMatrix,src,alpha,dx,dy),src.isStroked&&StrokePathWebGL$5(pipeline,src,alpha,dx,dy),renderer.pipelines.postBatch(src)},renderCanvas:function(renderer,src,px1,py1){px1.addToRenderList(src);var ctx=renderer.currentContext;if(SetTransform$9(renderer,ctx,src,px1,py1)){var dx=src._displayOriginX+src._curveBounds.x,dy=src._displayOriginY+src._curveBounds.y,path=src.pathData,pathLength=path.length-1,px1=path[0]-dx,py1=path[1]-dy;ctx.beginPath(),ctx.moveTo(px1,py1),src.closePath||(pathLength-=2);for(var i=2;i<pathLength;i+=2){var px2=path[i]-dx,py2=path[i+1]-dy;ctx.lineTo(px2,py2)}src.closePath&&ctx.closePath(),src.isFilled&&(FillStyleCanvas$8(ctx,src),ctx.fill()),src.isStroked&&(LineStyleCanvas$7(ctx,src),ctx.stroke()),ctx.restore()}}}],initialize:function(scene,x,y,curve,fillColor,fillAlpha){void 0===x&&(x=0),void 0===y&&(y=0),Shape$9.call(this,scene,"Curve",curve),this._smoothness=32,this._curveBounds=new Rectangle$h,this.closePath=!1,this.setPosition(x,y),void 0!==fillColor&&this.setFillStyle(fillColor,fillAlpha),this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(value){this._smoothness=value,this.updateData()}},setSmoothness:function(value){return this._smoothness=value,this.updateData()},updateData:function(){var bounds=this._curveBounds,smoothness=this._smoothness;this.geom.getBounds(bounds,smoothness),this.setSize(bounds.width,bounds.height),this.updateDisplayOrigin();for(var path=[],points=this.geom.getPoints(smoothness),i=0;i<points.length;i++)path.push(points[i].x,points[i].y);return path.push(points[0].x,points[0].y),this.pathIndexes=Earcut$3(path),this.pathData=path,this}}),FillPathWebGL$2=CircumCenter_1,GetCalcMatrix$c=GetCalcMatrix_1,StrokePathWebGL$4=Clone_1$4,FillStyleCanvas$7=Parse2DArray_1,LineStyleCanvas$6=CenterOn_1,SetTransform$8=parsers,Earcut$2=AtlasJSONFile_1,GeomEllipse=Constraint_1,Shape$8=AtlasXMLFile_1,CustomMain=new Class_1({Extends:Shape$8,Mixins:[{renderWebGL:function(renderer,src,alpha,dx){alpha.addToRenderList(src);var pipeline=renderer.pipelines.set(src.pipeline),dy=GetCalcMatrix$c(src,alpha,dx),calcMatrix=pipeline.calcMatrix.copyFrom(dy.calc),dx=src._displayOriginX,dy=src._displayOriginY,alpha=alpha.alpha*src.alpha;renderer.pipelines.preBatch(src),src.isFilled&&FillPathWebGL$2(pipeline,calcMatrix,src,alpha,dx,dy),src.isStroked&&StrokePathWebGL$4(pipeline,src,alpha,dx,dy),renderer.pipelines.postBatch(src)},renderCanvas:function(renderer,src,px1,py1){px1.addToRenderList(src);var ctx=renderer.currentContext;if(SetTransform$8(renderer,ctx,src,px1,py1)){var dx=src._displayOriginX,dy=src._displayOriginY,path=src.pathData,pathLength=path.length-1,px1=path[0]-dx,py1=path[1]-dy;ctx.beginPath(),ctx.moveTo(px1,py1),src.closePath||(pathLength-=2);for(var i=2;i<pathLength;i+=2){var px2=path[i]-dx,py2=path[i+1]-dy;ctx.lineTo(px2,py2)}ctx.closePath(),src.isFilled&&(FillStyleCanvas$7(ctx,src),ctx.fill()),src.isStroked&&(LineStyleCanvas$6(ctx,src),ctx.stroke()),ctx.restore()}}}],initialize:function(scene,x,y,width,height,fillColor,fillAlpha){void 0===x&&(x=0),void 0===y&&(y=0),Shape$8.call(this,scene,"Ellipse",new GeomEllipse((width=void 0===width?128:width)/2,(height=void 0===height?128:height)/2,width,height)),this._smoothness=64,this.setPosition(x,y),this.width=width,this.height=height,void 0!==fillColor&&this.setFillStyle(fillColor,fillAlpha),this.updateDisplayOrigin(),this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(value){this._smoothness=value,this.updateData()}},setSize:function(width,height){return this.width=width,this.height=height,this.geom.setPosition(width/2,height/2),this.geom.setSize(width,height),this.updateData()},setSmoothness:function(value){return this._smoothness=value,this.updateData()},updateData:function(){for(var path=[],points=this.geom.getPoints(this._smoothness),i=0;i<points.length;i++)path.push(points[i].x,points[i].y);return path.push(points[0].x,points[0].y),this.pathIndexes=Earcut$2(path),this.pathData=path,this}}),GetCalcMatrix$b=GetCalcMatrix_1,Utils$9=GetProps_1,FillStyleCanvas$6=Parse2DArray_1,LineStyleCanvas$5=CenterOn_1,SetTransform$7=parsers,Shape$7=AtlasXMLFile_1,HTMLTextureFile_1=new Class_1({Extends:Shape$7,Mixins:[{renderWebGL:function(renderer,src,strokeTint,color){strokeTint.addToRenderList(src);var pipeline=renderer.pipelines.set(src.pipeline),showCells=GetCalcMatrix$b(src,strokeTint,color);pipeline.calcMatrix.copyFrom(showCells.calc).translate(-src._displayOriginX,-src._displayOriginY);var fillTint,fillTintColor,color=strokeTint.alpha*src.alpha,width=src.width,height=src.height,cellWidth=src.cellWidth,cellHeight=src.cellHeight,gridWidth=Math.ceil(width/cellWidth),gridHeight=Math.ceil(height/cellHeight),cellWidthA=cellWidth,cellHeightA=cellHeight,cellWidthB=cellWidth-(gridWidth*cellWidth-width),cellHeightB=cellHeight-(gridHeight*cellHeight-height),showCells=src.showCells,showAltCells=src.showAltCells,strokeTint=src.showOutline,x=0,y=0,r=0;if(strokeTint&&(cellWidthA--,cellHeightA--,cellWidthB===cellWidth&&cellWidthB--,cellHeightB===cellHeight&&cellHeightB--),renderer.pipelines.preBatch(src),showCells&&0<src.fillAlpha)for(fillTint=pipeline.fillTint,fillTintColor=Utils$9.getTintAppendFloatAlpha(src.fillColor,src.fillAlpha*color),fillTint.TL=fillTintColor,fillTint.TR=fillTintColor,fillTint.BL=fillTintColor,fillTint.BR=fillTintColor,y=0;y<gridHeight;y++)for(showAltCells&&(r=y%2),x=0;x<gridWidth;x++)showAltCells&&r?r=0:(r++,pipeline.batchFillRect(x*cellWidth,y*cellHeight,x<gridWidth-1?cellWidthA:cellWidthB,y<gridHeight-1?cellHeightA:cellHeightB));if(showAltCells&&0<src.altFillAlpha)for(fillTint=pipeline.fillTint,fillTintColor=Utils$9.getTintAppendFloatAlpha(src.altFillColor,src.altFillAlpha*color),fillTint.TL=fillTintColor,fillTint.TR=fillTintColor,fillTint.BL=fillTintColor,fillTint.BR=fillTintColor,y=0;y<gridHeight;y++)for(showAltCells&&(r=y%2),x=0;x<gridWidth;x++)!showAltCells||r?(r=0,pipeline.batchFillRect(x*cellWidth,y*cellHeight,x<gridWidth-1?cellWidthA:cellWidthB,y<gridHeight-1?cellHeightA:cellHeightB)):r=1;if(strokeTint&&0<src.outlineFillAlpha){strokeTint=pipeline.strokeTint,color=Utils$9.getTintAppendFloatAlpha(src.outlineFillColor,src.outlineFillAlpha*color);for(strokeTint.TL=color,strokeTint.TR=color,strokeTint.BL=color,strokeTint.BR=color,x=1;x<gridWidth;x++){var x1=x*cellWidth;pipeline.batchLine(x1,0,x1,height,1,1,1,0,!1)}for(y=1;y<gridHeight;y++){var y1=y*cellHeight;pipeline.batchLine(0,y1,width,y1,1,1,1,0,!1)}}renderer.pipelines.postBatch(src)},renderCanvas:function(alpha,src,showOutline,showCells){showOutline.addToRenderList(src);var ctx=alpha.currentContext;if(SetTransform$7(alpha,ctx,src,showOutline,showCells)){var dx=-src._displayOriginX,dy=-src._displayOriginY,alpha=showOutline.alpha*src.alpha,width=src.width,height=src.height,cellWidth=src.cellWidth,cellHeight=src.cellHeight,gridWidth=Math.ceil(width/cellWidth),gridHeight=Math.ceil(height/cellHeight),cellWidthA=cellWidth,cellHeightA=cellHeight,cellWidthB=cellWidth-(gridWidth*cellWidth-width),cellHeightB=cellHeight-(gridHeight*cellHeight-height),showCells=src.showCells,showAltCells=src.showAltCells,showOutline=src.showOutline,x=0,y=0,r=0;if(showOutline&&(cellWidthA--,cellHeightA--,cellWidthB===cellWidth&&cellWidthB--,cellHeightB===cellHeight&&cellHeightB--),showCells&&0<src.fillAlpha)for(FillStyleCanvas$6(ctx,src),y=0;y<gridHeight;y++)for(showAltCells&&(r=y%2),x=0;x<gridWidth;x++)showAltCells&&r?r=0:(r++,ctx.fillRect(dx+x*cellWidth,dy+y*cellHeight,x<gridWidth-1?cellWidthA:cellWidthB,y<gridHeight-1?cellHeightA:cellHeightB));if(showAltCells&&0<src.altFillAlpha)for(FillStyleCanvas$6(ctx,src,src.altFillColor,src.altFillAlpha*alpha),y=0;y<gridHeight;y++)for(showAltCells&&(r=y%2),x=0;x<gridWidth;x++)!showAltCells||r?(r=0,ctx.fillRect(dx+x*cellWidth,dy+y*cellHeight,x<gridWidth-1?cellWidthA:cellWidthB,y<gridHeight-1?cellHeightA:cellHeightB)):r=1;if(showOutline&&0<src.outlineFillAlpha){for(LineStyleCanvas$5(ctx,src,src.outlineFillColor,src.outlineFillAlpha*alpha),x=1;x<gridWidth;x++){var x1=x*cellWidth;ctx.beginPath(),ctx.moveTo(x1+dx,dy),ctx.lineTo(x1+dx,height+dy),ctx.stroke()}for(y=1;y<gridHeight;y++){var y1=y*cellHeight;ctx.beginPath(),ctx.moveTo(dx,y1+dy),ctx.lineTo(dx+width,y1+dy),ctx.stroke()}}ctx.restore()}}}],initialize:function(scene,x,y,width,height,cellWidth,cellHeight,fillColor,fillAlpha,outlineFillColor,outlineFillAlpha){void 0===x&&(x=0),void 0===y&&(y=0),void 0===width&&(width=128),void 0===height&&(height=128),void 0===cellWidth&&(cellWidth=32),void 0===cellHeight&&(cellHeight=32),Shape$7.call(this,scene,"Grid",null),this.cellWidth=cellWidth,this.cellHeight=cellHeight,this.showCells=!0,this.outlineFillColor=0,this.outlineFillAlpha=0,this.showOutline=!0,this.showAltCells=!1,this.altFillColor,this.altFillAlpha,this.setPosition(x,y),this.setSize(width,height),this.setFillStyle(fillColor,fillAlpha),void 0!==outlineFillColor&&this.setOutlineStyle(outlineFillColor,outlineFillAlpha),this.updateDisplayOrigin()},setFillStyle:function(fillColor,fillAlpha){return void 0===fillAlpha&&(fillAlpha=1),void 0===fillColor?this.showCells=!1:(this.fillColor=fillColor,this.fillAlpha=fillAlpha,this.showCells=!0),this},setAltFillStyle:function(fillColor,fillAlpha){return void 0===fillAlpha&&(fillAlpha=1),void 0===fillColor?this.showAltCells=!1:(this.altFillColor=fillColor,this.altFillAlpha=fillAlpha,this.showAltCells=!0),this},setOutlineStyle:function(fillColor,fillAlpha){return void 0===fillAlpha&&(fillAlpha=1),void 0===fillColor?this.showOutline=!1:(this.outlineFillColor=fillColor,this.outlineFillAlpha=fillAlpha,this.showOutline=!0),this}}),GetCalcMatrix$a=GetCalcMatrix_1,Utils$8=GetProps_1,FillStyleCanvas$5=Parse2DArray_1,SetTransform$6=parsers,Shape$6=AtlasXMLFile_1,BitmapFontFile_1=new Class_1({Extends:Shape$6,Mixins:[{renderWebGL:function(renderer,src,alpha,height){alpha.addToRenderList(src);var tint,x0,y0,x1,y1,x2,y2,x3,y3,pipeline=renderer.pipelines.set(src.pipeline),sizeA=GetCalcMatrix$a(src,alpha,height),calcMatrix=pipeline.calcMatrix.copyFrom(sizeA.calc),sizeB=src.width,height=src.height,sizeA=sizeB/2,sizeB=sizeB/src.projection,alpha=alpha.alpha*src.alpha;src.isFilled&&(renderer.pipelines.preBatch(src),src.showTop&&(tint=Utils$8.getTintAppendFloatAlpha(src.fillTop,alpha),x0=calcMatrix.getX(-sizeA,-height),y0=calcMatrix.getY(-sizeA,-height),x1=calcMatrix.getX(0,-sizeB-height),y1=calcMatrix.getY(0,-sizeB-height),x2=calcMatrix.getX(sizeA,-height),y2=calcMatrix.getY(sizeA,-height),x3=calcMatrix.getX(0,sizeB-height),y3=calcMatrix.getY(0,sizeB-height),pipeline.batchQuad(src,x0,y0,x1,y1,x2,y2,x3,y3,0,0,1,1,tint,tint,tint,tint,2)),src.showLeft&&(tint=Utils$8.getTintAppendFloatAlpha(src.fillLeft,alpha),x0=calcMatrix.getX(-sizeA,0),y0=calcMatrix.getY(-sizeA,0),x1=calcMatrix.getX(0,sizeB),y1=calcMatrix.getY(0,sizeB),x2=calcMatrix.getX(0,sizeB-height),y2=calcMatrix.getY(0,sizeB-height),x3=calcMatrix.getX(-sizeA,-height),y3=calcMatrix.getY(-sizeA,-height),pipeline.batchQuad(src,x0,y0,x1,y1,x2,y2,x3,y3,0,0,1,1,tint,tint,tint,tint,2)),src.showRight&&(tint=Utils$8.getTintAppendFloatAlpha(src.fillRight,alpha),x0=calcMatrix.getX(sizeA,0),y0=calcMatrix.getY(sizeA,0),x1=calcMatrix.getX(0,sizeB),y1=calcMatrix.getY(0,sizeB),x2=calcMatrix.getX(0,sizeB-height),y2=calcMatrix.getY(0,sizeB-height),x3=calcMatrix.getX(sizeA,-height),y3=calcMatrix.getY(sizeA,-height),pipeline.batchQuad(src,x0,y0,x1,y1,x2,y2,x3,y3,0,0,1,1,tint,tint,tint,tint,2)),renderer.pipelines.postBatch(src))},renderCanvas:function(sizeB,src,height,sizeA){height.addToRenderList(src);var ctx=sizeB.currentContext;SetTransform$6(sizeB,ctx,src,height,sizeA)&&src.isFilled&&(sizeB=src.width,height=src.height,sizeA=sizeB/2,sizeB=sizeB/src.projection,src.showTop&&(FillStyleCanvas$5(ctx,src,src.fillTop),ctx.beginPath(),ctx.moveTo(-sizeA,-height),ctx.lineTo(0,-sizeB-height),ctx.lineTo(sizeA,-height),ctx.lineTo(sizeA,-1),ctx.lineTo(0,sizeB-1),ctx.lineTo(-sizeA,-1),ctx.lineTo(-sizeA,-height),ctx.fill()),src.showLeft&&(FillStyleCanvas$5(ctx,src,src.fillLeft),ctx.beginPath(),ctx.moveTo(-sizeA,0),ctx.lineTo(0,sizeB),ctx.lineTo(0,sizeB-height),ctx.lineTo(-sizeA,-height),ctx.lineTo(-sizeA,0),ctx.fill()),src.showRight&&(FillStyleCanvas$5(ctx,src,src.fillRight),ctx.beginPath(),ctx.moveTo(sizeA,0),ctx.lineTo(0,sizeB),ctx.lineTo(0,sizeB-height),ctx.lineTo(sizeA,-height),ctx.lineTo(sizeA,0),ctx.fill()),ctx.restore())}}],initialize:function(scene,x,y,size,height,fillTop,fillLeft,fillRight){void 0===x&&(x=0),void 0===y&&(y=0),void 0===size&&(size=48),void 0===height&&(height=32),void 0===fillTop&&(fillTop=15658734),void 0===fillLeft&&(fillLeft=10066329),void 0===fillRight&&(fillRight=13421772),Shape$6.call(this,scene,"IsoBox",null),this.projection=4,this.fillTop=fillTop,this.fillLeft=fillLeft,this.fillRight=fillRight,this.showTop=!0,this.showLeft=!0,this.showRight=!0,this.isFilled=!0,this.setPosition(x,y),this.setSize(size,height),this.updateDisplayOrigin()},setProjection:function(value){return this.projection=value,this},setFaces:function(showTop,showLeft,showRight){return void 0===showLeft&&(showLeft=!0),void 0===showRight&&(showRight=!0),this.showTop=showTop=void 0===showTop?!0:showTop,this.showLeft=showLeft,this.showRight=showRight,this},setFillStyle:function(fillTop,fillLeft,fillRight){return this.fillTop=fillTop,this.fillLeft=fillLeft,this.fillRight=fillRight,this.isFilled=!0,this}}),GetCalcMatrix$9=GetCalcMatrix_1,Utils$7=GetProps_1,FillStyleCanvas$4=Parse2DArray_1,SetTransform$5=parsers,Shape$5=AtlasXMLFile_1,Events_1=new Class_1({Extends:Shape$5,Mixins:[{renderWebGL:function(renderer,src,y3,reversed){y3.addToRenderList(src);var tint,x0,y0,x1,y1,x2,y2,pipeline=renderer.pipelines.set(src.pipeline),alpha=GetCalcMatrix$9(src,y3,reversed),calcMatrix=pipeline.calcMatrix.copyFrom(alpha.calc),x3=src.width,height=src.height,sizeA=x3/2,sizeB=x3/src.projection,reversed=src.isReversed,alpha=y3.alpha*src.alpha;src.isFilled&&(renderer.pipelines.preBatch(src),src.showTop&&reversed&&(tint=Utils$7.getTintAppendFloatAlpha(src.fillTop,alpha),x0=calcMatrix.getX(-sizeA,-height),y0=calcMatrix.getY(-sizeA,-height),x1=calcMatrix.getX(0,-sizeB-height),y1=calcMatrix.getY(0,-sizeB-height),x2=calcMatrix.getX(sizeA,-height),y2=calcMatrix.getY(sizeA,-height),x3=calcMatrix.getX(0,sizeB-height),y3=calcMatrix.getY(0,sizeB-height),pipeline.batchQuad(src,x0,y0,x1,y1,x2,y2,x3,y3,0,0,1,1,tint,tint,tint,tint,2)),src.showLeft&&(tint=Utils$7.getTintAppendFloatAlpha(src.fillLeft,alpha),y2=(x2=(y1=(x1=(y0=reversed?(x0=calcMatrix.getX(-sizeA,-height),calcMatrix.getY(-sizeA,-height)):(x0=calcMatrix.getX(-sizeA,0),calcMatrix.getY(-sizeA,0)),calcMatrix.getX(0,sizeB)),calcMatrix.getY(0,sizeB)),calcMatrix.getX(0,sizeB-height)),calcMatrix.getY(0,sizeB-height)),pipeline.batchTri(src,x0,y0,x1,y1,x2,y2,0,0,1,1,tint,tint,tint,2)),src.showRight&&(tint=Utils$7.getTintAppendFloatAlpha(src.fillRight,alpha),y2=(x2=(y1=(x1=(y0=reversed?(x0=calcMatrix.getX(sizeA,-height),calcMatrix.getY(sizeA,-height)):(x0=calcMatrix.getX(sizeA,0),calcMatrix.getY(sizeA,0)),calcMatrix.getX(0,sizeB)),calcMatrix.getY(0,sizeB)),calcMatrix.getX(0,sizeB-height)),calcMatrix.getY(0,sizeB-height)),pipeline.batchTri(src,x0,y0,x1,y1,x2,y2,0,0,1,1,tint,tint,tint,2)),renderer.pipelines.postBatch(src))},renderCanvas:function(height,src,sizeA,sizeB){sizeA.addToRenderList(src);var reversed,ctx=height.currentContext;SetTransform$5(height,ctx,src,sizeA,sizeB)&&src.isFilled&&(reversed=src.width,height=src.height,sizeA=reversed/2,sizeB=reversed/src.projection,reversed=src.isReversed,src.showTop&&reversed&&(FillStyleCanvas$4(ctx,src,src.fillTop),ctx.beginPath(),ctx.moveTo(-sizeA,-height),ctx.lineTo(0,-sizeB-height),ctx.lineTo(sizeA,-height),ctx.lineTo(0,sizeB-height),ctx.fill()),src.showLeft&&(FillStyleCanvas$4(ctx,src,src.fillLeft),ctx.beginPath(),reversed?ctx.moveTo(-sizeA,-height):ctx.moveTo(-sizeA,0),ctx.lineTo(0,sizeB),ctx.lineTo(0,sizeB-height),ctx.fill()),src.showRight&&(FillStyleCanvas$4(ctx,src,src.fillRight),ctx.beginPath(),reversed?ctx.moveTo(sizeA,-height):ctx.moveTo(sizeA,0),ctx.lineTo(0,sizeB),ctx.lineTo(0,sizeB-height),ctx.fill()),ctx.restore())}}],initialize:function(scene,x,y,size,height,reversed,fillTop,fillLeft,fillRight){void 0===x&&(x=0),void 0===y&&(y=0),void 0===size&&(size=48),void 0===height&&(height=32),void 0===reversed&&(reversed=!1),void 0===fillTop&&(fillTop=15658734),void 0===fillLeft&&(fillLeft=10066329),void 0===fillRight&&(fillRight=13421772),Shape$5.call(this,scene,"IsoTriangle",null),this.projection=4,this.fillTop=fillTop,this.fillLeft=fillLeft,this.fillRight=fillRight,this.showTop=!0,this.showLeft=!0,this.showRight=!0,this.isReversed=reversed,this.isFilled=!0,this.setPosition(x,y),this.setSize(size,height),this.updateDisplayOrigin()},setProjection:function(value){return this.projection=value,this},setReversed:function(reversed){return this.isReversed=reversed,this},setFaces:function(showTop,showLeft,showRight){return void 0===showLeft&&(showLeft=!0),void 0===showRight&&(showRight=!0),this.showTop=showTop=void 0===showTop?!0:showTop,this.showLeft=showLeft,this.showRight=showRight,this},setFillStyle:function(fillTop,fillLeft,fillRight){return this.fillTop=fillTop,this.fillLeft=fillLeft,this.fillRight=fillRight,this.isFilled=!0,this}}),GetCalcMatrix$8=GetCalcMatrix_1,Utils$6=GetProps_1,LineStyleCanvas$4=CenterOn_1,SetTransform$4=parsers,Shape$4=AtlasXMLFile_1,GeomLine=Floor_1,Decompose_1$1=new Class_1({Extends:Shape$4,Mixins:[{renderWebGL:function(renderer,src,startWidth,endWidth){startWidth.addToRenderList(src);var pipeline=renderer.pipelines.set(src.pipeline),result=GetCalcMatrix$8(src,startWidth,endWidth);pipeline.calcMatrix.copyFrom(result.calc);var dx=src._displayOriginX,dy=src._displayOriginY,endWidth=startWidth.alpha*src.alpha;renderer.pipelines.preBatch(src),src.isStroked&&(startWidth=pipeline.strokeTint,endWidth=Utils$6.getTintAppendFloatAlpha(src.strokeColor,src.strokeAlpha*endWidth),startWidth.TL=endWidth,startWidth.TR=endWidth,startWidth.BL=endWidth,startWidth.BR=endWidth,startWidth=src._startWidth,endWidth=src._endWidth,pipeline.batchLine(src.geom.x1-dx,src.geom.y1-dy,src.geom.x2-dx,src.geom.y2-dy,startWidth,endWidth,1,0,!1,result.sprite,result.camera)),renderer.pipelines.postBatch(src)},renderCanvas:function(renderer,src,dx,dy){dx.addToRenderList(src);var ctx=renderer.currentContext;SetTransform$4(renderer,ctx,src,dx,dy)&&(dx=src._displayOriginX,dy=src._displayOriginY,src.isStroked&&(LineStyleCanvas$4(ctx,src),ctx.beginPath(),ctx.moveTo(src.geom.x1-dx,src.geom.y1-dy),ctx.lineTo(src.geom.x2-dx,src.geom.y2-dy),ctx.stroke()),ctx.restore())}}],initialize:function(scene,x,y,x1,y1,width,height,strokeColor,strokeAlpha){void 0===x&&(x=0),void 0===y&&(y=0),Shape$4.call(this,scene,"Line",new GeomLine(x1=void 0===x1?0:x1,y1=void 0===y1?0:y1,width=void 0===width?128:width,height=void 0===height?0:height));width=Math.max(1,this.geom.right-this.geom.left),height=Math.max(1,this.geom.bottom-this.geom.top);this.lineWidth=1,this._startWidth=1,this._endWidth=1,this.setPosition(x,y),this.setSize(width,height),void 0!==strokeColor&&this.setStrokeStyle(1,strokeColor,strokeAlpha),this.updateDisplayOrigin()},setLineWidth:function(startWidth,endWidth){return void 0===endWidth&&(endWidth=startWidth),this._startWidth=startWidth,this._endWidth=endWidth,this.lineWidth=startWidth,this},setTo:function(x1,y1,x2,y2){return this.geom.setTo(x1,y1,x2,y2),this}}),FillPathWebGL$1=CircumCenter_1,GetCalcMatrix$7=GetCalcMatrix_1,StrokePathWebGL$3=Clone_1$4,FillStyleCanvas$3=Parse2DArray_1,LineStyleCanvas$3=CenterOn_1,SetTransform$3=parsers,GetTileAtWorldXY_1={renderWebGL:function(renderer,src,alpha,dx){alpha.addToRenderList(src);var pipeline=renderer.pipelines.set(src.pipeline),dy=GetCalcMatrix$7(src,alpha,dx),calcMatrix=pipeline.calcMatrix.copyFrom(dy.calc),dx=src._displayOriginX,dy=src._displayOriginY,alpha=alpha.alpha*src.alpha;renderer.pipelines.preBatch(src),src.isFilled&&FillPathWebGL$1(pipeline,calcMatrix,src,alpha,dx,dy),src.isStroked&&StrokePathWebGL$3(pipeline,src,alpha,dx,dy),renderer.pipelines.postBatch(src)},renderCanvas:function(renderer,src,px1,py1){px1.addToRenderList(src);var ctx=renderer.currentContext;if(SetTransform$3(renderer,ctx,src,px1,py1)){var dx=src._displayOriginX,dy=src._displayOriginY,path=src.pathData,pathLength=path.length-1,px1=path[0]-dx,py1=path[1]-dy;ctx.beginPath(),ctx.moveTo(px1,py1),src.closePath||(pathLength-=2);for(var i=2;i<pathLength;i+=2){var px2=path[i]-dx,py2=path[i+1]-dy;ctx.lineTo(px2,py2)}ctx.closePath(),src.isFilled&&(FillStyleCanvas$3(ctx,src),ctx.fill()),src.isStroked&&(LineStyleCanvas$3(ctx,src),ctx.stroke()),ctx.restore()}}},Rectangle$g=HasTileAtWorldXY_1,BuildFromPolygon_1=function(polygon,out){void 0===out&&(out=new Rectangle$g);for(var p,minX=1/0,minY=1/0,maxX=-minX,maxY=-minY,i=0;i<polygon.points.length;i++)p=polygon.points[i],minX=Math.min(minX,p.x),minY=Math.min(minY,p.y),maxX=Math.max(maxX,p.x),maxY=Math.max(maxY,p.y);return out.x=minX,out.y=minY,out.width=maxX-minX,out.height=maxY-minY,out},Inflate_1=function(polygon,x,y){for(var inside=!1,i=-1,j=polygon.points.length-1;++i<polygon.points.length;j=i){var ix=polygon.points[i].x,iy=polygon.points[i].y,jx=polygon.points[j].x,jy=polygon.points[j].y;(iy<=y&&y<jy||jy<=y&&y<iy)&&x<(jx-ix)*(y-iy)/(jy-iy)+ix&&(inside=!inside)}return inside},Length$5=Grid_1,Line$7=Floor_1,plugins=function(polygon){for(var points=polygon.points,perimeter=0,i=0;i<points.length;i++){var pointA=points[i],line=points[(i+1)%points.length],line=new Line$7(pointA.x,pointA.y,line.x,line.y);perimeter+=Length$5(line)}return perimeter},Length$4=Grid_1,Line$6=Floor_1,Perimeter$1=plugins,Centroid_1=function(polygon,quantity,stepRate,out){void 0===out&&(out=[]);var points=polygon.points,perimeter=Perimeter$1(polygon);!quantity&&0<stepRate&&(quantity=perimeter/stepRate);for(var i=0;i<quantity;i++)for(var position=perimeter*(i/quantity),accumulatedPerimeter=0,j=0;j<points.length;j++){var point=points[j],length=points[(j+1)%points.length],point=new Line$6(point.x,point.y,length.x,length.y),length=Length$4(point);if(!(position<accumulatedPerimeter||accumulatedPerimeter+length<position)){point=point.getPoint((position-accumulatedPerimeter)/length);out.push(point);break}accumulatedPerimeter+=length}return out},Contains$c=Inflate_1,GetPoints$2=Centroid_1,GEOM_CONST$2=loader,GetCenter_1=new Class_1({initialize:function(points){this.type=GEOM_CONST$2.POLYGON,this.area=0,this.points=[],points&&this.setTo(points)},contains:function(x,y){return Contains$c(this,x,y)},setTo:function(points){if(this.area=0,this.points=[],"string"==typeof points&&(points=points.split(" ")),!Array.isArray(points))return this;for(var p,y0=Number.MAX_VALUE,i=0;i<points.length;i++)p={x:0,y:0},"number"==typeof points[i]||"string"==typeof points[i]?(p.x=parseFloat(points[i]),p.y=parseFloat(points[i+1]),i++):Array.isArray(points[i])?(p.x=points[i][0],p.y=points[i][1]):(p.x=points[i].x,p.y=points[i].y),this.points.push(p),p.y<y0&&(y0=p.y);return this.calculateArea(y0),this},calculateArea:function(){if(this.points.length<3)return this.area=0,this.area;for(var p1,p2,sum=0,i=0;i<this.points.length-1;i++)p1=this.points[i],sum+=((p2=this.points[i+1]).x-p1.x)*(p1.y+p2.y);return p1=this.points[0],p2=this.points[this.points.length-1],sum+=(p1.x-p2.x)*(p2.y+p1.y),this.area=.5*-sum,this.area},getPoints:function(quantity,step,output){return GetPoints$2(this,quantity,step,output)}}),AsepriteFile_1=function(polygon){for(var points=[],data=polygon.points,i=0;i<data.length;i++)points.push([data[i].x,data[i].y]);var output=[];for(0<points.length&&output.push(copy([0,0],points[0])),i=0;i<points.length-1;i++){var p1x=points[i],p1y=points[i+1],p0x=p1x[0],p0y=p1x[1],p1x=p1y[0],p1y=p1y[1];output.push([.85*p0x+.15*p1x,.85*p0y+.15*p1y]),output.push([.15*p0x+.85*p1x,.15*p0y+.85*p1y])}return 1<points.length&&output.push(copy([0,0],points[points.length-1])),polygon.setTo(output)},Earcut$1=AtlasJSONFile_1,GetAABB=BuildFromPolygon_1,GeomPolygon=GetCenter_1,Shape$3=AtlasXMLFile_1,Smooth=AsepriteFile_1,AnimationJSONFile_1=new Class_1({Extends:Shape$3,Mixins:[GetTileAtWorldXY_1],initialize:function(scene,x,y,bounds,fillColor,fillAlpha){void 0===x&&(x=0),void 0===y&&(y=0),Shape$3.call(this,scene,"Polygon",new GeomPolygon(bounds));bounds=GetAABB(this.geom);this.setPosition(x,y),this.setSize(bounds.width,bounds.height),void 0!==fillColor&&this.setFillStyle(fillColor,fillAlpha),this.updateDisplayOrigin(),this.updateData()},smooth:function(iterations){void 0===iterations&&(iterations=1);for(var i=0;i<iterations;i++)Smooth(this.geom);return this.updateData()},updateData:function(){for(var path=[],points=this.geom.points,i=0;i<points.length;i++)path.push(points[i].x,points[i].y);return path.push(points[0].x,points[0].y),this.pathIndexes=Earcut$1(path),this.pathData=path,this}}),GetCalcMatrix$6=GetCalcMatrix_1,StrokePathWebGL$2=Clone_1$4,Utils$5=GetProps_1,FillStyleCanvas$2=Parse2DArray_1,LineStyleCanvas$2=CenterOn_1,SetTransform$2=parsers,GeomRectangle=HasTileAtWorldXY_1,Shape$2=AtlasXMLFile_1,GetAspectRatio_1=new Class_1({Extends:Shape$2,Mixins:[{renderWebGL:function(renderer,src,fillTintColor,alpha){fillTintColor.addToRenderList(src);var pipeline=renderer.pipelines.set(src.pipeline),fillTint=GetCalcMatrix$6(src,fillTintColor,alpha);pipeline.calcMatrix.copyFrom(fillTint.calc);var dx=src._displayOriginX,dy=src._displayOriginY,alpha=fillTintColor.alpha*src.alpha;renderer.pipelines.preBatch(src),src.isFilled&&(fillTint=pipeline.fillTint,fillTintColor=Utils$5.getTintAppendFloatAlpha(src.fillColor,src.fillAlpha*alpha),fillTint.TL=fillTintColor,fillTint.TR=fillTintColor,fillTint.BL=fillTintColor,fillTint.BR=fillTintColor,pipeline.batchFillRect(-dx,-dy,src.width,src.height)),src.isStroked&&StrokePathWebGL$2(pipeline,src,alpha,dx,dy),renderer.pipelines.postBatch(src)},renderCanvas:function(renderer,src,dx,dy){dx.addToRenderList(src);var ctx=renderer.currentContext;SetTransform$2(renderer,ctx,src,dx,dy)&&(dx=src._displayOriginX,dy=src._displayOriginY,src.isFilled&&(FillStyleCanvas$2(ctx,src),ctx.fillRect(-dx,-dy,src.width,src.height)),src.isStroked&&(LineStyleCanvas$2(ctx,src),ctx.beginPath(),ctx.rect(-dx,-dy,src.width,src.height),ctx.stroke()),ctx.restore())}}],initialize:function(scene,x,y,width,height,fillColor,fillAlpha){void 0===x&&(x=0),void 0===y&&(y=0),Shape$2.call(this,scene,"Rectangle",new GeomRectangle(0,0,width=void 0===width?128:width,height=void 0===height?128:height)),this.setPosition(x,y),this.setSize(width,height),void 0!==fillColor&&this.setFillStyle(fillColor,fillAlpha),this.updateDisplayOrigin(),this.updateData()},setSize:function(width,height){return this.width=width,this.height=height,this.geom.setSize(width,height),this.updateData(),this},updateData:function(){var path=[],rect=this.geom,line=this._tempLine;return rect.getLineA(line),path.push(line.x1,line.y1,line.x2,line.y2),rect.getLineB(line),path.push(line.x2,line.y2),rect.getLineC(line),path.push(line.x2,line.y2),rect.getLineD(line),path.push(line.x2,line.y2),this.pathData=path,this}}),FillPathWebGL=CircumCenter_1,GetCalcMatrix$5=GetCalcMatrix_1,StrokePathWebGL$1=Clone_1$4,FillStyleCanvas$1=Parse2DArray_1,LineStyleCanvas$1=CenterOn_1,SetTransform$1=parsers,Earcut=AtlasJSONFile_1,Shape$1=AtlasXMLFile_1,BinaryFile_1=new Class_1({Extends:Shape$1,Mixins:[{renderWebGL:function(renderer,src,alpha,dx){alpha.addToRenderList(src);var pipeline=renderer.pipelines.set(src.pipeline),dy=GetCalcMatrix$5(src,alpha,dx),calcMatrix=pipeline.calcMatrix.copyFrom(dy.calc),dx=src._displayOriginX,dy=src._displayOriginY,alpha=alpha.alpha*src.alpha;renderer.pipelines.preBatch(src),src.isFilled&&FillPathWebGL(pipeline,calcMatrix,src,alpha,dx,dy),src.isStroked&&StrokePathWebGL$1(pipeline,src,alpha,dx,dy),renderer.pipelines.postBatch(src)},renderCanvas:function(renderer,src,px1,py1){px1.addToRenderList(src);var ctx=renderer.currentContext;if(SetTransform$1(renderer,ctx,src,px1,py1)){var dx=src._displayOriginX,dy=src._displayOriginY,path=src.pathData,pathLength=path.length-1,px1=path[0]-dx,py1=path[1]-dy;ctx.beginPath(),ctx.moveTo(px1,py1),src.closePath||(pathLength-=2);for(var i=2;i<pathLength;i+=2){var px2=path[i]-dx,py2=path[i+1]-dy;ctx.lineTo(px2,py2)}ctx.closePath(),src.isFilled&&(FillStyleCanvas$1(ctx,src),ctx.fill()),src.isStroked&&(LineStyleCanvas$1(ctx,src),ctx.stroke()),ctx.restore()}}}],initialize:function(scene,x,y,points,innerRadius,outerRadius,fillColor,fillAlpha){void 0===x&&(x=0),void 0===y&&(y=0),void 0===points&&(points=5),void 0===innerRadius&&(innerRadius=32),void 0===outerRadius&&(outerRadius=64),Shape$1.call(this,scene,"Star",null),this._points=points,this._innerRadius=innerRadius,this._outerRadius=outerRadius,this.setPosition(x,y),this.setSize(2*outerRadius,2*outerRadius),void 0!==fillColor&&this.setFillStyle(fillColor,fillAlpha),this.updateDisplayOrigin(),this.updateData()},setPoints:function(value){return this._points=value,this.updateData()},setInnerRadius:function(value){return this._innerRadius=value,this.updateData()},setOuterRadius:function(value){return this._outerRadius=value,this.updateData()},points:{get:function(){return this._points},set:function(value){this._points=value,this.updateData()}},innerRadius:{get:function(){return this._innerRadius},set:function(value){this._innerRadius=value,this.updateData()}},outerRadius:{get:function(){return this._outerRadius},set:function(value){this._outerRadius=value,this.updateData()}},updateData:function(){var path=[],points=this._points,innerRadius=this._innerRadius,outerRadius=this._outerRadius,rot=Math.PI/2*3,step=Math.PI/points,x=outerRadius,y=outerRadius;path.push(x,y+-outerRadius);for(var i=0;i<points;i++)path.push(x+Math.cos(rot)*outerRadius,y+Math.sin(rot)*outerRadius),rot+=step,path.push(x+Math.cos(rot)*innerRadius,y+Math.sin(rot)*innerRadius),rot+=step;return path.push(x,y+-outerRadius),this.pathIndexes=Earcut(path),this.pathData=path,this}}),HTMLFile_1=function(dot01,v,dot00){var dot02=dot01.x3-dot01.x1,u=dot01.y3-dot01.y1,v1x=dot01.x2-dot01.x1,dot12=dot01.y2-dot01.y1,v2x=v-dot01.x1,v=dot00-dot01.y1,dot00=dot02*dot02+u*u,dot01=dot02*v1x+u*dot12,dot02=dot02*v2x+u*v,u=v1x*v1x+dot12*dot12,dot12=v1x*v2x+dot12*v,v=dot00*u-dot01*dot01,v=0==v?0:1/v,u=(u*dot02-dot01*dot12)*v,v=(dot00*dot12-dot01*dot02)*v;return 0<=u&&0<=v&&u+v<1},Point$o=JSONFile_1,Length$3=Grid_1,Composite_1=function(p,localPosition,out){void 0===out&&(out=new Point$o);var line1=p.getLineA(),line2=p.getLineB(),line3=p.getLineC();if(localPosition<=0||1<=localPosition)return out.x=line1.x1,out.y=line1.y1,out;var length1=Length$3(line1),length2=Length$3(line2),length3=Length$3(line3),p=(length1+length2+length3)*localPosition,localPosition=0;return p<length1?(out.x=line1.x1+(line1.x2-line1.x1)*(localPosition=p/length1),out.y=line1.y1+(line1.y2-line1.y1)*localPosition):length1+length2<p?(out.x=line3.x1+(line3.x2-line3.x1)*(localPosition=(p-=length1+length2)/length3),out.y=line3.y1+(line3.y2-line3.y1)*localPosition):(out.x=line2.x1+(line2.x2-line2.x1)*(localPosition=(p-=length1)/length2),out.y=line2.y1+(line2.y2-line2.y1)*localPosition),out},Length$2=Grid_1,Point$n=JSONFile_1,IsInLayerBounds_1=function(triangle,quantity,stepRate,out){void 0===out&&(out=[]);var line1=triangle.getLineA(),line2=triangle.getLineB(),line3=triangle.getLineC(),length1=Length$2(line1),length2=Length$2(line2),length3=Length$2(line3),perimeter=length1+length2+length3;!quantity&&0<stepRate&&(quantity=perimeter/stepRate);for(var i=0;i<quantity;i++){var p=perimeter*(i/quantity),localPosition=0,point=new Point$n;p<length1?(point.x=line1.x1+(line1.x2-line1.x1)*(localPosition=p/length1),point.y=line1.y1+(line1.y2-line1.y1)*localPosition):length1+length2<p?(p-=length1+length2,point.x=line3.x1+(line3.x2-line3.x1)*(localPosition=p/length3),point.y=line3.y1+(line3.y2-line3.y1)*localPosition):(p-=length1,point.x=line2.x1+(line2.x2-line2.x1)*(localPosition=p/length2),point.y=line2.y1+(line2.y2-line2.y1)*localPosition),out.push(point)}return out},Contains$a=HTMLFile_1,GetPoint=Composite_1,GetPoints=IsInLayerBounds_1,GEOM_CONST$1=loader,Line$5=Floor_1,Random=MatterImage_1,Engine_1=new Class_1({initialize:function(x1,y1,x2,y2,x3,y3){void 0===x1&&(x1=0),void 0===y1&&(y1=0),void 0===x2&&(x2=0),void 0===y2&&(y2=0),void 0===x3&&(x3=0),void 0===y3&&(y3=0),this.type=GEOM_CONST$1.TRIANGLE,this.x1=x1,this.y1=y1,this.x2=x2,this.y2=y2,this.x3=x3,this.y3=y3},contains:function(x,y){return Contains$a(this,x,y)},getPoint:function(position,output){return GetPoint(this,position,output)},getPoints:function(quantity,stepRate,output){return GetPoints(this,quantity,stepRate,output)},getRandomPoint:function(point){return Random(this,point)},setTo:function(x1,y1,x2,y2,x3,y3){return void 0===y1&&(y1=0),void 0===x2&&(x2=0),void 0===y2&&(y2=0),void 0===x3&&(x3=0),void 0===y3&&(y3=0),this.x1=x1=void 0===x1?0:x1,this.y1=y1,this.x2=x2,this.y2=y2,this.x3=x3,this.y3=y3,this},getLineA:function(line){return(line=void 0===line?new Line$5:line).setTo(this.x1,this.y1,this.x2,this.y2),line},getLineB:function(line){return(line=void 0===line?new Line$5:line).setTo(this.x2,this.y2,this.x3,this.y3),line},getLineC:function(line){return(line=void 0===line?new Line$5:line).setTo(this.x3,this.y3,this.x1,this.y1),line},left:{get:function(){return Math.min(this.x1,this.x2,this.x3)},set:function(value){var diff=0,diff=this.x1<=this.x2&&this.x1<=this.x3?this.x1-value:this.x2<=this.x1&&this.x2<=this.x3?this.x2-value:this.x3-value;this.x1-=diff,this.x2-=diff,this.x3-=diff}},right:{get:function(){return Math.max(this.x1,this.x2,this.x3)},set:function(value){var diff=0,diff=this.x1>=this.x2&&this.x1>=this.x3?this.x1-value:this.x2>=this.x1&&this.x2>=this.x3?this.x2-value:this.x3-value;this.x1-=diff,this.x2-=diff,this.x3-=diff}},top:{get:function(){return Math.min(this.y1,this.y2,this.y3)},set:function(value){var diff=0,diff=this.y1<=this.y2&&this.y1<=this.y3?this.y1-value:this.y2<=this.y1&&this.y2<=this.y3?this.y2-value:this.y3-value;this.y1-=diff,this.y2-=diff,this.y3-=diff}},bottom:{get:function(){return Math.max(this.y1,this.y2,this.y3)},set:function(value){var diff=0,diff=this.y1>=this.y2&&this.y1>=this.y3?this.y1-value:this.y2>=this.y1&&this.y2>=this.y3?this.y2-value:this.y3-value;this.y1-=diff,this.y2-=diff,this.y3-=diff}}}),GetCalcMatrix$4=GetCalcMatrix_1,StrokePathWebGL=Clone_1$4,Utils$4=GetProps_1,FillStyleCanvas=Parse2DArray_1,LineStyleCanvas=CenterOn_1,SetTransform=parsers,Shape=AtlasXMLFile_1,GeomTriangle=Engine_1,input=new Class_1({Extends:Shape,Mixins:[{renderWebGL:function(renderer,src,y2,x2){y2.addToRenderList(src);var pipeline=renderer.pipelines.set(src.pipeline),result=GetCalcMatrix$4(src,y2,x2);pipeline.calcMatrix.copyFrom(result.calc);var x1,y1,x3,y3,dx=src._displayOriginX,dy=src._displayOriginY,alpha=y2.alpha*src.alpha;renderer.pipelines.preBatch(src),src.isFilled&&(x3=pipeline.fillTint,y3=Utils$4.getTintAppendFloatAlpha(src.fillColor,src.fillAlpha*alpha),x3.TL=y3,x3.TR=y3,x3.BL=y3,x3.BR=y3,x1=src.geom.x1-dx,y1=src.geom.y1-dy,x2=src.geom.x2-dx,y2=src.geom.y2-dy,x3=src.geom.x3-dx,y3=src.geom.y3-dy,pipeline.batchFillTriangle(x1,y1,x2,y2,x3,y3,result.sprite,result.camera)),src.isStroked&&StrokePathWebGL(pipeline,src,alpha,dx,dy),renderer.pipelines.postBatch(src)},renderCanvas:function(y1,src,x2,y2){x2.addToRenderList(src);var x1,x3,y3,ctx=y1.currentContext;SetTransform(y1,ctx,src,x2,y2)&&(x3=src._displayOriginX,y3=src._displayOriginY,x1=src.geom.x1-x3,y1=src.geom.y1-y3,x2=src.geom.x2-x3,y2=src.geom.y2-y3,x3=src.geom.x3-x3,y3=src.geom.y3-y3,ctx.beginPath(),ctx.moveTo(x1,y1),ctx.lineTo(x2,y2),ctx.lineTo(x3,y3),ctx.closePath(),src.isFilled&&(FillStyleCanvas(ctx,src),ctx.fill()),src.isStroked&&(LineStyleCanvas(ctx,src),ctx.stroke()),ctx.restore())}}],initialize:function(scene,x,y,x1,y1,x2,y2,width,height,fillColor,fillAlpha){void 0===x&&(x=0),void 0===y&&(y=0),Shape.call(this,scene,"Triangle",new GeomTriangle(x1=void 0===x1?0:x1,y1=void 0===y1?128:y1,x2=void 0===x2?64:x2,y2=void 0===y2?0:y2,width=void 0===width?128:width,height=void 0===height?128:height));width=this.geom.right-this.geom.left,height=this.geom.bottom-this.geom.top;this.setPosition(x,y),this.setSize(width,height),void 0!==fillColor&&this.setFillStyle(fillColor,fillAlpha),this.updateDisplayOrigin(),this.updateData()},setTo:function(x1,y1,x2,y2,x3,y3){return this.geom.setTo(x1,y1,x2,y2,x3,y3),this.updateData()},updateData:function(){var path=[],tri=this.geom,line=this._tempLine;return tri.getLineA(line),path.push(line.x1,line.y1,line.x2,line.y2),tri.getLineB(line),path.push(line.x2,line.y2),tri.getLineC(line),path.push(line.x2,line.y2),this.pathData=path,this}}),Blitter$1=Blitter_1;Tween_1.register("blitter",function(x,y,key,frame){return this.displayList.add(new Blitter$1(this.scene,x,y,key,frame))});var Container$1=Container_1;Tween_1.register("container",function(x,y,children){return this.displayList.add(new Container$1(this.scene,x,y,children))});var DOMElement=DOMElement_1;Tween_1.register("dom",function(x,y,element,style,gameObject){gameObject=new DOMElement(this.scene,x,y,element,style,gameObject);return this.displayList.add(gameObject),gameObject});var DynamicBitmapText=DynamicBitmapText_1;Tween_1.register("dynamicBitmapText",function(x,y,font,text,size){return this.displayList.add(new DynamicBitmapText(this.scene,x,y,font,text,size))});var Extern=Extern_1;Tween_1.register("extern",function(){var extern=new Extern(this.scene);return this.displayList.add(extern),extern});var Graphics$1=Graphics_1;Tween_1.register("graphics",function(config){return this.displayList.add(new Graphics$1(this.scene,config))});var Group$3=events$1;Tween_1.register("group",function(children,config){return this.updateList.add(new Group$3(this.scene,children,config))});var Image$4=Resolver_1;Tween_1.register("image",function(x,y,key,frame){return this.displayList.add(new Image$4(this.scene,x,y,key,frame))});var Layer$1=Layer_1;Tween_1.register("layer",function(children){return this.displayList.add(new Layer$1(this.scene,children))});var ParticleEmitterManager$1=Equals_1$1;Tween_1.register("particles",function(key,frame,emitters){return this.displayList.add(new ParticleEmitterManager$1(this.scene,key,frame,emitters))});var PathFollower=PathFollower_1;Tween_1.register("follower",function(path,x,y,key,sprite){sprite=new PathFollower(this.scene,path,x,y,key,sprite);return this.displayList.add(sprite),this.updateList.add(sprite),sprite});var RenderTexture$1=RenderTexture_1;Tween_1.register("renderTexture",function(x,y,width,height,key,frame){return this.displayList.add(new RenderTexture$1(this.scene,x,y,width,height,key,frame))});var Rope$1=Rope_1;Tween_1.register("rope",function(x,y,texture,frame,points,horizontal,colors,alphas){return this.displayList.add(new Rope$1(this.scene,x,y,texture,frame,points,horizontal,colors,alphas))});var Sprite$4=time;Tween_1.register("sprite",function(x,y,key,sprite){sprite=new Sprite$4(this.scene,x,y,key,sprite);return this.displayList.add(sprite),sprite});var BitmapText$2=BitmapText_1;Tween_1.register("bitmapText",function(x,y,font,text,size,align){return this.displayList.add(new BitmapText$2(this.scene,x,y,font,text,size,align))});var Text$2=Text_1;Tween_1.register("text",function(x,y,text,style){return this.displayList.add(new Text$2(this.scene,x,y,text,style))});var TileSprite$1=Pair_1;Tween_1.register("tileSprite",function(x,y,width,height,key,frame){return this.displayList.add(new TileSprite$1(this.scene,x,y,width,height,key,frame))});var Zone$1=gameobjects;Tween_1.register("zone",function(x,y,width,height){return this.displayList.add(new Zone$1(this.scene,x,y,width,height))});var Video$1=Ceil_1;Tween_1.register("video",function(x,y,key){return this.displayList.add(new Video$1(this.scene,x,y,key))});var Arc=GetNearestPoint_1,physics=Tween_1;physics.register("arc",function(x,y,radius,startAngle,endAngle,anticlockwise,fillColor,fillAlpha){return this.displayList.add(new Arc(this.scene,x,y,radius,startAngle,endAngle,anticlockwise,fillColor,fillAlpha))}),physics.register("circle",function(x,y,radius,fillColor,fillAlpha){return this.displayList.add(new Arc(this.scene,x,y,radius,0,360,!1,fillColor,fillAlpha))});var Curve=Body_1;Tween_1.register("curve",function(x,y,curve,fillColor,fillAlpha){return this.displayList.add(new Curve(this.scene,x,y,curve,fillColor,fillAlpha))});var Ellipse$3=CustomMain;Tween_1.register("ellipse",function(x,y,width,height,fillColor,fillAlpha){return this.displayList.add(new Ellipse$3(this.scene,x,y,width,height,fillColor,fillAlpha))});var Grid$3=HTMLTextureFile_1;Tween_1.register("grid",function(x,y,width,height,cellWidth,cellHeight,fillColor,fillAlpha,outlineFillColor,outlineFillAlpha){return this.displayList.add(new Grid$3(this.scene,x,y,width,height,cellWidth,cellHeight,fillColor,fillAlpha,outlineFillColor,outlineFillAlpha))});var IsoBox=BitmapFontFile_1;Tween_1.register("isobox",function(x,y,size,height,fillTop,fillLeft,fillRight){return this.displayList.add(new IsoBox(this.scene,x,y,size,height,fillTop,fillLeft,fillRight))});var IsoTriangle=Events_1;Tween_1.register("isotriangle",function(x,y,size,height,reversed,fillTop,fillLeft,fillRight){return this.displayList.add(new IsoTriangle(this.scene,x,y,size,height,reversed,fillTop,fillLeft,fillRight))});var Line$4=Decompose_1$1;Tween_1.register("line",function(x,y,x1,y1,x2,y2,strokeColor,strokeAlpha){return this.displayList.add(new Line$4(this.scene,x,y,x1,y1,x2,y2,strokeColor,strokeAlpha))});var Polygon$2=AnimationJSONFile_1;Tween_1.register("polygon",function(x,y,points,fillColor,fillAlpha){return this.displayList.add(new Polygon$2(this.scene,x,y,points,fillColor,fillAlpha))});var Rectangle$e=GetAspectRatio_1;Tween_1.register("rectangle",function(x,y,width,height,fillColor,fillAlpha){return this.displayList.add(new Rectangle$e(this.scene,x,y,width,height,fillColor,fillAlpha))});var Star=BinaryFile_1;Tween_1.register("star",function(x,y,points,innerRadius,outerRadius,fillColor,fillAlpha){return this.displayList.add(new Star(this.scene,x,y,points,innerRadius,outerRadius,fillColor,fillAlpha))});var Triangle$6=input;Tween_1.register("triangle",function(x,y,x1,y1,x2,y2,x3,y3,fillColor,fillAlpha){return this.displayList.add(new Triangle$6(this.scene,x,y,x1,y1,x2,y2,x3,y3,fillColor,fillAlpha))});var Blitter=Blitter_1,BuildGameObject$e=BuildGameObject_1,GetAdvancedValue$j=GetAdvancedValue_1;TweenManager.register("blitter",function(config,addToScene){var key=GetAdvancedValue$j(config=void 0===config?{}:config,"key",null),blitter=GetAdvancedValue$j(config,"frame",null),blitter=new Blitter(this.scene,0,0,key,blitter);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject$e(this.scene,blitter,config),blitter});var BuildGameObject$d=BuildGameObject_1,Container=Container_1,GetAdvancedValue$i=GetAdvancedValue_1;TweenManager.register("container",function(config,addToScene){var x=GetAdvancedValue$i(config=void 0===config?{}:config,"x",0),y=GetAdvancedValue$i(config,"y",0),container=GetAdvancedValue$i(config,"children",null),container=new Container(this.scene,x,y,container);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject$d(this.scene,container,config),container});var BitmapText$1=DynamicBitmapText_1,BuildGameObject$c=BuildGameObject_1,GetAdvancedValue$h=GetAdvancedValue_1;TweenManager.register("dynamicBitmapText",function(config,addToScene){var font=GetAdvancedValue$h(config=void 0===config?{}:config,"font",""),text=GetAdvancedValue$h(config,"text",""),bitmapText=GetAdvancedValue$h(config,"size",!1),bitmapText=new BitmapText$1(this.scene,0,0,font,text,bitmapText);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject$c(this.scene,bitmapText,config),bitmapText});var Graphics=Graphics_1;TweenManager.register("graphics",function(config,graphics){void 0===config&&(config={}),void 0!==graphics&&(config.add=graphics);graphics=new Graphics(this.scene,config);return config.add&&this.scene.sys.displayList.add(graphics),graphics});var Group$2=events$1;TweenManager.register("group",function(config){return new Group$2(this.scene,null,config)});var BuildGameObject$b=BuildGameObject_1,GetAdvancedValue$g=GetAdvancedValue_1,Image$3=Resolver_1;TweenManager.register("image",function(config,addToScene){var key=GetAdvancedValue$g(config=void 0===config?{}:config,"key",null),image=GetAdvancedValue$g(config,"frame",null),image=new Image$3(this.scene,0,0,key,image);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject$b(this.scene,image,config),image});var BuildGameObject$a=BuildGameObject_1,Layer=Layer_1,GetAdvancedValue$f=GetAdvancedValue_1;TweenManager.register("layer",function(config,addToScene){var layer=GetAdvancedValue$f(config=void 0===config?{}:config,"children",null),layer=new Layer(this.scene,layer);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject$a(this.scene,layer,config),layer});var GetAdvancedValue$e=GetAdvancedValue_1,GetFastValue$U=GetFastValue_1,ParticleEmitterManager=Equals_1$1;TweenManager.register("particles",function(config,addToScene){var key=GetAdvancedValue$e(config=void 0===config?{}:config,"key",null),frame=GetAdvancedValue$e(config,"frame",null),manager=GetFastValue$U(config,"emitters",null),manager=new ParticleEmitterManager(this.scene,key,frame,manager);return void 0!==addToScene&&(config.add=addToScene),(GetFastValue$U(config,"add",!1)?this.displayList:this.updateList).add(manager),manager});var BuildGameObject$9=BuildGameObject_1,GetAdvancedValue$d=GetAdvancedValue_1,RenderTexture=RenderTexture_1;TweenManager.register("renderTexture",function(config,addToScene){var x=GetAdvancedValue$d(config=void 0===config?{}:config,"x",0),y=GetAdvancedValue$d(config,"y",0),width=GetAdvancedValue$d(config,"width",32),height=GetAdvancedValue$d(config,"height",32),key=GetAdvancedValue$d(config,"key",void 0),renderTexture=GetAdvancedValue$d(config,"frame",void 0),renderTexture=new RenderTexture(this.scene,x,y,width,height,key,renderTexture);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject$9(this.scene,renderTexture,config),renderTexture});var BuildGameObject$8=BuildGameObject_1,GetAdvancedValue$c=GetAdvancedValue_1,GetValue$g=GetValue_1,Rope=Rope_1;TweenManager.register("rope",function(config,addToScene){var key=GetAdvancedValue$c(config=void 0===config?{}:config,"key",null),frame=GetAdvancedValue$c(config,"frame",null),horizontal=GetAdvancedValue$c(config,"horizontal",!0),points=GetValue$g(config,"points",void 0),colors=GetValue$g(config,"colors",void 0),rope=GetValue$g(config,"alphas",void 0),rope=new Rope(this.scene,0,0,key,frame,points,horizontal,colors,rope);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject$8(this.scene,rope,config),config.add||this.updateList.add(rope),rope});var BuildGameObject$7=BuildGameObject_1,BuildGameObjectAnimation=BuildGameObjectAnimation_1,GetAdvancedValue$b=GetAdvancedValue_1,Sprite$3=time;TweenManager.register("sprite",function(config,addToScene){var key=GetAdvancedValue$b(config=void 0===config?{}:config,"key",null),sprite=GetAdvancedValue$b(config,"frame",null),sprite=new Sprite$3(this.scene,0,0,key,sprite);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject$7(this.scene,sprite,config),BuildGameObjectAnimation(sprite,config),sprite});var BitmapText=BitmapText_1,BuildGameObject$6=BuildGameObject_1,GetAdvancedValue$a=GetAdvancedValue_1,GetValue$f=GetValue_1;TweenManager.register("bitmapText",function(config,addToScene){var font=GetValue$f(config=void 0===config?{}:config,"font",""),text=GetAdvancedValue$a(config,"text",""),size=GetAdvancedValue$a(config,"size",!1),bitmapText=GetValue$f(config,"align",0),bitmapText=new BitmapText(this.scene,0,0,font,text,size,bitmapText);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject$6(this.scene,bitmapText,config),bitmapText});var BuildGameObject$5=BuildGameObject_1,GetAdvancedValue$9=GetAdvancedValue_1,Text$1=Text_1;TweenManager.register("text",function(config,addToScene){var content=GetAdvancedValue$9(config=void 0===config?{}:config,"text",""),text=GetAdvancedValue$9(config,"style",null),padding=GetAdvancedValue$9(config,"padding",null);null!==padding&&(text.padding=padding);text=new Text$1(this.scene,0,0,content,text);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject$5(this.scene,text,config),text.autoRound=GetAdvancedValue$9(config,"autoRound",!0),text.resolution=GetAdvancedValue$9(config,"resolution",1),text});var BuildGameObject$4=BuildGameObject_1,GetAdvancedValue$8=GetAdvancedValue_1,TileSprite=Pair_1;TweenManager.register("tileSprite",function(config,addToScene){var x=GetAdvancedValue$8(config=void 0===config?{}:config,"x",0),y=GetAdvancedValue$8(config,"y",0),width=GetAdvancedValue$8(config,"width",512),height=GetAdvancedValue$8(config,"height",512),key=GetAdvancedValue$8(config,"key",""),tile=GetAdvancedValue$8(config,"frame",""),tile=new TileSprite(this.scene,x,y,width,height,key,tile);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject$4(this.scene,tile,config),tile});var GetAdvancedValue$7=GetAdvancedValue_1,Zone=gameobjects;TweenManager.register("zone",function(height){var x=GetAdvancedValue$7(height,"x",0),y=GetAdvancedValue$7(height,"y",0),width=GetAdvancedValue$7(height,"width",1),height=GetAdvancedValue$7(height,"height",width);return new Zone(this.scene,x,y,width,height)});var BuildGameObject$3=BuildGameObject_1,GetAdvancedValue$6=GetAdvancedValue_1,Video=Ceil_1;TweenManager.register("video",function(config,addToScene){var video=GetAdvancedValue$6(config=void 0===config?{}:config,"key",null),video=new Video(this.scene,0,0,video);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject$3(this.scene,video,config),config.add||this.updateList.add(video),video});var SetValue_1=function(source,key,value){if(!source||"number"==typeof source)return!1;if(source.hasOwnProperty(key))return source[key]=value,!0;if(-1===key.indexOf("."))return!1;for(var keys=key.split("."),parent=source,prev=source,i=0;i<keys.length;i++){if(!parent.hasOwnProperty(keys[i]))return!1;parent=(prev=parent)[keys[i]]}return prev[keys[keys.length-1]]=value,!0},GetCalcMatrix$3=GetCalcMatrix_1,GameObject$5=GameObject_1,GetFastValue$T=GetFastValue_1,Extend$f=Extend_1$1,SetValue=SetValue_1,TransformMatrix$2=TransformMatrix,FitInside_1=new Class_1({Extends:GameObject$5,Mixins:[components$3.ComputedSize,components$3.Depth,components$3.GetBounds,components$3.Mask,components$3.Origin,components$3.ScrollFactor,components$3.Transform,components$3.Visible,{renderWebGL:function(renderer,src,camera,calcMatrix){src.shader&&(camera.addToRenderList(src),renderer.pipelines.clear(),src.renderToTexture?src.load():(calcMatrix=GetCalcMatrix$3(src,camera,calcMatrix).calc,renderer.width===src._rendererWidth&&renderer.height===src._rendererHeight||src.projOrtho(0,renderer.width,renderer.height,0),src.load(calcMatrix.matrix)),src.flush(),renderer.pipelines.rebind())},renderCanvas:function(){}}],initialize:function(renderer,key,x,y,width,height,textures,textureData){void 0===x&&(x=0),void 0===y&&(y=0),void 0===width&&(width=128),void 0===height&&(height=128),GameObject$5.call(this,renderer,"Shader"),this.blendMode=-1,this.shader;renderer=renderer.sys.renderer;this.renderer=renderer,this.gl=renderer.gl,this.vertexData=new ArrayBuffer(2*Float32Array.BYTES_PER_ELEMENT*6),this.vertexBuffer=renderer.createVertexBuffer(this.vertexData.byteLength,this.gl.STREAM_DRAW),this.program=null,this.bytes=new Uint8Array(this.vertexData),this.vertexViewF32=new Float32Array(this.vertexData),this._tempMatrix1=new TransformMatrix$2,this._tempMatrix2=new TransformMatrix$2,this._tempMatrix3=new TransformMatrix$2,this.viewMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.projectionMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.uniforms={},this.pointer=null,this._rendererWidth=renderer.width,this._rendererHeight=renderer.height,this._textureCount=0,this.framebuffer=null,this.glTexture=null,this.renderToTexture=!1,this.texture=null,this.setPosition(x,y),this.setSize(width,height),this.setOrigin(.5,.5),this.setShader(key,textures,textureData)},willRender:function(camera){return!!this.renderToTexture||!(GameObject$5.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&camera.id)},setRenderToTexture:function(key,flipY){var width,height,renderer;return void 0===flipY&&(flipY=!1),this.renderToTexture||(width=this.width,height=this.height,renderer=this.renderer,this.glTexture=renderer.createTextureFromSource(null,width,height,0),this.glTexture.flipY=flipY,this.framebuffer=renderer.createFramebuffer(width,height,this.glTexture,!1),this._rendererWidth=width,this._rendererHeight=height,this.renderToTexture=!0,this.projOrtho(0,this.width,this.height,0),key&&(this.texture=this.scene.sys.textures.addGLTexture(key,this.glTexture,width,height))),this.shader&&(renderer.pipelines.clear(),this.load(),this.flush(),renderer.pipelines.rebind()),this},setShader:function(defaultUniforms,textures,textureData){if(void 0===textures&&(textures=[]),"string"==typeof defaultUniforms){var gl=this.scene.sys.cache.shader;if(!gl.has(defaultUniforms))return console.warn("Shader missing: "+defaultUniforms),this;this.shader=gl.get(defaultUniforms)}else this.shader=defaultUniforms;gl=this.gl,defaultUniforms=this.renderer;this.program&&gl.deleteProgram(this.program);defaultUniforms=defaultUniforms.createProgram(this.shader.vertexSrc,this.shader.fragmentSrc);gl.uniformMatrix4fv(gl.getUniformLocation(defaultUniforms,"uViewMatrix"),!1,this.viewMatrix),gl.uniformMatrix4fv(gl.getUniformLocation(defaultUniforms,"uProjectionMatrix"),!1,this.projectionMatrix),gl.uniform2f(gl.getUniformLocation(defaultUniforms,"uResolution"),this.width,this.height),this.program=defaultUniforms;defaultUniforms=new Date,defaultUniforms={resolution:{type:"2f",value:{x:this.width,y:this.height}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:this.width/2,y:this.height/2}},date:{type:"4fv",value:[defaultUniforms.getFullYear(),defaultUniforms.getMonth(),defaultUniforms.getDate(),60*defaultUniforms.getHours()*60+60*defaultUniforms.getMinutes()+defaultUniforms.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}};this.shader.uniforms?this.uniforms=Extend$f(!0,{},this.shader.uniforms,defaultUniforms):this.uniforms=defaultUniforms;for(var i=0;i<4;i++)textures[i]&&this.setSampler2D("iChannel"+i,textures[i],i,textureData);return this.initUniforms(),this.projOrtho(0,this._rendererWidth,this._rendererHeight,0),this},setPointer:function(pointer){return this.pointer=pointer,this},projOrtho:function(left,right,bottom,top){var leftRight=1/(left-right),program=1/(bottom-top),gl=this.projectionMatrix;gl[0]=-2*leftRight,gl[5]=-2*program,gl[10]=-.001,gl[12]=(left+right)*leftRight,gl[13]=(top+bottom)*program,gl[14]=-0;program=this.program,gl=this.gl;this.renderer.setProgram(program),gl.uniformMatrix4fv(gl.getUniformLocation(program,"uProjectionMatrix"),!1,this.projectionMatrix),this._rendererWidth=right,this._rendererHeight=bottom},initUniforms:function(){var key,gl=this.gl,map=this.renderer.glFuncMap,program=this.program;for(key in this._textureCount=0,this.uniforms){var uniform=this.uniforms[key],type=uniform.type,data=map[type];uniform.uniformLocation=gl.getUniformLocation(program,key),"sampler2D"!==type&&(uniform.glMatrix=data.matrix,uniform.glValueLength=data.length,uniform.glFunc=data.func)}},setSampler2DBuffer:function(uniform,texture,width,height,textureIndex,textureData){void 0===textureIndex&&(textureIndex=0),void 0===textureData&&(textureData={});uniform=this.uniforms[uniform];return uniform.value=texture,textureData.width=width,textureData.height=height,uniform.textureData=textureData,this._textureCount=textureIndex,this.initSampler2D(uniform),this},setSampler2D:function(source,textureKey,textureIndex,textureData){void 0===textureIndex&&(textureIndex=0);var uniform=this.scene.sys.textures;if(uniform.exists(textureKey)){var frame=uniform.getFrame(textureKey);if(frame.glTexture&&frame.glTexture.isRenderTexture)return this.setSampler2DBuffer(source,frame.glTexture,frame.width,frame.height,textureIndex,textureData);uniform=this.uniforms[source],source=frame.source;uniform.textureKey=textureKey,uniform.source=source.image,uniform.value=frame.glTexture,source.isGLTexture&&((textureData=textureData||{}).width=source.width,textureData.height=source.height),textureData&&(uniform.textureData=textureData),this._textureCount=textureIndex,this.initSampler2D(uniform)}return this},setUniform:function(key,value){return SetValue(this.uniforms,key,value),this},getUniform:function(key){return GetFastValue$T(this.uniforms,key,null)},setChannel0:function(textureKey,textureData){return this.setSampler2D("iChannel0",textureKey,0,textureData)},setChannel1:function(textureKey,textureData){return this.setSampler2D("iChannel1",textureKey,1,textureData)},setChannel2:function(textureKey,textureData){return this.setSampler2D("iChannel2",textureKey,2,textureData)},setChannel3:function(textureKey,textureData){return this.setSampler2D("iChannel3",textureKey,3,textureData)},initSampler2D:function(uniform){var gl,magFilter,minFilter,wrapS,wrapT,format,width,height,border;uniform.value&&((gl=this.gl).activeTexture(gl.TEXTURE0+this._textureCount),gl.bindTexture(gl.TEXTURE_2D,uniform.value),(border=uniform.textureData)&&!uniform.value.isRenderTexture&&(magFilter=gl[GetFastValue$T(border,"magFilter","linear").toUpperCase()],minFilter=gl[GetFastValue$T(border,"minFilter","linear").toUpperCase()],wrapS=gl[GetFastValue$T(border,"wrapS","repeat").toUpperCase()],wrapT=gl[GetFastValue$T(border,"wrapT","repeat").toUpperCase()],format=gl[GetFastValue$T(border,"format","rgba").toUpperCase()],border.repeat&&(wrapS=gl.REPEAT,wrapT=gl.REPEAT),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!!border.flipY),border.width?(width=GetFastValue$T(border,"width",512),height=GetFastValue$T(border,"height",2),border=GetFastValue$T(border,"border",0),gl.texImage2D(gl.TEXTURE_2D,0,format,width,height,border,format,gl.UNSIGNED_BYTE,null)):gl.texImage2D(gl.TEXTURE_2D,0,format,gl.RGBA,gl.UNSIGNED_BYTE,uniform.source),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,magFilter),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,minFilter),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,wrapS),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,wrapT)),this.renderer.setProgram(this.program),gl.uniform1i(uniform.uniformLocation,this._textureCount),this._textureCount++)},syncUniforms:function(){var uniform,length,glFunc,location,value,key,gl=this.gl,uniforms=this.uniforms,textureCount=0;for(key in uniforms)glFunc=(uniform=uniforms[key]).glFunc,length=uniform.glValueLength,location=uniform.uniformLocation,null!==(value=uniform.value)&&(1===length?uniform.glMatrix?glFunc.call(gl,location,uniform.transpose,value):glFunc.call(gl,location,value):2===length?glFunc.call(gl,location,value.x,value.y):3===length?glFunc.call(gl,location,value.x,value.y,value.z):4===length?glFunc.call(gl,location,value.x,value.y,value.z,value.w):"sampler2D"===uniform.type&&(gl.activeTexture(gl.TEXTURE0+textureCount),gl.bindTexture(gl.TEXTURE_2D,value),gl.uniform1i(location,textureCount),textureCount++))},load:function(matrix2D){var x,y,mouse=this.gl,px=this.width,py=this.height,pointer=this.renderer,res=this.program,vm=this.viewMatrix;this.renderToTexture||(x=-this._displayOriginX,y=-this._displayOriginY,vm[0]=matrix2D[0],vm[1]=matrix2D[1],vm[4]=matrix2D[2],vm[5]=matrix2D[3],vm[8]=matrix2D[4],vm[9]=matrix2D[5],vm[12]=vm[0]*x+vm[4]*y,vm[13]=vm[1]*x+vm[5]*y),mouse.useProgram(res),mouse.uniformMatrix4fv(mouse.getUniformLocation(res,"uViewMatrix"),!1,vm),mouse.uniform2f(mouse.getUniformLocation(res,"uResolution"),this.width,this.height);mouse=this.uniforms,res=mouse.resolution;res.value.x=px,res.value.y=py,mouse.time.value=pointer.game.loop.getDuration();pointer=this.pointer;pointer&&(mouse=mouse.mouse,px=pointer.x/px,py=1-pointer.y/py,mouse.value.x=px.toFixed(2),mouse.value.y=py.toFixed(2)),this.syncUniforms()},flush:function(){var width=this.width,height=this.height,vf=this.program,gl=this.gl,vertexBuffer=this.vertexBuffer,renderer=this.renderer,vertexSize=2*Float32Array.BYTES_PER_ELEMENT;this.renderToTexture&&(renderer.setFramebuffer(this.framebuffer),gl.clearColor(0,0,0,0),gl.clear(gl.COLOR_BUFFER_BIT)),gl.bindBuffer(gl.ARRAY_BUFFER,vertexBuffer);vf=gl.getAttribLocation(vf,"inPosition");-1!==vf&&(gl.enableVertexAttribArray(vf),gl.vertexAttribPointer(vf,2,gl.FLOAT,!1,vertexSize,0));vf=this.vertexViewF32;vf[3]=height,vf[4]=width,vf[5]=height,vf[8]=width,vf[9]=height,vf[10]=width;gl.bufferSubData(gl.ARRAY_BUFFER,0,this.bytes.subarray(0,6*vertexSize)),gl.drawArrays(gl.TRIANGLES,0,6),this.renderToTexture&&renderer.setFramebuffer(null,!1)},setAlpha:function(){},setBlendMode:function(){},preDestroy:function(){var gl=this.gl;gl.deleteProgram(this.program),gl.deleteBuffer(this.vertexBuffer),this.renderToTexture&&(this.renderer.deleteFramebuffer(this.framebuffer),this.texture.destroy(),this.framebuffer=null,this.glTexture=null,this.texture=null)}}),Rectangle$d=HasTileAtWorldXY_1,Vector2$r=BuildTilesetIndex_1;function GetLength(x1,y1,x,y){x=x1-x,y=y1-y;return Math.sqrt(x*x+y*y)}var BuildRight_1=new Class_1({initialize:function(vertex1,vertex2,vertex3){this.vertex1=vertex1,this.vertex2=vertex2,this.vertex3=vertex3,this.bounds=new Rectangle$d,this._inCenter=new Vector2$r},getInCenter:function(d1){var v1x,v1y,v2x,v2y,v3x,d2=this.vertex1,d3=this.vertex2,p=this.vertex3,v3y=(d1=void 0===d1?!0:d1)?(v1x=d2.x,v1y=d2.y,v2x=d3.x,v2y=d3.y,v3x=p.x,p.y):(v1x=d2.vx,v1y=d2.vy,v2x=d3.vx,v2y=d3.vy,v3x=p.vx,p.vy),d1=GetLength(v3x,v3y,v2x,v2y),d2=GetLength(v1x,v1y,v3x,v3y),d3=GetLength(v2x,v2y,v1x,v1y),p=d1+d2+d3;return this._inCenter.set((v1x*d1+v2x*d2+v3x*d3)/p,(v1y*d1+v2y*d2+v3y*d3)/p)},contains:function(t2x,dot00,f){var a,b,c,d,e,vertex1=this.vertex1,vertex2=this.vertex2,vertex3=this.vertex3,v=vertex1.vx,dot01=vertex1.vy,t1x=vertex2.vx,dot12=vertex2.vy,dot02=vertex3.vx,u=vertex3.vy;f&&(a=f.a,b=f.b,c=f.c,d=f.d,e=f.e,f=f.f,v=vertex1.vx*a+vertex1.vy*c+e,dot01=vertex1.vx*b+vertex1.vy*d+f,t1x=vertex2.vx*a+vertex2.vy*c+e,dot12=vertex2.vx*b+vertex2.vy*d+f,dot02=vertex3.vx*a+vertex3.vy*c+e,u=vertex3.vx*b+vertex3.vy*d+f);dot02-=v,u-=dot01,t1x-=v,dot12-=dot01,t2x-=v,v=dot00-dot01,dot00=dot02*dot02+u*u,dot01=dot02*t1x+u*dot12,dot02=dot02*t2x+u*v,u=t1x*t1x+dot12*dot12,dot12=t1x*t2x+dot12*v,v=dot00*u-dot01*dot01,v=0==v?0:1/v,u=(u*dot02-dot01*dot12)*v,v*=dot00*dot12-dot01*dot02;return 0<=u&&0<=v&&u+v<1},isCounterClockwise:function(z){var d=this.vertex1,v2=this.vertex2,v3=this.vertex3,d=(v2.vx-d.vx)*(v3.vy-d.vy)-(v2.vy-d.vy)*(v3.vx-d.vx);return z<=0?0<=d:d<0},load:function(F32,U32,offset,textureUnit,tintEffect){return offset=this.vertex1.load(F32,U32,offset,textureUnit,tintEffect),offset=this.vertex2.load(F32,U32,offset,textureUnit,tintEffect),offset=this.vertex3.load(F32,U32,offset,textureUnit,tintEffect)},transformCoordinatesLocal:function(transformMatrix,width,height,cameraZ){return this.vertex1.transformCoordinatesLocal(transformMatrix,width,height,cameraZ),this.vertex2.transformCoordinatesLocal(transformMatrix,width,height,cameraZ),this.vertex3.transformCoordinatesLocal(transformMatrix,width,height,cameraZ),this},updateBounds:function(){var v1=this.vertex1,v2=this.vertex2,v3=this.vertex3,bounds=this.bounds;return bounds.x=Math.min(v1.vx,v2.vx,v3.vx),bounds.y=Math.min(v1.vy,v2.vy,v3.vy),bounds.width=Math.max(v1.vx,v2.vx,v3.vx)-bounds.x,bounds.height=Math.max(v1.vy,v2.vy,v3.vy)-bounds.y,this},isInView:function(camera,hideCCW,bounds,cb,a,b,c,d,e,f,roundPixels){var v1=this.vertex1.update(a,b,c,d,e,f,roundPixels,cb),cr=this.vertex2.update(a,b,c,d,e,f,roundPixels,cb),cb=this.vertex3.update(a,b,c,d,e,f,roundPixels,cb);if(v1.ta<=0&&cr.ta<=0&&cb.ta<=0)return!1;if(hideCCW&&!this.isCounterClockwise(bounds))return!1;bounds=this.bounds;bounds.x=Math.min(v1.tx,cr.tx,cb.tx),bounds.y=Math.min(v1.ty,cr.ty,cb.ty),bounds.width=Math.max(v1.tx,cr.tx,cb.tx)-bounds.x,bounds.height=Math.max(v1.ty,cr.ty,cb.ty)-bounds.y;cr=camera.x+camera.width,cb=camera.y+camera.height;return!(bounds.width<=0||bounds.height<=0||camera.width<=0||camera.height<=0)&&!(bounds.right<camera.x||bounds.bottom<camera.y||bounds.x>cr||bounds.y>cb)},translate:function(x,y){void 0===y&&(y=0);var v1=this.vertex1,v2=this.vertex2,v3=this.vertex3;return v1.x+=x,v1.y+=y,v2.x+=x,v2.y+=y,v3.x+=x,v3.y+=y,this},x:{get:function(){return this.getInCenter().x},set:function(value){var current=this.getInCenter();this.translate(value-current.x,0)}},y:{get:function(){return this.getInCenter().y},set:function(value){var current=this.getInCenter();this.translate(0,value-current.y)}},alpha:{get:function(){var v1=this.vertex1,v2=this.vertex2,v3=this.vertex3;return(v1.alpha+v2.alpha+v3.alpha)/3},set:function(value){this.vertex1.alpha=value,this.vertex2.alpha=value,this.vertex3.alpha=value}},depth:{get:function(){var v1=this.vertex1,v2=this.vertex2,v3=this.vertex3;return(v1.vz+v2.vz+v3.vz)/3}},destroy:function(){this.vertex1=null,this.vertex2=null,this.vertex3=null}}),Utils$3=GetProps_1,Vector3$6=FromXY_1,GetTileAtWorldXY_1=new Class_1({Extends:Vector3$6,initialize:function(x,y,z,u,v,color,alpha,nx,ny,nz){void 0===color&&(color=16777215),void 0===alpha&&(alpha=1),void 0===nx&&(nx=0),void 0===ny&&(ny=0),void 0===nz&&(nz=0),Vector3$6.call(this,x,y,z),this.vx=0,this.vy=0,this.vz=0,this.nx=nx,this.ny=ny,this.nz=nz,this.u=u,this.v=v,this.color=color,this.alpha=alpha,this.tx=0,this.ty=0,this.ta=0},setUVs:function(u,v){return this.u=u,this.v=v,this},transformCoordinatesLocal:function(tz,width,height,cameraZ){var x=this.x,y=this.y,z=this.z,tw=tz.val,tx=x*tw[0]+y*tw[4]+z*tw[8]+tw[12],ty=x*tw[1]+y*tw[5]+z*tw[9]+tw[13],tz=x*tw[2]+y*tw[6]+z*tw[10]+tw[14],tw=x*tw[3]+y*tw[7]+z*tw[11]+tw[15];this.vx=tx/tw*width,this.vy=-ty/tw*height,this.vz=cameraZ<=0?tz/tw:-tz/tw},update:function(a,b,c,d,tx,ty,roundPixels,alpha){tx=this.vx*a+this.vy*c+tx,ty=this.vx*b+this.vy*d+ty;return roundPixels&&(tx=Math.round(tx),ty=Math.round(ty)),this.tx=tx,this.ty=ty,this.ta=this.alpha*alpha,this},load:function(F32,U32,offset,textureUnit,tintEffect){return F32[++offset]=this.tx,F32[++offset]=this.ty,F32[++offset]=this.u,F32[++offset]=this.v,F32[++offset]=textureUnit,F32[++offset]=tintEffect,U32[++offset]=Utils$3.getTintAppendFloatAlpha(this.color,this.ta),offset}}),Face$3=BuildRight_1,Vertex$3=GetTileAtWorldXY_1,CircumCenter_1=function(vertices,uvs,indicies,containsZ,normals,colors,alphas){if(void 0===containsZ&&(containsZ=!1),void 0===colors&&(colors=16777215),void 0===alphas&&(alphas=1),vertices.length===uvs.length){var result={faces:[],vertices:[]},iInc=containsZ?3:2,isColorArray=Array.isArray(colors),isAlphaArray=Array.isArray(alphas);if(Array.isArray(indicies)&&0<indicies.length)for(i=0;i<indicies.length;i++){var index1=indicies[i],index2=2*indicies[i],index3=indicies[i]*iInc,x=vertices[index3],y=vertices[1+index3],z=containsZ?vertices[2+index3]:0,u=uvs[index2],v=uvs[1+index2],color=isColorArray?colors[index1]:colors,alpha=isAlphaArray?alphas[index1]:alphas,normalX=0,normalY=0,normalZ=0;normals&&(normalX=normals[index3],normalY=normals[1+index3],normalZ=containsZ?normals[2+index3]:0),result.vertices.push(new Vertex$3(x,y,z,u,v,color,alpha,normalX,normalY,normalZ))}else for(var uvIndex=0,colorIndex=0,i=0;i<vertices.length;i+=iInc)x=vertices[i],y=vertices[i+1],z=containsZ?vertices[i+2]:0,u=uvs[uvIndex],v=uvs[uvIndex+1],color=isColorArray?colors[colorIndex]:colors,alpha=isAlphaArray?alphas[colorIndex]:alphas,normalZ=normalY=normalX=0,normals&&(normalX=normals[i],normalY=normals[i+1],normalZ=containsZ?normals[i+2]:0),result.vertices.push(new Vertex$3(x,y,z,u,v,color,alpha,normalX,normalY,normalZ)),uvIndex+=2,colorIndex++;for(i=0;i<result.vertices.length;i+=3){var vert1=result.vertices[i],vert2=result.vertices[i+1],vert3=result.vertices[i+2];result.faces.push(new Face$3(vert1,vert2,vert3))}return result}console.warn("GenerateVerts: vertices and uvs count not equal")},Face$2=BuildRight_1,Clone_1$4=FloorAll_1,Parse2DArray_1=FromXY_1,Vertex$2=GetTileAtWorldXY_1,tempPosition$1=new Parse2DArray_1,tempRotation$1=new Parse2DArray_1,tempMatrix$1=new Clone_1$4,CenterOn_1=function(data,mesh,scale,x,y,z,rotateX,rotateY,rotateZ,zIsUp){void 0===scale&&(scale=1),void 0===rotateX&&(rotateX=0),void 0===rotateY&&(rotateY=0),void 0===rotateZ&&(rotateZ=0),void 0===zIsUp&&(zIsUp=!0);var result={faces:[],verts:[]},materials=data.materials;tempPosition$1.set(x=void 0===x?0:x,y=void 0===y?0:y,z=void 0===z?0:z),tempRotation$1.set(rotateX,rotateY,rotateZ),tempMatrix$1.fromRotationXYTranslation(tempRotation$1,tempPosition$1,zIsUp);for(var m=0;m<data.models.length;m++)for(var model=data.models[m],vertices=model.vertices,textureCoords=model.textureCoords,faces=model.faces,i=0;i<faces.length;i++){var face=faces[i],uv3=face.vertices[0],vert3=face.vertices[1],vert1=face.vertices[2],m1=vertices[uv3.vertexIndex],m2=vertices[vert3.vertexIndex],m3=vertices[vert1.vertexIndex],vert2=uv3.textureCoordsIndex,uv3=vert3.textureCoordsIndex,vert3=vert1.textureCoordsIndex,vert1=-1===vert2?{u:0,v:1}:textureCoords[vert2],vert2=-1===uv3?{u:0,v:0}:textureCoords[uv3],uv3=-1===vert3?{u:1,v:1}:textureCoords[vert3],vert3=16777215;""!==face.material&&materials[face.material]&&(vert3=materials[face.material]);vert1=new Vertex$2(m1.x*scale,m1.y*scale,m1.z*scale,vert1.u,vert1.v,vert3).transformMat4(tempMatrix$1),vert2=new Vertex$2(m2.x*scale,m2.y*scale,m2.z*scale,vert2.u,vert2.v,vert3).transformMat4(tempMatrix$1),vert3=new Vertex$2(m3.x*scale,m3.y*scale,m3.z*scale,uv3.u,uv3.v,vert3).transformMat4(tempMatrix$1);result.verts.push(vert1,vert2,vert3),result.faces.push(new Face$2(vert1,vert2,vert3))}return mesh&&(mesh.faces=mesh.faces.concat(result.faces),mesh.vertices=mesh.vertices.concat(result.verts)),result},GetCalcMatrix$2=GetCalcMatrix_1,physics=function(renderer,src,camera,calcMatrix){var faces=src.faces,totalFaces=faces.length;if(0!==totalFaces){camera.addToRenderList(src);var pipeline=renderer.pipelines.set(src.pipeline,src),calcMatrix=GetCalcMatrix$2(src,camera,calcMatrix).calc,textureUnit=pipeline.setGameObject(src),F32=pipeline.vertexViewF32,U32=pipeline.vertexViewU32,vertexOffset=pipeline.vertexCount*pipeline.currentShader.vertexComponentCount-1,tintEffect=src.tintFill,debugFaces=[],debugCallback=src.debugCallback,a=calcMatrix.a,b=calcMatrix.b,c=calcMatrix.c,d=calcMatrix.d,e=calcMatrix.e,f=calcMatrix.f,z=src.viewPosition.z,hideCCW=src.hideCCW,roundPixels=camera.roundPixels,alpha=camera.alpha*src.alpha,totalFacesRendered=0;renderer.pipelines.preBatch(src);for(var i=0;i<totalFaces;i++){var face=faces[i];face.isInView(camera,hideCCW,z,alpha,a,b,c,d,e,f,roundPixels)&&(pipeline.shouldFlush(3)&&(pipeline.flush(),vertexOffset=0),vertexOffset=face.load(F32,U32,vertexOffset,textureUnit,tintEffect),totalFacesRendered++,pipeline.vertexCount+=3,debugCallback&&debugFaces.push(face))}src.totalFrame+=totalFacesRendered,debugCallback&&debugCallback.call(src,src,debugFaces),renderer.pipelines.postBatch(src)}},DegToRad$3=DegToRad_1,Face$1=BuildRight_1,GameObject$4=GameObject_1,GenerateVerts=CircumCenter_1,GenerateObjVerts=CenterOn_1,GetCalcMatrix$1=GetCalcMatrix_1,Matrix4$1=FloorAll_1,StableSort$1=Extend_1,Vector3$4=FromXY_1,Vertex$1=GetTileAtWorldXY_1,Equals_1$1=new Class_1({Extends:GameObject$4,Mixins:[components$3.AlphaSingle,components$3.BlendMode,components$3.Depth,components$3.Mask,components$3.Pipeline,components$3.Size,components$3.Texture,components$3.Transform,components$3.Visible,components$3.ScrollFactor,{renderWebGL:physics,renderCanvas:function(){}}],initialize:function(renderer,x,y,texture,frame,vertices,uvs,indicies,containsZ,normals,colors,alphas){void 0===x&&(x=0),void 0===y&&(y=0),void 0===texture&&(texture="__WHITE"),GameObject$4.call(this,renderer,"Mesh"),this.faces=[],this.vertices=[],this.tintFill=!1,this.debugCallback=null,this.debugGraphic=null,this.hideCCW=!0,this.modelPosition=new Vector3$4,this.modelScale=new Vector3$4(1,1,1),this.modelRotation=new Vector3$4,this.dirtyCache=[0,0,0,0,0,0,0,0,0,0,0,0],this.transformMatrix=new Matrix4$1,this.viewPosition=new Vector3$4,this.viewMatrix=new Matrix4$1,this.projectionMatrix=new Matrix4$1,this.totalRendered=0,this.totalFrame=0,this.ignoreDirtyCache=!1;renderer=renderer.sys.renderer;this.setPosition(x,y),this.setTexture(texture,frame),this.setSize(renderer.width,renderer.height),this.initPipeline(),this.setPerspective(renderer.width,renderer.height),vertices&&this.addVertices(vertices,uvs,indicies,containsZ,normals,colors,alphas)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},panX:function(v){return this.viewPosition.addScale(Vector3$4.LEFT,v),this.dirtyCache[10]=1,this},panY:function(v){return this.viewPosition.y+=Vector3$4.DOWN.y*v,this.dirtyCache[10]=1,this},panZ:function(amount){return this.viewPosition.z+=amount,this.dirtyCache[10]=1,this},setPerspective:function(width,height,fov,near,far){return void 0===near&&(near=.01),void 0===far&&(far=1e3),this.projectionMatrix.perspective(DegToRad$3(fov=void 0===fov?45:fov),width/height,near,far),this.dirtyCache[10]=1,this.dirtyCache[11]=0,this},setOrtho:function(scaleX,scaleY,near,far){return void 0===scaleX&&(scaleX=this.scene.sys.renderer.getAspectRatio()),this.projectionMatrix.ortho(-scaleX,scaleX,-(scaleY=void 0===scaleY?1:scaleY),scaleY,near=void 0===near?-1e3:near,far=void 0===far?1e3:far),this.dirtyCache[10]=1,this.dirtyCache[11]=1,this},clear:function(){return this.faces.forEach(function(face){face.destroy()}),this.faces=[],this.vertices=[],this},addVerticesFromObj:function(data,scale,x,y,z,rotateX,rotateY,rotateZ,zIsUp){data=this.scene.sys.cache.obj.get(data);return data&&GenerateObjVerts(data,this,scale,x,y,z,rotateX,rotateY,rotateZ,zIsUp),this},sortByDepth:function(faceA,faceB){return faceA.depth-faceB.depth},depthSort:function(){return StableSort$1(this.faces,this.sortByDepth),this},addVertex:function(x,y,z,u,v,color,vert){vert=new Vertex$1(x,y,z,u,v,color,vert);return this.vertices.push(vert),vert},addFace:function(vertex1,vertex2,face){face=new Face$1(vertex1,vertex2,face);return this.faces.push(face),this.dirtyCache[9]=-1,face},addVertices:function(vertices,uvs,indicies,containsZ,normals,colors,result){result=GenerateVerts(vertices,uvs,indicies,containsZ,normals,colors,result);return result&&(this.faces=this.faces.concat(result.faces),this.vertices=this.vertices.concat(result.vertices)),this.dirtyCache[9]=-1,this},getFaceCount:function(){return this.faces.length},getVertexCount:function(){return this.vertices.length},getFace:function(index){return this.faces[index]},getFaceAt:function(x,y,camera){void 0===camera&&(camera=this.scene.sys.cameras.main);for(var calcMatrix=GetCalcMatrix$1(this,camera).calc,faces=this.faces,results=[],i=0;i<faces.length;i++){var face=faces[i];face.contains(x,y,calcMatrix)&&results.push(face)}return StableSort$1(results,this.sortByDepth)},setDebug:function(graphic,callback){return this.debugGraphic=graphic,this.debugCallback=graphic||callback?callback||this.renderDebug:null,this},isDirty:function(){var syCached=this.modelPosition,szCached=this.modelRotation,fCached=this.modelScale,dirtyCache=this.dirtyCache,px=syCached.x,py=syCached.y,pz=syCached.z,rx=szCached.x,ry=szCached.y,rz=szCached.z,sx=fCached.x,sy=fCached.y,sz=fCached.z,faces=this.getFaceCount(),pxCached=dirtyCache[0],pyCached=dirtyCache[1],pzCached=dirtyCache[2],rxCached=dirtyCache[3],ryCached=dirtyCache[4],rzCached=dirtyCache[5],sxCached=dirtyCache[6],syCached=dirtyCache[7],szCached=dirtyCache[8],fCached=dirtyCache[9];return dirtyCache[0]=px,dirtyCache[1]=py,dirtyCache[2]=pz,dirtyCache[3]=rx,dirtyCache[4]=ry,dirtyCache[5]=rz,dirtyCache[6]=sx,dirtyCache[7]=sy,dirtyCache[8]=sz,dirtyCache[9]=faces,pxCached!==px||pyCached!==py||pzCached!==pz||rxCached!==rx||ryCached!==ry||rzCached!==rz||sxCached!==sx||syCached!==sy||szCached!==sz||fCached!==faces},preUpdate:function(){this.totalRendered=this.totalFrame,this.totalFrame=0;var dirty=this.dirtyCache;if(this.ignoreDirtyCache||dirty[10]||this.isDirty()){var width=this.width,height=this.height,viewMatrix=this.viewMatrix,viewPosition=this.viewPosition;dirty[10]&&(viewMatrix.identity(),viewMatrix.translate(viewPosition),viewMatrix.invert(),dirty[10]=0);var transformMatrix=this.transformMatrix;transformMatrix.setWorldMatrix(this.modelRotation,this.modelPosition,this.modelScale,this.viewMatrix,this.projectionMatrix);for(var z=viewPosition.z,faces=this.faces,i=0;i<faces.length;i++)faces[i].transformCoordinatesLocal(transformMatrix,width,height,z);this.depthSort()}},renderDebug:function(src,faces){for(var graphic=src.debugGraphic,i=0;i<faces.length;i++){var y2=faces[i],x0=y2.vertex1.tx,y0=y2.vertex1.ty,x1=y2.vertex2.tx,y1=y2.vertex2.ty,x2=y2.vertex3.tx,y2=y2.vertex3.ty;graphic.strokeTriangle(x0,y0,x1,y1,x2,y2)}},preDestroy:function(){this.clear(),this.debugCallback=null,this.debugGraphic=null}}),GetCalcMatrix=GetCalcMatrix_1,GameObject$3=GameObject_1,IntegerToColor=CopyFrom_1$3,PIPELINES_CONST=ParseGID_1,Parse2DArray_1=new Class_1({Extends:GameObject$3,Mixins:[components$3.AlphaSingle,components$3.BlendMode,components$3.Depth,components$3.GetBounds,components$3.Mask,components$3.Pipeline,components$3.ScrollFactor,components$3.Transform,components$3.Visible,{renderWebGL:function(renderer,src,camera,tx1){camera.addToRenderList(src);var pipeline=renderer.pipelines.set(src.pipeline),calcMatrix=GetCalcMatrix(src,camera,tx1).calc,ty1=src.width,tx2=src.height,ty2=-src._radius,ty3=-src._radius,xw=ty2+ty1,tx3=ty3+tx2,lightX=calcMatrix.getX(0,0),lightY=calcMatrix.getY(0,0),tx0=calcMatrix.getX(ty2,ty3),ty0=calcMatrix.getY(ty2,ty3),tx1=calcMatrix.getX(ty2,tx3),ty1=calcMatrix.getY(ty2,tx3),tx2=calcMatrix.getX(xw,tx3),ty2=calcMatrix.getY(xw,tx3),tx3=calcMatrix.getX(xw,ty3),ty3=calcMatrix.getY(xw,ty3);renderer.pipelines.preBatch(src),pipeline.batchPointLight(src,camera,tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,lightX,lightY),renderer.pipelines.postBatch(src)},renderCanvas:gameConfig}],initialize:function(scene,x,y,color,radius,intensity,attenuation){void 0===color&&(color=16777215),void 0===radius&&(radius=128),void 0===intensity&&(intensity=1),void 0===attenuation&&(attenuation=.1),GameObject$3.call(this,scene,"PointLight"),this.initPipeline(PIPELINES_CONST.POINTLIGHT_PIPELINE),this.setPosition(x,y),this.color=IntegerToColor(color),this.intensity=intensity,this.attenuation=attenuation,this.width=2*radius,this.height=2*radius,this._radius=radius},radius:{get:function(){return this._radius},set:function(value){this._radius=value,this.width=2*value,this.height=2*value}},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return this._radius}},displayOriginY:{get:function(){return this._radius}}}),Shader$2=FitInside_1;Tween_1.register("shader",function(key,x,y,width,height,textures,textureData){return this.displayList.add(new Shader$2(this.scene,key,x,y,width,height,textures,textureData))});var Mesh$2=Equals_1$1;Tween_1.register("mesh",function(x,y,texture,frame,vertices,uvs,indicies,containsZ,normals,colors,alphas){return this.displayList.add(new Mesh$2(this.scene,x,y,texture,frame,vertices,uvs,indicies,containsZ,normals,colors,alphas))});var PointLight$2=Parse2DArray_1;Tween_1.register("pointlight",function(x,y,color,radius,intensity,attenuation){return this.displayList.add(new PointLight$2(this.scene,x,y,color,radius,intensity,attenuation))});var BuildGameObject$2=BuildGameObject_1,GetAdvancedValue$5=GetAdvancedValue_1,Shader$1=FitInside_1;TweenManager.register("shader",function(config,addToScene){var key=GetAdvancedValue$5(config=void 0===config?{}:config,"key",null),x=GetAdvancedValue$5(config,"x",0),y=GetAdvancedValue$5(config,"y",0),width=GetAdvancedValue$5(config,"width",128),shader=GetAdvancedValue$5(config,"height",128),shader=new Shader$1(this.scene,key,x,y,width,shader);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject$2(this.scene,shader,config),shader});var BuildGameObject$1=BuildGameObject_1,GetAdvancedValue$4=GetAdvancedValue_1,GetValue$e=GetValue_1,Mesh$1=Equals_1$1;TweenManager.register("mesh",function(config,addToScene){var key=GetAdvancedValue$4(config=void 0===config?{}:config,"key",null),frame=GetAdvancedValue$4(config,"frame",null),vertices=GetValue$e(config,"vertices",[]),uvs=GetValue$e(config,"uvs",[]),indicies=GetValue$e(config,"indicies",[]),containsZ=GetValue$e(config,"containsZ",!1),normals=GetValue$e(config,"normals",[]),colors=GetValue$e(config,"colors",16777215),mesh=GetValue$e(config,"alphas",1),mesh=new Mesh$1(this.scene,0,0,key,frame,vertices,uvs,indicies,containsZ,normals,colors,mesh);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject$1(this.scene,mesh,config),mesh});var BuildGameObject=BuildGameObject_1,GetAdvancedValue$3=GetAdvancedValue_1,PointLight$1=Parse2DArray_1;TweenManager.register("pointlight",function(config,addToScene){var color=GetAdvancedValue$3(config=void 0===config?{}:config,"color",16777215),radius=GetAdvancedValue$3(config,"radius",128),intensity=GetAdvancedValue$3(config,"intensity",1),layer=GetAdvancedValue$3(config,"attenuation",.1),layer=new PointLight$1(this.scene,0,0,color,radius,intensity,layer);return void 0!==addToScene&&(config.add=addToScene),BuildGameObject(this.scene,layer,config),layer});var Circle$5=Svg_1,RGB$1=PluginCache$7,Utils$2=GetProps_1,Light$1=new Class_1({Extends:Circle$5,Mixins:[components$3.ScrollFactor,components$3.Visible],initialize:function(x,y,radius,r,g,b,intensity){Circle$5.call(this,x,y,radius),this.color=new RGB$1(r,g,b),this.intensity=intensity,this.renderFlags=15,this.cameraFilter=0,this.setScrollFactor(1,1)},willRender:function(camera){return!(Light$1.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&camera.id)},setColor:function(color){color=Utils$2.getFloatsFromUintRGB(color);return this.color.set(color[0],color[1],color[2]),this},setIntensity:function(intensity){return this.intensity=intensity,this},setRadius:function(radius){return this.radius=radius,this}});Light$1.RENDER_MASK=15;var Clone_1$4=Light$1,physics=function(circle,yDist){var xCornerDist=yDist.width/2,yCornerDist=yDist.height/2,cx=Math.abs(circle.x-yDist.x-xCornerDist),cy=Math.abs(circle.y-yDist.y-yCornerDist),xDist=xCornerDist+circle.radius,yDist=yCornerDist+circle.radius;if(xDist<cx||yDist<cy)return!1;if(cx<=xCornerDist||cy<=yCornerDist)return!0;xCornerDist=cx-xCornerDist,yCornerDist=cy-yCornerDist;return xCornerDist*xCornerDist+yCornerDist*yCornerDist<=circle.radius*circle.radius},CircleToRectangle$2=physics,DistanceBetween$5=DistanceBetween_1,Light=Clone_1$4,PointLight=Parse2DArray_1,RGB=PluginCache$7,SpliceOne$1=SpliceOne_1,StableSort=Extend_1,Utils$1=GetProps_1,CopyFrom_1$3=new Class_1({initialize:function(){this.lights=[],this.ambientColor=new RGB(.1,.1,.1),this.active=!1,this.maxLights=-1,this.visibleLights=0},addPointLight:function(x,y,color,radius,intensity,attenuation){return this.systems.displayList.add(new PointLight(this.scene,x,y,color,radius,intensity,attenuation))},enable:function(){return-1===this.maxLights&&(this.maxLights=this.systems.renderer.config.maxLights),this.active=!0,this},disable:function(){return this.active=!1,this},getLights:function(camera){for(var lights=this.lights,worldView=camera.worldView,visibleLights=[],i=0;i<lights.length;i++){var light=lights[i];light.willRender(camera)&&CircleToRectangle$2(light,worldView)&&visibleLights.push({light:light,distance:DistanceBetween$5(light.x,light.y,worldView.centerX,worldView.centerY)})}return visibleLights.length>this.maxLights&&(StableSort(visibleLights,this.sortByDistance),visibleLights=visibleLights.slice(0,this.maxLights)),this.visibleLights=visibleLights.length,visibleLights},sortByDistance:function(a,b){return a.distance>=b.distance},setAmbientColor:function(color){color=Utils$1.getFloatsFromUintRGB(color);return this.ambientColor.set(color[0],color[1],color[2]),this},getMaxVisibleLights:function(){return this.maxLights},getLightCount:function(){return this.lights.length},addLight:function(x,y,radius,color,light){void 0===x&&(x=0),void 0===y&&(y=0),void 0===radius&&(radius=128),void 0===light&&(light=1);color=Utils$1.getFloatsFromUintRGB(color=void 0===color?16777215:color),light=new Light(x,y,radius,color[0],color[1],color[2],light);return this.lights.push(light),light},removeLight:function(index){index=this.lights.indexOf(index);return 0<=index&&SpliceOne$1(this.lights,index),this},shutdown:function(){this.lights.length=0},destroy:function(){this.shutdown()}}),LightsManager=CopyFrom_1$3,PluginCache$7=PluginCache,SceneEvents$8=events$g,Extend_1=new Class_1({Extends:LightsManager,initialize:function(scene){this.scene=scene,this.systems=scene.sys,scene.sys.settings.isBooted||scene.sys.events.once(SceneEvents$8.BOOT,this.boot,this),LightsManager.call(this)},boot:function(){var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents$8.SHUTDOWN,this.shutdown,this),eventEmitter.on(SceneEvents$8.DESTROY,this.destroy,this)},destroy:function(){this.shutdown(),this.scene=void 0,this.systems=void 0}});PluginCache$7.register("LightsPlugin",Extend_1,"lights");Pair_1={Events:events$h,DisplayList:DisplayList_1,GameObjectCreator:TweenManager,GameObjectFactory:Tween_1,UpdateList:UpdateList_1,Components:components$3,GetCalcMatrix:GetCalcMatrix_1,BuildGameObject:BuildGameObject_1,BuildGameObjectAnimation:BuildGameObjectAnimation_1,GameObject:GameObject_1,BitmapText:BitmapText_1,Blitter:Blitter_1,Bob:Bob_1,Container:Container_1,DOMElement:DOMElement_1,DynamicBitmapText:DynamicBitmapText_1,Extern:Extern_1,Graphics:Graphics_1,Group:events$1,Image:Resolver_1,Layer:Layer_1,Particles:particles,PathFollower:PathFollower_1,RenderTexture:RenderTexture_1,RetroFont:RetroFont_1,Rope:Rope_1,Sprite:time,Text:Text_1,GetTextSize:GetTextSize_1,MeasureText:MeasureText_1,TextStyle:TextStyle_1,TileSprite:Pair_1,Zone:gameobjects,Video:Ceil_1,Shape:AtlasXMLFile_1,Arc:GetNearestPoint_1,Curve:Body_1,Ellipse:CustomMain,Grid:HTMLTextureFile_1,IsoBox:BitmapFontFile_1,IsoTriangle:Events_1,Line:Decompose_1$1,Polygon:AnimationJSONFile_1,Rectangle:GetAspectRatio_1,Star:BinaryFile_1,Triangle:input,Factories:{Blitter:{},Container:{},DOMElement:{},DynamicBitmapText:{},Extern:{},Graphics:{},Group:{},Image:{},Layer:{},Particles:{},PathFollower:{},RenderTexture:{},Rope:{},Sprite:{},StaticBitmapText:{},Text:{},TileSprite:{},Zone:{},Video:{},Arc:{},Curve:{},Ellipse:{},Grid:{},IsoBox:{},IsoTriangle:{},Line:{},Polygon:{},Rectangle:{},Star:{},Triangle:{}},Creators:{Blitter:{},Container:{},DynamicBitmapText:{},Graphics:{},Group:{},Image:{},Layer:{},Particles:{},RenderTexture:{},Rope:{},Sprite:{},StaticBitmapText:{},Text:{},TileSprite:{},Zone:{},Video:{}}};Pair_1.Shader=FitInside_1,Pair_1.Mesh=Equals_1$1,Pair_1.PointLight=Parse2DArray_1,Pair_1.Factories.Shader={},Pair_1.Factories.Mesh={},Pair_1.Factories.PointLight={},Pair_1.Creators.Shader={},Pair_1.Creators.Mesh={},Pair_1.Creators.PointLight={},Pair_1.Light=Clone_1$4,Pair_1.LightsManager=CopyFrom_1$3,Pair_1.LightsPlugin=Extend_1;var gameobjects=Pair_1,Circle$4=Svg_1,Ceil_1=function(source){return new Circle$4(source.x,source.y,source.radius)},Contains$9=Bounds_1,AtlasXMLFile_1=function(circle,point){return Contains$9(circle,point.x,point.y)},Contains$8=Bounds_1,GetNearestPoint_1=function(circle,rect){return Contains$8(circle,rect.x,rect.y)&&Contains$8(circle,rect.right,rect.y)&&Contains$8(circle,rect.x,rect.bottom)&&Contains$8(circle,rect.right,rect.bottom)},Body_1=function(source,dest){return dest.setTo(source.x,source.y,source.radius)},CustomMain=function(circle,toCompare){return circle.x===toCompare.x&&circle.y===toCompare.y&&circle.radius===toCompare.radius},Rectangle$c=HasTileAtWorldXY_1,HTMLTextureFile_1=function(circle,out){return(out=void 0===out?new Rectangle$c:out).x=circle.left,out.y=circle.top,out.width=circle.diameter,out.height=circle.diameter,out},BitmapFontFile_1=function(circle,x,y){return circle.x+=x,circle.y+=y,circle},Events_1=function(circle,point){return circle.x+=point.x,circle.y+=point.y,circle},Decompose_1$1=Svg_1;Decompose_1$1.Area=function(circle){return 0<circle.radius?Math.PI*circle.radius*circle.radius:0},Decompose_1$1.Circumference=Query_1,Decompose_1$1.CircumferencePoint=GetMidPoint_1,Decompose_1$1.Clone=Ceil_1,Decompose_1$1.Contains=Bounds_1,Decompose_1$1.ContainsPoint=AtlasXMLFile_1,Decompose_1$1.ContainsRect=GetNearestPoint_1,Decompose_1$1.CopyFrom=Body_1,Decompose_1$1.Equals=CustomMain,Decompose_1$1.GetBounds=HTMLTextureFile_1,Decompose_1$1.GetPoint=CeilAll_1,Decompose_1$1.GetPoints=ContainsPoint_1$1,Decompose_1$1.Offset=BitmapFontFile_1,Decompose_1$1.OffsetPoint=Events_1,Decompose_1$1.Random=GetTilesWithin_1;var AnimationJSONFile_1=Decompose_1$1,Ellipse$2=Constraint_1,GetAspectRatio_1=function(source){return new Ellipse$2(source.x,source.y,source.width,source.height)},Contains$7=Composites_1,BinaryFile_1=function(ellipse,point){return Contains$7(ellipse,point.x,point.y)},Contains$6=Composites_1,input=function(ellipse,rect){return Contains$6(ellipse,rect.x,rect.y)&&Contains$6(ellipse,rect.right,rect.y)&&Contains$6(ellipse,rect.x,rect.bottom)&&Contains$6(ellipse,rect.right,rect.bottom)},FitInside_1=function(source,dest){return dest.setTo(source.x,source.y,source.width,source.height)},Equals_1$1=function(ellipse,toCompare){return ellipse.x===toCompare.x&&ellipse.y===toCompare.y&&ellipse.width===toCompare.width&&ellipse.height===toCompare.height},Rectangle$b=HasTileAtWorldXY_1,Parse2DArray_1=function(ellipse,out){return(out=void 0===out?new Rectangle$b:out).x=ellipse.left,out.y=ellipse.top,out.width=ellipse.width,out.height=ellipse.height,out},Clone_1$4=function(ellipse,x,y){return ellipse.x+=x,ellipse.y+=y,ellipse},CopyFrom_1$3=function(ellipse,point){return ellipse.x+=point.x,ellipse.y+=point.y,ellipse},Extend_1=Constraint_1;Extend_1.Area=function(ellipse){return ellipse.isEmpty()?0:ellipse.getMajorRadius()*ellipse.getMinorRadius()*Math.PI},Extend_1.Circumference=ContainsRect_1,Extend_1.CircumferencePoint=CopyFrom_1$1,Extend_1.Clone=GetAspectRatio_1,Extend_1.Contains=Composites_1,Extend_1.ContainsPoint=BinaryFile_1,Extend_1.ContainsRect=input,Extend_1.CopyFrom=FitInside_1,Extend_1.Equals=Equals_1$1,Extend_1.GetBounds=Parse2DArray_1,Extend_1.GetPoint=Angle_1,Extend_1.GetPoints=CenterOn_1$1,Extend_1.Offset=Clone_1$4,Extend_1.OffsetPoint=CopyFrom_1$3,Extend_1.Random=Equals_1$3;var Pair_1=Extend_1,DistanceBetween$4=DistanceBetween_1,Query_1=function(circleA,circleB){return DistanceBetween$4(circleA.x,circleA.y,circleB.x,circleB.y)<=circleA.radius+circleB.radius},Point$m=JSONFile_1,CircleToCircle$1=Query_1,GetMidPoint_1=function(r1,v1,out){var x0,y0,r0,x1,x,n,coefficientA,coefficientB,lambda;return void 0===out&&(out=[]),CircleToCircle$1(r1,v1)&&(x0=r1.x,y0=r1.y,r0=r1.radius,x1=v1.x,n=v1.y,r1=v1.radius,y0===n?0===(lambda=(coefficientB=-2*n)*coefficientB-4*(coefficientA=1)*(x1*x1+(x=(r1*r1-r0*r0-x1*x1+x0*x0)/(2*(x0-x1)))*x-2*x1*x+n*n-r1*r1))?out.push(new Point$m(x,-coefficientB/(2*coefficientA))):0<lambda&&(out.push(new Point$m(x,(-coefficientB+Math.sqrt(lambda))/(2*coefficientA))),out.push(new Point$m(x,(-coefficientB-Math.sqrt(lambda))/(2*coefficientA)))):0===(lambda=(coefficientB=2*y0*(v1=(x0-x1)/(y0-n))-2*(n=(r1*r1-r0*r0-x1*x1+x0*x0-n*n+y0*y0)/(2*(y0-n)))*v1-2*x0)*coefficientB-4*(coefficientA=v1*v1+1)*(x0*x0+y0*y0+n*n-r0*r0-2*y0*n))?out.push(new Point$m(x=-coefficientB/(2*coefficientA),n-x*v1)):0<lambda&&(x=(-coefficientB+Math.sqrt(lambda))/(2*coefficientA),out.push(new Point$m(x,n-x*v1)),x=(-coefficientB-Math.sqrt(lambda))/(2*coefficientA),out.push(new Point$m(x,n-x*v1)))),out},Contains$5=Bounds_1,tmp=new JSONFile_1,Ceil_1=function(line,circle,nearest){if(void 0===nearest&&(nearest=tmp),Contains$5(circle,line.x1,line.y1))return nearest.x=line.x1,nearest.y=line.y1,!0;if(Contains$5(circle,line.x2,line.y2))return nearest.x=line.x2,nearest.y=line.y2,!0;var dx=line.x2-line.x1,dy=line.y2-line.y1,lcx=circle.x-line.x1,dp=circle.y-line.y1,dLen2=dx*dx+dy*dy,px=dx,py=dy;return 0<dLen2&&(px*=dp=(lcx*dx+dp*dy)/dLen2,py*=dp),nearest.x=line.x1+px,nearest.y=line.y1+py,px*px+py*py<=dLen2&&0<=px*dx+py*dy&&Contains$5(circle,nearest.x,nearest.y)},Point$k=JSONFile_1,LineToCircle$1=Ceil_1,AtlasXMLFile_1=function(oDirY,lambda,out){var lx1,ly1,lDirX,lDirY,oDirX,coefficientB,x,y,root1,root2;return void 0===out&&(out=[]),LineToCircle$1(oDirY,lambda)&&(lx1=oDirY.x1,ly1=oDirY.y1,coefficientB=oDirY.x2,root2=oDirY.y2,0==(lambda=(coefficientB=2*((lDirX=coefficientB-lx1)*(oDirX=lx1-lambda.x)+(lDirY=root2-ly1)*(oDirY=ly1-lambda.y)))*coefficientB-4*(root2=lDirX*lDirX+lDirY*lDirY)*(oDirX*oDirX+oDirY*oDirY-(lambda=lambda.radius)*lambda))?(x=lx1+(root1=-coefficientB/(2*root2))*lDirX,y=ly1+root1*lDirY,0<=root1&&root1<=1&&out.push(new Point$k(x,y))):0<lambda&&(x=lx1+(root1=(-coefficientB-Math.sqrt(lambda))/(2*root2))*lDirX,y=ly1+root1*lDirY,0<=root1&&root1<=1&&out.push(new Point$k(x,y)),x=lx1+(root2=(-coefficientB+Math.sqrt(lambda))/(2*root2))*lDirX,y=ly1+root2*lDirY,0<=root2&&root2<=1&&out.push(new Point$k(x,y)))),out},GetLineToCircle$1=AtlasXMLFile_1,CircleToRectangle$1=physics,GetNearestPoint_1=function(circle,lineD,out){var lineA,lineB,lineC;return void 0===out&&(out=[]),CircleToRectangle$1(circle,lineD)&&(lineA=lineD.getLineA(),lineB=lineD.getLineB(),lineC=lineD.getLineC(),lineD=lineD.getLineD(),GetLineToCircle$1(lineA,circle,out),GetLineToCircle$1(lineB,circle,out),GetLineToCircle$1(lineC,circle,out),GetLineToCircle$1(lineD,circle,out)),out},Vector3$3=FromXY_1,Body_1=function(dx1,T2,out){var x1=dx1.x1,y1=dx1.y1,dy1=dx1.x2,T1=dx1.y2,x3=T2.x1,y3=T2.y1,dx1=dy1-x1,dy1=T1-y1,T1=T2.x2-x3,T2=T2.y2-y3;if(0==dx1||0==T2*dx1-T1*dy1)return!1;T2=(dx1*(y3-y1)+dy1*(x1-x3))/(T1*dy1-T2*dx1),T1=(x3+T1*T2-x1)/dx1;return T1<0||T2<0||1<T2?null:(out=void 0===out?new Vector3$3:out).set(x1+dx1*T1,y1+dy1*T1,T1)},Vector3$2=FromXY_1,GetLineToLine=Body_1,segment$1=new Floor_1,tempIntersect$1=new Vector3$2,CustomMain=function(line,points,out){var closestIntersect=!1;(out=void 0===out?new Vector3$2:out).set(),tempIntersect$1.set();for(var prev=points[0],i=1;i<points.length;i++){var current=points[i];segment$1.setTo(prev.x,prev.y,current.x,current.y),prev=current,GetLineToLine(line,segment$1,tempIntersect$1)&&(!closestIntersect||tempIntersect$1.z<out.z)&&(out.copy(tempIntersect$1),closestIntersect=!0)}return closestIntersect?out:null},Vector4$1=GetEasedPoints_1,GetLineToPoints=CustomMain,tempIntersect=new FromXY_1,HTMLTextureFile_1=function(line,polygons,out){void 0===out&&(out=new Vector4$1),Array.isArray(polygons)||(polygons=[polygons]);var closestIntersect=!1;out.set(),tempIntersect.set();for(var i=0;i<polygons.length;i++)GetLineToPoints(line,polygons[i].points,tempIntersect)&&(!closestIntersect||tempIntersect.z<out.z)&&(out.set(tempIntersect.x,tempIntersect.y,tempIntersect.z,i),closestIntersect=!0);return closestIntersect?out:null},Point$j=JSONFile_1,CeilAll_1=function(uA,uB,out){void 0===out&&(out=new Point$j);var x1=uA.x1,y1=uA.y1,x2=uA.x2,y2=uA.y2,x3=uB.x1,y3=uB.y1,x4=uB.x2,uA=uB.y2,uB=(uA-y3)*(x2-x1)-(x4-x3)*(y2-y1);if(0==uB)return!1;uA=((x4-x3)*(y1-y3)-(uA-y3)*(x1-x3))/uB,uB=((x2-x1)*(y1-y3)-(y2-y1)*(x1-x3))/uB;return 0<=uA&&uA<=1&&0<=uB&&uB<=1&&(out.x=x1+uA*(x2-x1),out.y=y1+uA*(y2-y1),!0)},ContainsPoint_1$1=function(by2,t){var x1=by2.x1,y1=by2.y1,x2=by2.x2,y2=by2.y2,bx1=t.x,by1=t.y,bx2=t.right,by2=t.bottom,t=0;if(bx1<=x1&&x1<=bx2&&by1<=y1&&y1<=by2||bx1<=x2&&x2<=bx2&&by1<=y2&&y2<=by2)return!0;if(x1<bx1&&bx1<=x2){if(by1<(t=y1+(y2-y1)*(bx1-x1)/(x2-x1))&&t<=by2)return!0}else if(bx2<x1&&x2<=bx2&&by1<=(t=y1+(y2-y1)*(bx2-x1)/(x2-x1))&&t<=by2)return!0;if(y1<by1&&by1<=y2){if(bx1<=(t=x1+(x2-x1)*(by1-y1)/(y2-y1))&&t<=bx2)return!0}else if(by2<y1&&y2<=by2&&bx1<=(t=x1+(x2-x1)*(by2-y1)/(y2-y1))&&t<=bx2)return!0;return!1},Point$i=JSONFile_1,LineToLine$4=CeilAll_1,LineToRectangle=ContainsPoint_1$1,BitmapFontFile_1=function(line,lineD,out){if(void 0===out&&(out=[]),LineToRectangle(line,lineD))for(var lineA=lineD.getLineA(),lineB=lineD.getLineB(),lineC=lineD.getLineC(),lineD=lineD.getLineD(),output=[new Point$i,new Point$i,new Point$i,new Point$i],result=[LineToLine$4(lineA,line,output[0]),LineToLine$4(lineB,line,output[1]),LineToLine$4(lineC,line,output[2]),LineToLine$4(lineD,line,output[3])],i=0;i<4;i++)result[i]&&out.push(output[i]);return out},Vector4=GetEasedPoints_1,GetLineToPolygon=HTMLTextureFile_1,segment=new Floor_1;function CheckIntersects(angle,x,y,closestIntersect,intersects){var dx=Math.cos(angle),dy=Math.sin(angle);segment.setTo(x,y,x+dx,y+dy);closestIntersect=GetLineToPolygon(segment,closestIntersect);closestIntersect&&intersects.push(new Vector4(closestIntersect.x,closestIntersect.y,angle,closestIntersect.w))}function SortIntersects(a,b){return a.z-b.z}var Events_1=function(rectA,rectB){return!(rectA.width<=0||rectA.height<=0||rectB.width<=0||rectB.height<=0)&&!(rectA.right<rectB.x||rectA.bottom<rectB.y||rectA.x>rectB.right||rectA.y>rectB.bottom)},Rectangle$a=HasTileAtWorldXY_1,RectangleToRectangle$1=Events_1,GetLineToRectangle$1=BitmapFontFile_1,RectangleToRectangle=Events_1,GetTilesWithin_1=function(triangle,points,returnFirst,out){void 0===returnFirst&&(returnFirst=!1),void 0===out&&(out=[]);for(var v,dot02,u,v0x=triangle.x3-triangle.x1,v0y=triangle.y3-triangle.y1,v1x=triangle.x2-triangle.x1,v1y=triangle.y2-triangle.y1,dot00=v0x*v0x+v0y*v0y,dot01=v0x*v1x+v0y*v1y,dot11=v1x*v1x+v1y*v1y,b=dot00*dot11-dot01*dot01,inv=0==b?0:1/b,x1=triangle.x1,y1=triangle.y1,i=0;i<points.length&&(v=(dot00*(u=v1x*(dot02=points[i].x-x1)+v1y*(v=points[i].y-y1))-dot01*(dot02=v0x*dot02+v0y*v))*inv,!(0<=(u=(dot11*dot02-dot01*u)*inv)&&0<=v&&u+v<1&&(out.push({x:points[i].x,y:points[i].y}),returnFirst)));i++);return out},Decompose_1$1=function(rect,out){return(out=void 0===out?[]:out).push({x:rect.x,y:rect.y}),out.push({x:rect.right,y:rect.y}),out.push({x:rect.right,y:rect.bottom}),out.push({x:rect.x,y:rect.bottom}),out},LineToLine$3=CeilAll_1,Contains$4=arcade,ContainsArray$1=GetTilesWithin_1,Decompose$2=Decompose_1$1,ContainsRect_1=function(points,triangle){if(triangle.left>points.right||triangle.right<points.left||triangle.top>points.bottom||triangle.bottom<points.top)return!1;var triA=triangle.getLineA(),triB=triangle.getLineB(),triC=triangle.getLineC();if(Contains$4(points,triA.x1,triA.y1)||Contains$4(points,triA.x2,triA.y2))return!0;if(Contains$4(points,triB.x1,triB.y1)||Contains$4(points,triB.x2,triB.y2))return!0;if(Contains$4(points,triC.x1,triC.y1)||Contains$4(points,triC.x2,triC.y2))return!0;var rectA=points.getLineA(),rectB=points.getLineB(),rectC=points.getLineC(),rectD=points.getLineD();if(LineToLine$3(triA,rectA)||LineToLine$3(triA,rectB)||LineToLine$3(triA,rectC)||LineToLine$3(triA,rectD))return!0;if(LineToLine$3(triB,rectA)||LineToLine$3(triB,rectB)||LineToLine$3(triB,rectC)||LineToLine$3(triB,rectD))return!0;if(LineToLine$3(triC,rectA)||LineToLine$3(triC,rectB)||LineToLine$3(triC,rectC)||LineToLine$3(triC,rectD))return!0;points=Decompose$2(points);return 0<ContainsArray$1(triangle,points,!0).length},RectangleToTriangle=ContainsRect_1,GetLineToRectangle=BitmapFontFile_1,LineToCircle=Ceil_1,Contains$3=HTMLFile_1,CopyFrom_1$1=function(triangle,circle){return!(triangle.left>circle.right||triangle.right<circle.left||triangle.top>circle.bottom||triangle.bottom<circle.top)&&(!!Contains$3(triangle,circle.x,circle.y)||(!!LineToCircle(triangle.getLineA(),circle)||(!!LineToCircle(triangle.getLineB(),circle)||!!LineToCircle(triangle.getLineC(),circle))))},GetLineToCircle=AtlasXMLFile_1,TriangleToCircle=CopyFrom_1$1,LineToLine$2=CeilAll_1,GetAspectRatio_1=function(triangle,line){return!(!triangle.contains(line.x1,line.y1)&&!triangle.contains(line.x2,line.y2))||(!!LineToLine$2(triangle.getLineA(),line)||(!!LineToLine$2(triangle.getLineB(),line)||!!LineToLine$2(triangle.getLineC(),line)))},Point$h=JSONFile_1,TriangleToLine=GetAspectRatio_1,LineToLine$1=CeilAll_1,BinaryFile_1=function(lineC,line,out){if(void 0===out&&(out=[]),TriangleToLine(lineC,line))for(var lineA=lineC.getLineA(),lineB=lineC.getLineB(),lineC=lineC.getLineC(),output=[new Point$h,new Point$h,new Point$h],result=[LineToLine$1(lineA,line,output[0]),LineToLine$1(lineB,line,output[1]),LineToLine$1(lineC,line,output[2])],i=0;i<3;i++)result[i]&&out.push(output[i]);return out},input=function(triangle,out){return(out=void 0===out?[]:out).push({x:triangle.x1,y:triangle.y1}),out.push({x:triangle.x2,y:triangle.y2}),out.push({x:triangle.x3,y:triangle.y3}),out},ContainsArray=GetTilesWithin_1,Decompose=input,LineToLine=CeilAll_1,FitInside_1=function(triangleA,triangleB){if(triangleA.left>triangleB.right||triangleA.right<triangleB.left||triangleA.top>triangleB.bottom||triangleA.bottom<triangleB.top)return!1;var lineAA=triangleA.getLineA(),lineAB=triangleA.getLineB(),lineAC=triangleA.getLineC(),lineBA=triangleB.getLineA(),lineBB=triangleB.getLineB(),points=triangleB.getLineC();if(LineToLine(lineAA,lineBA)||LineToLine(lineAA,lineBB)||LineToLine(lineAA,points))return!0;if(LineToLine(lineAB,lineBA)||LineToLine(lineAB,lineBB)||LineToLine(lineAB,points))return!0;if(LineToLine(lineAC,lineBA)||LineToLine(lineAC,lineBB)||LineToLine(lineAC,points))return!0;points=Decompose(triangleA);return 0<ContainsArray(triangleB,points,!0).length||(points=Decompose(triangleB),0<ContainsArray(triangleA,points,!0).length)},TriangleToTriangle=FitInside_1,GetTriangleToLine=BinaryFile_1,Equals_1$1=function(r,L2,lineThickness){void 0===lineThickness&&(lineThickness=1);var x1=L2.x1,y1=L2.y1,x2=L2.x2,y2=L2.y2,px=r.x,py=r.y,L2=(x2-x1)*(x2-x1)+(y2-y1)*(y2-y1);if(0==L2)return!1;r=((px-x1)*(x2-x1)+(py-y1)*(y2-y1))/L2;return r<0?Math.sqrt((x1-px)*(x1-px)+(y1-py)*(y1-py))<=lineThickness:0<=r&&r<=1?Math.abs(((y1-py)*(x2-x1)-(x1-px)*(y2-y1))/L2)*Math.sqrt(L2)<=lineThickness:Math.sqrt((x2-px)*(x2-px)+(y2-py)*(y2-py))<=lineThickness},PointToLine=Equals_1$1,Parse2DArray_1={CircleToCircle:Query_1,CircleToRectangle:physics,GetCircleToCircle:GetMidPoint_1,GetCircleToRectangle:GetNearestPoint_1,GetLineToCircle:AtlasXMLFile_1,GetLineToLine:Body_1,GetLineToPoints:CustomMain,GetLineToPolygon:HTMLTextureFile_1,GetLineToRectangle:BitmapFontFile_1,GetRaysFromPointToPolygon:function(x,y,polygons){Array.isArray(polygons)||(polygons=[polygons]);for(var intersects=[],angles=[],i=0;i<polygons.length;i++)for(var points=polygons[i].points,p=0;p<points.length;p++){var angle=Math.atan2(points[p].y-y,points[p].x-x);-1===angles.indexOf(angle)&&(CheckIntersects(angle,x,y,polygons,intersects),CheckIntersects(angle-1e-5,x,y,polygons,intersects),CheckIntersects(angle+1e-5,x,y,polygons,intersects),angles.push(angle))}return intersects.sort(SortIntersects)},GetRectangleIntersection:function(rectA,rectB,output){return void 0===output&&(output=new Rectangle$a),RectangleToRectangle$1(rectA,rectB)&&(output.x=Math.max(rectA.x,rectB.x),output.y=Math.max(rectA.y,rectB.y),output.width=Math.min(rectA.right,rectB.right)-output.x,output.height=Math.min(rectA.bottom,rectB.bottom)-output.y),output},GetRectangleToRectangle:function(lineD,rectB,out){var lineA,lineB,lineC;return void 0===out&&(out=[]),RectangleToRectangle(lineD,rectB)&&(lineA=lineD.getLineA(),lineB=lineD.getLineB(),lineC=lineD.getLineC(),lineD=lineD.getLineD(),GetLineToRectangle$1(lineA,rectB,out),GetLineToRectangle$1(lineB,rectB,out),GetLineToRectangle$1(lineC,rectB,out),GetLineToRectangle$1(lineD,rectB,out)),out},GetRectangleToTriangle:function(rect,lineC,out){var lineA,lineB;return void 0===out&&(out=[]),RectangleToTriangle(rect,lineC)&&(lineA=lineC.getLineA(),lineB=lineC.getLineB(),lineC=lineC.getLineC(),GetLineToRectangle(lineA,rect,out),GetLineToRectangle(lineB,rect,out),GetLineToRectangle(lineC,rect,out)),out},GetTriangleToCircle:function(lineC,circle,out){var lineA,lineB;return void 0===out&&(out=[]),TriangleToCircle(lineC,circle)&&(lineA=lineC.getLineA(),lineB=lineC.getLineB(),lineC=lineC.getLineC(),GetLineToCircle(lineA,circle,out),GetLineToCircle(lineB,circle,out),GetLineToCircle(lineC,circle,out)),out},GetTriangleToLine:BinaryFile_1,GetTriangleToTriangle:function(triangleA,lineC,out){var lineA,lineB;return void 0===out&&(out=[]),TriangleToTriangle(triangleA,lineC)&&(lineA=lineC.getLineA(),lineB=lineC.getLineB(),lineC=lineC.getLineC(),GetTriangleToLine(triangleA,lineA,out),GetTriangleToLine(triangleA,lineB,out),GetTriangleToLine(triangleA,lineC,out)),out},LineToCircle:Ceil_1,LineToLine:CeilAll_1,LineToRectangle:ContainsPoint_1$1,PointToLine:Equals_1$1,PointToLineSegment:function(point,yMax){if(!PointToLine(point,yMax))return!1;var xMin=Math.min(yMax.x1,yMax.x2),xMax=Math.max(yMax.x1,yMax.x2),yMin=Math.min(yMax.y1,yMax.y2),yMax=Math.max(yMax.y1,yMax.y2);return point.x>=xMin&&point.x<=xMax&&point.y>=yMin&&point.y<=yMax},RectangleToRectangle:Events_1,RectangleToTriangle:ContainsRect_1,RectangleToValues:function(rect,left,right,top,bottom,tolerance){return!(left>rect.right+(tolerance=void 0===tolerance?0:tolerance)||right<rect.left-tolerance||top>rect.bottom+tolerance||bottom<rect.top-tolerance)},TriangleToCircle:CopyFrom_1$1,TriangleToLine:GetAspectRatio_1,TriangleToTriangle:FitInside_1},Angle_1=function(line){return Math.atan2(line.y2-line.y1,line.x2-line.x1)},CenterOn_1$1=function(line,tx,ty){tx-=(line.x1+line.x2)/2,ty-=(line.y1+line.y2)/2;return line.x1+=tx,line.y1+=ty,line.x2+=tx,line.y2+=ty,line},Line$1=Floor_1,Clone_1$4=function(source){return new Line$1(source.x1,source.y1,source.x2,source.y2)},CopyFrom_1$3=function(source,dest){return dest.setTo(source.x1,source.y1,source.x2,source.y2)},Equals_1$3=function(line,toCompare){return line.x1===toCompare.x1&&line.y1===toCompare.y1&&line.x2===toCompare.x2&&line.y2===toCompare.y2},Length$1=Grid_1,Extend_1=function(line,left,right){void 0===right&&(right=left);var length=Length$1(line),slopX=line.x2-line.x1,slopY=line.y2-line.y1;return left&&(line.x1=line.x1-slopX/length*left,line.y1=line.y1-slopY/length*left),right&&(line.x2=line.x2+slopX/length*right,line.y2=line.y2+slopY/length*right),line},DistanceBetweenPoints=FitOutside_1,GetEaseFunction$4=GetEaseFunction_1,Point$g=JSONFile_1,GetEasedPoints_1=function(line,ease,endPoint,collinearThreshold,easeParams){void 0===collinearThreshold&&(collinearThreshold=0);var v,results=[],x1=line.x1,y1=line.y1,spaceX=line.x2-x1,spaceY=line.y2-y1,easeFunc=GetEaseFunction$4(ease,easeParams=void 0===easeParams?[]:easeParams),q=endPoint-1;for(i=0;i<q;i++)v=easeFunc(i/q),results.push(new Point$g(x1+spaceX*v,y1+spaceY*v));if(v=easeFunc(1),results.push(new Point$g(x1+spaceX*v,y1+spaceY*v)),0<collinearThreshold){for(var prevPoint=results[0],sortedResults=[prevPoint],i=1;i<results.length-1;i++){var point=results[i];DistanceBetweenPoints(prevPoint,point)>=collinearThreshold&&(sortedResults.push(point),prevPoint=point)}endPoint=results[results.length-1];return DistanceBetweenPoints(prevPoint,endPoint)<collinearThreshold&&sortedResults.pop(),sortedResults.push(endPoint),sortedResults}return results},Point$f=JSONFile_1,GetMidPoint_1=function(line,out){return(out=void 0===out?new Point$f:out).x=(line.x1+line.x2)/2,out.y=(line.y1+line.y2)/2,out},Point$e=JSONFile_1,GetNearestPoint_1=function(r,point,out){void 0===out&&(out=new Point$e);var x1=r.x1,y1=r.y1,x2=r.x2,y2=r.y2,r=(x2-x1)*(x2-x1)+(y2-y1)*(y2-y1);if(0==r)return out;r=((point.x-x1)*(x2-x1)+(point.y-y1)*(y2-y1))/r;return out.x=x1+r*(x2-x1),out.y=y1+r*(y2-y1),out},MATH_CONST$7=Tweens,Angle$4=Angle_1,Point$d=JSONFile_1,AtlasXMLFile_1=function(a,out){void 0===out&&(out=new Point$d);a=Angle$4(a)-MATH_CONST$7.TAU;return out.x=Math.cos(a),out.y=Math.sin(a),out},Body_1=function(L2,point){var x1=L2.x1,s=L2.y1,x2=L2.x2,y2=L2.y2,L2=(x2-x1)*(x2-x1)+(y2-s)*(y2-s);if(0==L2)return!1;s=((s-point.y)*(x2-x1)-(x1-point.x)*(y2-s))/L2;return Math.abs(s)*Math.sqrt(L2)},CustomMain=function(line){return Math.abs(line.y1-line.y2)},MATH_CONST$6=Tweens,Wrap$1=Vector_1,Angle$3=Angle_1,HTMLTextureFile_1=function(angle){angle=Angle$3(angle)-MATH_CONST$6.TAU;return Wrap$1(angle,-Math.PI,Math.PI)},MATH_CONST$5=Tweens,Angle$2=Angle_1,BitmapFontFile_1=function(line){return Math.cos(Angle$2(line)-MATH_CONST$5.TAU)},MATH_CONST$4=Tweens,Angle$1=Angle_1,BinaryFile_1=function(line){return Math.sin(Angle$1(line)-MATH_CONST$4.TAU)},Ceil_1=function(line,x,y){return line.x1+=x,line.y1+=y,line.x2+=x,line.y2+=y,line},CeilAll_1=function(line){return-((line.x2-line.x1)/(line.y2-line.y1))},Angle=Angle_1,NormalAngle=HTMLTextureFile_1,ContainsPoint_1$1=function(lineA,lineB){return 2*NormalAngle(lineB)-Math.PI-Angle(lineA)},Equals_1$1=function(line,x,y,ty){var c=Math.cos(ty),s=Math.sin(ty),tx=line.x1-x,ty=line.y1-y;return line.x1=tx*c-ty*s+x,line.y1=tx*s+ty*c+y,tx=line.x2-x,ty=line.y2-y,line.x2=tx*c-ty*s+x,line.y2=tx*s+ty*c+y,line},RotateAroundXY$4=Equals_1$1,ContainsRect_1=function(line,angle){var x=(line.x1+line.x2)/2,y=(line.y1+line.y2)/2;return RotateAroundXY$4(line,x,y,angle)},RotateAroundXY$3=Equals_1$1,CopyFrom_1$1=function(line,point,angle){return RotateAroundXY$3(line,point.x,point.y,angle)},GetAspectRatio_1=function(line,x,y,angle,length){return line.x1=x,line.y1=y,line.x2=x+Math.cos(angle)*length,line.y2=y+Math.sin(angle)*length,line},FitInside_1=function(line){return(line.y2-line.y1)/(line.x2-line.x1)},FitOutside_1=function(line){return Math.abs(line.x1-line.x2)},Floor_1=Floor_1;Floor_1.Angle=Angle_1,Floor_1.BresenhamPoints=BresenhamPoints_1,Floor_1.CenterOn=CenterOn_1$1,Floor_1.Clone=Clone_1$4,Floor_1.CopyFrom=CopyFrom_1$3,Floor_1.Equals=Equals_1$3,Floor_1.Extend=Extend_1,Floor_1.GetEasedPoints=GetEasedPoints_1,Floor_1.GetMidPoint=GetMidPoint_1,Floor_1.GetNearestPoint=GetNearestPoint_1,Floor_1.GetNormal=AtlasXMLFile_1,Floor_1.GetPoint=GetSize_1,Floor_1.GetPoints=AudioFile_1,Floor_1.GetShortestDistance=Body_1,Floor_1.Height=CustomMain,Floor_1.Length=Grid_1,Floor_1.NormalAngle=HTMLTextureFile_1,Floor_1.NormalX=BitmapFontFile_1,Floor_1.NormalY=BinaryFile_1,Floor_1.Offset=Ceil_1,Floor_1.PerpSlope=CeilAll_1,Floor_1.Random=Clone_1$1,Floor_1.ReflectAngle=ContainsPoint_1$1,Floor_1.Rotate=ContainsRect_1,Floor_1.RotateAroundPoint=CopyFrom_1$1,Floor_1.RotateAroundXY=Equals_1$1,Floor_1.SetToAngle=GetAspectRatio_1,Floor_1.Slope=FitInside_1,Floor_1.Width=FitOutside_1;var AtlasXMLFile_1=Floor_1,Face=BuildRight_1,GetFastValue$S=GetFastValue_1,GetSize_1=FloorAll_1,AudioFile_1=FromXY_1,Vertex=GetTileAtWorldXY_1,tempPosition=new AudioFile_1,tempRotation=new AudioFile_1,tempMatrix=new GetSize_1,flip=!0,defaultModelName="untitled",currentGroup="",currentMaterial="";function currentModel(result){return 0===result.models.length&&result.models.push({faces:[],name:defaultModelName,textureCoords:[],vertexNormals:[],vertices:[]}),currentGroup="",result.models[result.models.length-1]}var Body_1=function(data,flipUV){flip=flipUV=void 0===flipUV?!0:flipUV;var result={materials:{},materialLibraries:[],models:[]};currentMaterial=currentGroup="";for(var lines=data.split("\n"),i=0;i<lines.length;i++){var lineItems=function(line){var idx=line.indexOf("#");return-1<idx?line.substring(0,idx):line}(lines[i]).replace(/\s\s+/g," ").trim().split(" ");switch(lineItems[0].toLowerCase()){case"o":!function(modelName,result){modelName=2<=modelName.length?modelName[1]:defaultModelName,result.models.push({faces:[],name:modelName,textureCoords:[],vertexNormals:[],vertices:[]}),currentGroup=""}(lineItems,result);break;case"g":!function(lineItems){2===lineItems.length&&(currentGroup=lineItems[1])}(lineItems);break;case"v":!function(z,result){var len=z.length,x=2<=len?parseFloat(z[1]):0,y=3<=len?parseFloat(z[2]):0,z=4<=len?parseFloat(z[3]):0;currentModel(result).vertices.push({x:x,y:y,z:z})}(lineItems,result);break;case"vt":!function(w,result){var len=w.length,u=2<=len?parseFloat(w[1]):0,v=3<=len?parseFloat(w[2]):0,w=4<=len?parseFloat(w[3]):0;isNaN(u)&&(u=0),isNaN(v)&&(v=0),isNaN(w)&&(w=0),flip&&(v=1-v),currentModel(result).textureCoords.push({u:u,v:v,w:w})}(lineItems,result);break;case"vn":!function(z,result){var len=z.length,x=2<=len?parseFloat(z[1]):0,y=3<=len?parseFloat(z[2]):0,z=4<=len?parseFloat(z[3]):0;currentModel(result).vertexNormals.push({x:x,y:y,z:z})}(lineItems,result);break;case"f":!function(lineItems,result){var totalVertices=lineItems.length-1;if(!(totalVertices<3)){for(var face={group:currentGroup,material:currentMaterial,vertices:[]},i=0;i<totalVertices;i++){var textureCoordsIndex,vertexNormalIndex,vertexIndex,vertexValues=lineItems[i+1].split("/"),vvLen=vertexValues.length;vvLen<1||3<vvLen||(vertexNormalIndex=textureCoordsIndex=vertexIndex=0,vertexIndex=parseInt(vertexValues[0],10),1<vvLen&&""!==vertexValues[1]&&(textureCoordsIndex=parseInt(vertexValues[1],10)),2<vvLen&&(vertexNormalIndex=parseInt(vertexValues[2],10)),0!==vertexIndex&&(vertexIndex<0&&(vertexIndex=currentModel(result).vertices.length+1+vertexIndex),--textureCoordsIndex,--vertexIndex,--vertexNormalIndex,face.vertices.push({textureCoordsIndex:textureCoordsIndex,vertexIndex:vertexIndex,vertexNormalIndex:vertexNormalIndex})))}currentModel(result).faces.push(face)}}(lineItems,result);break;case"mtllib":!function(lineItems,result){2<=lineItems.length&&result.materialLibraries.push(lineItems[1])}(lineItems,result);break;case"usemtl":!function(lineItems){2<=lineItems.length&&(currentMaterial=lineItems[1])}(lineItems)}}return result},GetColor=AssignTileProperties_1,CustomMain=function(mtl){for(var output={},lines=mtl.split("\n"),currentMaterial="",i=0;i<lines.length;i++){var line=lines[i].trim();if(0!==line.indexOf("#")&&""!==line){var lineItems=line.replace(/\s\s+/g," ").trim().split(" ");switch(lineItems[0].toLowerCase()){case"newmtl":currentMaterial=lineItems[1];break;case"kd":var r=Math.floor(255*lineItems[1]),g=2<=lineItems.length?Math.floor(255*lineItems[2]):r,b=3<=lineItems.length?Math.floor(255*lineItems[3]):r;output[currentMaterial]=GetColor(r,g,b)}}}return output},HTMLTextureFile_1={Face:BuildRight_1,GenerateGridVerts:function(widthSet){var mesh=GetFastValue$S(widthSet,"mesh"),texture=GetFastValue$S(widthSet,"texture",null),textureFrame=GetFastValue$S(widthSet,"frame"),width=GetFastValue$S(widthSet,"width",1),height=GetFastValue$S(widthSet,"height",width),widthSegments=GetFastValue$S(widthSet,"widthSegments",1),heightSegments=GetFastValue$S(widthSet,"heightSegments",widthSegments),posX=GetFastValue$S(widthSet,"x",0),posY=GetFastValue$S(widthSet,"y",0),posZ=GetFastValue$S(widthSet,"z",0),rotateX=GetFastValue$S(widthSet,"rotateX",0),rotateY=GetFastValue$S(widthSet,"rotateY",0),rotateZ=GetFastValue$S(widthSet,"rotateZ",0),zIsUp=GetFastValue$S(widthSet,"zIsUp",!0),isOrtho=GetFastValue$S(widthSet,"isOrtho",!!mesh&&mesh.dirtyCache[11]),colors=GetFastValue$S(widthSet,"colors",[16777215]),alphas=GetFastValue$S(widthSet,"alphas",[1]),tile=GetFastValue$S(widthSet,"tile",!1),flipY=GetFastValue$S(widthSet,"flipY",!1),widthSet=GetFastValue$S(widthSet,"width",null),result={faces:[],verts:[]};if(tempPosition.set(posX,posY,posZ),tempRotation.set(rotateX,rotateY,rotateZ),tempMatrix.fromRotationXYTranslation(tempRotation,tempPosition,zIsUp),!texture&&mesh)texture=mesh.texture;else{if(!mesh||"string"!=typeof texture)return result;texture=mesh.scene.sys.textures.get(texture)}textureFrame=texture.get(textureFrame);!widthSet&&isOrtho&&texture&&mesh&&(width=textureFrame.width/mesh.height,height=textureFrame.height/mesh.height);var halfWidth=width/2,halfHeight=height/2,gridX=Math.floor(widthSegments),gridY=Math.floor(heightSegments),gridX1=gridX+1,gridY1=gridY+1,segmentWidth=width/gridX,segmentHeight=height/gridY,uvs=[],vertices=[],frameU0=0,frameU1=1,frameV0=0,frameV1=1;textureFrame&&(frameU0=textureFrame.u0,frameU1=textureFrame.u1,frameV1=flipY?(frameV0=textureFrame.v1,textureFrame.v0):(frameV0=textureFrame.v0,textureFrame.v1));for(var frameU=frameU1-frameU0,frameV=frameV1-frameV0,iy=0;iy<gridY1;iy++)for(var y=iy*segmentHeight-halfHeight,ix=0;ix<gridX1;ix++)vertices.push(ix*segmentWidth-halfWidth,-y),uvs.push(frameU0+ix/gridX*frameU,frameV0+iy/gridY*frameV);Array.isArray(colors)||(colors=[colors]),Array.isArray(alphas)||(alphas=[alphas]);var alphaIndex=0,colorIndex=0;for(iy=0;iy<gridY;iy++)for(ix=0;ix<gridX;ix++){var vert3=2*(ix+gridX1*iy),vert4=2*(ix+gridX1*(iy+1)),vert5=2*(ix+1+gridX1*(iy+1)),d=2*(ix+1+gridX1*iy),color=colors[colorIndex],vert6=alphas[alphaIndex],vert1=new Vertex(vertices[vert3],vertices[1+vert3],0,uvs[vert3],uvs[1+vert3],color,vert6).transformMat4(tempMatrix),vert2=new Vertex(vertices[vert4],vertices[1+vert4],0,uvs[vert4],uvs[1+vert4],color,vert6).transformMat4(tempMatrix),vert3=new Vertex(vertices[d],vertices[1+d],0,uvs[d],uvs[1+d],color,vert6).transformMat4(tempMatrix),vert4=new Vertex(vertices[vert4],vertices[1+vert4],0,uvs[vert4],uvs[1+vert4],color,vert6).transformMat4(tempMatrix),vert5=new Vertex(vertices[vert5],vertices[1+vert5],0,uvs[vert5],uvs[1+vert5],color,vert6).transformMat4(tempMatrix),vert6=new Vertex(vertices[d],vertices[1+d],0,uvs[d],uvs[1+d],color,vert6).transformMat4(tempMatrix);tile&&(vert1.setUVs(frameU0,frameV1),vert2.setUVs(frameU0,frameV0),vert3.setUVs(frameU1,frameV1),vert4.setUVs(frameU0,frameV0),vert5.setUVs(frameU1,frameV0),vert6.setUVs(frameU1,frameV1)),++colorIndex===colors.length&&(colorIndex=0),++alphaIndex===alphas.length&&(alphaIndex=0),result.verts.push(vert1,vert2,vert3,vert4,vert5,vert6),result.faces.push(new Face(vert1,vert2,vert3),new Face(vert4,vert5,vert6))}return mesh&&(mesh.faces=mesh.faces.concat(result.faces),mesh.vertices=mesh.vertices.concat(result.verts)),result},GenerateObjVerts:CenterOn_1,GenerateVerts:CircumCenter_1,ParseObj:Body_1,ParseObjMaterial:CustomMain,RotateFace:function(ty,tx,v1,v2){var x,y;void 0===v1&&void 0===v2&&(x=(v3=ty.getInCenter()).x,y=v3.y);var c=Math.cos(tx),s=Math.sin(tx),v1=ty.vertex1,v2=ty.vertex2,v3=ty.vertex3,tx=v1.x-x,ty=v1.y-y;v1.set(tx*c-ty*s+x,tx*s+ty*c+y),tx=v2.x-x,ty=v2.y-y,v2.set(tx*c-ty*s+x,tx*s+ty*c+y),tx=v3.x-x,ty=v3.y-y,v3.set(tx*c-ty*s+x,tx*s+ty*c+y)},Vertex:GetTileAtWorldXY_1},Point$c=JSONFile_1,BitmapFontFile_1=function(source){return new Point$c(source.x,source.y)},BinaryFile_1=function(source,dest){return dest.setTo(source.x,source.y)},Ceil_1=function(point,toCompare){return point.x===toCompare.x&&point.y===toCompare.y},CeilAll_1=function(point){return point.setTo(Math.floor(point.x),Math.floor(point.y))},Point$b=JSONFile_1,Clone_1$1=function(points,out){if(void 0===out&&(out=new Point$b),!Array.isArray(points))throw new Error("GetCentroid points argument must be an array");var len=points.length;if(len<1)throw new Error("GetCentroid points array must not be empty");if(1===len)out.x=points[0].x,out.y=points[0].y;else{for(var i=0;i<len;i++)out.x+=points[i].x,out.y+=points[i].y;out.x/=len,out.y/=len}return out},ContainsPoint_1$1=function(point){return Math.sqrt(point.x*point.x+point.y*point.y)},ContainsRect_1=function(point){return point.x*point.x+point.y*point.y},Rectangle$9=HasTileAtWorldXY_1,CopyFrom_1$1=function(points,out){void 0===out&&(out=new Rectangle$9);for(var xMax=Number.NEGATIVE_INFINITY,xMin=Number.POSITIVE_INFINITY,yMax=Number.NEGATIVE_INFINITY,yMin=Number.POSITIVE_INFINITY,i=0;i<points.length;i++){var point=points[i];point.x>xMax&&(xMax=point.x),point.x<xMin&&(xMin=point.x),point.y>yMax&&(yMax=point.y),point.y<yMin&&(yMin=point.y)}return out.x=xMin,out.y=yMin,out.width=xMax-xMin,out.height=yMax-yMin,out},Point$a=JSONFile_1,Equals_1$1=function(pointA,pointB,t,out){return void 0===t&&(t=0),(out=void 0===out?new Point$a:out).x=pointA.x+(pointB.x-pointA.x)*t,out.y=pointA.y+(pointB.y-pointA.y)*t,out},GetAspectRatio_1=function(point){return point.setTo(point.y,point.x)},Point$9=JSONFile_1,FitInside_1=function(point,out){return(out=void 0===out?new Point$9:out).setTo(-point.x,-point.y)},Point$8=JSONFile_1,GetMagnitudeSq=ContainsRect_1,FitOutside_1=function(amt,pointB,out){void 0===out&&(out=new Point$8);amt=(amt.x*pointB.x+amt.y*pointB.y)/GetMagnitudeSq(pointB);return 0!=amt&&(out.x=amt*pointB.x,out.y=amt*pointB.y),out},Point$7=JSONFile_1,Floor_1=function(amt,pointB,out){void 0===out&&(out=new Point$7);amt=amt.x*pointB.x+amt.y*pointB.y;return 0!=amt&&(out.x=amt*pointB.x,out.y=amt*pointB.y),out},GetMagnitude=ContainsPoint_1$1,FloorAll_1=function(point,magnitude){var m;return 0===point.x&&0===point.y||(m=GetMagnitude(point),point.x/=m,point.y/=m),point.x*=magnitude,point.y*=magnitude,point},FromXY_1=JSONFile_1;FromXY_1.Ceil=function(point){return point.setTo(Math.ceil(point.x),Math.ceil(point.y))},FromXY_1.Clone=BitmapFontFile_1,FromXY_1.CopyFrom=BinaryFile_1,FromXY_1.Equals=Ceil_1,FromXY_1.Floor=CeilAll_1,FromXY_1.GetCentroid=Clone_1$1,FromXY_1.GetMagnitude=ContainsPoint_1$1,FromXY_1.GetMagnitudeSq=ContainsRect_1,FromXY_1.GetRectangleFromPoints=CopyFrom_1$1,FromXY_1.Interpolate=Equals_1$1,FromXY_1.Invert=GetAspectRatio_1,FromXY_1.Negative=FitInside_1,FromXY_1.Project=FitOutside_1,FromXY_1.ProjectUnit=Floor_1,FromXY_1.SetMagnitude=FloorAll_1;var AudioFile_1=FromXY_1,Polygon$1=GetCenter_1,GetSize_1=function(polygon){return new Polygon$1(polygon.points)},Contains$2=Inflate_1,AssignTileProperties_1=function(polygon,point){return Contains$2(polygon,point.x,point.y)},BuildRight_1=function(polygon,output){void 0===output&&(output=[]);for(var i=0;i<polygon.points.length;i++)output.push(polygon.points[i].x),output.push(polygon.points[i].y);return output},CenterOn_1=function(polygon){return polygon.points.reverse(),polygon};function simplifyDouglasPeucker(points,sqTolerance){var last=points.length-1,simplified=[points[0]];return function simplifyDPStep(points,first,last,sqTolerance,simplified){for(var index,p,t,p2,x,y,dx,maxSqDist=sqTolerance,i=first+1;i<last;i++){var sqDist=(p=points[i],t=points[first],p2=points[last],sqDist=dx=y=x=void 0,x=t.x,y=t.y,dx=p2.x-x,sqDist=p2.y-y,0===dx&&0===sqDist||(1<(t=((p.x-x)*dx+(p.y-y)*sqDist)/(dx*dx+sqDist*sqDist))?(x=p2.x,y=p2.y):0<t&&(x+=dx*t,y+=sqDist*t)),(dx=p.x-x)*dx+(sqDist=p.y-y)*sqDist);maxSqDist<sqDist&&(index=i,maxSqDist=sqDist)}sqTolerance<maxSqDist&&(1<index-first&&simplifyDPStep(points,first,index,sqTolerance,simplified),simplified.push(points[index]),1<last-index&&simplifyDPStep(points,index,last,sqTolerance,simplified))}(points,0,last,sqTolerance,simplified),simplified.push(points[last]),simplified}CircumCenter_1=function(polygon,sqTolerance,highestQuality){void 0===sqTolerance&&(sqTolerance=1),void 0===highestQuality&&(highestQuality=!1);var points=polygon.points;return 2<points.length&&(sqTolerance=sqTolerance*sqTolerance,highestQuality||(points=function(points,sqTolerance){for(var point,p1,dy,dx,prevPoint=points[0],newPoints=[prevPoint],i=1,len=points.length;i<len;i++)point=points[i],dy=prevPoint,dx=void 0,dx=(p1=point).x-dy.x,dy=p1.y-dy.y,sqTolerance<dx*dx+dy*dy&&(newPoints.push(point),prevPoint=point);return prevPoint!==point&&newPoints.push(point),newPoints}(points,sqTolerance)),polygon.setTo(simplifyDouglasPeucker(points,sqTolerance))),polygon},GetTileAtWorldXY_1=function(polygon,x,y){for(var points=polygon.points,i=0;i<points.length;i++)points[i].x+=x,points[i].y+=y;return polygon},BitmapFontFile_1=GetCenter_1;BitmapFontFile_1.Clone=GetSize_1,BitmapFontFile_1.Contains=Inflate_1,BitmapFontFile_1.ContainsPoint=AssignTileProperties_1,BitmapFontFile_1.Earcut=AtlasJSONFile_1,BitmapFontFile_1.GetAABB=BuildFromPolygon_1,BitmapFontFile_1.GetNumberArray=BuildRight_1,BitmapFontFile_1.GetPoints=Centroid_1,BitmapFontFile_1.Perimeter=plugins,BitmapFontFile_1.Reverse=CenterOn_1,BitmapFontFile_1.Simplify=CircumCenter_1,BitmapFontFile_1.Smooth=AsepriteFile_1,BitmapFontFile_1.Translate=GetTileAtWorldXY_1;var BinaryFile_1=BitmapFontFile_1,Ceil_1=function(rect){return rect.x=Math.ceil(rect.x),rect.y=Math.ceil(rect.y),rect},CeilAll_1=function(rect){return rect.x=Math.ceil(rect.x),rect.y=Math.ceil(rect.y),rect.width=Math.ceil(rect.width),rect.height=Math.ceil(rect.height),rect},Rectangle$8=HasTileAtWorldXY_1,Clone_1$1=function(source){return new Rectangle$8(source.x,source.y,source.width,source.height)},Contains$1=arcade,ContainsPoint_1$1=function(rect,point){return Contains$1(rect,point.x,point.y)},ContainsRect_1=function(rectA,rectB){return!(rectB.width*rectB.height>rectA.width*rectA.height)&&(rectB.x>rectA.x&&rectB.x<rectA.right&&rectB.right>rectA.x&&rectB.right<rectA.right&&rectB.y>rectA.y&&rectB.y<rectA.bottom&&rectB.bottom>rectA.y&&rectB.bottom<rectA.bottom)},CopyFrom_1$1=function(source,dest){return dest.setTo(source.x,source.y,source.width,source.height)},Equals_1$1=function(rect,toCompare){return rect.x===toCompare.x&&rect.y===toCompare.y&&rect.width===toCompare.width&&rect.height===toCompare.height},GetAspectRatio_1=function(rect){return 0===rect.height?NaN:rect.width/rect.height},GetAspectRatio$1=GetAspectRatio_1,FitInside_1=function(target,source){var ratio=GetAspectRatio$1(target);return ratio<GetAspectRatio$1(source)?target.setSize(source.height*ratio,source.height):target.setSize(source.width,source.width/ratio),target.setPosition(source.centerX-target.width/2,source.centerY-target.height/2)},GetAspectRatio=GetAspectRatio_1,FitOutside_1=function(target,source){var ratio=GetAspectRatio(target);return ratio>GetAspectRatio(source)?target.setSize(source.height*ratio,source.height):target.setSize(source.width,source.width/ratio),target.setPosition(source.centerX-target.width/2,source.centerY-target.height/2)},Floor_1=function(rect){return rect.x=Math.floor(rect.x),rect.y=Math.floor(rect.y),rect},FloorAll_1=function(rect){return rect.x=Math.floor(rect.x),rect.y=Math.floor(rect.y),rect.width=Math.floor(rect.width),rect.height=Math.floor(rect.height),rect},Rectangle$7=HasTileAtWorldXY_1,FromXY_1=function(x1,y1,x2,y2,out){return(out=void 0===out?new Rectangle$7:out).setTo(Math.min(x1,x2),Math.min(y1,y2),Math.abs(x1-x2),Math.abs(y1-y2))},Point$5=JSONFile_1,GetCenter_1=function(rect,out){return(out=void 0===out?new Point$5:out).x=rect.centerX,out.y=rect.centerY,out},Point$4=JSONFile_1,GetSize_1=function(rect,out){return(out=void 0===out?new Point$4:out).x=rect.width,out.y=rect.height,out},CenterOn$1=CenterOn_1$2,Inflate_1=function(rect,x,y){var cx=rect.centerX,cy=rect.centerY;return rect.setSize(rect.width+2*x,rect.height+2*y),CenterOn$1(rect,cx,cy)},Rectangle$6=HasTileAtWorldXY_1,Intersects$1=Events_1,AssignTileProperties_1=function(rectA,rectB,out){return void 0===out&&(out=new Rectangle$6),Intersects$1(rectA,rectB)?(out.x=Math.max(rectA.x,rectB.x),out.y=Math.max(rectA.y,rectB.y),out.width=Math.min(rectA.right,rectB.right)-out.x,out.height=Math.min(rectA.bottom,rectB.bottom)-out.y):out.setEmpty(),out},BuildFromPolygon_1=function(target,points){for(var minX=target.x,maxX=target.right,minY=target.y,maxY=target.bottom,i=0;i<points.length;i++)minX=Math.min(minX,points[i].x),maxX=Math.max(maxX,points[i].x),minY=Math.min(minY,points[i].y),maxY=Math.max(maxY,points[i].y);return target.x=minX,target.y=minY,target.width=maxX-minX,target.height=maxY-minY,target},BuildRight_1=function(target,maxY){var minY=Math.min(target.x,maxY.x),maxX=Math.max(target.right,maxY.right);target.x=minY,target.width=maxX-minY;minY=Math.min(target.y,maxY.y),maxY=Math.max(target.bottom,maxY.bottom);return target.y=minY,target.height=maxY-minY,target},Centroid_1=function(target,maxX,maxY){var minY=Math.min(target.x,maxX),maxX=Math.max(target.right,maxX);target.x=minY,target.width=maxX-minY;minY=Math.min(target.y,maxY),maxY=Math.max(target.bottom,maxY);return target.y=minY,target.height=maxY-minY,target},plugins=function(rect,x,y){return rect.x+=x,rect.y+=y,rect},CenterOn_1=function(rect,point){return rect.x+=point.x,rect.y+=point.y,rect},CircumCenter_1=function(rectA,rectB){return rectA.x<rectB.right&&rectA.right>rectB.x&&rectA.y<rectB.bottom&&rectA.bottom>rectB.y},Point$3=JSONFile_1,DegToRad$2=DegToRad_1,AsepriteFile_1=function(rectangle,dy,out){void 0===out&&(out=new Point$3),dy=DegToRad$2(dy);var s=Math.sin(dy),c=Math.cos(dy),dx=0<c?rectangle.width/2:rectangle.width/-2,dy=0<s?rectangle.height/2:rectangle.height/-2;return Math.abs(dx*s)<Math.abs(dy*c)?dy=dx*s/c:dx=dy*c/s,out.x=dx+rectangle.centerX,out.y=dy+rectangle.centerY,out},Between=Bodies_1,ContainsRect=ContainsRect_1,Point$2=JSONFile_1,GetTileAtWorldXY_1=function(outer,inner,out){if(void 0===out&&(out=new Point$2),ContainsRect(outer,inner))switch(Between(0,3)){case 0:out.x=outer.x+Math.random()*(inner.right-outer.x),out.y=outer.y+Math.random()*(inner.top-outer.y);break;case 1:out.x=inner.x+Math.random()*(outer.right-inner.x),out.y=inner.bottom+Math.random()*(outer.bottom-inner.bottom);break;case 2:out.x=outer.x+Math.random()*(inner.x-outer.x),out.y=inner.y+Math.random()*(outer.bottom-inner.y);break;case 3:out.x=inner.right+Math.random()*(outer.right-inner.right),out.y=outer.y+Math.random()*(inner.bottom-outer.y)}return out},BitmapFontFile_1=function(rect,toCompare){return rect.width===toCompare.width&&rect.height===toCompare.height},Events_1=function(rect,x,y){return void 0===y&&(y=x),rect.width*=x,rect.height*=y,rect},Bodies_1=HasTileAtWorldXY_1;Bodies_1.Area=function(rect){return rect.width*rect.height},Bodies_1.Ceil=Ceil_1,Bodies_1.CeilAll=CeilAll_1,Bodies_1.CenterOn=CenterOn_1$2,Bodies_1.Clone=Clone_1$1,Bodies_1.Contains=arcade,Bodies_1.ContainsPoint=ContainsPoint_1$1,Bodies_1.ContainsRect=ContainsRect_1,Bodies_1.CopyFrom=CopyFrom_1$1,Bodies_1.Decompose=Decompose_1$1,Bodies_1.Equals=Equals_1$1,Bodies_1.FitInside=FitInside_1,Bodies_1.FitOutside=FitOutside_1,Bodies_1.Floor=Floor_1,Bodies_1.FloorAll=FloorAll_1,Bodies_1.FromPoints=FromPoints_1,Bodies_1.FromXY=FromXY_1,Bodies_1.GetAspectRatio=GetAspectRatio_1,Bodies_1.GetCenter=GetCenter_1,Bodies_1.GetPoint=GetPoint_1$3,Bodies_1.GetPoints=GetPoints_1$4,Bodies_1.GetSize=GetSize_1,Bodies_1.Inflate=Inflate_1,Bodies_1.Intersection=AssignTileProperties_1,Bodies_1.MarchingAnts=BuildEquilateral_1,Bodies_1.MergePoints=BuildFromPolygon_1,Bodies_1.MergeRect=BuildRight_1,Bodies_1.MergeXY=Centroid_1,Bodies_1.Offset=plugins,Bodies_1.OffsetPoint=CenterOn_1,Bodies_1.Overlaps=CircumCenter_1,Bodies_1.Perimeter=geom,Bodies_1.PerimeterPoint=AsepriteFile_1,Bodies_1.Random=Axes_1,Bodies_1.RandomOutside=GetTileAtWorldXY_1,Bodies_1.SameDimensions=BitmapFontFile_1,Bodies_1.Scale=Events_1,Bodies_1.Union=MatterGameObject_1;var AssignTileProperties_1=Bodies_1,Triangle$5=Engine_1,BuildEquilateral_1=function(x,y,length){var height=length*(Math.sqrt(3)/2);return new Triangle$5(x,y,x+length/2,y+height,x-length/2,y+height)},EarCut=AtlasJSONFile_1,Triangle$4=Engine_1,BuildFromPolygon_1=function(data,holes,scaleX,scaleY,out){void 0===scaleX&&(scaleX=1),void 0===scaleY&&(scaleY=1),void 0===out&&(out=[]);for(var x1,y1,x2,y2,x3,y3,tris=EarCut(data,holes=void 0===holes?null:holes),i=0;i<tris.length;i+=3)y2=tris[i],x3=tris[i+1],y3=tris[i+2],x1=data[2*y2]*scaleX,y1=data[2*y2+1]*scaleY,x2=data[2*x3]*scaleX,y2=data[2*x3+1]*scaleY,x3=data[2*y3]*scaleX,y3=data[2*y3+1]*scaleY,out.push(new Triangle$4(x1,y1,x2,y2,x3,y3));return out},Triangle$3=Engine_1,BuildRight_1=function(x,y,width,height){return new Triangle$3(x,y,x,y-(height=void 0===height?width:height),x+width,y)},Point$1=JSONFile_1,Centroid_1=function(triangle,out){return(out=void 0===out?new Point$1:out).x=(triangle.x1+triangle.x2+triangle.x3)/3,out.y=(triangle.y1+triangle.y2+triangle.y3)/3,out},plugins=function(triangle,x,y){return triangle.x1+=x,triangle.y1+=y,triangle.x2+=x,triangle.y2+=y,triangle.x3+=x,triangle.y3+=y,triangle},Centroid=Centroid_1,Offset=plugins,CenterOn_1=function(triangle,diffX,y,diffY){diffY=(diffY=void 0===diffY?Centroid:diffY)(triangle),diffX-=diffY.x,diffY=y-diffY.y;return Offset(triangle,diffX,diffY)},Vector2$q=BuildTilesetIndex_1;var CircumCenter_1=function(numy,out){void 0===out&&(out=new Vector2$q);var cx=numy.x3,cy=numy.y3,ax=numy.x1-cx,ay=numy.y1-cy,bx=numy.x2-cx,by=numy.y2-cy,denom=2*(ax*by-ay*bx),numy=ax*(bx*bx+by*by)-(ax*ax+ay*ay)*bx;return out.x=cx-(ay*(bx*bx+by*by)-(ax*ax+ay*ay)*by)/denom,out.y=cy+numy/denom,out},Circle$2=Svg_1,geom=function(minY,out){void 0===out&&(out=new Circle$2);var minX,dx,dy,x1=minY.x1,y1=minY.y1,x2=minY.x2,y2=minY.y2,x3=minY.x3,y3=minY.y3,A=x2-x1,B=y2-y1,C=x3-x1,D=y3-y1,E=A*(x1+x2)+B*(y1+y2),F=C*(x1+x3)+D*(y1+y3),G=2*(A*(y3-y2)-B*(x3-x2));return Math.abs(G)<1e-6?(minX=Math.min(x1,x2,x3),minY=Math.min(y1,y2,y3),dx=.5*(Math.max(x1,x2,x3)-minX),dy=.5*(Math.max(y1,y2,y3)-minY),out.x=minX+dx,out.y=minY+dy):(out.x=(D*E-B*F)/G,out.y=(A*F-C*E)/G,dx=out.x-x1,dy=out.y-y1),out.radius=Math.sqrt(dx*dx+dy*dy),out},Triangle$2=Engine_1,AsepriteFile_1=function(source){return new Triangle$2(source.x1,source.y1,source.x2,source.y2,source.x3,source.y3)},Contains=HTMLFile_1,Axes_1=function(triangle,point){return Contains(triangle,point.x,point.y)},GetTileAtWorldXY_1=function(source,dest){return dest.setTo(source.x1,source.y1,source.x2,source.y2,source.x3,source.y3)},BitmapFontFile_1=function(triangle,toCompare){return triangle.x1===toCompare.x1&&triangle.y1===toCompare.y1&&triangle.x2===toCompare.x2&&triangle.y2===toCompare.y2&&triangle.x3===toCompare.x3&&triangle.y3===toCompare.y3},Point=JSONFile_1;function getLength(x1,y1,x,y){x=x1-x,y=y1-y;return Math.sqrt(x*x+y*y)}var Events_1=function(p,out){void 0===out&&(out=new Point);var x1=p.x1,y1=p.y1,x2=p.x2,y2=p.y2,x3=p.x3,y3=p.y3,d1=getLength(x3,y3,x2,y2),d2=getLength(x1,y1,x3,y3),d3=getLength(x2,y2,x1,y1),p=d1+d2+d3;return out.x=(x1*d1+x2*d2+x3*d3)/p,out.y=(y1*d1+y2*d2+y3*d3)/p,out},Length=Grid_1,MatterGameObject_1=function(line3){var line1=line3.getLineA(),line2=line3.getLineB(),line3=line3.getLineC();return Length(line1)+Length(line2)+Length(line3)},Bodies_1=function(triangle,x,y,ty){var c=Math.cos(ty),s=Math.sin(ty),tx=triangle.x1-x,ty=triangle.y1-y;return triangle.x1=tx*c-ty*s+x,triangle.y1=tx*s+ty*c+y,tx=triangle.x2-x,ty=triangle.y2-y,triangle.x2=tx*c-ty*s+x,triangle.y2=tx*s+ty*c+y,tx=triangle.x3-x,ty=triangle.y3-y,triangle.x3=tx*c-ty*s+x,triangle.y3=tx*s+ty*c+y,triangle},RotateAroundXY$1=Bodies_1,InCenter=Events_1,AtlasJSONFile_1=function(triangle,angle){var point=InCenter(triangle);return RotateAroundXY$1(triangle,point.x,point.y,angle)},RotateAroundXY=Bodies_1,JSONFile_1=function(triangle,point,angle){return RotateAroundXY(triangle,point.x,point.y,angle)},Grid_1=Engine_1;Grid_1.Area=function(y3){var x1=y3.x1,y1=y3.y1,x2=y3.x2,y2=y3.y2,x3=y3.x3,y3=y3.y3;return Math.abs(((x3-x1)*(y2-y1)-(x2-x1)*(y3-y1))/2)},Grid_1.BuildEquilateral=BuildEquilateral_1,Grid_1.BuildFromPolygon=BuildFromPolygon_1,Grid_1.BuildRight=BuildRight_1,Grid_1.CenterOn=CenterOn_1,Grid_1.Centroid=Centroid_1,Grid_1.CircumCenter=CircumCenter_1,Grid_1.CircumCircle=geom,Grid_1.Clone=AsepriteFile_1,Grid_1.Contains=HTMLFile_1,Grid_1.ContainsArray=GetTilesWithin_1,Grid_1.ContainsPoint=Axes_1,Grid_1.CopyFrom=GetTileAtWorldXY_1,Grid_1.Decompose=input,Grid_1.Equals=BitmapFontFile_1,Grid_1.GetPoint=Composite_1,Grid_1.GetPoints=IsInLayerBounds_1,Grid_1.InCenter=Events_1,Grid_1.Perimeter=MatterGameObject_1,Grid_1.Offset=plugins,Grid_1.Random=MatterImage_1,Grid_1.Rotate=AtlasJSONFile_1,Grid_1.RotateAroundPoint=JSONFile_1,Grid_1.RotateAroundXY=Bodies_1;var geom=Extend_1$1(!1,{Circle:AnimationJSONFile_1,Ellipse:Pair_1,Intersects:Parse2DArray_1,Line:AtlasXMLFile_1,Mesh:HTMLTextureFile_1,Point:AudioFile_1,Polygon:BinaryFile_1,Rectangle:AssignTileProperties_1,Triangle:Grid_1},loader),AsepriteFile_1=function(textureManager,alphaTolerance){return function(hitArea,x,y,alpha){alpha=textureManager.getPixelAlpha(x,y,alpha.texture.key,alpha.frame.name);return alpha&&alphaTolerance<=alpha}},GetTilesWithin_1=function(gameObject,hitArea,hitAreaCallback){return{gameObject:gameObject,enabled:!0,alwaysEnabled:!1,draggable:!1,dropZone:!1,cursor:!1,target:null,camera:null,hitArea:hitArea,hitAreaCallback:hitAreaCallback,hitAreaDebug:null,customHitArea:!1,localX:0,localY:0,dragState:0,dragStartX:0,dragStartY:0,dragStartXGlobal:0,dragStartYGlobal:0,dragX:0,dragY:0}},Axes_1=new Class_1({initialize:function(pad,index){this.pad=pad,this.events=pad.events,this.index=index,this.value=0,this.threshold=.1},update:function(value){this.value=value},getValue:function(){return Math.abs(this.value)<this.threshold?0:this.value},destroy:function(){this.pad=null,this.events=null}}),GetTileAtWorldXY_1={BUTTON_DOWN:"down",BUTTON_UP:"up",CONNECTED:"connected",DISCONNECTED:"disconnected",GAMEPAD_BUTTON_DOWN:"down",GAMEPAD_BUTTON_UP:"up"},Events$k=GetTileAtWorldXY_1,input=new Class_1({initialize:function(pad,index){this.pad=pad,this.events=pad.manager,this.index=index,this.value=0,this.threshold=1,this.pressed=!1},update:function(value){this.value=value;var pad=this.pad,index=this.index;value>=this.threshold?this.pressed||(this.pressed=!0,this.events.emit(Events$k.BUTTON_DOWN,pad,this,value),this.pad.emit(Events$k.GAMEPAD_BUTTON_DOWN,index,value,this)):this.pressed&&(this.pressed=!1,this.events.emit(Events$k.BUTTON_UP,pad,this,value),this.pad.emit(Events$k.GAMEPAD_BUTTON_UP,index,value,this))},destroy:function(){this.pad=null,this.events=null}}),Axis=Axes_1,Button$1=input,BitmapFontFile_1=Class_1,EventEmitter$a=eventemitter3.exports,Vector2$p=BuildTilesetIndex_1,Composite_1=new BitmapFontFile_1({Extends:EventEmitter$a,initialize:function(_noAxis,pad){EventEmitter$a.call(this),this.manager=_noAxis,this.pad=pad,this.id=pad.id,this.index=pad.index;for(var buttons=[],i=0;i<pad.buttons.length;i++)buttons.push(new Button$1(this,i));this.buttons=buttons;for(var axes=[],i=0;i<pad.axes.length;i++)axes.push(new Axis(this,i));this.axes=axes,this.vibration=pad.vibrationActuator;_noAxis={value:0,pressed:!1};this._LCLeft=buttons[14]||_noAxis,this._LCRight=buttons[15]||_noAxis,this._LCTop=buttons[12]||_noAxis,this._LCBottom=buttons[13]||_noAxis,this._RCLeft=buttons[2]||_noAxis,this._RCRight=buttons[1]||_noAxis,this._RCTop=buttons[3]||_noAxis,this._RCBottom=buttons[0]||_noAxis,this._FBLeftTop=buttons[4]||_noAxis,this._FBLeftBottom=buttons[6]||_noAxis,this._FBRightTop=buttons[5]||_noAxis,this._FBRightBottom=buttons[7]||_noAxis;_noAxis={value:0};this._HAxisLeft=axes[0]||_noAxis,this._VAxisLeft=axes[1]||_noAxis,this._HAxisRight=axes[2]||_noAxis,this._VAxisRight=axes[3]||_noAxis,this.leftStick=new Vector2$p,this.rightStick=new Vector2$p,this._created=performance.now()},getAxisTotal:function(){return this.axes.length},getAxisValue:function(index){return this.axes[index].getValue()},setAxisThreshold:function(value){for(var i=0;i<this.axes.length;i++)this.axes[i].threshold=value},getButtonTotal:function(){return this.buttons.length},getButtonValue:function(index){return this.buttons[index].value},isButtonDown:function(index){return this.buttons[index].pressed},update:function(pad){if(!(pad.timestamp<this._created)){for(var localButtons=this.buttons,gamepadButtons=pad.buttons,len=localButtons.length,i=0;i<len;i++)localButtons[i].update(gamepadButtons[i].value);var localAxes=this.axes,gamepadAxes=pad.axes,len=localAxes.length;for(i=0;i<len;i++)localAxes[i].update(gamepadAxes[i]);2<=len&&(this.leftStick.set(localAxes[0].getValue(),localAxes[1].getValue()),4<=len&&this.rightStick.set(localAxes[2].getValue(),localAxes[3].getValue()))}},destroy:function(){var i;for(this.removeAllListeners(),this.manager=null,this.pad=null,i=0;i<this.buttons.length;i++)this.buttons[i].destroy();for(i=0;i<this.axes.length;i++)this.axes[i].destroy();this.buttons=[],this.axes=[]},connected:{get:function(){return this.pad.connected}},timestamp:{get:function(){return this.pad.timestamp}},left:{get:function(){return this._LCLeft.pressed}},right:{get:function(){return this._LCRight.pressed}},up:{get:function(){return this._LCTop.pressed}},down:{get:function(){return this._LCBottom.pressed}},A:{get:function(){return this._RCBottom.pressed}},Y:{get:function(){return this._RCTop.pressed}},X:{get:function(){return this._RCLeft.pressed}},B:{get:function(){return this._RCRight.pressed}},L1:{get:function(){return this._FBLeftTop.value}},L2:{get:function(){return this._FBLeftBottom.value}},R1:{get:function(){return this._FBRightTop.value}},R2:{get:function(){return this._FBRightBottom.value}}}),GetValue$d=GetValue_1,inputPlugins={},IsInLayerBounds_1={register:function(key,plugin,mapping,settingsKey,configKey){inputPlugins[key]={plugin:plugin,mapping:mapping,settingsKey:settingsKey,configKey:configKey}},getPlugin:function(key){return inputPlugins[key]},install:function(target){var key,sys=target.scene.sys,settings=sys.settings.input,config=sys.game.config;for(key in inputPlugins){var source=inputPlugins[key].plugin,mapping=inputPlugins[key].mapping,settingsKey=inputPlugins[key].settingsKey,configKey=inputPlugins[key].configKey;GetValue$d(settings,settingsKey,config[configKey])&&(target[mapping]=new source(target))}},remove:function(key){inputPlugins.hasOwnProperty(key)&&delete inputPlugins[key]}},Events_1=IsInLayerBounds_1,MatterGameObject_1=Class_1,EventEmitter$9=eventemitter3.exports,Events$j=GetTileAtWorldXY_1,Gamepad=Composite_1,GetValue$c=GetValue_1,plugins=Events_1,InputEvents$2=renderer,MatterImage_1=new MatterGameObject_1({Extends:EventEmitter$9,initialize:function(sceneInputPlugin){EventEmitter$9.call(this),this.scene=sceneInputPlugin.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=sceneInputPlugin,this.enabled=!0,this.target,this.gamepads=[],this.queue=[],this.onGamepadHandler,this._pad1,this._pad2,this._pad3,this._pad4,sceneInputPlugin.pluginEvents.once(InputEvents$2.BOOT,this.boot,this),sceneInputPlugin.pluginEvents.on(InputEvents$2.START,this.start,this)},boot:function(){var game=this.scene.sys.game,settings=this.settings.input,config=game.config;this.enabled=GetValue$c(settings,"gamepad",config.inputGamepad)&&game.device.input.gamepads,this.target=GetValue$c(settings,"gamepad.target",config.inputGamepadEventTarget),this.sceneInputPlugin.pluginEvents.once(InputEvents$2.DESTROY,this.destroy,this)},start:function(){this.enabled&&(this.startListeners(),this.refreshPads()),this.sceneInputPlugin.pluginEvents.once(InputEvents$2.SHUTDOWN,this.shutdown,this)},isActive:function(){return this.enabled&&this.scene.sys.isActive()},startListeners:function(){function handler(event){!event.defaultPrevented&&_this.isActive()&&(_this.refreshPads(),_this.queue.push(event))}var _this=this,target=this.target;this.onGamepadHandler=handler,target.addEventListener("gamepadconnected",handler,!1),target.addEventListener("gamepaddisconnected",handler,!1),this.sceneInputPlugin.pluginEvents.on(InputEvents$2.UPDATE,this.update,this)},stopListeners:function(){this.target.removeEventListener("gamepadconnected",this.onGamepadHandler),this.target.removeEventListener("gamepaddisconnected",this.onGamepadHandler),this.sceneInputPlugin.pluginEvents.off(InputEvents$2.UPDATE,this.update);for(var i=0;i<this.gamepads.length;i++)this.gamepads[i].removeAllListeners()},disconnectAll:function(){for(var i=0;i<this.gamepads.length;i++)this.gamepads[i].pad.connected=!1},refreshPads:function(){var connectedPads=navigator.getGamepads();if(connectedPads)for(var currentPads=this.gamepads,i=0;i<connectedPads.length;i++){var id,index,currentPad,newPad=connectedPads[i];newPad&&(id=newPad.id,(currentPad=currentPads[index=newPad.index])?currentPad.id!==id?(currentPad.destroy(),currentPads[index]=new Gamepad(this,newPad)):currentPad.update(newPad):(newPad=new Gamepad(this,newPad),currentPads[index]=newPad,this._pad1?this._pad2?this._pad3?this._pad4||(this._pad4=newPad):this._pad3=newPad:this._pad2=newPad:this._pad1=newPad))}else this.disconnectAll()},getAll:function(){for(var out=[],pads=this.gamepads,i=0;i<pads.length;i++)pads[i]&&out.push(pads[i]);return out},getPad:function(index){for(var pads=this.gamepads,i=0;i<pads.length;i++)if(pads[i]&&pads[i].index===index)return pads[i]},update:function(){if(this.enabled){this.refreshPads();var len=this.queue.length;if(0!==len)for(var queue=this.queue.splice(0,len),i=0;i<len;i++){var event=queue[i],pad=this.getPad(event.gamepad.index);"gamepadconnected"===event.type?this.emit(Events$j.CONNECTED,pad,event):"gamepaddisconnected"===event.type&&this.emit(Events$j.DISCONNECTED,pad,event)}}},shutdown:function(){this.stopListeners(),this.removeAllListeners()},destroy:function(){this.shutdown();for(var i=0;i<this.gamepads.length;i++)this.gamepads[i]&&this.gamepads[i].destroy();this.gamepads=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.target=null},total:{get:function(){return this.gamepads.length}},pad1:{get:function(){return this._pad1}},pad2:{get:function(){return this._pad2}},pad3:{get:function(){return this._pad3}},pad4:{get:function(){return this._pad4}}});plugins.register("GamepadPlugin",MatterImage_1,"gamepad","gamepad","inputGamepad");var AtlasJSONFile_1={Axis:Axes_1,Button:input,Events:GetTileAtWorldXY_1,Gamepad:Composite_1,GamepadPlugin:MatterImage_1,Configs:{DUALSHOCK_4:{UP:12,DOWN:13,LEFT:14,RIGHT:15,SHARE:8,OPTIONS:9,PS:16,TOUCHBAR:17,X:0,CIRCLE:1,SQUARE:2,TRIANGLE:3,L1:4,R1:5,L2:6,R2:7,L3:10,R3:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3},SNES_USB:{UP:12,DOWN:13,LEFT:14,RIGHT:15,SELECT:8,START:9,B:0,A:1,Y:2,X:3,LEFT_SHOULDER:4,RIGHT_SHOULDER:5},XBOX_360:{UP:12,DOWN:13,LEFT:14,RIGHT:15,MENU:16,A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,BACK:8,START:9,LS:10,RS:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3}}},Circle$1=Svg_1,CircleContains$1=Bounds_1,JSONFile_1=Class_1,CONST$R=GLSLFile_1,CreateInteractiveObject=GetTilesWithin_1,CreatePixelPerfectHandler=AsepriteFile_1,DistanceBetween$3=DistanceBetween_1,Ellipse=Constraint_1,EllipseContains=Composites_1,Events$i=renderer,EventEmitter$8=eventemitter3.exports,GetFastValue$R=GetFastValue_1,GEOM_CONST=loader,InputPluginCache$1=Events_1,IsPlainObject$t=IsPlainObject_1,Bodies_1=PluginCache,Rectangle$4=HasTileAtWorldXY_1,RectangleContains$2=arcade,SceneEvents$7=events$g,Triangle=Engine_1,TriangleContains=HTMLFile_1,AnimationJSONFile_1=new JSONFile_1({Extends:EventEmitter$8,initialize:function(scene){EventEmitter$8.call(this),this.scene=scene,this.systems=scene.sys,this.settings=scene.sys.settings,this.manager=scene.sys.game.input,this.pluginEvents=new EventEmitter$8,this.enabled=!0,this.displayList,this.cameras,InputPluginCache$1.install(this),this.mouse=this.manager.mouse,this.topOnly=!0,this.pollRate=-1,this._pollTimer=0;var _eventData={cancelled:!1};this._eventContainer={stopPropagation:function(){_eventData.cancelled=!0}},this._eventData=_eventData,this.dragDistanceThreshold=0,this.dragTimeThreshold=0,this._temp=[],this._tempZones=[],this._list=[],this._pendingInsertion=[],this._pendingRemoval=[],this._draggable=[],this._drag={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._dragState=[],this._over={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._validTypes=["onDown","onUp","onOver","onOut","onMove","onDragStart","onDrag","onDragEnd","onDragEnter","onDragLeave","onDragOver","onDrop"],this._updatedThisFrame=!1,scene.sys.events.once(SceneEvents$7.BOOT,this.boot,this),scene.sys.events.on(SceneEvents$7.START,this.start,this)},boot:function(){this.cameras=this.systems.cameras,this.displayList=this.systems.displayList,this.systems.events.once(SceneEvents$7.DESTROY,this.destroy,this),this.pluginEvents.emit(Events$i.BOOT)},start:function(){var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents$7.TRANSITION_START,this.transitionIn,this),eventEmitter.on(SceneEvents$7.TRANSITION_OUT,this.transitionOut,this),eventEmitter.on(SceneEvents$7.TRANSITION_COMPLETE,this.transitionComplete,this),eventEmitter.on(SceneEvents$7.PRE_UPDATE,this.preUpdate,this),eventEmitter.once(SceneEvents$7.SHUTDOWN,this.shutdown,this),this.manager.events.on(Events$i.GAME_OUT,this.onGameOut,this),this.manager.events.on(Events$i.GAME_OVER,this.onGameOver,this),this.enabled=!0,this._dragState=[0,0,0,0,0,0,0,0,0,0],this.pluginEvents.emit(Events$i.START)},onGameOver:function(event){this.isActive()&&this.emit(Events$i.GAME_OVER,event.timeStamp,event)},onGameOut:function(event){this.isActive()&&this.emit(Events$i.GAME_OUT,event.timeStamp,event)},preUpdate:function(){this.pluginEvents.emit(Events$i.PRE_UPDATE);var removeList=this._pendingRemoval,insertList=this._pendingInsertion,toRemove=removeList.length,toInsert=insertList.length;if(0!==toRemove||0!==toInsert){for(var current=this._list,i=0;i<toRemove;i++){var gameObject=removeList[i],index=current.indexOf(gameObject);-1<index&&(current.splice(index,1),this.clear(gameObject,!0))}removeList.length=0,this._pendingRemoval.length=0,this._list=current.concat(insertList.splice(0))}},isActive:function(){return this.enabled&&this.scene.sys.isActive()},updatePoll:function(time,delta){if(!this.isActive())return!1;if(this.pluginEvents.emit(Events$i.UPDATE,time,delta),this._updatedThisFrame)return this._updatedThisFrame=!1;for(var rate=this.manager,pointers=rate.pointers,pointersTotal=rate.pointersTotal,i=0;i<pointersTotal;i++)pointers[i].updateMotion();if(0===this._list.length)return!1;rate=this.pollRate;if(-1===rate)return!1;if(0<rate){if(this._pollTimer-=delta,!(this._pollTimer<0))return!1;this._pollTimer=this.pollRate}var captured=!1;for(i=0;i<pointersTotal;i++){var total=0,pointer=pointers[i];this._tempZones=[],this._temp=this.hitTestPointer(pointer),this.sortGameObjects(this._temp,pointer),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),total+=this.processOverOutEvents(pointer),2===this.getDragState(pointer)&&this.processDragThresholdEvent(pointer,time),0<total&&(captured=!0)}return captured},update:function(type,pointers){if(!this.isActive())return!1;for(var pointersTotal=pointers.length,captured=!1,i=0;i<pointersTotal;i++){var total=0,pointer=pointers[i];switch(this._tempZones=[],this._temp=this.hitTestPointer(pointer),this.sortGameObjects(this._temp,pointer),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),type){case CONST$R.MOUSE_DOWN:total+=this.processDragDownEvent(pointer),total+=this.processDownEvents(pointer),total+=this.processOverOutEvents(pointer);break;case CONST$R.MOUSE_UP:total+=this.processDragUpEvent(pointer),total+=this.processUpEvents(pointer),total+=this.processOverOutEvents(pointer);break;case CONST$R.TOUCH_START:total+=this.processDragDownEvent(pointer),total+=this.processDownEvents(pointer),total+=this.processOverEvents(pointer);break;case CONST$R.TOUCH_END:case CONST$R.TOUCH_CANCEL:total+=this.processDragUpEvent(pointer),total+=this.processUpEvents(pointer),total+=this.processOutEvents(pointer);break;case CONST$R.MOUSE_MOVE:case CONST$R.TOUCH_MOVE:total+=this.processDragMoveEvent(pointer),total+=this.processMoveEvents(pointer),total+=this.processOverOutEvents(pointer);break;case CONST$R.MOUSE_WHEEL:total+=this.processWheelEvent(pointer)}0<total&&(captured=!0)}return this._updatedThisFrame=!0,captured},clear:function(gameObject,index){void 0===index&&(index=!1);var input=gameObject.input;if(input){index||this.queueForRemoval(gameObject),input.gameObject=void 0,input.target=void 0,input.hitArea=void 0,input.hitAreaCallback=void 0,input.callbackContext=void 0,gameObject.input=null;index=this._draggable.indexOf(gameObject);return-1<index&&this._draggable.splice(index,1),-1<(index=this._drag[0].indexOf(gameObject))&&this._drag[0].splice(index,1),-1<(index=this._over[0].indexOf(gameObject))&&(this._over[0].splice(index,1),this.manager.resetCursor(input)),gameObject}},disable:function(gameObject){gameObject.input.enabled=!1},enable:function(gameObject,hitArea,hitAreaCallback,dropZone){return void 0===dropZone&&(dropZone=!1),gameObject.input?gameObject.input.enabled=!0:this.setHitArea(gameObject,hitArea,hitAreaCallback),gameObject.input&&dropZone&&!gameObject.input.dropZone&&(gameObject.input.dropZone=dropZone),this},hitTestPointer:function(pointer){for(var cameras=this.cameras.getCamerasBelowPointer(pointer),c=0;c<cameras.length;c++){for(var camera=cameras[c],over=this.manager.hitTest(pointer,this._list,camera),i=0;i<over.length;i++){var obj=over[i];obj.input.dropZone&&this._tempZones.push(obj)}if(0<over.length)return pointer.camera=camera,over}return pointer.camera=cameras[0],[]},processDownEvents:function(pointer){for(var total=0,currentlyOver=this._temp,_eventData=this._eventData,_eventContainer=this._eventContainer,aborted=_eventData.cancelled=!1,i=0;i<currentlyOver.length;i++){var gameObject=currentlyOver[i];if(gameObject.input){if(total++,gameObject.emit(Events$i.GAMEOBJECT_POINTER_DOWN,pointer,gameObject.input.localX,gameObject.input.localY,_eventContainer),_eventData.cancelled||!gameObject.input){aborted=!0;break}if(this.emit(Events$i.GAMEOBJECT_DOWN,pointer,gameObject,_eventContainer),_eventData.cancelled||!gameObject.input){aborted=!0;break}}}return!aborted&&this.manager&&(pointer.downElement===this.manager.game.canvas?this.emit(Events$i.POINTER_DOWN,pointer,currentlyOver):this.emit(Events$i.POINTER_DOWN_OUTSIDE,pointer)),total},getDragState:function(pointer){return this._dragState[pointer.id]},setDragState:function(pointer,state){this._dragState[pointer.id]=state},processDragThresholdEvent:function(pointer,time){var passed=!1,timeThreshold=this.dragTimeThreshold,distanceThreshold=this.dragDistanceThreshold;if(passed=0<distanceThreshold&&DistanceBetween$3(pointer.x,pointer.y,pointer.downX,pointer.downY)>=distanceThreshold||0<timeThreshold&&time>=pointer.downTime+timeThreshold?!0:passed)return this.setDragState(pointer,3),this.processDragStartList(pointer)},processDragStartList:function(pointer){if(3!==this.getDragState(pointer))return 0;for(var list=this._drag[pointer.id],i=0;i<list.length;i++){var gameObject=list[i],input=gameObject.input;input.dragState=2,input.dragStartX=gameObject.x,input.dragStartY=gameObject.y,input.dragStartXGlobal=pointer.worldX,input.dragStartYGlobal=pointer.worldY,input.dragX=input.dragStartXGlobal-input.dragStartX,input.dragY=input.dragStartYGlobal-input.dragStartY,gameObject.emit(Events$i.GAMEOBJECT_DRAG_START,pointer,input.dragX,input.dragY),this.emit(Events$i.DRAG_START,pointer,gameObject)}return this.setDragState(pointer,4),list.length},processDragDownEvent:function(pointer){var currentlyOver=this._temp;if(0===this._draggable.length||0===currentlyOver.length||!pointer.primaryDown||0!==this.getDragState(pointer))return 0;this.setDragState(pointer,1);for(var draglist=[],i=0;i<currentlyOver.length;i++){var gameObject=currentlyOver[i];gameObject.input.draggable&&0===gameObject.input.dragState&&draglist.push(gameObject)}return 0===draglist.length?(this.setDragState(pointer,0),0):(1<draglist.length&&(this.sortGameObjects(draglist,pointer),this.topOnly&&draglist.splice(1)),this._drag[pointer.id]=draglist,0===this.dragDistanceThreshold&&0===this.dragTimeThreshold?(this.setDragState(pointer,3),this.processDragStartList(pointer)):(this.setDragState(pointer,2),0))},processDragMoveEvent:function(pointer){if(2===this.getDragState(pointer)&&this.processDragThresholdEvent(pointer,this.manager.game.loop.now),4!==this.getDragState(pointer))return 0;for(var dropZones=this._tempZones,list=this._drag[pointer.id],i=0;i<list.length;i++){var dx,dy,dragX,gameObject=list[i],dragY=gameObject.input,dyRotated=dragY.target;dyRotated?0===(dy=dropZones.indexOf(dyRotated))?(gameObject.emit(Events$i.GAMEOBJECT_DRAG_OVER,pointer,dyRotated),this.emit(Events$i.DRAG_OVER,pointer,gameObject,dyRotated)):0<dy?(gameObject.emit(Events$i.GAMEOBJECT_DRAG_LEAVE,pointer,dyRotated),this.emit(Events$i.DRAG_LEAVE,pointer,gameObject,dyRotated),dragY.target=dropZones[0],dyRotated=dragY.target,gameObject.emit(Events$i.GAMEOBJECT_DRAG_ENTER,pointer,dyRotated),this.emit(Events$i.DRAG_ENTER,pointer,gameObject,dyRotated)):(gameObject.emit(Events$i.GAMEOBJECT_DRAG_LEAVE,pointer,dyRotated),this.emit(Events$i.DRAG_LEAVE,pointer,gameObject,dyRotated),dropZones[0]?(dragY.target=dropZones[0],dyRotated=dragY.target,gameObject.emit(Events$i.GAMEOBJECT_DRAG_ENTER,pointer,dyRotated),this.emit(Events$i.DRAG_ENTER,pointer,gameObject,dyRotated)):dragY.target=null):!dyRotated&&dropZones[0]&&(dragY.target=dropZones[0],dyRotated=dragY.target,gameObject.emit(Events$i.GAMEOBJECT_DRAG_ENTER,pointer,dyRotated),this.emit(Events$i.DRAG_ENTER,pointer,gameObject,dyRotated)),dragY=gameObject.parentContainer?(dx=pointer.worldX-dragY.dragStartXGlobal,dy=pointer.worldY-dragY.dragStartYGlobal,dyRotated=gameObject.getParentRotation(),dragX=dx*Math.cos(dyRotated)+dy*Math.sin(dyRotated),dyRotated=dy*Math.cos(dyRotated)-dx*Math.sin(dyRotated),dragX*=1/gameObject.parentContainer.scaleX,dyRotated*=1/gameObject.parentContainer.scaleY,dragX=dragX+dragY.dragStartX,dyRotated+dragY.dragStartY):(dragX=pointer.worldX-dragY.dragX,pointer.worldY-dragY.dragY),gameObject.emit(Events$i.GAMEOBJECT_DRAG,pointer,dragX,dragY),this.emit(Events$i.DRAG,pointer,gameObject,dragX,dragY)}return list.length},processDragUpEvent:function(pointer){for(var list=this._drag[pointer.id],i=0;i<list.length;i++){var dropped,target,gameObject=list[i],input=gameObject.input;input&&2===input.dragState&&(input.dragState=0,input.dragX=input.localX-gameObject.displayOriginX,input.dragY=input.localY-gameObject.displayOriginY,dropped=!1,(target=input.target)&&(gameObject.emit(Events$i.GAMEOBJECT_DROP,pointer,target),this.emit(Events$i.DROP,pointer,gameObject,target),dropped=!(input.target=null)),gameObject.input&&(gameObject.emit(Events$i.GAMEOBJECT_DRAG_END,pointer,input.dragX,input.dragY,dropped),this.emit(Events$i.DRAG_END,pointer,gameObject,dropped)))}return this.setDragState(pointer,0),list.splice(0),0},processMoveEvents:function(pointer){for(var total=0,currentlyOver=this._temp,_eventData=this._eventData,_eventContainer=this._eventContainer,aborted=_eventData.cancelled=!1,i=0;i<currentlyOver.length;i++){var gameObject=currentlyOver[i];if(gameObject.input){if(total++,gameObject.emit(Events$i.GAMEOBJECT_POINTER_MOVE,pointer,gameObject.input.localX,gameObject.input.localY,_eventContainer),_eventData.cancelled||!gameObject.input){aborted=!0;break}if(this.emit(Events$i.GAMEOBJECT_MOVE,pointer,gameObject,_eventContainer),_eventData.cancelled||!gameObject.input){aborted=!0;break}if(this.topOnly)break}}return aborted||this.emit(Events$i.POINTER_MOVE,pointer,currentlyOver),total},processWheelEvent:function(pointer){for(var total=0,currentlyOver=this._temp,_eventData=this._eventData,_eventContainer=this._eventContainer,aborted=_eventData.cancelled=!1,dx=pointer.deltaX,dy=pointer.deltaY,dz=pointer.deltaZ,i=0;i<currentlyOver.length;i++){var gameObject=currentlyOver[i];if(gameObject.input){if(total++,gameObject.emit(Events$i.GAMEOBJECT_POINTER_WHEEL,pointer,dx,dy,dz,_eventContainer),_eventData.cancelled||!gameObject.input){aborted=!0;break}if(this.emit(Events$i.GAMEOBJECT_WHEEL,pointer,gameObject,dx,dy,dz,_eventContainer),_eventData.cancelled||!gameObject.input){aborted=!0;break}}}return aborted||this.emit(Events$i.POINTER_WHEEL,pointer,currentlyOver,dx,dy,dz),total},processOverEvents:function(pointer){var currentlyOver=this._temp,totalInteracted=0,total=currentlyOver.length,justOver=[];if(0<total){for(var manager=this.manager,_eventData=this._eventData,_eventContainer=this._eventContainer,aborted=_eventData.cancelled=!1,i=0;i<total;i++){var gameObject=currentlyOver[i];if(gameObject.input){if(justOver.push(gameObject),manager.setCursor(gameObject.input),gameObject.emit(Events$i.GAMEOBJECT_POINTER_OVER,pointer,gameObject.input.localX,gameObject.input.localY,_eventContainer),totalInteracted++,_eventData.cancelled||!gameObject.input){aborted=!0;break}if(this.emit(Events$i.GAMEOBJECT_OVER,pointer,gameObject,_eventContainer),_eventData.cancelled||!gameObject.input){aborted=!0;break}}}aborted||this.emit(Events$i.POINTER_OVER,pointer,justOver)}return this._over[pointer.id]=justOver,totalInteracted},processOutEvents:function(pointer){var previouslyOver=this._over[pointer.id],totalInteracted=0,total=previouslyOver.length;if(0<total){var manager=this.manager,_eventData=this._eventData,_eventContainer=this._eventContainer,aborted=_eventData.cancelled=!1;this.sortGameObjects(previouslyOver,pointer);for(var i=0;i<total;i++){var gameObject=previouslyOver[i];if((gameObject=previouslyOver[i]).input){if(manager.resetCursor(gameObject.input),gameObject.emit(Events$i.GAMEOBJECT_POINTER_OUT,pointer,_eventContainer),totalInteracted++,_eventData.cancelled||!gameObject.input){aborted=!0;break}if(this.emit(Events$i.GAMEOBJECT_OUT,pointer,gameObject,_eventContainer),_eventData.cancelled||!gameObject.input){aborted=!0;break}aborted||this.emit(Events$i.POINTER_OUT,pointer,previouslyOver)}}this._over[pointer.id]=[]}return totalInteracted},processOverOutEvents:function(pointer){for(var gameObject,currentlyOver=this._temp,justOut=[],justOver=[],stillOver=[],previouslyOver=this._over[pointer.id],currentlyDragging=this._drag[pointer.id],manager=this.manager,i=0;i<previouslyOver.length;i++)gameObject=previouslyOver[i],(-1===currentlyOver.indexOf(gameObject)&&-1===currentlyDragging.indexOf(gameObject)?justOut:stillOver).push(gameObject);for(i=0;i<currentlyOver.length;i++)gameObject=currentlyOver[i],-1===previouslyOver.indexOf(gameObject)&&justOver.push(gameObject);var total=justOut.length,totalInteracted=0,_eventData=this._eventData,_eventContainer=this._eventContainer,aborted=_eventData.cancelled=!1;if(0<total){for(this.sortGameObjects(justOut,pointer),i=0;i<total;i++)if((gameObject=justOut[i]).input){if(manager.resetCursor(gameObject.input),gameObject.emit(Events$i.GAMEOBJECT_POINTER_OUT,pointer,_eventContainer),totalInteracted++,_eventData.cancelled||!gameObject.input){aborted=!0;break}if(this.emit(Events$i.GAMEOBJECT_OUT,pointer,gameObject,_eventContainer),_eventData.cancelled||!gameObject.input){aborted=!0;break}}aborted||this.emit(Events$i.POINTER_OUT,pointer,justOut)}if(total=justOver.length,aborted=_eventData.cancelled=!1,0<total){for(this.sortGameObjects(justOver,pointer),i=0;i<total;i++)if((gameObject=justOver[i]).input){if(manager.setCursor(gameObject.input),gameObject.emit(Events$i.GAMEOBJECT_POINTER_OVER,pointer,gameObject.input.localX,gameObject.input.localY,_eventContainer),totalInteracted++,_eventData.cancelled||!gameObject.input){aborted=!0;break}if(this.emit(Events$i.GAMEOBJECT_OVER,pointer,gameObject,_eventContainer),_eventData.cancelled||!gameObject.input){aborted=!0;break}}aborted||this.emit(Events$i.POINTER_OVER,pointer,justOver)}return previouslyOver=stillOver.concat(justOver),this._over[pointer.id]=this.sortGameObjects(previouslyOver,pointer),totalInteracted},processUpEvents:function(pointer){for(var currentlyOver=this._temp,_eventData=this._eventData,_eventContainer=this._eventContainer,aborted=_eventData.cancelled=!1,i=0;i<currentlyOver.length;i++){var gameObject=currentlyOver[i];if(gameObject.input){if(gameObject.emit(Events$i.GAMEOBJECT_POINTER_UP,pointer,gameObject.input.localX,gameObject.input.localY,_eventContainer),_eventData.cancelled||!gameObject.input){aborted=!0;break}if(this.emit(Events$i.GAMEOBJECT_UP,pointer,gameObject,_eventContainer),_eventData.cancelled||!gameObject.input){aborted=!0;break}}}return!aborted&&this.manager&&(pointer.upElement===this.manager.game.canvas?this.emit(Events$i.POINTER_UP,pointer,currentlyOver):this.emit(Events$i.POINTER_UP_OUTSIDE,pointer)),currentlyOver.length},queueForInsertion:function(child){return-1===this._pendingInsertion.indexOf(child)&&-1===this._list.indexOf(child)&&this._pendingInsertion.push(child),this},queueForRemoval:function(child){return this._pendingRemoval.push(child),this},setDraggable:function(gameObjects,value){void 0===value&&(value=!0),Array.isArray(gameObjects)||(gameObjects=[gameObjects]);for(var i=0;i<gameObjects.length;i++){var gameObject=gameObjects[i];gameObject.input.draggable=value;var index=this._draggable.indexOf(gameObject);value&&-1===index?this._draggable.push(gameObject):!value&&-1<index&&this._draggable.splice(index,1)}return this},makePixelPerfect:function(alphaTolerance){var textureManager=this.systems.textures;return CreatePixelPerfectHandler(textureManager,alphaTolerance=void 0===alphaTolerance?1:alphaTolerance)},setHitArea:function(gameObjects,hitArea,hitAreaCallback){if(void 0===hitArea)return this.setHitAreaFromTexture(gameObjects);Array.isArray(gameObjects)||(gameObjects=[gameObjects]);var alphaTolerance,draggable=!1,dropZone=!1,cursor=!1,useHandCursor=!1,pixelPerfect=!1,customHitArea=!0;IsPlainObject$t(hitArea)?(hitArea=GetFastValue$R(alphaTolerance=hitArea,"hitArea",null),hitAreaCallback=GetFastValue$R(alphaTolerance,"hitAreaCallback",null),draggable=GetFastValue$R(alphaTolerance,"draggable",!1),dropZone=GetFastValue$R(alphaTolerance,"dropZone",!1),cursor=GetFastValue$R(alphaTolerance,"cursor",!1),useHandCursor=GetFastValue$R(alphaTolerance,"useHandCursor",!1),pixelPerfect=GetFastValue$R(alphaTolerance,"pixelPerfect",!1),alphaTolerance=GetFastValue$R(alphaTolerance,"alphaTolerance",1),pixelPerfect&&(hitArea={},hitAreaCallback=this.makePixelPerfect(alphaTolerance)),hitArea&&hitAreaCallback||(this.setHitAreaFromTexture(gameObjects),customHitArea=!1)):"function"!=typeof hitArea||hitAreaCallback||(hitAreaCallback=hitArea,hitArea={});for(var i=0;i<gameObjects.length;i++){var io,gameObject=gameObjects[i];pixelPerfect&&"Container"===gameObject.type?console.warn("Cannot pixelPerfect test a Container. Use a custom callback."):((io=gameObject.input||CreateInteractiveObject(gameObject,hitArea,hitAreaCallback)).customHitArea=customHitArea,io.dropZone=dropZone,io.cursor=useHandCursor?"pointer":cursor,gameObject.input=io,draggable&&this.setDraggable(gameObject),this.queueForInsertion(gameObject))}return this},setHitAreaCircle:function(gameObjects,x,y,shape,callback){void 0===callback&&(callback=CircleContains$1);shape=new Circle$1(x,y,shape);return this.setHitArea(gameObjects,shape,callback)},setHitAreaEllipse:function(gameObjects,x,y,width,shape,callback){void 0===callback&&(callback=EllipseContains);shape=new Ellipse(x,y,width,shape);return this.setHitArea(gameObjects,shape,callback)},setHitAreaFromTexture:function(gameObjects,callback){void 0===callback&&(callback=RectangleContains$2),Array.isArray(gameObjects)||(gameObjects=[gameObjects]);for(var i=0;i<gameObjects.length;i++){var gameObject=gameObjects[i],frame=gameObject.frame,width=0,height=0;gameObject.width?(width=gameObject.width,height=gameObject.height):frame&&(width=frame.realWidth,height=frame.realHeight),"Container"!==gameObject.type||0!==width&&0!==height?0!==width&&0!==height&&(gameObject.input=CreateInteractiveObject(gameObject,new Rectangle$4(0,0,width,height),callback),this.queueForInsertion(gameObject)):console.warn("Container.setInteractive must specify a Shape or call setSize() first")}return this},setHitAreaRectangle:function(gameObjects,x,y,width,shape,callback){void 0===callback&&(callback=RectangleContains$2);shape=new Rectangle$4(x,y,width,shape);return this.setHitArea(gameObjects,shape,callback)},setHitAreaTriangle:function(gameObjects,x1,y1,x2,y2,x3,shape,callback){void 0===callback&&(callback=TriangleContains);shape=new Triangle(x1,y1,x2,y2,x3,shape);return this.setHitArea(gameObjects,shape,callback)},enableDebug:function(gameObject,color){void 0===color&&(color=65280);var input=gameObject.input;if(!input||!input.hitArea)return this;var shape=input.hitArea,shapeType=shape.type,debug=input.hitAreaDebug,factory=this.systems.add,updateList=this.systems.updateList;debug&&(updateList.remove(debug),debug.destroy(),debug=null);var offsetx=0,offsety=0;switch(shapeType){case GEOM_CONST.CIRCLE:debug=factory.arc(0,0,shape.radius),offsetx=shape.x-shape.radius,offsety=shape.y-shape.radius;break;case GEOM_CONST.ELLIPSE:debug=factory.ellipse(0,0,shape.width,shape.height),offsetx=shape.x-shape.width/2,offsety=shape.y-shape.height/2;break;case GEOM_CONST.LINE:debug=factory.line(0,0,shape.x1,shape.y1,shape.x2,shape.y2);break;case GEOM_CONST.POLYGON:debug=factory.polygon(0,0,shape.points);break;case GEOM_CONST.RECTANGLE:debug=factory.rectangle(0,0,shape.width,shape.height),offsetx=shape.x,offsety=shape.y;break;case GEOM_CONST.TRIANGLE:debug=factory.triangle(0,0,shape.x1,shape.y1,shape.x2,shape.y2,shape.x3,shape.y3)}return debug&&(debug.isFilled=!1,debug.preUpdate=function(){debug.setStrokeStyle(1/gameObject.scale,color),debug.setDisplayOrigin(gameObject.displayOriginX,gameObject.displayOriginY);var matrix,x=gameObject.x,y=gameObject.y,rotation=gameObject.rotation,scaleX=gameObject.scaleX,scaleY=gameObject.scaleY;gameObject.parentContainer&&(x=(matrix=gameObject.getWorldTransformMatrix()).tx,y=matrix.ty,rotation=matrix.rotation,scaleX=matrix.scaleX,scaleY=matrix.scaleY),debug.setRotation(rotation),debug.setScale(scaleX,scaleY),debug.setPosition(x+offsetx,y+offsety),debug.setScrollFactor(gameObject.scrollFactorX,gameObject.scrollFactorY),debug.setDepth(gameObject.depth)},updateList.add(debug),input.hitAreaDebug=debug),this},removeDebug:function(debug){var input=debug.input;return input&&input.hitAreaDebug&&(debug=input.hitAreaDebug,this.systems.updateList.remove(debug),debug.destroy(),input.hitAreaDebug=null),this},setPollAlways:function(){return this.setPollRate(0)},setPollOnMove:function(){return this.setPollRate(-1)},setPollRate:function(value){return this.pollRate=value,this._pollTimer=0,this},setGlobalTopOnly:function(value){return this.manager.globalTopOnly=value,this},setTopOnly:function(value){return this.topOnly=value,this},sortGameObjects:function(gameObjects,pointer){if(gameObjects.length<2)return gameObjects;var list=pointer.camera.renderList;return gameObjects.sort(function(childA,childB){return list.indexOf(childB)-list.indexOf(childA)})},sortDropZones:function(gameObjects){return gameObjects.length<2?gameObjects:(this.scene.sys.depthSort(),gameObjects.sort(this.sortDropZoneHandler.bind(this)))},sortDropZoneHandler:function(childA,childB){if(childA.parentContainer||childB.parentContainer){if(childA.parentContainer===childB.parentContainer)return childB.parentContainer.getIndex(childB)-childA.parentContainer.getIndex(childA);if(childA.parentContainer===childB)return-1;if(childB.parentContainer===childA)return 1;for(var listA=childA.getIndexList(),listB=childB.getIndexList(),len=Math.min(listA.length,listB.length),i=0;i<len;i++){var indexA=listA[i],indexB=listB[i];if(indexA!==indexB)return indexB-indexA}return listB.length-listA.length}return this.displayList.getIndex(childB)-this.displayList.getIndex(childA)},stopPropagation:function(){return this.manager._tempSkip=!0,this},addPointer:function(quantity){return this.manager.addPointer(quantity)},setDefaultCursor:function(cursor){return this.manager.setDefaultCursor(cursor),this},transitionIn:function(){this.enabled=this.settings.transitionAllowInput},transitionComplete:function(){this.settings.transitionAllowInput||(this.enabled=!0)},transitionOut:function(){this.enabled=this.settings.transitionAllowInput},shutdown:function(){this.pluginEvents.emit(Events$i.SHUTDOWN),this._temp.length=0,this._list.length=0,this._draggable.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0;for(var i=this._dragState.length=0;i<10;i++)this._drag[i]=[],this._over[i]=[];this.removeAllListeners();var manager=this.manager;manager.canvas.style.cursor=manager.defaultCursor;var eventEmitter=this.systems.events;eventEmitter.off(SceneEvents$7.TRANSITION_START,this.transitionIn,this),eventEmitter.off(SceneEvents$7.TRANSITION_OUT,this.transitionOut,this),eventEmitter.off(SceneEvents$7.TRANSITION_COMPLETE,this.transitionComplete,this),eventEmitter.off(SceneEvents$7.PRE_UPDATE,this.preUpdate,this),manager.events.off(Events$i.GAME_OUT,this.onGameOut,this),manager.events.off(Events$i.GAME_OVER,this.onGameOver,this),eventEmitter.off(SceneEvents$7.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.pluginEvents.emit(Events$i.DESTROY),this.pluginEvents.removeAllListeners(),this.scene.sys.events.off(SceneEvents$7.START,this.start,this),this.scene=null,this.cameras=null,this.manager=null,this.events=null,this.mouse=null},x:{get:function(){return this.manager.activePointer.x}},y:{get:function(){return this.manager.activePointer.y}},isOver:{get:function(){return this.manager.isOver}},mousePointer:{get:function(){return this.manager.mousePointer}},activePointer:{get:function(){return this.manager.activePointer}},pointer1:{get:function(){return this.manager.pointers[1]}},pointer2:{get:function(){return this.manager.pointers[2]}},pointer3:{get:function(){return this.manager.pointers[3]}},pointer4:{get:function(){return this.manager.pointers[4]}},pointer5:{get:function(){return this.manager.pointers[5]}},pointer6:{get:function(){return this.manager.pointers[6]}},pointer7:{get:function(){return this.manager.pointers[7]}},pointer8:{get:function(){return this.manager.pointers[8]}},pointer9:{get:function(){return this.manager.pointers[9]}},pointer10:{get:function(){return this.manager.pointers[10]}}});Bodies_1.register("InputPlugin",AnimationJSONFile_1,"input");var key,Pair_1=AnimationJSONFile_1,AtlasXMLFile_1={ANY_KEY_DOWN:"keydown",ANY_KEY_UP:"keyup",COMBO_MATCH:"keycombomatch",DOWN:"down",KEY_DOWN:"keydown-",KEY_UP:"keyup-",UP:"up"},HTMLTextureFile_1=Class_1,EventEmitter$7=eventemitter3.exports,Events$h=AtlasXMLFile_1,AudioFile_1=new HTMLTextureFile_1({Extends:EventEmitter$7,initialize:function(plugin,keyCode){EventEmitter$7.call(this),this.plugin=plugin,this.keyCode=keyCode,this.originalEvent=void 0,this.enabled=!0,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.location=0,this.timeDown=0,this.duration=0,this.timeUp=0,this.emitOnRepeat=!1,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1},setEmitOnRepeat:function(value){return this.emitOnRepeat=value,this},onDown:function(event){this.originalEvent=event,this.enabled&&(this.altKey=event.altKey,this.ctrlKey=event.ctrlKey,this.shiftKey=event.shiftKey,this.metaKey=event.metaKey,this.location=event.location,this.repeats++,this.isDown?this.emitOnRepeat&&this.emit(Events$h.DOWN,this,event):(this.isDown=!0,this.isUp=!1,this.timeDown=event.timeStamp,this.duration=0,this._justDown=!0,this._justUp=!1,this.emit(Events$h.DOWN,this,event)))},onUp:function(event){this.originalEvent=event,this.enabled&&(this.isDown=!1,this.isUp=!0,this.timeUp=event.timeStamp,this.duration=this.timeUp-this.timeDown,this.repeats=0,this._justDown=!1,this._justUp=!0,this._tick=-1,this.emit(Events$h.UP,this,event))},reset:function(){return this.preventDefault=!0,this.enabled=!0,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.timeDown=0,this.duration=0,this.timeUp=0,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1,this},getDuration:function(){return this.isDown?this.plugin.game.loop.time-this.timeDown:0},destroy:function(){this.removeAllListeners(),this.originalEvent=null,this.plugin=null}}),BinaryFile_1=function(event,combo){return combo.timeLastMatched=event.timeStamp,combo.index++,combo.index===combo.size||(combo.current=combo.keyCodes[combo.index],!1)},AdvanceKeyCombo=BinaryFile_1,Grid_1=function(event,combo){if(combo.matched)return!0;var timeLimit,comboMatched=!1,keyMatched=!1;return event.keyCode===combo.current&&(0<combo.index&&0<combo.maxKeyDelay?(timeLimit=combo.timeLastMatched+combo.maxKeyDelay,event.timeStamp<=timeLimit&&(keyMatched=!0,comboMatched=AdvanceKeyCombo(event,combo))):(keyMatched=!0,comboMatched=AdvanceKeyCombo(event,combo))),!keyMatched&&combo.resetOnWrongKey&&(combo.index=0,combo.current=combo.keyCodes[0]),comboMatched&&(combo.timeLastMatched=event.timeStamp,combo.matched=!0,combo.timeMatched=event.timeStamp),comboMatched},BitmapFontFile_1=function(combo){return combo.current=combo.keyCodes[0],combo.index=0,combo.timeLastMatched=0,combo.matched=!1,combo.timeMatched=0,combo},Events$g=AtlasXMLFile_1,GetFastValue$Q=GetFastValue_1,ProcessKeyCombo=Grid_1,ResetKeyCombo=BitmapFontFile_1,IsInLayerBounds_1=new Class_1({initialize:function(keyboardPlugin,keys,config){if(void 0===config&&(config={}),keys.length<2)return!1;this.manager=keyboardPlugin,this.enabled=!0,this.keyCodes=[];for(var i=0;i<keys.length;i++){var char=keys[i];"string"==typeof char?this.keyCodes.push(char.toUpperCase().charCodeAt(0)):"number"==typeof char?this.keyCodes.push(char):char.hasOwnProperty("keyCode")&&this.keyCodes.push(char.keyCode)}this.current=this.keyCodes[0],this.index=0,this.size=this.keyCodes.length,this.timeLastMatched=0,this.matched=!1,this.timeMatched=0,this.resetOnWrongKey=GetFastValue$Q(config,"resetOnWrongKey",!0),this.maxKeyDelay=GetFastValue$Q(config,"maxKeyDelay",0),this.resetOnMatch=GetFastValue$Q(config,"resetOnMatch",!1),this.deleteOnMatch=GetFastValue$Q(config,"deleteOnMatch",!1);var _this=this;this.onKeyDown=function(event){!_this.matched&&_this.enabled&&ProcessKeyCombo(event,_this)&&(_this.manager.emit(Events$g.COMBO_MATCH,_this,event),_this.resetOnMatch?ResetKeyCombo(_this):_this.deleteOnMatch&&_this.destroy())},this.manager.on(Events$g.ANY_KEY_DOWN,this.onKeyDown)},progress:{get:function(){return this.index/this.size}},destroy:function(){this.enabled=!1,this.keyCodes=[],this.manager.off(Events$g.ANY_KEY_DOWN,this.onKeyDown),this.manager=null}}),KeyCodes$1=components$1,KeyMap$1={};for(key in KeyCodes$1)KeyMap$1[KeyCodes$1[key]]=key;var MatterGameObject_1=Class_1,EventEmitter$6=eventemitter3.exports,Events$f=AtlasXMLFile_1,GameEvents=ImageFile_1,GetValue$b=GetValue_1,InputEvents$1=renderer,plugins=Events_1,Key=AudioFile_1,KeyCodes=components$1,KeyCombo=IsInLayerBounds_1,KeyMap=KeyMap$1,SceneEvents$6=events$g,SnapFloor$3=builders,Axes_1=new MatterGameObject_1({Extends:EventEmitter$6,initialize:function(sceneInputPlugin){EventEmitter$6.call(this),this.game=sceneInputPlugin.systems.game,this.scene=sceneInputPlugin.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=sceneInputPlugin,this.manager=sceneInputPlugin.manager.keyboard,this.enabled=!0,this.keys=[],this.combos=[],this.prevCode=null,this.prevTime=0,this.prevType=null,sceneInputPlugin.pluginEvents.once(InputEvents$1.BOOT,this.boot,this),sceneInputPlugin.pluginEvents.on(InputEvents$1.START,this.start,this)},boot:function(){var captures=this.settings.input;this.enabled=GetValue$b(captures,"keyboard",!0);captures=GetValue$b(captures,"keyboard.capture",null);captures&&this.addCaptures(captures),this.sceneInputPlugin.pluginEvents.once(InputEvents$1.DESTROY,this.destroy,this)},start:function(){this.sceneInputPlugin.manager.events.on(InputEvents$1.MANAGER_PROCESS,this.update,this),this.sceneInputPlugin.pluginEvents.once(InputEvents$1.SHUTDOWN,this.shutdown,this),this.game.events.on(GameEvents.BLUR,this.resetKeys,this),this.scene.sys.events.on(SceneEvents$6.PAUSE,this.resetKeys,this),this.scene.sys.events.on(SceneEvents$6.SLEEP,this.resetKeys,this)},isActive:function(){return this.enabled&&this.scene.sys.isActive()},addCapture:function(keycode){return this.manager.addCapture(keycode),this},removeCapture:function(keycode){return this.manager.removeCapture(keycode),this},getCaptures:function(){return this.manager.captures},enableGlobalCapture:function(){return this.manager.preventDefault=!0,this},disableGlobalCapture:function(){return this.manager.preventDefault=!1,this},clearCaptures:function(){return this.manager.clearCaptures(),this},createCursorKeys:function(){return this.addKeys({up:KeyCodes.UP,down:KeyCodes.DOWN,left:KeyCodes.LEFT,right:KeyCodes.RIGHT,space:KeyCodes.SPACE,shift:KeyCodes.SHIFT})},addKeys:function(keys,enableCapture,emitOnRepeat){void 0===enableCapture&&(enableCapture=!0),void 0===emitOnRepeat&&(emitOnRepeat=!1);var output={};if("string"==typeof keys){keys=keys.split(",");for(var i=0;i<keys.length;i++){var currentKey=keys[i].trim();currentKey&&(output[currentKey]=this.addKey(currentKey,enableCapture,emitOnRepeat))}}else for(var key in keys)output[key]=this.addKey(keys[key],enableCapture,emitOnRepeat);return output},addKey:function(key,enableCapture,emitOnRepeat){void 0===enableCapture&&(enableCapture=!0),void 0===emitOnRepeat&&(emitOnRepeat=!1);var keys=this.keys;if(key instanceof Key){var idx=keys.indexOf(key);return-1<idx?keys[idx]=key:keys[key.keyCode]=key,enableCapture&&this.addCapture(key.keyCode),key.setEmitOnRepeat(emitOnRepeat),key}return keys[key="string"==typeof key?KeyCodes[key.toUpperCase()]:key]||(keys[key]=new Key(this,key),enableCapture&&this.addCapture(key),keys[key].setEmitOnRepeat(emitOnRepeat)),keys[key]},removeKey:function(key,destroy){void 0===destroy&&(destroy=!1);var ref,idx,keys=this.keys;return key instanceof Key?-1<(idx=keys.indexOf(key))&&(ref=this.keys[idx],this.keys[idx]=void 0):"string"==typeof key&&(key=KeyCodes[key.toUpperCase()]),keys[key]&&(ref=keys[key],keys[key]=void 0),ref&&(ref.plugin=null,destroy&&ref.destroy()),this},removeAllKeys:function(destroy){for(var keys=this.keys,i=0;i<keys.length;i++){var key=keys[i];key&&(keys[i]=void 0,destroy&&key.destroy())}return this},createCombo:function(keys,config){return new KeyCombo(this,keys,config)},checkDown:function(key,t){if(void 0===t&&(t=0),this.enabled&&key.isDown){t=SnapFloor$3(this.time-key.timeDown,t);if(t>key._tick)return key._tick=t,!0}return!1},update:function(){var queue=this.manager.queue,len=queue.length;if(this.isActive()&&0!==len)for(var keys=this.keys,i=0;i<len;i++){var event=queue[i],code=event.keyCode,key=keys[code],repeat=!1;void 0===event.cancelled&&(event.cancelled=0,event.stopImmediatePropagation=function(){event.cancelled=1},event.stopPropagation=function(){event.cancelled=-1}),-1!==event.cancelled&&(code===this.prevCode&&event.timeStamp===this.prevTime&&event.type===this.prevType||(this.prevCode=code,this.prevTime=event.timeStamp,this.prevType=event.type,"keydown"===event.type?(key&&(repeat=key.isDown,key.onDown(event)),event.cancelled||key&&repeat||(KeyMap[code]&&this.emit(Events$f.KEY_DOWN+KeyMap[code],event),event.cancelled||this.emit(Events$f.ANY_KEY_DOWN,event))):(key&&key.onUp(event),event.cancelled||(KeyMap[code]&&this.emit(Events$f.KEY_UP+KeyMap[code],event),event.cancelled||this.emit(Events$f.ANY_KEY_UP,event))),1===event.cancelled&&(event.cancelled=0)))}},resetKeys:function(){for(var keys=this.keys,i=0;i<keys.length;i++)keys[i]&&keys[i].reset();return this},shutdown:function(){this.removeAllKeys(!0),this.removeAllListeners(),this.sceneInputPlugin.manager.events.off(InputEvents$1.MANAGER_PROCESS,this.update,this),this.game.events.off(GameEvents.BLUR,this.resetKeys),this.scene.sys.events.off(SceneEvents$6.PAUSE,this.resetKeys,this),this.scene.sys.events.off(SceneEvents$6.SLEEP,this.resetKeys,this),this.queue=[]},destroy:function(){this.shutdown();for(var keys=this.keys,i=0;i<keys.length;i++)keys[i]&&keys[i].destroy();this.keys=[],this.combos=[],this.queue=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.manager=null},time:{get:function(){return this.sceneInputPlugin.manager.time}}});plugins.register("KeyboardPlugin",Axes_1,"keyboard","keyboard","inputKeyboard");var input=Extend_1$1(!1,{CreatePixelPerfectHandler:AsepriteFile_1,CreateInteractiveObject:GetTilesWithin_1,Events:renderer,Gamepad:AtlasJSONFile_1,InputManager:SAT_1,InputPlugin:Pair_1,InputPluginCache:Events_1,Keyboard:{Events:AtlasXMLFile_1,KeyboardManager:HTML5AudioFile_1,KeyboardPlugin:Axes_1,Key:AudioFile_1,KeyCodes:components$1,KeyCombo:IsInLayerBounds_1,AdvanceKeyCombo:BinaryFile_1,ProcessKeyCombo:Grid_1,ResetKeyCombo:BitmapFontFile_1,JustDown:function(key){return!!key._justDown&&!(key._justDown=!1)},JustUp:function(key){return!!key._justUp&&!(key._justUp=!1)},DownDuration:function(key,duration){void 0===duration&&(duration=50);var current=key.plugin.game.loop.time-key.timeDown;return key.isDown&&current<duration},UpDuration:function(key,duration){void 0===duration&&(duration=50);var current=key.plugin.game.loop.time-key.timeUp;return key.isUp&&current<duration}},Mouse:{MouseManager:tilemaps},Pointer:CSSFile_1,Touch:{TouchManager:World_1$1}},GLSLFile_1),GetTileAtWorldXY_1={LOADER_IDLE:0,LOADER_LOADING:1,LOADER_PROCESSING:2,LOADER_COMPLETE:3,LOADER_SHUTDOWN:4,LOADER_DESTROYED:5,FILE_PENDING:10,FILE_LOADING:11,FILE_LOADED:12,FILE_FAILED:13,FILE_PROCESSING:14,FILE_ERRORED:16,FILE_COMPLETE:17,FILE_DESTROYED:18,FILE_POPULATED:19},Composite_1=function(file,baseURL){return!!file.url&&(file.url.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)?file.url:baseURL+file.url)},MatterImage_1=function(responseType,async,user,password,timeout,withCredentials){return{responseType:responseType=void 0===responseType?"":responseType,async:async=void 0===async?!0:async,user:user=void 0===user?"":user,password:password=void 0===password?"":password,timeout:timeout=void 0===timeout?0:timeout,headers:void 0,header:void 0,headerValue:void 0,requestedWith:!1,overrideMimeType:void 0,withCredentials:withCredentials=void 0===withCredentials?!1:withCredentials}},Extend$b=Extend_1$1,XHRSettings$2=MatterImage_1,Constraint_1=function(global,local){var output=void 0===global?XHRSettings$2():Extend$b({},global);if(local)for(var setting in local)void 0!==local[setting]&&(output[setting]=local[setting]);return output},MergeXHRSettings$1=Constraint_1,Composites_1=function(file,globalXHRSettings){var config=MergeXHRSettings$1(globalXHRSettings,file.xhrSettings),xhr=new XMLHttpRequest;if(xhr.open("GET",file.src,config.async,config.user,config.password),xhr.responseType=file.xhrSettings.responseType,xhr.timeout=config.timeout,config.headers)for(var key in config.headers)xhr.setRequestHeader(key,config.headers[key]);return config.header&&config.headerValue&&xhr.setRequestHeader(config.header,config.headerValue),config.requestedWith&&xhr.setRequestHeader("X-Requested-With",config.requestedWith),config.overrideMimeType&&xhr.overrideMimeType(config.overrideMimeType),config.withCredentials&&(xhr.withCredentials=!0),xhr.onload=file.onLoad.bind(file,xhr),xhr.onerror=file.onError.bind(file,xhr),xhr.onprogress=file.onProgress.bind(file),xhr.send(),xhr},CONST$P=GetTileAtWorldXY_1,Events$e=Pairs_1,GetFastValue$P=GetFastValue_1,GetURL$2=Composite_1,MergeXHRSettings=Constraint_1,XHRLoader=Composites_1,XHRSettings$1=MatterImage_1,loader=new Class_1({initialize:function(loader,fileConfig){this.loader=loader,this.cache=GetFastValue$P(fileConfig,"cache",!1),this.type=GetFastValue$P(fileConfig,"type",!1),this.key=GetFastValue$P(fileConfig,"key",!1);var loadKey=this.key;if(loader.prefix&&""!==loader.prefix&&(this.key=loader.prefix+loadKey),!this.type||!this.key)throw new Error("Invalid Loader."+this.type+" key");var url=GetFastValue$P(fileConfig,"url");void 0===url?url=loader.path+loadKey+"."+GetFastValue$P(fileConfig,"extension",""):"string"!=typeof url||url.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)||(url=loader.path+url),this.url=url,this.src="",this.xhrSettings=XHRSettings$1(GetFastValue$P(fileConfig,"responseType",void 0)),GetFastValue$P(fileConfig,"xhrSettings",!1)&&(this.xhrSettings=MergeXHRSettings(this.xhrSettings,GetFastValue$P(fileConfig,"xhrSettings",{}))),this.xhrLoader=null,this.state="function"==typeof this.url?CONST$P.FILE_POPULATED:CONST$P.FILE_PENDING,this.bytesTotal=0,this.bytesLoaded=-1,this.percentComplete=-1,this.crossOrigin=void 0,this.data=void 0,this.config=GetFastValue$P(fileConfig,"config",{}),this.multiFile,this.linkFile},setLink:function(fileB){(this.linkFile=fileB).linkFile=this},resetXHR:function(){this.xhrLoader&&(this.xhrLoader.onload=void 0,this.xhrLoader.onerror=void 0,this.xhrLoader.onprogress=void 0)},load:function(){this.state===CONST$P.FILE_POPULATED?this.loader.nextFile(this,!0):(this.state=CONST$P.FILE_LOADING,this.src=GetURL$2(this,this.loader.baseURL),0===this.src.indexOf("data:")?console.warn("Local data URIs are not supported: "+this.key):this.xhrLoader=XHRLoader(this,this.loader.xhr))},onLoad:function(xhr,event){var success=xhr.responseURL&&(0===xhr.responseURL.indexOf("file://")||0===xhr.responseURL.indexOf("capacitor://"))&&0===event.target.status,success=!(event.target&&200!==event.target.status)||success;4===xhr.readyState&&400<=xhr.status&&xhr.status<=599&&(success=!1),this.state=CONST$P.FILE_LOADED,this.resetXHR(),this.loader.nextFile(this,success)},onError:function(){this.resetXHR(),this.loader.nextFile(this,!1)},onProgress:function(event){event.lengthComputable&&(this.bytesLoaded=event.loaded,this.bytesTotal=event.total,this.percentComplete=Math.min(this.bytesLoaded/this.bytesTotal,1),this.loader.emit(Events$e.FILE_PROGRESS,this,this.percentComplete))},onProcess:function(){this.state=CONST$P.FILE_PROCESSING,this.onProcessComplete()},onProcessComplete:function(){this.state=CONST$P.FILE_COMPLETE,this.multiFile&&this.multiFile.onFileComplete(this),this.loader.fileProcessComplete(this)},onProcessError:function(){this.state=CONST$P.FILE_ERRORED,this.multiFile&&this.multiFile.onFileFailed(this),this.loader.fileProcessComplete(this)},hasCacheConflict:function(){return this.cache&&this.cache.exists(this.key)},addToCache:function(){this.cache&&this.cache.add(this.key,this.data),this.pendingDestroy()},pendingDestroy:function(data){void 0===data&&(data=this.data);var key=this.key,type=this.type;this.loader.emit(Events$e.FILE_COMPLETE,key,type,data),this.loader.emit(Events$e.FILE_KEY_COMPLETE+type+"-"+key,key,type,data),this.loader.flagForRemoval(this)},destroy:function(){this.loader=null,this.cache=null,this.xhrSettings=null,this.multiFile=null,this.linkFile=null,this.data=null}});loader.createObjectURL=function(image,blob,defaultType){var reader;"function"==typeof URL?image.src=URL.createObjectURL(blob):((reader=new FileReader).onload=function(){image.removeAttribute("crossOrigin"),image.src="data:"+(blob.type||defaultType)+";base64,"+reader.result.split(",")[1]},reader.onerror=image.onerror,reader.readAsDataURL(blob))},loader.revokeObjectURL=function(image){"function"==typeof URL&&URL.revokeObjectURL(image.src)};var Engine_1=loader,CONST$O=GetTileAtWorldXY_1,File$h=Engine_1,HTMLFile_1=GetTilesWithinWorldXY_1,GetFastValue$O=GetFastValue_1,GetValue$a=GetValue_1,IsPlainObject$s=IsPlainObject_1,JSONFile$8=new Class_1({Extends:File$h,initialize:function(loader,key,url,fileConfig,dataKey){var config,extension="json";IsPlainObject$s(key)&&(key=GetFastValue$O(config=key,"key"),url=GetFastValue$O(config,"url"),fileConfig=GetFastValue$O(config,"xhrSettings"),extension=GetFastValue$O(config,"extension",extension),dataKey=GetFastValue$O(config,"dataKey",dataKey));fileConfig={type:"json",cache:loader.cacheManager.json,extension:extension,responseType:"text",key:key,url:url,xhrSettings:fileConfig,config:dataKey};File$h.call(this,loader,fileConfig),IsPlainObject$s(url)&&(this.data=dataKey?GetValue$a(url,dataKey):url,this.state=CONST$O.FILE_POPULATED)},onProcess:function(){if(this.state!==CONST$O.FILE_POPULATED){this.state=CONST$O.FILE_PROCESSING;try{var json=JSON.parse(this.xhrLoader.responseText)}catch(e){throw console.warn("Invalid JSON: "+this.key),this.onProcessError(),e}var key=this.config;this.data="string"==typeof key?GetValue$a(json,key,json):json}this.onProcessComplete()}});HTMLFile_1.register("json",function(key,url,dataKey,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new JSONFile$8(this,key[i]));else this.addFile(new JSONFile$8(this,key,url,xhrSettings,dataKey));return this});var JSONFile_1=JSONFile$8,Bodies_1=GetTilesWithinWorldXY_1,JSONFile$7=JSONFile_1,LoaderEvents=Pairs_1,AnimationJSONFile=new Class_1({Extends:JSONFile$7,initialize:function(loader,key,url,xhrSettings,dataKey){JSONFile$7.call(this,loader,key,url,xhrSettings,dataKey),this.type="animationJSON"},onProcess:function(){this.loader.once(LoaderEvents.POST_PROCESS,this.onLoadComplete,this),JSONFile$7.prototype.onProcess.call(this)},onLoadComplete:function(){this.loader.systems.anims.fromJSON(this.data)}});Bodies_1.register("animation",function(key,url,dataKey,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new AnimationJSONFile(this,key[i]));else this.addFile(new AnimationJSONFile(this,key,url,xhrSettings,dataKey));return this});var AnimationJSONFile_1=AnimationJSONFile,CONST$N=GetTileAtWorldXY_1,File$g=Engine_1,HTMLTextureFile_1=GetTilesWithinWorldXY_1,GetFastValue$N=GetFastValue_1,IsPlainObject$r=IsPlainObject_1,ImageFile$7=new Class_1({Extends:File$g,initialize:function ImageFile(loader,key,fileConfig,xhrSettings,normalMap){var normalMapURL,config,extension="png";IsPlainObject$r(key)&&(key=GetFastValue$N(config=key,"key"),fileConfig=GetFastValue$N(config,"url"),normalMapURL=GetFastValue$N(config,"normalMap"),xhrSettings=GetFastValue$N(config,"xhrSettings"),extension=GetFastValue$N(config,"extension",extension),normalMap=GetFastValue$N(config,"frameConfig")),Array.isArray(fileConfig)&&(normalMapURL=fileConfig[1],fileConfig=fileConfig[0]);fileConfig={type:"image",cache:loader.textureManager,extension:extension,responseType:"blob",key:key,url:fileConfig,xhrSettings:xhrSettings,config:normalMap};File$g.call(this,loader,fileConfig),normalMapURL&&((normalMap=new ImageFile(loader,this.key,normalMapURL,xhrSettings,normalMap)).type="normalMap",this.setLink(normalMap),loader.addFile(normalMap))},onProcess:function(){this.state=CONST$N.FILE_PROCESSING,this.data=new Image,this.data.crossOrigin=this.crossOrigin;var _this=this;this.data.onload=function(){File$g.revokeObjectURL(_this.data),_this.onProcessComplete()},this.data.onerror=function(){File$g.revokeObjectURL(_this.data),_this.onProcessError()},File$g.createObjectURL(this.data,this.xhrLoader.response,"image/png")},addToCache:function(){var texture,linkFile=this.linkFile;linkFile&&linkFile.state===CONST$N.FILE_COMPLETE?(texture="image"===this.type?this.cache.addImage(this.key,this.data,linkFile.data):this.cache.addImage(linkFile.key,linkFile.data,this.data),this.pendingDestroy(texture),linkFile.pendingDestroy(texture)):linkFile||(texture=this.cache.addImage(this.key,this.data),this.pendingDestroy(texture))}});HTMLTextureFile_1.register("image",function(key,url,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new ImageFile$7(this,key[i]));else this.addFile(new ImageFile$7(this,key,url,xhrSettings));return this});var ImageFile_1=ImageFile$7,MatterGameObject_1=new Class_1({initialize:function(loader,type,key,files){var finalFiles=[];files.forEach(function(file){file&&finalFiles.push(file)}),this.loader=loader,this.type=type,this.key=key,this.multiKeyIndex=loader.multiKeyIndex++,this.files=finalFiles,this.complete=!1,this.pending=finalFiles.length,this.failed=0,this.config={},this.baseURL=loader.baseURL,this.path=loader.path,this.prefix=loader.prefix;for(var i=0;i<finalFiles.length;i++)finalFiles[i].multiFile=this},isReadyToProcess:function(){return 0===this.pending&&0===this.failed&&!this.complete},addToMultiFile:function(file){return this.files.push(file),(file.multiFile=this).pending++,this.complete=!1,this},onFileComplete:function(file){-1!==this.files.indexOf(file)&&this.pending--},onFileFailed:function(file){-1!==this.files.indexOf(file)&&this.failed++}}),plugins=GetTilesWithinWorldXY_1,GetFastValue$M=GetFastValue_1,ImageFile$6=ImageFile_1,IsPlainObject$q=IsPlainObject_1,JSONFile$6=JSONFile_1,MultiFile$8=MatterGameObject_1,AsepriteFile=new Class_1({Extends:MultiFile$8,initialize:function(loader,key,textureURL,atlasURL,textureXhrSettings,data){var image,config,data=IsPlainObject$q(key)?(key=GetFastValue$M(config=key,"key"),image=new ImageFile$6(loader,{key:key,url:GetFastValue$M(config,"textureURL"),extension:GetFastValue$M(config,"textureExtension","png"),normalMap:GetFastValue$M(config,"normalMap"),xhrSettings:GetFastValue$M(config,"textureXhrSettings")}),new JSONFile$6(loader,{key:key,url:GetFastValue$M(config,"atlasURL"),extension:GetFastValue$M(config,"atlasExtension","json"),xhrSettings:GetFastValue$M(config,"atlasXhrSettings")})):(image=new ImageFile$6(loader,key,textureURL,textureXhrSettings),new JSONFile$6(loader,key,atlasURL,data));image.linkFile?MultiFile$8.call(this,loader,"atlasjson",key,[image,data,image.linkFile]):MultiFile$8.call(this,loader,"atlasjson",key,[image,data])},addToCache:function(){var image,json,normalMap;this.isReadyToProcess()&&(image=this.files[0],json=this.files[1],normalMap=this.files[2]?this.files[2].data:null,this.loader.textureManager.addAtlas(image.key,image.data,json.data,normalMap),json.addToCache(),this.complete=!0)}});plugins.register("aseprite",function(key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings){var multifile;if(Array.isArray(key))for(var i=0;i<key.length;i++)multifile=new AsepriteFile(this,key[i]),this.addFile(multifile.files);else multifile=new AsepriteFile(this,key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings),this.addFile(multifile.files);return this});var AsepriteFile_1=AsepriteFile,GetTilesWithin_1=GetTilesWithinWorldXY_1,GetFastValue$L=GetFastValue_1,ImageFile$5=ImageFile_1,IsPlainObject$p=IsPlainObject_1,JSONFile$5=JSONFile_1,MultiFile$7=MatterGameObject_1,AtlasJSONFile=new Class_1({Extends:MultiFile$7,initialize:function(loader,key,textureURL,atlasURL,textureXhrSettings,data){var image,config,data=IsPlainObject$p(key)?(key=GetFastValue$L(config=key,"key"),image=new ImageFile$5(loader,{key:key,url:GetFastValue$L(config,"textureURL"),extension:GetFastValue$L(config,"textureExtension","png"),normalMap:GetFastValue$L(config,"normalMap"),xhrSettings:GetFastValue$L(config,"textureXhrSettings")}),new JSONFile$5(loader,{key:key,url:GetFastValue$L(config,"atlasURL"),extension:GetFastValue$L(config,"atlasExtension","json"),xhrSettings:GetFastValue$L(config,"atlasXhrSettings")})):(image=new ImageFile$5(loader,key,textureURL,textureXhrSettings),new JSONFile$5(loader,key,atlasURL,data));image.linkFile?MultiFile$7.call(this,loader,"atlasjson",key,[image,data,image.linkFile]):MultiFile$7.call(this,loader,"atlasjson",key,[image,data])},addToCache:function(){var image,json,normalMap;this.isReadyToProcess()&&(image=this.files[0],json=this.files[1],normalMap=this.files[2]?this.files[2].data:null,this.loader.textureManager.addAtlas(image.key,image.data,json.data,normalMap),json.pendingDestroy(),this.complete=!0)}});GetTilesWithin_1.register("atlas",function(key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings){var multifile;if(Array.isArray(key))for(var i=0;i<key.length;i++)multifile=new AtlasJSONFile(this,key[i]),this.addFile(multifile.files);else multifile=new AtlasJSONFile(this,key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings),this.addFile(multifile.files);return this});var AtlasJSONFile_1=AtlasJSONFile,CONST$M=GetTileAtWorldXY_1,File$f=Engine_1,SAT_1=GetTilesWithinWorldXY_1,GetFastValue$K=GetFastValue_1,IsPlainObject$o=IsPlainObject_1,ParseXML=FileTypesManager$1,XMLFile$2=new Class_1({Extends:File$f,initialize:function(loader,key,url,fileConfig){var config,extension="xml";IsPlainObject$o(key)&&(key=GetFastValue$K(config=key,"key"),url=GetFastValue$K(config,"url"),fileConfig=GetFastValue$K(config,"xhrSettings"),extension=GetFastValue$K(config,"extension",extension));fileConfig={type:"xml",cache:loader.cacheManager.xml,extension:extension,responseType:"text",key:key,url:url,xhrSettings:fileConfig};File$f.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST$M.FILE_PROCESSING,this.data=ParseXML(this.xhrLoader.responseText),this.data?this.onProcessComplete():(console.warn("Invalid XMLFile: "+this.key),this.onProcessError())}});SAT_1.register("xml",function(key,url,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new XMLFile$2(this,key[i]));else this.addFile(new XMLFile$2(this,key,url,xhrSettings));return this});var Pair_1=XMLFile$2,Events_1=GetTilesWithinWorldXY_1,GetFastValue$J=GetFastValue_1,ImageFile$4=ImageFile_1,IsPlainObject$n=IsPlainObject_1,MultiFile$6=MatterGameObject_1,XMLFile$1=Pair_1,AtlasXMLFile=new Class_1({Extends:MultiFile$6,initialize:function(loader,key,textureURL,atlasURL,textureXhrSettings,data){var image,config,data=IsPlainObject$n(key)?(key=GetFastValue$J(config=key,"key"),image=new ImageFile$4(loader,{key:key,url:GetFastValue$J(config,"textureURL"),extension:GetFastValue$J(config,"textureExtension","png"),normalMap:GetFastValue$J(config,"normalMap"),xhrSettings:GetFastValue$J(config,"textureXhrSettings")}),new XMLFile$1(loader,{key:key,url:GetFastValue$J(config,"atlasURL"),extension:GetFastValue$J(config,"atlasExtension","xml"),xhrSettings:GetFastValue$J(config,"atlasXhrSettings")})):(image=new ImageFile$4(loader,key,textureURL,textureXhrSettings),new XMLFile$1(loader,key,atlasURL,data));image.linkFile?MultiFile$6.call(this,loader,"atlasxml",key,[image,data,image.linkFile]):MultiFile$6.call(this,loader,"atlasxml",key,[image,data])},addToCache:function(){var image,xml,normalMap;this.isReadyToProcess()&&(image=this.files[0],xml=this.files[1],normalMap=this.files[2]?this.files[2].data:null,this.loader.textureManager.addAtlasXML(image.key,image.data,xml.data,normalMap),xml.pendingDestroy(),this.complete=!0)}});Events_1.register("atlasXML",function(key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings){var multifile;if(Array.isArray(key))for(var i=0;i<key.length;i++)multifile=new AtlasXMLFile(this,key[i]),this.addFile(multifile.files);else multifile=new AtlasXMLFile(this,key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings),this.addFile(multifile.files);return this});var AtlasXMLFile_1=AtlasXMLFile,Events$d=Pairs_1,File$e=Engine_1,GetFastValue$I=GetFastValue_1,GetURL$1=Composite_1,IsPlainObject$m=IsPlainObject_1,HTML5AudioFile_1=new Class_1({Extends:File$e,initialize:function(loader,key,urlConfig,fileConfig){var config;IsPlainObject$m(key)&&(key=GetFastValue$I(config=key,"key"),fileConfig=GetFastValue$I(config,"config",fileConfig));fileConfig={type:"audio",cache:loader.cacheManager.audio,extension:urlConfig.type,key:key,url:urlConfig.url,config:fileConfig};File$e.call(this,loader,fileConfig),this.locked="ontouchstart"in window,this.loaded=!1,this.filesLoaded=0,this.filesTotal=0},onLoad:function(){this.loaded||(this.loaded=!0,this.loader.nextFile(this,!0))},onError:function(){for(var i=0;i<this.data.length;i++){var audio=this.data[i];audio.oncanplaythrough=null,audio.onerror=null}this.loader.nextFile(this,!1)},onProgress:function(audio){audio=audio.target;audio.oncanplaythrough=null,audio.onerror=null,this.filesLoaded++,this.percentComplete=Math.min(this.filesLoaded/this.filesTotal,1),this.loader.emit(Events$d.FILE_PROGRESS,this,this.percentComplete),this.filesLoaded===this.filesTotal&&this.onLoad()},load:function(){this.data=[];var instances=this.config&&this.config.instances||1;this.filesTotal=instances,this.filesLoaded=0;for(var i=this.percentComplete=0;i<instances;i++){var audio=new Audio;audio.dataset||(audio.dataset={}),audio.dataset.name=this.key+("0"+i).slice(-2),audio.dataset.used="false",this.locked?audio.dataset.locked="true":(audio.dataset.locked="false",audio.preload="auto",audio.oncanplaythrough=this.onProgress.bind(this),audio.onerror=this.onError.bind(this)),this.data.push(audio)}for(i=0;i<this.data.length;i++)(audio=this.data[i]).src=GetURL$1(this,this.loader.baseURL),this.locked||audio.load();this.locked&&setTimeout(this.onLoad.bind(this))}}),CONST$L=GetTileAtWorldXY_1,File$d=Engine_1,Axes_1=GetTilesWithinWorldXY_1,GetFastValue$H=GetFastValue_1,HTML5AudioFile=HTML5AudioFile_1,IsPlainObject$l=IsPlainObject_1,AudioFile$1=new Class_1({Extends:File$d,initialize:function(loader,key,urlConfig,xhrSettings,fileConfig){var config;IsPlainObject$l(key)&&(key=GetFastValue$H(config=key,"key"),xhrSettings=GetFastValue$H(config,"xhrSettings"),fileConfig=GetFastValue$H(config,"context",fileConfig));fileConfig={type:"audio",cache:loader.cacheManager.audio,extension:urlConfig.type,responseType:"arraybuffer",key:key,url:urlConfig.url,xhrSettings:xhrSettings,config:{context:fileConfig}};File$d.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST$L.FILE_PROCESSING;var _this=this;this.config.context.decodeAudioData(this.xhrLoader.response,function(audioBuffer){_this.data=audioBuffer,_this.onProcessComplete()},function(e){console.error("Error decoding audio: "+_this.key+" - ",e?e.message:null),_this.onProcessError()}),this.config.context=null}});AudioFile$1.create=function(loader,key,urlConfig,config,xhrSettings){var game=loader.systems.game,audioConfig=game.config.audio,deviceAudio=game.device.audio;IsPlainObject$l(key)&&(urlConfig=GetFastValue$H(key,"url",[]),config=GetFastValue$H(key,"config",{}));urlConfig=AudioFile$1.getAudioURL(game,urlConfig);return urlConfig?deviceAudio.webAudio&&!audioConfig.disableWebAudio?new AudioFile$1(loader,key,urlConfig,xhrSettings,game.sound.context):new HTML5AudioFile(loader,key,urlConfig,config):null},AudioFile$1.getAudioURL=function(game,urls){Array.isArray(urls)||(urls=[urls]);for(var i=0;i<urls.length;i++){var url=GetFastValue$H(urls[i],"url",urls[i]);if(0===url.indexOf("blob:")||0===url.indexOf("data:"))return{url:url,type:""};var audioType=url.match(/\.([a-zA-Z0-9]+)($|\?)/),audioType=GetFastValue$H(urls[i],"type",audioType?audioType[1]:"").toLowerCase();if(game.device.audio[audioType])return{url:url,type:audioType}}return null},Axes_1.register("audio",function(key,urls,config,xhrSettings){var audioFile,deviceAudio=this.systems.game,audioConfig=deviceAudio.config.audio,deviceAudio=deviceAudio.device.audio;if(audioConfig.noAudio||!deviceAudio.webAudio&&!deviceAudio.audioData)return this;if(Array.isArray(key))for(var i=0;i<key.length;i++)(audioFile=AudioFile$1.create(this,key[i]))&&this.addFile(audioFile);else(audioFile=AudioFile$1.create(this,key,urls,config,xhrSettings))&&this.addFile(audioFile);return this});var AudioFile_1=AudioFile$1,AudioFile=AudioFile_1,components$1=GetTilesWithinWorldXY_1,GetFastValue$G=GetFastValue_1,IsPlainObject$k=IsPlainObject_1,JSONFile$4=JSONFile_1,MultiFile$5=MatterGameObject_1,AudioSpriteFile=new Class_1({Extends:MultiFile$5,initialize:function(loader,key,jsonURL,audio,audioConfig,audioXhrSettings,jsonXhrSettings){var config,data;IsPlainObject$k(key)&&(key=GetFastValue$G(config=key,"key"),jsonURL=GetFastValue$G(config,"jsonURL"),audio=GetFastValue$G(config,"audioURL"),audioConfig=GetFastValue$G(config,"audioConfig"),audioXhrSettings=GetFastValue$G(config,"audioXhrSettings"),jsonXhrSettings=GetFastValue$G(config,"jsonXhrSettings")),audio?(audio=AudioFile.create(loader,key,audio,audioConfig,audioXhrSettings))&&(data=new JSONFile$4(loader,key,jsonURL,jsonXhrSettings),MultiFile$5.call(this,loader,"audiosprite",key,[audio,data]),this.config.resourceLoad=!1):(data=new JSONFile$4(loader,key,jsonURL,jsonXhrSettings),MultiFile$5.call(this,loader,"audiosprite",key,[data]),this.config.resourceLoad=!0,this.config.audioConfig=audioConfig,this.config.audioXhrSettings=audioXhrSettings)},onFileComplete:function(file){var urls,audioConfig,audio;-1!==this.files.indexOf(file)&&(this.pending--,this.config.resourceLoad&&"json"===file.type&&file.data.hasOwnProperty("resources")&&(urls=file.data.resources,audioConfig=GetFastValue$G(this.config,"audioConfig"),audio=GetFastValue$G(this.config,"audioXhrSettings"),(audio=AudioFile.create(this.loader,file.key,urls,audioConfig,audio))&&(this.addToMultiFile(audio),this.loader.addFile(audio))))},addToCache:function(){var fileA,fileB;this.isReadyToProcess()&&(fileA=this.files[0],fileB=this.files[1],fileA.addToCache(),fileB.addToCache(),this.complete=!0)}});components$1.register("audioSprite",function(key,jsonURL,audioURL,audioConfig,audioXhrSettings,jsonXhrSettings){var multifile,deviceAudio=this.systems.game,gameAudioConfig=deviceAudio.config.audio,deviceAudio=deviceAudio.device.audio;if(gameAudioConfig&&gameAudioConfig.noAudio||!deviceAudio.webAudio&&!deviceAudio.audioData)return this;if(Array.isArray(key))for(var i=0;i<key.length;i++)(multifile=new AudioSpriteFile(this,key[i])).files&&this.addFile(multifile.files);else(multifile=new AudioSpriteFile(this,key,jsonURL,audioURL,audioConfig,audioXhrSettings,jsonXhrSettings)).files&&this.addFile(multifile.files);return this});var CONST$K=GetTileAtWorldXY_1,File$c=Engine_1,IsInLayerBounds_1=GetTilesWithinWorldXY_1,GetFastValue$F=GetFastValue_1,IsPlainObject$j=IsPlainObject_1,BinaryFile=new Class_1({Extends:File$c,initialize:function(loader,key,url,xhrSettings,fileConfig){var config,extension="bin";IsPlainObject$j(key)&&(key=GetFastValue$F(config=key,"key"),url=GetFastValue$F(config,"url"),xhrSettings=GetFastValue$F(config,"xhrSettings"),extension=GetFastValue$F(config,"extension",extension),fileConfig=GetFastValue$F(config,"dataType",fileConfig));fileConfig={type:"binary",cache:loader.cacheManager.binary,extension:extension,responseType:"arraybuffer",key:key,url:url,xhrSettings:xhrSettings,config:{dataType:fileConfig}};File$c.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST$K.FILE_PROCESSING;var ctor=this.config.dataType;this.data=ctor?new ctor(this.xhrLoader.response):this.xhrLoader.response,this.onProcessComplete()}});IsInLayerBounds_1.register("binary",function(key,url,dataType,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new BinaryFile(this,key[i]));else this.addFile(new BinaryFile(this,key,url,xhrSettings,dataType));return this});var BinaryFile_1=BinaryFile,Grid_1=GetTilesWithinWorldXY_1,GetFastValue$E=GetFastValue_1,ImageFile$3=ImageFile_1,IsPlainObject$i=IsPlainObject_1,MultiFile$4=MatterGameObject_1,ParseXMLBitmapFont=GetTargets_1,XMLFile=Pair_1,BitmapFontFile=new Class_1({Extends:MultiFile$4,initialize:function(loader,key,textureURL,fontDataURL,textureXhrSettings,data){var image,config,data=IsPlainObject$i(key)?(key=GetFastValue$E(config=key,"key"),image=new ImageFile$3(loader,{key:key,url:GetFastValue$E(config,"textureURL"),extension:GetFastValue$E(config,"textureExtension","png"),normalMap:GetFastValue$E(config,"normalMap"),xhrSettings:GetFastValue$E(config,"textureXhrSettings")}),new XMLFile(loader,{key:key,url:GetFastValue$E(config,"fontDataURL"),extension:GetFastValue$E(config,"fontDataExtension","xml"),xhrSettings:GetFastValue$E(config,"fontDataXhrSettings")})):(image=new ImageFile$3(loader,key,textureURL,textureXhrSettings),new XMLFile(loader,key,fontDataURL,data));image.linkFile?MultiFile$4.call(this,loader,"bitmapfont",key,[image,data,image.linkFile]):MultiFile$4.call(this,loader,"bitmapfont",key,[image,data])},addToCache:function(){var image,xml,data;this.isReadyToProcess()&&(image=this.files[0],xml=this.files[1],image.addToCache(),xml.pendingDestroy(),data=image.cache.get(image.key),data=ParseXMLBitmapFont(xml.data,image.cache.getFrame(image.key),0,0,data),this.loader.cacheManager.bitmapFont.add(image.key,{data:data,texture:image.key,frame:null}),this.complete=!0)}});Grid_1.register("bitmapFont",function(key,textureURL,fontDataURL,textureXhrSettings,fontDataXhrSettings){var multifile;if(Array.isArray(key))for(var i=0;i<key.length;i++)multifile=new BitmapFontFile(this,key[i]),this.addFile(multifile.files);else multifile=new BitmapFontFile(this,key,textureURL,fontDataURL,textureXhrSettings,fontDataXhrSettings),this.addFile(multifile.files);return this});var BitmapFontFile_1=BitmapFontFile,CONST$J=GetTileAtWorldXY_1,File$b=Engine_1,tilemaps=GetTilesWithinWorldXY_1,GetFastValue$D=GetFastValue_1,IsPlainObject$h=IsPlainObject_1,CSSFile=new Class_1({Extends:File$b,initialize:function(loader,key,url,xhrSettings){var config,extension="css";IsPlainObject$h(key)&&(key=GetFastValue$D(config=key,"key"),url=GetFastValue$D(config,"url"),xhrSettings=GetFastValue$D(config,"xhrSettings"),extension=GetFastValue$D(config,"extension",extension)),File$b.call(this,loader,{type:"script",cache:!1,extension:extension,responseType:"text",key:key,url:url,xhrSettings:xhrSettings})},onProcess:function(){this.state=CONST$J.FILE_PROCESSING,this.data=document.createElement("style"),this.data.defer=!1,this.data.innerHTML=this.xhrLoader.responseText,document.head.appendChild(this.data),this.onProcessComplete()}});tilemaps.register("css",function(key,url,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new CSSFile(this,key[i]));else this.addFile(new CSSFile(this,key,url,xhrSettings));return this});var CSSFile_1=CSSFile,CONST$I=GetTileAtWorldXY_1,File$a=Engine_1,World_1$1=GetTilesWithinWorldXY_1,GetFastValue$C=GetFastValue_1,IsPlainObject$g=IsPlainObject_1,Shader=GetWorldToTileXFunction_1,GLSLFile=new Class_1({Extends:File$a,initialize:function(loader,key,url,shaderType,fileConfig){var config,extension="glsl";IsPlainObject$g(key)?(key=GetFastValue$C(config=key,"key"),url=GetFastValue$C(config,"url"),shaderType=GetFastValue$C(config,"shaderType","fragment"),fileConfig=GetFastValue$C(config,"xhrSettings"),extension=GetFastValue$C(config,"extension",extension)):void 0===shaderType&&(shaderType="fragment");fileConfig={type:"glsl",cache:loader.cacheManager.shader,extension:extension,responseType:"text",key:key,url:url,config:{shaderType:shaderType},xhrSettings:fileConfig};File$a.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST$I.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var data=this.data.split("\n"),block=this.extractBlock(data,0);if(block)for(;block;){var shader,key=this.getShaderName(block.header),shaderType=this.getShaderType(block.header),uniforms=this.getShaderUniforms(block.header),shaderSrc=block.shader;this.cache.has(key)?(shader=this.cache.get(key),"fragment"===shaderType?shader.fragmentSrc=shaderSrc:shader.vertexSrc=shaderSrc,shader.uniforms||(shader.uniforms=uniforms)):"fragment"===shaderType?this.cache.add(key,new Shader(key,shaderSrc,"",uniforms)):this.cache.add(key,new Shader(key,"",shaderSrc,uniforms)),block=this.extractBlock(data,block.offset)}else"fragment"===this.config.shaderType?this.cache.add(this.key,new Shader(this.key,this.data)):this.cache.add(this.key,new Shader(this.key,"",this.data));this.pendingDestroy()},getShaderName:function(headerSource){for(var i=0;i<headerSource.length;i++){var line=headerSource[i].trim();if("name:"===line.substring(0,5))return line.substring(5).trim()}return this.key},getShaderType:function(headerSource){for(var i=0;i<headerSource.length;i++){var line=headerSource[i].trim();if("type:"===line.substring(0,5))return line.substring(5).trim()}return this.config.shaderType},getShaderUniforms:function(headerSource){for(var uniforms={},i=0;i<headerSource.length;i++){var line=headerSource[i].trim();if("uniform."===line.substring(0,8)){var pos=line.indexOf(":");if(pos){var key=line.substring(8,pos);try{uniforms[key]=JSON.parse(line.substring(pos+1))}catch(e){console.warn("Invalid uniform JSON: "+key)}}}}return uniforms},extractBlock:function(data,offset){for(var headerStart=-1,headerEnd=-1,blockEnd=-1,headerOpen=!1,captureSource=!1,headerSource=[],shaderSource=[],i=offset;i<data.length;i++){var line=data[i].trim();if("---"===line)if(-1===headerStart)headerStart=i,headerOpen=!0;else{if(!headerOpen){captureSource=!1;break}headerEnd=i,captureSource=!(headerOpen=!1)}else headerOpen?headerSource.push(line):captureSource&&(shaderSource.push(line),blockEnd=i)}return headerOpen||-1===headerEnd?null:{header:headerSource,shader:shaderSource.join("\n"),offset:blockEnd}}});World_1$1.register("glsl",function(key,url,shaderType,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new GLSLFile(this,key[i]));else this.addFile(new GLSLFile(this,key,url,shaderType,xhrSettings));return this});var GLSLFile_1=GLSLFile,CONST$H=GetTileAtWorldXY_1,File$9=Engine_1,loader=GetTilesWithinWorldXY_1,GetFastValue$B=GetFastValue_1,IsPlainObject$f=IsPlainObject_1,HTMLFile=new Class_1({Extends:File$9,initialize:function(loader,key,url,fileConfig){var config,extension="html";IsPlainObject$f(key)&&(key=GetFastValue$B(config=key,"key"),url=GetFastValue$B(config,"url"),fileConfig=GetFastValue$B(config,"xhrSettings"),extension=GetFastValue$B(config,"extension",extension));fileConfig={type:"text",cache:loader.cacheManager.html,extension:extension,responseType:"text",key:key,url:url,xhrSettings:fileConfig};File$9.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST$H.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});loader.register("html",function(key,url,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new HTMLFile(this,key[i]));else this.addFile(new HTMLFile(this,key,url,xhrSettings));return this});var HTMLFile_1=HTMLFile,CONST$G=GetTileAtWorldXY_1,File$8=Engine_1,Bodies_1=GetTilesWithinWorldXY_1,GetFastValue$A=GetFastValue_1,IsPlainObject$e=IsPlainObject_1,HTMLTextureFile=new Class_1({Extends:File$8,initialize:function(loader,key,url,width,fileConfig,xhrSettings){void 0===width&&(width=512),void 0===fileConfig&&(fileConfig=512);var config,extension="html";IsPlainObject$e(key)&&(key=GetFastValue$A(config=key,"key"),url=GetFastValue$A(config,"url"),xhrSettings=GetFastValue$A(config,"xhrSettings"),extension=GetFastValue$A(config,"extension",extension),width=GetFastValue$A(config,"width",width),fileConfig=GetFastValue$A(config,"height",fileConfig));fileConfig={type:"html",cache:loader.textureManager,extension:extension,responseType:"text",key:key,url:url,xhrSettings:xhrSettings,config:{width:width,height:fileConfig}};File$8.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST$G.FILE_PROCESSING;var w=this.config.width,h=this.config.height,svg=[];svg.push('<svg width="'+w+'px" height="'+h+'px" viewBox="0 0 '+w+" "+h+'" xmlns="http://www.w3.org/2000/svg">'),svg.push('<foreignObject width="100%" height="100%">'),svg.push('<body xmlns="http://www.w3.org/1999/xhtml">'),svg.push(this.xhrLoader.responseText),svg.push("</body>"),svg.push("</foreignObject>"),svg.push("</svg>");var svg=[svg.join("\n")],_this=this;try{var blob=new window.Blob(svg,{type:"image/svg+xml;charset=utf-8"})}catch(e){return _this.state=CONST$G.FILE_ERRORED,void _this.onProcessComplete()}this.data=new Image,this.data.crossOrigin=this.crossOrigin,this.data.onload=function(){File$8.revokeObjectURL(_this.data),_this.onProcessComplete()},this.data.onerror=function(){File$8.revokeObjectURL(_this.data),_this.onProcessError()},File$8.createObjectURL(this.data,blob,"image/svg+xml")},addToCache:function(){var texture=this.cache.addImage(this.key,this.data);this.pendingDestroy(texture)}});Bodies_1.register("htmlTexture",function(key,url,width,height,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new HTMLTextureFile(this,key[i]));else this.addFile(new HTMLTextureFile(this,key,url,width,height,xhrSettings));return this});var HTMLTextureFile_1=HTMLTextureFile,plugins=GetTilesWithinWorldXY_1,GetFastValue$z=GetFastValue_1,ImageFile$2=ImageFile_1,IsPlainObject$d=IsPlainObject_1,JSONFile$3=JSONFile_1,MultiFile$3=MatterGameObject_1,MultiAtlasFile=new Class_1({Extends:MultiFile$3,initialize:function(loader,key,atlasURL,path,baseURL,data,textureXhrSettings){var config;IsPlainObject$d(key)&&(key=GetFastValue$z(config=key,"key"),atlasURL=GetFastValue$z(config,"url",!1)?GetFastValue$z(config,"url"):GetFastValue$z(config,"atlasURL"),data=GetFastValue$z(config,"xhrSettings"),path=GetFastValue$z(config,"path"),baseURL=GetFastValue$z(config,"baseURL"),textureXhrSettings=GetFastValue$z(config,"textureXhrSettings"));data=new JSONFile$3(loader,key,atlasURL,data);MultiFile$3.call(this,loader,"multiatlas",key,[data]),this.config.path=path,this.config.baseURL=baseURL,this.config.textureXhrSettings=textureXhrSettings},onFileComplete:function(prefix){var path=this.files.indexOf(prefix);if(-1!==path&&(this.pending--,"json"===prefix.type&&prefix.data.hasOwnProperty("textures"))){var textures=prefix.data.textures,config=this.config,loader=this.loader,currentBaseURL=loader.baseURL,currentPath=loader.path,currentPrefix=loader.prefix,baseURL=GetFastValue$z(config,"baseURL",this.baseURL),path=GetFastValue$z(config,"path",this.path),prefix=GetFastValue$z(config,"prefix",this.prefix),textureXhrSettings=GetFastValue$z(config,"textureXhrSettings");loader.setBaseURL(baseURL),loader.setPath(path),loader.setPrefix(prefix);for(var i=0;i<textures.length;i++){var image=textures[i].image,normalMap="MA"+this.multiKeyIndex+"_"+image,image=new ImageFile$2(loader,normalMap,image,textureXhrSettings);this.addToMultiFile(image),loader.addFile(image),textures[i].normalMap&&((normalMap=new ImageFile$2(loader,normalMap,textures[i].normalMap,textureXhrSettings)).type="normalMap",image.setLink(normalMap),this.addToMultiFile(normalMap),loader.addFile(normalMap))}loader.setBaseURL(currentBaseURL),loader.setPath(currentPath),loader.setPrefix(currentPrefix)}},addToCache:function(){if(this.isReadyToProcess()){for(var fileJSON=this.files[0],data=[],images=[],normalMaps=[],i=1;i<this.files.length;i++){var file=this.files[i];if("normalMap"!==file.type)for(var pos=file.key.indexOf("_"),key=file.key.substr(pos+1),image=file.data,t=0;t<fileJSON.data.textures.length;t++){var item=fileJSON.data.textures[t];if(item.image===key){images.push(image),data.push(item),file.linkFile&&normalMaps.push(file.linkFile.data);break}}}for(0===normalMaps.length&&(normalMaps=void 0),this.loader.textureManager.addAtlasJSONArray(this.key,images,data,normalMaps),this.complete=!0,i=0;i<this.files.length;i++)this.files[i].pendingDestroy()}}});plugins.register("multiatlas",function(key,atlasURL,path,baseURL,atlasXhrSettings){var multifile;if(Array.isArray(key))for(var i=0;i<key.length;i++)multifile=new MultiAtlasFile(this,key[i]),this.addFile(multifile.files);else multifile=new MultiAtlasFile(this,key,atlasURL,path,baseURL,atlasXhrSettings),this.addFile(multifile.files);return this});var GetTilesWithin_1=MultiAtlasFile,CONST$F=GetTileAtWorldXY_1,File$7=Engine_1,FileTypesManager$1=GetTilesWithinWorldXY_1,GetFastValue$y=GetFastValue_1,IsPlainObject$c=IsPlainObject_1,ScriptFile$1=new Class_1({Extends:File$7,initialize:function(loader,key,url,xhrSettings){var config,extension="js";IsPlainObject$c(key)&&(key=GetFastValue$y(config=key,"key"),url=GetFastValue$y(config,"url"),xhrSettings=GetFastValue$y(config,"xhrSettings"),extension=GetFastValue$y(config,"extension",extension)),File$7.call(this,loader,{type:"script",cache:!1,extension:extension,responseType:"text",key:key,url:url,xhrSettings:xhrSettings})},onProcess:function(){this.state=CONST$F.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),this.onProcessComplete()}});FileTypesManager$1.register("script",function(key,url,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new ScriptFile$1(this,key[i]));else this.addFile(new ScriptFile$1(this,key,url,xhrSettings));return this});var SAT_1=ScriptFile$1,Events_1=GetTilesWithinWorldXY_1,GetFastValue$x=GetFastValue_1,IsPlainObject$b=IsPlainObject_1,MultiFile$2=MatterGameObject_1,ScriptFile=SAT_1,MultiScriptFile=new Class_1({Extends:MultiFile$2,initialize:function(loader,key,url,xhrSettings){var config,extension="js",files=[];IsPlainObject$b(key)&&(key=GetFastValue$x(config=key,"key"),url=GetFastValue$x(config,"url"),xhrSettings=GetFastValue$x(config,"xhrSettings"),extension=GetFastValue$x(config,"extension",extension)),Array.isArray(url)||(url=[url]);for(var i=0;i<url.length;i++){var scriptFile=new ScriptFile(loader,{key:key+"_"+i.toString(),url:url[i],extension:extension,xhrSettings:xhrSettings});scriptFile.onProcess=function(){this.onProcessComplete()},files.push(scriptFile)}MultiFile$2.call(this,loader,"scripts",key,files)},addToCache:function(){if(this.isReadyToProcess()){for(var i=0;i<this.files.length;i++){var file=this.files[i];file.data=document.createElement("script"),file.data.language="javascript",file.data.type="text/javascript",file.data.defer=!1,file.data.text=file.xhrLoader.responseText,document.head.appendChild(file.data)}this.complete=!0}}});Events_1.register("scripts",function(key,url,xhrSettings){var multifile;if(Array.isArray(key))for(var i=0;i<key.length;i++)multifile=new MultiScriptFile(this,key[i]),this.addFile(multifile.files);else multifile=new MultiScriptFile(this,key,url,xhrSettings),this.addFile(multifile.files);return this});var Axes_1=MultiScriptFile,CONST$E=GetTileAtWorldXY_1,File$6=Engine_1,components$1=GetTilesWithinWorldXY_1,GetFastValue$w=GetFastValue_1,IsPlainObject$a=IsPlainObject_1,TextFile$2=new Class_1({Extends:File$6,initialize:function(loader,key,url,xhrSettings){var config,type="text",extension="txt",cache=loader.cacheManager.text;IsPlainObject$a(key)&&(key=GetFastValue$w(config=key,"key"),url=GetFastValue$w(config,"url"),xhrSettings=GetFastValue$w(config,"xhrSettings"),extension=GetFastValue$w(config,"extension",extension),type=GetFastValue$w(config,"type",type),cache=GetFastValue$w(config,"cache",cache)),File$6.call(this,loader,{type:type,cache:cache,extension:extension,responseType:"text",key:key,url:url,xhrSettings:xhrSettings})},onProcess:function(){this.state=CONST$E.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});components$1.register("text",function(key,url,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new TextFile$2(this,key[i]));else this.addFile(new TextFile$2(this,key,url,xhrSettings));return this});var IsInLayerBounds_1=TextFile$2,GetTargets_1=GetTilesWithinWorldXY_1,GetFastValue$v=GetFastValue_1,IsPlainObject$9=IsPlainObject_1,MultiFile$1=MatterGameObject_1,ParseObj=Body_1,ParseObjMaterial=CustomMain,TextFile$1=IsInLayerBounds_1,OBJFile=new Class_1({Extends:MultiFile$1,initialize:function(loader,key,objURL,matURL,flipUV,xhrSettings){var obj,mat,config,cache=loader.cacheManager.obj;IsPlainObject$9(key)?(key=GetFastValue$v(config=key,"key"),obj=new TextFile$1(loader,{key:key,type:"obj",cache:cache,url:GetFastValue$v(config,"url"),extension:GetFastValue$v(config,"extension","obj"),xhrSettings:GetFastValue$v(config,"xhrSettings"),config:{flipUV:GetFastValue$v(config,"flipUV",flipUV)}}),(matURL=GetFastValue$v(config,"matURL"))&&(mat=new TextFile$1(loader,{key:key,type:"mat",cache:cache,url:matURL,extension:GetFastValue$v(config,"matExtension","mat"),xhrSettings:GetFastValue$v(config,"xhrSettings")}))):(obj=new TextFile$1(loader,{key:key,url:objURL,type:"obj",cache:cache,extension:"obj",xhrSettings:xhrSettings,config:{flipUV:flipUV}}),matURL&&(mat=new TextFile$1(loader,{key:key,url:matURL,type:"mat",cache:cache,extension:"mat",xhrSettings:xhrSettings}))),MultiFile$1.call(this,loader,"obj",key,[obj,mat])},addToCache:function(){var obj,mat,objData;this.isReadyToProcess()&&(obj=this.files[0],mat=this.files[1],objData=ParseObj(obj.data,obj.config.flipUV),mat&&(objData.materials=ParseObjMaterial(mat.data)),obj.cache.add(obj.key,objData),this.complete=!0)}});GetTargets_1.register("obj",function(key,objURL,matURL,flipUVs,xhrSettings){var multifile;if(Array.isArray(key))for(var i=0;i<key.length;i++)multifile=new OBJFile(this,key[i]),this.addFile(multifile.files);else multifile=new OBJFile(this,key,objURL,matURL,flipUVs,xhrSettings),this.addFile(multifile.files);return this});var Grid_1=OBJFile,CONST$D=GetTileAtWorldXY_1,tilemaps=GetTilesWithinWorldXY_1,JSONFile$2=JSONFile_1,PackFile=new Class_1({Extends:JSONFile$2,initialize:function(loader,key,url,xhrSettings,dataKey){JSONFile$2.call(this,loader,key,url,xhrSettings,dataKey),this.type="packfile"},onProcess:function(){this.state!==CONST$D.FILE_POPULATED&&(this.state=CONST$D.FILE_PROCESSING,this.data=JSON.parse(this.xhrLoader.responseText)),this.loader.addPack(this.data,this.config),this.onProcessComplete()}});tilemaps.register("pack",function(key,url,packKey,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new PackFile(this,key[i]));else this.addFile(new PackFile(this,key,url,xhrSettings,packKey));return this});var GetWorldToTileXFunction_1=PackFile,CONST$C=GetTileAtWorldXY_1,File$5=Engine_1,World_1$1=GetTilesWithinWorldXY_1,GetFastValue$u=GetFastValue_1,IsPlainObject$8=IsPlainObject_1,PluginFile=new Class_1({Extends:File$5,initialize:function(loader,key,url,start,mapping,xhrSettings){var config,extension="js";IsPlainObject$8(key)&&(key=GetFastValue$u(config=key,"key"),url=GetFastValue$u(config,"url"),xhrSettings=GetFastValue$u(config,"xhrSettings"),extension=GetFastValue$u(config,"extension",extension),start=GetFastValue$u(config,"start"),mapping=GetFastValue$u(config,"mapping")),File$5.call(this,loader,{type:"plugin",cache:!1,extension:extension,responseType:"text",key:key,url:url,xhrSettings:xhrSettings,config:{start:start,mapping:mapping}}),"function"==typeof url&&(this.data=url,this.state=CONST$C.FILE_POPULATED)},onProcess:function(){var plugin=this.loader.systems.plugins,mapping=this.config,start=GetFastValue$u(mapping,"start",!1),mapping=GetFastValue$u(mapping,"mapping",null);this.state===CONST$C.FILE_POPULATED?plugin.install(this.key,this.data,start,mapping):(this.state=CONST$C.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),plugin=plugin.install(this.key,window[this.key],start,mapping),(start||mapping)&&(this.loader.systems[mapping]=plugin,this.loader.scene[mapping]=plugin)),this.onProcessComplete()}});World_1$1.register("plugin",function(key,url,start,mapping,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new PluginFile(this,key[i]));else this.addFile(new PluginFile(this,key,url,start,mapping,xhrSettings));return this});var loader=PluginFile,CONST$B=GetTileAtWorldXY_1,File$4=Engine_1,Bodies_1=GetTilesWithinWorldXY_1,GetFastValue$t=GetFastValue_1,IsPlainObject$7=IsPlainObject_1,SceneFile=new Class_1({Extends:File$4,initialize:function(loader,key,url,xhrSettings){var config,extension="js";IsPlainObject$7(key)&&(key=GetFastValue$t(config=key,"key"),url=GetFastValue$t(config,"url"),xhrSettings=GetFastValue$t(config,"xhrSettings"),extension=GetFastValue$t(config,"extension",extension)),File$4.call(this,loader,{type:"text",extension:extension,responseType:"text",key:key,url:url,xhrSettings:xhrSettings})},onProcess:function(){this.state=CONST$B.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var code=this.data.concat("(function(){\nreturn new "+this.key+"();\n}).call(this);"),eval2=eval;this.loader.sceneManager.add(this.key,eval2(code)),this.complete=!0}});Bodies_1.register("sceneFile",function(key,url,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new SceneFile(this,key[i]));else this.addFile(new SceneFile(this,key,url,xhrSettings));return this});var plugins=SceneFile,CONST$A=GetTileAtWorldXY_1,File$3=Engine_1,FileTypesManager$1=GetTilesWithinWorldXY_1,GetFastValue$s=GetFastValue_1,IsPlainObject$6=IsPlainObject_1,ScenePluginFile=new Class_1({Extends:File$3,initialize:function(loader,key,url,systemKey,sceneKey,xhrSettings){var config,extension="js";IsPlainObject$6(key)&&(key=GetFastValue$s(config=key,"key"),url=GetFastValue$s(config,"url"),xhrSettings=GetFastValue$s(config,"xhrSettings"),extension=GetFastValue$s(config,"extension",extension),systemKey=GetFastValue$s(config,"systemKey"),sceneKey=GetFastValue$s(config,"sceneKey")),File$3.call(this,loader,{type:"scenePlugin",cache:!1,extension:extension,responseType:"text",key:key,url:url,xhrSettings:xhrSettings,config:{systemKey:systemKey,sceneKey:sceneKey}}),"function"==typeof url&&(this.data=url,this.state=CONST$A.FILE_POPULATED)},onProcess:function(){var pluginManager=this.loader.systems.plugins,config=this.config,sceneKey=this.key,systemKey=GetFastValue$s(config,"systemKey",sceneKey),sceneKey=GetFastValue$s(config,"sceneKey",sceneKey);this.state===CONST$A.FILE_POPULATED?pluginManager.installScenePlugin(systemKey,this.data,sceneKey,this.loader.scene,!0):(this.state=CONST$A.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),pluginManager.installScenePlugin(systemKey,window[this.key],sceneKey,this.loader.scene,!0)),this.onProcessComplete()}});FileTypesManager$1.register("scenePlugin",function(key,url,systemKey,sceneKey,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new ScenePluginFile(this,key[i]));else this.addFile(new ScenePluginFile(this,key,url,systemKey,sceneKey,xhrSettings));return this});var Events_1=ScenePluginFile,components$1=GetTilesWithinWorldXY_1,ImageFile$1=ImageFile_1,SpriteSheetFile=new Class_1({Extends:ImageFile$1,initialize:function(loader,key,url,frameConfig,xhrSettings){ImageFile$1.call(this,loader,key,url,xhrSettings,frameConfig),this.type="spritesheet"},addToCache:function(){var texture=this.cache.addSpriteSheet(this.key,this.data,this.config);this.pendingDestroy(texture)}});components$1.register("spritesheet",function(key,url,frameConfig,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new SpriteSheetFile(this,key[i]));else this.addFile(new SpriteSheetFile(this,key,url,frameConfig,xhrSettings));return this});var Body_1=SpriteSheetFile,CONST$z=GetTileAtWorldXY_1,File$2=Engine_1,CustomMain=GetTilesWithinWorldXY_1,GetFastValue$r=GetFastValue_1,IsPlainObject$5=IsPlainObject_1,SVGFile=new Class_1({Extends:File$2,initialize:function(loader,key,url,fileConfig,xhrSettings){var config,extension="svg";IsPlainObject$5(key)&&(key=GetFastValue$r(config=key,"key"),url=GetFastValue$r(config,"url"),fileConfig=GetFastValue$r(config,"svgConfig",{}),xhrSettings=GetFastValue$r(config,"xhrSettings"),extension=GetFastValue$r(config,"extension",extension));fileConfig={type:"svg",cache:loader.textureManager,extension:extension,responseType:"text",key:key,url:url,xhrSettings:xhrSettings,config:{width:GetFastValue$r(fileConfig,"width"),height:GetFastValue$r(fileConfig,"height"),scale:GetFastValue$r(fileConfig,"scale")}};File$2.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST$z.FILE_PROCESSING;var text=this.xhrLoader.responseText,svg=[text],width=this.config.width,height=this.config.height,scale=this.config.scale;resize:if(width&&height||scale){var svgXML=(new DOMParser).parseFromString(text,"text/xml").getElementsByTagName("svg")[0],viewBox=svgXML.hasAttribute("viewBox"),svgWidth=parseFloat(svgXML.getAttribute("width")),svgHeight=parseFloat(svgXML.getAttribute("height"));if(!viewBox&&svgWidth&&svgHeight?svgXML.setAttribute("viewBox","0  0 "+svgWidth+" "+svgHeight):!viewBox||svgWidth||svgHeight||(svgWidth=(viewBox=svgXML.getAttribute("viewBox").split(/\s+|,/))[2],svgHeight=viewBox[3]),scale){if(!svgWidth||!svgHeight)break resize;width=svgWidth*scale,height=svgHeight*scale}svgXML.setAttribute("width",width.toString()+"px"),svgXML.setAttribute("height",height.toString()+"px"),svg=[(new XMLSerializer).serializeToString(svgXML)]}try{var blob=new window.Blob(svg,{type:"image/svg+xml;charset=utf-8"})}catch(e){return void this.onProcessError()}this.data=new Image,this.data.crossOrigin=this.crossOrigin;var _this=this,retry=!1;this.data.onload=function(){retry||File$2.revokeObjectURL(_this.data),_this.onProcessComplete()},this.data.onerror=function(){retry?_this.onProcessError():(retry=!0,File$2.revokeObjectURL(_this.data),_this.data.src="data:image/svg+xml,"+encodeURIComponent(svg.join("")))},File$2.createObjectURL(this.data,blob,"image/svg+xml")},addToCache:function(){var texture=this.cache.addImage(this.key,this.data);this.pendingDestroy(texture)}});CustomMain.register("svg",function(key,url,svgConfig,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new SVGFile(this,key[i]));else this.addFile(new SVGFile(this,key,url,svgConfig,xhrSettings));return this});var GetTargets_1=SVGFile,tilemaps={CSV:0,TILED_JSON:1,ARRAY_2D:2,WELTMEISTER:3},CONST$y=GetTileAtWorldXY_1,File$1=Engine_1,World_1$1=GetTilesWithinWorldXY_1,GetFastValue$q=GetFastValue_1,IsPlainObject$4=IsPlainObject_1,TILEMAP_FORMATS$2=tilemaps,TilemapCSVFile=new Class_1({Extends:File$1,initialize:function(loader,key,url,fileConfig){var config,extension="csv";IsPlainObject$4(key)&&(key=GetFastValue$q(config=key,"key"),url=GetFastValue$q(config,"url"),fileConfig=GetFastValue$q(config,"xhrSettings"),extension=GetFastValue$q(config,"extension",extension));fileConfig={type:"tilemapCSV",cache:loader.cacheManager.tilemap,extension:extension,responseType:"text",key:key,url:url,xhrSettings:fileConfig};File$1.call(this,loader,fileConfig),this.tilemapFormat=TILEMAP_FORMATS$2.CSV},onProcess:function(){this.state=CONST$y.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var tiledata={format:this.tilemapFormat,data:this.data};this.cache.add(this.key,tiledata),this.pendingDestroy(tiledata)}});World_1$1.register("tilemapCSV",function(key,url,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new TilemapCSVFile(this,key[i]));else this.addFile(new TilemapCSVFile(this,key,url,xhrSettings));return this});var Bodies_1=TilemapCSVFile,FileTypesManager$1=GetTilesWithinWorldXY_1,JSONFile$1=JSONFile_1,TILEMAP_FORMATS$1=tilemaps,TilemapImpactFile=new Class_1({Extends:JSONFile$1,initialize:function(loader,key,url,xhrSettings){JSONFile$1.call(this,loader,key,url,xhrSettings),this.type="tilemapJSON",this.cache=loader.cacheManager.tilemap},addToCache:function(){var tiledata={format:TILEMAP_FORMATS$1.WELTMEISTER,data:this.data};this.cache.add(this.key,tiledata),this.pendingDestroy(tiledata)}});FileTypesManager$1.register("tilemapImpact",function(key,url,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new TilemapImpactFile(this,key[i]));else this.addFile(new TilemapImpactFile(this,key,url,xhrSettings));return this});var components$1=TilemapImpactFile,CustomMain=GetTilesWithinWorldXY_1,JSONFile=JSONFile_1,TILEMAP_FORMATS=tilemaps,TilemapJSONFile=new Class_1({Extends:JSONFile,initialize:function(loader,key,url,xhrSettings){JSONFile.call(this,loader,key,url,xhrSettings),this.type="tilemapJSON",this.cache=loader.cacheManager.tilemap},addToCache:function(){var tiledata={format:TILEMAP_FORMATS.TILED_JSON,data:this.data};this.cache.add(this.key,tiledata),this.pendingDestroy(tiledata)}});CustomMain.register("tilemapTiledJSON",function(key,url,xhrSettings){if(Array.isArray(key))for(var i=0;i<key.length;i++)this.addFile(new TilemapJSONFile(this,key[i]));else this.addFile(new TilemapJSONFile(this,key,url,xhrSettings));return this});var World_1$1=TilemapJSONFile,FileTypesManager$1=GetTilesWithinWorldXY_1,GetFastValue$p=GetFastValue_1,ImageFile=ImageFile_1,IsPlainObject$3=IsPlainObject_1,MultiFile=MatterGameObject_1,TextFile=IsInLayerBounds_1,UnityAtlasFile=new Class_1({Extends:MultiFile,initialize:function(loader,key,textureURL,atlasURL,textureXhrSettings,data){var image,config,data=IsPlainObject$3(key)?(key=GetFastValue$p(config=key,"key"),image=new ImageFile(loader,{key:key,url:GetFastValue$p(config,"textureURL"),extension:GetFastValue$p(config,"textureExtension","png"),normalMap:GetFastValue$p(config,"normalMap"),xhrSettings:GetFastValue$p(config,"textureXhrSettings")}),new TextFile(loader,{key:key,url:GetFastValue$p(config,"atlasURL"),extension:GetFastValue$p(config,"atlasExtension","txt"),xhrSettings:GetFastValue$p(config,"atlasXhrSettings")})):(image=new ImageFile(loader,key,textureURL,textureXhrSettings),new TextFile(loader,key,atlasURL,data));image.linkFile?MultiFile.call(this,loader,"unityatlas",key,[image,data,image.linkFile]):MultiFile.call(this,loader,"unityatlas",key,[image,data])},addToCache:function(){var image,text,normalMap;this.isReadyToProcess()&&(image=this.files[0],text=this.files[1],normalMap=this.files[2]?this.files[2].data:null,this.loader.textureManager.addUnityAtlas(image.key,image.data,text.data,normalMap),text.pendingDestroy(),this.complete=!0)}});FileTypesManager$1.register("unityAtlas",function(key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings){var multifile;if(Array.isArray(key))for(var i=0;i<key.length;i++)multifile=new UnityAtlasFile(this,key[i]),this.addFile(multifile.files);else multifile=new UnityAtlasFile(this,key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings),this.addFile(multifile.files);return this});var CustomMain=UnityAtlasFile,CONST$x=GetTileAtWorldXY_1,File=Engine_1,FileTypesManager$1=GetTilesWithinWorldXY_1,GetURL=Composite_1,GetFastValue$o=GetFastValue_1,IsPlainObject$2=IsPlainObject_1,VideoFile=new Class_1({Extends:File,initialize:function(loader,key,urlConfig,loadEvent,asBlob,fileConfig,xhrSettings){fileConfig={type:"video",cache:loader.cacheManager.video,extension:urlConfig.type,responseType:"blob",key:key,url:urlConfig.url,xhrSettings:xhrSettings,config:{loadEvent:loadEvent="loadeddata"!==(loadEvent=void 0===loadEvent?"loadeddata":loadEvent)&&"canplay"!==loadEvent&&"canplaythrough"!==loadEvent?"loadeddata":loadEvent,asBlob:asBlob=void 0===asBlob?!1:asBlob,noAudio:fileConfig=void 0===fileConfig?!1:fileConfig}};this.onLoadCallback=this.onVideoLoadHandler.bind(this),this.onErrorCallback=this.onVideoErrorHandler.bind(this),File.call(this,loader,fileConfig)},onProcess:function(){var video,_this;this.state=CONST$x.FILE_PROCESSING,this.config.asBlob?(video=this.createVideoElement(),this.data=video,(_this=this).data.onloadeddata=function(){_this.onProcessComplete()},this.data.onerror=function(){File.revokeObjectURL(_this.data),_this.onProcessError()},File.createObjectURL(video,this.xhrLoader.response,""),video.load()):this.onProcessComplete()},createVideoElement:function(){var video=document.createElement("video");return video.controls=!1,video.crossOrigin=this.loader.crossOrigin,this.config.noAudio&&(video.muted=!0,video.defaultMuted=!0,video.setAttribute("autoplay","autoplay")),video.setAttribute("playsinline","playsinline"),video.setAttribute("preload","auto"),video},onVideoLoadHandler:function(video){video=video.target;video.removeEventListener(this.config.loadEvent,this.onLoadCallback,!0),video.removeEventListener("error",this.onErrorCallback,!0),this.data=video,this.resetXHR(),this.loader.nextFile(this,!0)},onVideoErrorHandler:function(video){video=video.target;video&&(video.removeEventListener(this.config.loadEvent,this.onLoadCallback,!0),video.removeEventListener("error",this.onErrorCallback,!0)),this.resetXHR(),this.loader.nextFile(this,!1)},load:function(){var video,loadEvent=this.config.loadEvent;this.config.asBlob?File.prototype.load.call(this):(this.percentComplete=0,(video=this.createVideoElement()).addEventListener(loadEvent,this.onLoadCallback,!0),video.addEventListener("error",this.onErrorCallback,!0),video.src=GetURL(this,this.loader.baseURL),video.load())}});VideoFile.create=function(loader,key,urlConfig,loadEvent,asBlob,noAudio,xhrSettings){var game=loader.systems.game;IsPlainObject$2(key)&&(urlConfig=GetFastValue$o(key,"url",[]),loadEvent=GetFastValue$o(key,"loadEvent","loadeddata"),asBlob=GetFastValue$o(key,"asBlob",!1),noAudio=GetFastValue$o(key,"noAudio",!1),xhrSettings=GetFastValue$o(key,"xhrSettings"),key=GetFastValue$o(key,"key"));urlConfig=VideoFile.getVideoURL(game,urlConfig);if(urlConfig)return new VideoFile(loader,key,urlConfig,loadEvent,asBlob,noAudio,xhrSettings)},VideoFile.getVideoURL=function(game,urls){Array.isArray(urls)||(urls=[urls]);for(var i=0;i<urls.length;i++){var videoType,url=GetFastValue$o(urls[i],"url",urls[i]);if(0===url.indexOf("blob:"))return{url:url,type:""};if(videoType=0===url.indexOf("data:")?url.split(",")[0].match(/\/(.*?);/):url.match(/\.([a-zA-Z0-9]+)($|\?)/),videoType=GetFastValue$o(urls[i],"type",videoType?videoType[1]:"").toLowerCase(),game.device.video[videoType])return{url:url,type:videoType}}return null},FileTypesManager$1.register("video",function(key,urls,loadEvent,asBlob,noAudio,xhrSettings){var videoFile;if(Array.isArray(key))for(var i=0;i<key.length;i++)(videoFile=VideoFile.create(this,key[i]))&&this.addFile(videoFile);else(videoFile=VideoFile.create(this,key,urls,loadEvent,asBlob,noAudio,xhrSettings))&&this.addFile(videoFile);return this});var GetTilesWithin_1={AnimationJSONFile:AnimationJSONFile_1,AsepriteFile:AsepriteFile_1,AtlasJSONFile:AtlasJSONFile_1,AtlasXMLFile:AtlasXMLFile_1,AudioFile:AudioFile_1,AudioSpriteFile:{},BinaryFile:BinaryFile_1,BitmapFontFile:BitmapFontFile_1,CSSFile:CSSFile_1,GLSLFile:GLSLFile_1,HTML5AudioFile:HTML5AudioFile_1,HTMLFile:HTMLFile_1,HTMLTextureFile:HTMLTextureFile_1,ImageFile:ImageFile_1,JSONFile:JSONFile_1,MultiAtlasFile:GetTilesWithin_1,MultiScriptFile:Axes_1,OBJFile:Grid_1,PackFile:GetWorldToTileXFunction_1,PluginFile:loader,SceneFile:plugins,ScenePluginFile:Events_1,ScriptFile:SAT_1,SpriteSheetFile:Body_1,SVGFile:GetTargets_1,TextFile:IsInLayerBounds_1,TilemapCSVFile:Bodies_1,TilemapImpactFile:components$1,TilemapJSONFile:World_1$1,UnityAtlasFile:CustomMain,VideoFile:VideoFile,XMLFile:Pair_1},Axes_1=Class_1,CONST$w=GetTileAtWorldXY_1,CustomSet=HexagonalWorldToTileXY_1,EventEmitter$5=eventemitter3.exports,Events$c=Pairs_1,FileTypesManager=GetTilesWithinWorldXY_1,GetFastValue$n=GetFastValue_1,Grid_1=PluginCache,SceneEvents$5=events$g,XHRSettings=MatterImage_1,GetWorldToTileXFunction_1=new Axes_1({Extends:EventEmitter$5,initialize:function(scene){EventEmitter$5.call(this);var gameConfig=scene.sys.game.config,sceneConfig=scene.sys.settings.loader;this.scene=scene,this.systems=scene.sys,this.cacheManager=scene.sys.cache,this.textureManager=scene.sys.textures,this.sceneManager=scene.sys.game.scene,FileTypesManager.install(this),this.prefix="",this.path="",this.baseURL="",this.setBaseURL(GetFastValue$n(sceneConfig,"baseURL",gameConfig.loaderBaseURL)),this.setPath(GetFastValue$n(sceneConfig,"path",gameConfig.loaderPath)),this.setPrefix(GetFastValue$n(sceneConfig,"prefix",gameConfig.loaderPrefix)),this.maxParallelDownloads=GetFastValue$n(sceneConfig,"maxParallelDownloads",gameConfig.loaderMaxParallelDownloads),this.xhr=XHRSettings(GetFastValue$n(sceneConfig,"responseType",gameConfig.loaderResponseType),GetFastValue$n(sceneConfig,"async",gameConfig.loaderAsync),GetFastValue$n(sceneConfig,"user",gameConfig.loaderUser),GetFastValue$n(sceneConfig,"password",gameConfig.loaderPassword),GetFastValue$n(sceneConfig,"timeout",gameConfig.loaderTimeout),GetFastValue$n(sceneConfig,"withCredentials",gameConfig.loaderWithCredentials)),this.crossOrigin=GetFastValue$n(sceneConfig,"crossOrigin",gameConfig.loaderCrossOrigin),this.totalToLoad=0,this.progress=0,this.list=new CustomSet,this.inflight=new CustomSet,this.queue=new CustomSet,this._deleteQueue=new CustomSet,this.totalFailed=0,this.totalComplete=0,this.state=CONST$w.LOADER_IDLE,this.multiKeyIndex=0,scene.sys.events.once(SceneEvents$5.BOOT,this.boot,this),scene.sys.events.on(SceneEvents$5.START,this.pluginStart,this)},boot:function(){this.systems.events.once(SceneEvents$5.DESTROY,this.destroy,this)},pluginStart:function(){this.systems.events.once(SceneEvents$5.SHUTDOWN,this.shutdown,this)},setBaseURL:function(url){return""!==(url=void 0===url?"":url)&&"/"!==url.substr(-1)&&(url=url.concat("/")),this.baseURL=url,this},setPath:function(path){return""!==(path=void 0===path?"":path)&&"/"!==path.substr(-1)&&(path=path.concat("/")),this.path=path,this},setPrefix:function(prefix){return this.prefix=prefix=void 0===prefix?"":prefix,this},setCORS:function(crossOrigin){return this.crossOrigin=crossOrigin,this},addFile:function(file){Array.isArray(file)||(file=[file]);for(var i=0;i<file.length;i++){var item=file[i];this.keyExists(item)||(this.list.set(item),this.emit(Events$c.ADD,item.key,item.type,this,item),this.isLoading()&&(this.totalToLoad++,this.updateProgress()))}},keyExists:function(file){var keyConflict=file.hasCacheConflict();return keyConflict||this.list.iterate(function(item){if(item.type===file.type&&item.key===file.key)return!(keyConflict=!0)}),!keyConflict&&this.isLoading()&&(this.inflight.iterate(function(item){if(item.type===file.type&&item.key===file.key)return!(keyConflict=!0)}),this.queue.iterate(function(item){if(item.type===file.type&&item.key===file.key)return!(keyConflict=!0)})),keyConflict},addPack:function(pack,packKey){packKey&&pack.hasOwnProperty(packKey)&&(pack={packKey:pack[packKey]});var key,total=0,currentBaseURL=this.baseURL,currentPath=this.path,currentPrefix=this.prefix;for(key in pack)if(Object.prototype.hasOwnProperty.call(pack,key)){var config=pack[key],baseURL=GetFastValue$n(config,"baseURL",currentBaseURL),path=GetFastValue$n(config,"path",currentPath),prefix=GetFastValue$n(config,"prefix",currentPrefix),files=GetFastValue$n(config,"files",null),defaultType=GetFastValue$n(config,"defaultType","void");if(Array.isArray(files)){this.setBaseURL(baseURL),this.setPath(path),this.setPrefix(prefix);for(var i=0;i<files.length;i++){var file=files[i],type=file.hasOwnProperty("type")?file.type:defaultType;this[type]&&(this[type](file),total++)}}}return this.setBaseURL(currentBaseURL),this.setPath(currentPath),this.setPrefix(currentPrefix),0<total},isLoading:function(){return this.state===CONST$w.LOADER_LOADING||this.state===CONST$w.LOADER_PROCESSING},isReady:function(){return this.state===CONST$w.LOADER_IDLE||this.state===CONST$w.LOADER_COMPLETE},start:function(){this.isReady()&&(this.progress=0,this.totalFailed=0,this.totalComplete=0,this.totalToLoad=this.list.size,this.emit(Events$c.START,this),0===this.list.size?this.loadComplete():(this.state=CONST$w.LOADER_LOADING,this.inflight.clear(),this.queue.clear(),this.updateProgress(),this.checkLoadQueue(),this.systems.events.on(SceneEvents$5.UPDATE,this.update,this)))},updateProgress:function(){this.progress=1-(this.list.size+this.inflight.size)/this.totalToLoad,this.emit(Events$c.PROGRESS,this.progress)},update:function(){this.state===CONST$w.LOADER_LOADING&&0<this.list.size&&this.inflight.size<this.maxParallelDownloads&&this.checkLoadQueue()},checkLoadQueue:function(){this.list.each(function(file){if((file.state===CONST$w.FILE_POPULATED||file.state===CONST$w.FILE_PENDING&&this.inflight.size<this.maxParallelDownloads)&&(this.inflight.set(file),this.list.delete(file),file.crossOrigin||(file.crossOrigin=this.crossOrigin),file.load()),this.inflight.size===this.maxParallelDownloads)return!1},this)},nextFile:function(file,success){this.inflight&&(this.inflight.delete(file),this.updateProgress(),success?(this.totalComplete++,this.queue.set(file),this.emit(Events$c.FILE_LOAD,file),file.onProcess()):(this.totalFailed++,this._deleteQueue.set(file),this.emit(Events$c.FILE_LOAD_ERROR,file),this.fileProcessComplete(file)))},fileProcessComplete:function(file){this.scene&&this.systems&&this.systems.game&&!this.systems.game.pendingDestroy&&(file.state===CONST$w.FILE_ERRORED?file.multiFile&&file.multiFile.onFileFailed(file):file.state===CONST$w.FILE_COMPLETE&&(file.multiFile?file.multiFile.isReadyToProcess()&&file.multiFile.addToCache():file.addToCache()),this.queue.delete(file),0===this.list.size&&0===this.inflight.size&&0===this.queue.size&&this.loadComplete())},loadComplete:function(){this.emit(Events$c.POST_PROCESS,this),this.list.clear(),this.inflight.clear(),this.queue.clear(),this.progress=1,this.state=CONST$w.LOADER_COMPLETE,this.systems.events.off(SceneEvents$5.UPDATE,this.update,this),this._deleteQueue.iterateLocal("destroy"),this._deleteQueue.clear(),this.emit(Events$c.COMPLETE,this,this.totalComplete,this.totalFailed)},flagForRemoval:function(file){this._deleteQueue.set(file)},saveJSON:function(data,filename){return this.save(JSON.stringify(data),filename)},save:function(a,filename,url){void 0===filename&&(filename="file.json"),void 0===url&&(url="application/json");a=new Blob([a],{type:url}),url=URL.createObjectURL(a),a=document.createElement("a");return a.download=filename,a.textContent="Download "+filename,a.href=url,a.click(),this},reset:function(){this.list.clear(),this.inflight.clear(),this.queue.clear();var gameConfig=this.systems.game.config,sceneConfig=this.systems.settings.loader;this.setBaseURL(GetFastValue$n(sceneConfig,"baseURL",gameConfig.loaderBaseURL)),this.setPath(GetFastValue$n(sceneConfig,"path",gameConfig.loaderPath)),this.setPrefix(GetFastValue$n(sceneConfig,"prefix",gameConfig.loaderPrefix)),this.state=CONST$w.LOADER_IDLE},shutdown:function(){this.reset(),this.state=CONST$w.LOADER_SHUTDOWN,this.systems.events.off(SceneEvents$5.UPDATE,this.update,this),this.systems.events.off(SceneEvents$5.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.state=CONST$w.LOADER_DESTROYED,this.systems.events.off(SceneEvents$5.UPDATE,this.update,this),this.systems.events.off(SceneEvents$5.START,this.pluginStart,this),this.list=null,this.inflight=null,this.queue=null,this.scene=null,this.systems=null,this.textureManager=null,this.cacheManager=null,this.sceneManager=null}});Grid_1.register("Loader",GetWorldToTileXFunction_1,"load");var loader=Extend_1$1(!1,{Events:Pairs_1,FileTypes:GetTilesWithin_1,File:Engine_1,FileTypesManager:GetTilesWithinWorldXY_1,GetURL:Composite_1,LoaderPlugin:GetWorldToTileXFunction_1,MergeXHRSettings:Constraint_1,MultiFile:MatterGameObject_1,XHRLoader:Composites_1,XHRSettings:MatterImage_1},GetTileAtWorldXY_1),plugins={DYNAMIC_BODY:0,STATIC_BODY:1,GROUP:2,TILEMAPLAYER:3,FACING_NONE:10,FACING_UP:11,FACING_DOWN:12,FACING_LEFT:13,FACING_RIGHT:14},Events_1=function(world,x,y,width,height,bodies,includeStatic){void 0===bodies&&(bodies=!0),void 0===includeStatic&&(includeStatic=!1);var fakeBody,intersects,dynamicBodies=[],staticBodies=[],minMax=world.treeMinMax;return minMax.minX=x,minMax.minY=y,minMax.maxX=x+width,minMax.maxY=y+height,includeStatic&&(staticBodies=world.staticTree.search(minMax)),bodies&&world.useTree?dynamicBodies=world.tree.search(minMax):bodies&&(bodies=world.bodies,fakeBody={position:{x:x,y:y},left:x,top:y,right:x+width,bottom:y+height,isCircle:!1},intersects=world.intersects,bodies.iterate(function(target){intersects(target,fakeBody)&&dynamicBodies.push(target)})),staticBodies.concat(dynamicBodies)},OverlapRect$1=Events_1,Circle=Svg_1,CircleToCircle=Query_1,CircleToRectangle=physics,SAT_1=function(world,x,y,radius,includeDynamic,includeStatic){var bodiesInRect=OverlapRect$1(world,x-radius,y-radius,2*radius,2*radius,includeDynamic,includeStatic);if(0===bodiesInRect.length)return bodiesInRect;for(var area=new Circle(x,y,radius),circFromBody=new Circle,bodiesInArea=[],i=0;i<bodiesInRect.length;i++){var body=bodiesInRect[i];body.isCircle?(circFromBody.setTo(body.center.x,body.center.y,body.halfWidth),CircleToCircle(area,circFromBody)&&bodiesInArea.push(body)):CircleToRectangle(area,body)&&bodiesInArea.push(body)}return bodiesInArea},Body_1={Acceleration:{setAcceleration:function(x,y){return this.body.acceleration.set(x,y),this},setAccelerationX:function(value){return this.body.acceleration.x=value,this},setAccelerationY:function(value){return this.body.acceleration.y=value,this}},Angular:{setAngularVelocity:function(value){return this.body.angularVelocity=value,this},setAngularAcceleration:function(value){return this.body.angularAcceleration=value,this},setAngularDrag:function(value){return this.body.angularDrag=value,this}},Bounce:{setBounce:function(x,y){return this.body.bounce.set(x,y),this},setBounceX:function(value){return this.body.bounce.x=value,this},setBounceY:function(value){return this.body.bounce.y=value,this},setCollideWorldBounds:function(value,bounceX,bounceY){return this.body.setCollideWorldBounds(value,bounceX,bounceY),this}},Debug:{setDebug:function(showBody,showVelocity,bodyColor){return this.debugShowBody=showBody,this.debugShowVelocity=showVelocity,this.debugBodyColor=bodyColor,this},setDebugBodyColor:function(value){return this.body.debugBodyColor=value,this},debugShowBody:{get:function(){return this.body.debugShowBody},set:function(value){this.body.debugShowBody=value}},debugShowVelocity:{get:function(){return this.body.debugShowVelocity},set:function(value){this.body.debugShowVelocity=value}},debugBodyColor:{get:function(){return this.body.debugBodyColor},set:function(value){this.body.debugBodyColor=value}}},Drag:{setDrag:function(x,y){return this.body.drag.set(x,y),this},setDragX:function(value){return this.body.drag.x=value,this},setDragY:function(value){return this.body.drag.y=value,this},setDamping:function(value){return this.body.useDamping=value,this}},Enable:{enableBody:function(reset,x,y,enableGameObject,showGameObject){return reset&&this.body.reset(x,y),enableGameObject&&(this.body.gameObject.active=!0),showGameObject&&(this.body.gameObject.visible=!0),this.body.enable=!0,this},disableBody:function(disableGameObject,hideGameObject){return void 0===disableGameObject&&(disableGameObject=!1),void 0===hideGameObject&&(hideGameObject=!1),this.body.stop(),this.body.enable=!1,disableGameObject&&(this.body.gameObject.active=!1),hideGameObject&&(this.body.gameObject.visible=!1),this},refreshBody:function(){return this.body.updateFromGameObject(),this}},Friction:{setFriction:function(x,y){return this.body.friction.set(x,y),this},setFrictionX:function(x){return this.body.friction.x=x,this},setFrictionY:function(y){return this.body.friction.y=y,this}},Gravity:{setGravity:function(x,y){return this.body.gravity.set(x,y),this},setGravityX:function(x){return this.body.gravity.x=x,this},setGravityY:function(y){return this.body.gravity.y=y,this}},Immovable:{setImmovable:function(value){return this.body.immovable=value=void 0===value?!0:value,this}},Mass:{setMass:function(value){return this.body.mass=value,this}},OverlapCirc:SAT_1,OverlapRect:Events_1,Pushable:{setPushable:function(value){return this.body.pushable=value=void 0===value?!0:value,this}},Size:{setOffset:function(x,y){return this.body.setOffset(x,y),this},setSize:function(width,height,center){return this.body.setSize(width,height,center),this},setBodySize:function(width,height,center){return this.body.setSize(width,height,center),this},setCircle:function(radius,offsetX,offsetY){return this.body.setCircle(radius,offsetX,offsetY),this}},Velocity:{setVelocity:function(x,y){return this.body.setVelocity(x,y),this},setVelocityX:function(x){return this.body.setVelocityX(x),this},setVelocityY:function(y){return this.body.setVelocityY(y),this},setMaxVelocity:function(x,y){return this.body.maxVelocity.set(x,y),this}}},Image$2=Resolver_1,GetTargets_1=new Class_1({Extends:Image$2,Mixins:[Body_1.Acceleration,Body_1.Angular,Body_1.Bounce,Body_1.Debug,Body_1.Drag,Body_1.Enable,Body_1.Friction,Body_1.Gravity,Body_1.Immovable,Body_1.Mass,Body_1.Pushable,Body_1.Size,Body_1.Velocity],initialize:function(scene,x,y,texture,frame){Image$2.call(this,scene,x,y,texture,frame),this.body=null}}),Sprite$2=time,IsInLayerBounds_1=new Class_1({Extends:Sprite$2,Mixins:[Body_1.Acceleration,Body_1.Angular,Body_1.Bounce,Body_1.Debug,Body_1.Drag,Body_1.Enable,Body_1.Friction,Body_1.Gravity,Body_1.Immovable,Body_1.Mass,Body_1.Pushable,Body_1.Size,Body_1.Velocity],initialize:function(scene,x,y,texture,frame){Sprite$2.call(this,scene,x,y,texture,frame),this.body=null}}),ArcadeSprite$2=IsInLayerBounds_1,CONST$t=plugins,GetFastValue$m=GetFastValue_1,Group$1=events$1,IsPlainObject$1=IsPlainObject_1,Bodies_1=new Class_1({Extends:Group$1,initialize:function(world,scene,children,config){var _this;children||config?IsPlainObject$1(children)?(config=children,children=null,config.internalCreateCallback=this.createCallbackHandler,config.internalRemoveCallback=this.removeCallbackHandler):Array.isArray(children)&&IsPlainObject$1(children[0])?(config=children[0],_this=this,children.forEach(function(singleConfig){singleConfig.internalCreateCallback=_this.createCallbackHandler,singleConfig.internalRemoveCallback=_this.removeCallbackHandler}),children=null):config={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler}:config={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler},this.world=world,config.classType=GetFastValue$m(config,"classType",ArcadeSprite$2),this.physicsType=CONST$t.DYNAMIC_BODY,this.defaults={setCollideWorldBounds:GetFastValue$m(config,"collideWorldBounds",!1),setBoundsRectangle:GetFastValue$m(config,"customBoundsRectangle",null),setAccelerationX:GetFastValue$m(config,"accelerationX",0),setAccelerationY:GetFastValue$m(config,"accelerationY",0),setAllowDrag:GetFastValue$m(config,"allowDrag",!0),setAllowGravity:GetFastValue$m(config,"allowGravity",!0),setAllowRotation:GetFastValue$m(config,"allowRotation",!0),setBounceX:GetFastValue$m(config,"bounceX",0),setBounceY:GetFastValue$m(config,"bounceY",0),setDragX:GetFastValue$m(config,"dragX",0),setDragY:GetFastValue$m(config,"dragY",0),setEnable:GetFastValue$m(config,"enable",!0),setGravityX:GetFastValue$m(config,"gravityX",0),setGravityY:GetFastValue$m(config,"gravityY",0),setFrictionX:GetFastValue$m(config,"frictionX",0),setFrictionY:GetFastValue$m(config,"frictionY",0),setMaxVelocityX:GetFastValue$m(config,"maxVelocityX",1e4),setMaxVelocityY:GetFastValue$m(config,"maxVelocityY",1e4),setVelocityX:GetFastValue$m(config,"velocityX",0),setVelocityY:GetFastValue$m(config,"velocityY",0),setAngularVelocity:GetFastValue$m(config,"angularVelocity",0),setAngularAcceleration:GetFastValue$m(config,"angularAcceleration",0),setAngularDrag:GetFastValue$m(config,"angularDrag",0),setMass:GetFastValue$m(config,"mass",1),setImmovable:GetFastValue$m(config,"immovable",!1)},Group$1.call(this,scene,children,config),this.type="PhysicsGroup"},createCallbackHandler:function(child){child.body||this.world.enableBody(child,CONST$t.DYNAMIC_BODY);var key,body=child.body;for(key in this.defaults)body[key](this.defaults[key])},removeCallbackHandler:function(child){child.body&&this.world.disableBody(child)},setVelocity:function(x,y,step){void 0===step&&(step=0);for(var items=this.getChildren(),i=0;i<items.length;i++)items[i].body.velocity.set(x+i*step,y+i*step);return this},setVelocityX:function(value,step){void 0===step&&(step=0);for(var items=this.getChildren(),i=0;i<items.length;i++)items[i].body.velocity.x=value+i*step;return this},setVelocityY:function(value,step){void 0===step&&(step=0);for(var items=this.getChildren(),i=0;i<items.length;i++)items[i].body.velocity.y=value+i*step;return this}}),ArcadeSprite$1=IsInLayerBounds_1,CONST$s=plugins,GetFastValue$l=GetFastValue_1,Group=events$1,IsPlainObject=IsPlainObject_1,components$1=new Class_1({Extends:Group,initialize:function(world,scene,children,config){children||config?IsPlainObject(children)?(config=children,children=null,config.internalCreateCallback=this.createCallbackHandler,config.internalRemoveCallback=this.removeCallbackHandler,config.createMultipleCallback=this.createMultipleCallbackHandler,config.classType=GetFastValue$l(config,"classType",ArcadeSprite$1)):Array.isArray(children)&&IsPlainObject(children[0])?(config=children,children=null,config.forEach(function(singleConfig){singleConfig.internalCreateCallback=this.createCallbackHandler,singleConfig.internalRemoveCallback=this.removeCallbackHandler,singleConfig.createMultipleCallback=this.createMultipleCallbackHandler,singleConfig.classType=GetFastValue$l(singleConfig,"classType",ArcadeSprite$1)})):config={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler}:config={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler,createMultipleCallback:this.createMultipleCallbackHandler,classType:ArcadeSprite$1},this.world=world,this.physicsType=CONST$s.STATIC_BODY,Group.call(this,scene,children,config),this.type="StaticPhysicsGroup"},createCallbackHandler:function(child){child.body||this.world.enableBody(child,CONST$s.STATIC_BODY)},removeCallbackHandler:function(child){child.body&&this.world.disableBody(child)},createMultipleCallbackHandler:function(){this.refresh()},refresh:function(){for(var children=this.children.entries,i=0;i<children.length;i++)children[i].body.reset();return this}}),ArcadeImage=GetTargets_1,ArcadeSprite=IsInLayerBounds_1,CONST$r=plugins,PhysicsGroup=Bodies_1,StaticPhysicsGroup=components$1,World_1$1=new Class_1({initialize:function(world){this.world=world,this.scene=world.scene,this.sys=world.scene.sys},collider:function(object1,object2,collideCallback,processCallback,callbackContext){return this.world.addCollider(object1,object2,collideCallback,processCallback,callbackContext)},overlap:function(object1,object2,collideCallback,processCallback,callbackContext){return this.world.addOverlap(object1,object2,collideCallback,processCallback,callbackContext)},existing:function(gameObject,isStatic){return this.world.enableBody(gameObject,isStatic?CONST$r.STATIC_BODY:CONST$r.DYNAMIC_BODY),gameObject},staticImage:function(x,y,key,image){image=new ArcadeImage(this.scene,x,y,key,image);return this.sys.displayList.add(image),this.world.enableBody(image,CONST$r.STATIC_BODY),image},image:function(x,y,key,image){image=new ArcadeImage(this.scene,x,y,key,image);return this.sys.displayList.add(image),this.world.enableBody(image,CONST$r.DYNAMIC_BODY),image},staticSprite:function(x,y,key,sprite){sprite=new ArcadeSprite(this.scene,x,y,key,sprite);return this.sys.displayList.add(sprite),this.sys.updateList.add(sprite),this.world.enableBody(sprite,CONST$r.STATIC_BODY),sprite},sprite:function(x,y,key,sprite){sprite=new ArcadeSprite(this.scene,x,y,key,sprite);return this.sys.displayList.add(sprite),this.sys.updateList.add(sprite),this.world.enableBody(sprite,CONST$r.DYNAMIC_BODY),sprite},staticGroup:function(children,config){return this.sys.updateList.add(new StaticPhysicsGroup(this.world,this.world.scene,children,config))},group:function(children,config){return this.sys.updateList.add(new PhysicsGroup(this.world,this.world.scene,children,config))},destroy:function(){this.world=null,this.scene=null,this.sys=null}}),CustomMain={COLLIDE:"collide",OVERLAP:"overlap",PAUSE:"pause",RESUME:"resume",TILE_COLLIDE:"tilecollide",TILE_OVERLAP:"tileoverlap",WORLD_BOUNDS:"worldbounds",WORLD_STEP:"worldstep"},CONST$q=plugins,Events$b=CustomMain,RadToDeg=Common_1,Rectangle$3=HasTileAtWorldXY_1,RectangleContains$1=arcade,Vector2$o=BuildTilesetIndex_1,Pair_1=new Class_1({initialize:function(world,gameObject){var width=gameObject.displayWidth||64,height=gameObject.displayHeight||64;this.world=world,this.gameObject=gameObject,this.transform={x:gameObject.x,y:gameObject.y,rotation:gameObject.angle,scaleX:gameObject.scaleX,scaleY:gameObject.scaleY,displayOriginX:gameObject.displayOriginX,displayOriginY:gameObject.displayOriginY},this.debugShowBody=world.defaults.debugShowBody,this.debugShowVelocity=world.defaults.debugShowVelocity,this.debugBodyColor=world.defaults.bodyDebugColor,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new Vector2$o,this.position=new Vector2$o(gameObject.x-gameObject.scaleX*gameObject.displayOriginX,gameObject.y-gameObject.scaleY*gameObject.displayOriginY),this.prev=this.position.clone(),this.prevFrame=this.position.clone(),this.allowRotation=!0,this.rotation=gameObject.angle,this.preRotation=gameObject.angle,this.width=width,this.height=height,this.sourceWidth=width,this.sourceHeight=height,gameObject.frame&&(this.sourceWidth=gameObject.frame.realWidth,this.sourceHeight=gameObject.frame.realHeight),this.halfWidth=Math.abs(width/2),this.halfHeight=Math.abs(height/2),this.center=new Vector2$o(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.velocity=new Vector2$o,this.newVelocity=new Vector2$o,this.deltaMax=new Vector2$o,this.acceleration=new Vector2$o,this.allowDrag=!0,this.drag=new Vector2$o,this.allowGravity=!0,this.gravity=new Vector2$o,this.bounce=new Vector2$o,this.worldBounce=null,this.customBoundsRectangle=world.bounds,this.onWorldBounds=!1,this.onCollide=!1,this.onOverlap=!1,this.maxVelocity=new Vector2$o(1e4,1e4),this.maxSpeed=-1,this.friction=new Vector2$o(1,0),this.useDamping=!1,this.angularVelocity=0,this.angularAcceleration=0,this.angularDrag=0,this.maxAngular=1e3,this.mass=1,this.angle=0,this.speed=0,this.facing=CONST$q.FACING_NONE,this.immovable=!1,this.pushable=!0,this.moves=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision={none:!1,up:!0,down:!0,left:!0,right:!0},this.touching={none:!0,up:!1,down:!1,left:!1,right:!1},this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1},this.blocked={none:!0,up:!1,down:!1,left:!1,right:!1},this.syncBounds=!1,this.physicsType=CONST$q.DYNAMIC_BODY,this._sx=gameObject.scaleX,this._sy=gameObject.scaleY,this._dx=0,this._dy=0,this._tx=0,this._ty=0,this._bounds=new Rectangle$3},updateBounds:function(){var sprite=this.gameObject,asy=this.transform;sprite.parentContainer?(recalc=sprite.getWorldTransformMatrix(this.world._tempMatrix,this.world._tempMatrix2),asy.x=recalc.tx,asy.y=recalc.ty,asy.rotation=RadToDeg(recalc.rotation),asy.scaleX=recalc.scaleX,asy.scaleY=recalc.scaleY):(asy.x=sprite.x,asy.y=sprite.y,asy.rotation=sprite.angle,asy.scaleX=sprite.scaleX,asy.scaleY=sprite.scaleY),asy.displayOriginX=sprite.displayOriginX,asy.displayOriginY=sprite.displayOriginY;var asx,recalc=!1;this.syncBounds?(asx=sprite.getBounds(this._bounds),this.width=asx.width,this.height=asx.height,recalc=!0):(asx=Math.abs(asy.scaleX),asy=Math.abs(asy.scaleY),this._sx===asx&&this._sy===asy||(this.width=this.sourceWidth*asx,this.height=this.sourceHeight*asy,this._sx=asx,this._sy=asy,recalc=!0)),recalc&&(this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.updateCenter())},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},updateFromGameObject:function(){this.updateBounds();var transform=this.transform;this.position.x=transform.x+transform.scaleX*(this.offset.x-transform.displayOriginX),this.position.y=transform.y+transform.scaleY*(this.offset.y-transform.displayOriginY),this.updateCenter()},resetFlags:function(clear){var wasTouching=this.wasTouching,touching=this.touching,blocked=this.blocked;(clear=void 0===clear?!1:clear)?(wasTouching.none=!0,wasTouching.up=!1,wasTouching.down=!1,wasTouching.left=!1,wasTouching.right=!1):(wasTouching.none=touching.none,wasTouching.up=touching.up,wasTouching.down=touching.down,wasTouching.left=touching.left,wasTouching.right=touching.right),touching.none=!0,touching.up=!1,touching.down=!1,touching.left=!1,touching.right=!1,blocked.none=!0,blocked.up=!1,blocked.down=!1,blocked.left=!1,blocked.right=!1,this.overlapR=0,this.overlapX=0,this.overlapY=0,this.embedded=!1},preUpdate:function(willStep,delta){willStep&&this.resetFlags(),this.updateFromGameObject(),this.rotation=this.transform.rotation,this.preRotation=this.rotation,this.moves&&(this.prev.x=this.position.x,this.prev.y=this.position.y,this.prevFrame.x=this.position.x,this.prevFrame.y=this.position.y),willStep&&this.update(delta)},update:function(delta){var vx,vy;this.prev.x=this.position.x,this.prev.y=this.position.y,this.moves&&(this.world.updateMotion(this,delta),vx=this.velocity.x,vy=this.velocity.y,this.newVelocity.set(vx*delta,vy*delta),this.position.add(this.newVelocity),this.updateCenter(),this.angle=Math.atan2(vy,vx),this.speed=Math.sqrt(vx*vx+vy*vy),this.collideWorldBounds&&this.checkWorldBounds()&&this.onWorldBounds&&this.world.emit(Events$b.WORLD_BOUNDS,this,this.blocked.up,this.blocked.down,this.blocked.left,this.blocked.right)),this._dx=this.position.x-this.prev.x,this._dy=this.position.y-this.prev.y},postUpdate:function(){var my,dx=this.position.x-this.prevFrame.x,dy=this.position.y-this.prevFrame.y;this.moves&&(0!==(my=this.deltaMax.x)&&0!==dx&&(dx<0&&dx<-my?dx=-my:0<dx&&my<dx&&(dx=my)),0!==(my=this.deltaMax.y)&&0!==dy&&(dy<0&&dy<-my?dy=-my:0<dy&&my<dy&&(dy=my)),this.gameObject.x+=dx,this.gameObject.y+=dy),dx<0?this.facing=CONST$q.FACING_LEFT:0<dx&&(this.facing=CONST$q.FACING_RIGHT),dy<0?this.facing=CONST$q.FACING_UP:0<dy&&(this.facing=CONST$q.FACING_DOWN),this.allowRotation&&(this.gameObject.angle+=this.deltaZ()),this._tx=dx,this._ty=dy},setBoundsRectangle:function(bounds){return this.customBoundsRectangle=bounds||this.world.bounds,this},checkWorldBounds:function(){var pos=this.position,bounds=this.customBoundsRectangle,check=this.world.checkCollision,bx=this.worldBounce?-this.worldBounce.x:-this.bounce.x,by=this.worldBounce?-this.worldBounce.y:-this.bounce.y,wasSet=!1;return pos.x<bounds.x&&check.left?(pos.x=bounds.x,this.velocity.x*=bx,wasSet=this.blocked.left=!0):this.right>bounds.right&&check.right&&(pos.x=bounds.right-this.width,this.velocity.x*=bx,wasSet=this.blocked.right=!0),pos.y<bounds.y&&check.up?(pos.y=bounds.y,this.velocity.y*=by,wasSet=this.blocked.up=!0):this.bottom>bounds.bottom&&check.down&&(pos.y=bounds.bottom-this.height,this.velocity.y*=by,wasSet=this.blocked.down=!0),wasSet&&(this.blocked.none=!1,this.updateCenter()),wasSet},setOffset:function(x,y){return this.offset.set(x,y=void 0===y?x:y),this},setSize:function(ox,oy,center){void 0===center&&(center=!0);var gameObject=this.gameObject;return!ox&&gameObject.frame&&(ox=gameObject.frame.realWidth),!oy&&gameObject.frame&&(oy=gameObject.frame.realHeight),this.sourceWidth=ox,this.sourceHeight=oy,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.updateCenter(),center&&gameObject.getCenter&&(ox=(gameObject.width-ox)/2,oy=(gameObject.height-oy)/2,this.offset.set(ox,oy)),this.isCircle=!1,this.radius=0,this},setCircle:function(radius,offsetX,offsetY){return void 0===offsetX&&(offsetX=this.offset.x),void 0===offsetY&&(offsetY=this.offset.y),0<radius?(this.isCircle=!0,this.radius=radius,this.sourceWidth=2*radius,this.sourceHeight=2*radius,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.set(offsetX,offsetY),this.updateCenter()):this.isCircle=!1,this},reset:function(x,y){this.stop();var gameObject=this.gameObject;gameObject.setPosition(x,y),gameObject.getTopLeft?gameObject.getTopLeft(this.position):this.position.set(x,y),this.prev.copy(this.position),this.prevFrame.copy(this.position),this.rotation=gameObject.angle,this.preRotation=gameObject.angle,this.updateBounds(),this.updateCenter(),this.resetFlags(!0)},stop:function(){return this.velocity.set(0),this.acceleration.set(0),this.speed=0,this.angularVelocity=0,this.angularAcceleration=0,this},getBounds:function(obj){return obj.x=this.x,obj.y=this.y,obj.right=this.right,obj.bottom=this.bottom,obj},hitTest:function(x,y){return this.isCircle?0<this.radius&&x>=this.left&&x<=this.right&&y>=this.top&&y<=this.bottom&&(this.center.x-x)*(this.center.x-x)+(this.center.y-y)*(this.center.y-y)<=this.radius*this.radius:RectangleContains$1(this,x,y)},onFloor:function(){return this.blocked.down},onCeiling:function(){return this.blocked.up},onWall:function(){return this.blocked.left||this.blocked.right},deltaAbsX:function(){return 0<this._dx?this._dx:-this._dx},deltaAbsY:function(){return 0<this._dy?this._dy:-this._dy},deltaX:function(){return this._dx},deltaY:function(){return this._dy},deltaXFinal:function(){return this._tx},deltaYFinal:function(){return this._ty},deltaZ:function(){return this.rotation-this.preRotation},destroy:function(){this.enable=!1,this.world&&this.world.pendingDestroy.set(this)},drawDebug:function(graphic){var pos=this.position,x=pos.x+this.halfWidth,y=pos.y+this.halfHeight;this.debugShowBody&&(graphic.lineStyle(graphic.defaultStrokeWidth,this.debugBodyColor),this.isCircle?graphic.strokeCircle(x,y,this.width/2):(this.checkCollision.up&&graphic.lineBetween(pos.x,pos.y,pos.x+this.width,pos.y),this.checkCollision.right&&graphic.lineBetween(pos.x+this.width,pos.y,pos.x+this.width,pos.y+this.height),this.checkCollision.down&&graphic.lineBetween(pos.x,pos.y+this.height,pos.x+this.width,pos.y+this.height),this.checkCollision.left&&graphic.lineBetween(pos.x,pos.y,pos.x,pos.y+this.height))),this.debugShowVelocity&&(graphic.lineStyle(graphic.defaultStrokeWidth,this.world.defaults.velocityDebugColor,1),graphic.lineBetween(x,y,x+this.velocity.x/2,y+this.velocity.y/2))},willDrawDebug:function(){return this.debugShowBody||this.debugShowVelocity},setCollideWorldBounds:function(setBounceY,bounceX,bounceY,onWorldBounds){this.collideWorldBounds=setBounceY=void 0===setBounceY?!0:setBounceY;var setBounceX=void 0!==bounceX,setBounceY=void 0!==bounceY;return(setBounceX||setBounceY)&&(this.worldBounce||(this.worldBounce=new Vector2$o),setBounceX&&(this.worldBounce.x=bounceX),setBounceY&&(this.worldBounce.y=bounceY)),void 0!==onWorldBounds&&(this.onWorldBounds=onWorldBounds),this},setVelocity:function(x,y){return this.velocity.set(x,y),x=this.velocity.x,y=this.velocity.y,this.speed=Math.sqrt(x*x+y*y),this},setVelocityX:function(value){this.velocity.x=value;var y=this.velocity.y;return this.speed=Math.sqrt(value*value+y*y),this},setVelocityY:function(value){this.velocity.y=value;var x=this.velocity.x;return this.speed=Math.sqrt(x*x+value*value),this},setMaxVelocity:function(x,y){return this.maxVelocity.set(x,y),this},setMaxVelocityX:function(value){return this.maxVelocity.x=value,this},setMaxVelocityY:function(value){return this.maxVelocity.y=value,this},setMaxSpeed:function(value){return this.maxSpeed=value,this},setBounce:function(x,y){return this.bounce.set(x,y),this},setBounceX:function(value){return this.bounce.x=value,this},setBounceY:function(value){return this.bounce.y=value,this},setAcceleration:function(x,y){return this.acceleration.set(x,y),this},setAccelerationX:function(value){return this.acceleration.x=value,this},setAccelerationY:function(value){return this.acceleration.y=value,this},setAllowDrag:function(value){return this.allowDrag=value=void 0===value?!0:value,this},setAllowGravity:function(value){return this.allowGravity=value=void 0===value?!0:value,this},setAllowRotation:function(value){return this.allowRotation=value=void 0===value?!0:value,this},setDrag:function(x,y){return this.drag.set(x,y),this},setDamping:function(value){return this.useDamping=value,this},setDragX:function(value){return this.drag.x=value,this},setDragY:function(value){return this.drag.y=value,this},setGravity:function(x,y){return this.gravity.set(x,y),this},setGravityX:function(value){return this.gravity.x=value,this},setGravityY:function(value){return this.gravity.y=value,this},setFriction:function(x,y){return this.friction.set(x,y),this},setFrictionX:function(value){return this.friction.x=value,this},setFrictionY:function(value){return this.friction.y=value,this},setAngularVelocity:function(value){return this.angularVelocity=value,this},setAngularAcceleration:function(value){return this.angularAcceleration=value,this},setAngularDrag:function(value){return this.angularDrag=value,this},setMass:function(value){return this.mass=value,this},setImmovable:function(value){return this.immovable=value=void 0===value?!0:value,this},setEnable:function(value){return this.enable=value=void 0===value?!0:value,this},processX:function(x,blocked,left,right){this.x+=x,this.updateCenter(),null!==blocked&&(this.velocity.x=blocked);blocked=this.blocked;left&&(blocked.left=!0),right&&(blocked.right=!0)},processY:function(y,blocked,up,down){this.y+=y,this.updateCenter(),null!==blocked&&(this.velocity.y=blocked);blocked=this.blocked;up&&(blocked.up=!0),down&&(blocked.down=!0)},x:{get:function(){return this.position.x},set:function(value){this.position.x=value}},y:{get:function(){return this.position.y},set:function(value){this.position.y=value}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}}),Axes_1=new Class_1({initialize:function(world,overlapOnly,object1,object2,collideCallback,processCallback,callbackContext){this.world=world,this.name="",this.active=!0,this.overlapOnly=overlapOnly,this.object1=object1,this.object2=object2,this.collideCallback=collideCallback,this.processCallback=processCallback,this.callbackContext=callbackContext},setName:function(name){return this.name=name,this},update:function(){this.world.collideObjects(this.object1,this.object2,this.collideCallback,this.processCallback,this.callbackContext,this.overlapOnly)},destroy:function(){this.world.removeCollider(this),this.active=!1,this.world=null,this.object1=null,this.object2=null,this.collideCallback=null,this.processCallback=null,this.callbackContext=null}}),CONST$p=plugins,Grid_1=function(body1,body2,overlapOnly,maxOverlap){var overlap=0,maxOverlap=body1.deltaAbsX()+body2.deltaAbsX()+maxOverlap;return 0===body1._dx&&0===body2._dx?(body1.embedded=!0,body2.embedded=!0):body1._dx>body2._dx?maxOverlap<(overlap=body1.right-body2.x)&&!overlapOnly||!1===body1.checkCollision.right||!1===body2.checkCollision.left?overlap=0:(body1.touching.none=!1,body1.touching.right=!0,body2.touching.none=!1,body2.touching.left=!0,body2.physicsType!==CONST$p.STATIC_BODY||overlapOnly||(body1.blocked.none=!1,body1.blocked.right=!0),body1.physicsType!==CONST$p.STATIC_BODY||overlapOnly||(body2.blocked.none=!1,body2.blocked.left=!0)):body1._dx<body2._dx&&(maxOverlap<-(overlap=body1.x-body2.width-body2.x)&&!overlapOnly||!1===body1.checkCollision.left||!1===body2.checkCollision.right?overlap=0:(body1.touching.none=!1,body1.touching.left=!0,body2.touching.none=!1,body2.touching.right=!0,body2.physicsType!==CONST$p.STATIC_BODY||overlapOnly||(body1.blocked.none=!1,body1.blocked.left=!0),body1.physicsType!==CONST$p.STATIC_BODY||overlapOnly||(body2.blocked.none=!1,body2.blocked.right=!0))),body1.overlapX=overlap,body2.overlapX=overlap},CONST$o=plugins,Pairs_1=function(body1,body2,overlapOnly,maxOverlap){var overlap=0,maxOverlap=body1.deltaAbsY()+body2.deltaAbsY()+maxOverlap;return 0===body1._dy&&0===body2._dy?(body1.embedded=!0,body2.embedded=!0):body1._dy>body2._dy?maxOverlap<(overlap=body1.bottom-body2.y)&&!overlapOnly||!1===body1.checkCollision.down||!1===body2.checkCollision.up?overlap=0:(body1.touching.none=!1,body1.touching.down=!0,body2.touching.none=!1,body2.touching.up=!0,body2.physicsType!==CONST$o.STATIC_BODY||overlapOnly||(body1.blocked.none=!1,body1.blocked.down=!0),body1.physicsType!==CONST$o.STATIC_BODY||overlapOnly||(body2.blocked.none=!1,body2.blocked.up=!0)):body1._dy<body2._dy&&(maxOverlap<-(overlap=body1.y-body2.bottom)&&!overlapOnly||!1===body1.checkCollision.up||!1===body2.checkCollision.down?overlap=0:(body1.touching.none=!1,body1.touching.up=!0,body2.touching.none=!1,body2.touching.down=!0,body2.physicsType!==CONST$o.STATIC_BODY||overlapOnly||(body1.blocked.none=!1,body1.blocked.up=!0),body1.physicsType!==CONST$o.STATIC_BODY||overlapOnly||(body2.blocked.none=!1,body2.blocked.down=!0))),body1.overlapY=overlap,body2.overlapY=overlap},GetFastValue$k=GetFastValue_1,GetTilesWithin_1=function(tileX,tileY,width,height,filteringOptions,layer){void 0===tileX&&(tileX=0),void 0===tileY&&(tileY=0),void 0===width&&(width=layer.width),void 0===height&&(height=layer.height);var isNotEmpty=GetFastValue$k(filteringOptions=filteringOptions||{},"isNotEmpty",!1),isColliding=GetFastValue$k(filteringOptions,"isColliding",!1),hasInterestingFace=GetFastValue$k(filteringOptions,"hasInterestingFace",!1);tileX<0&&(width+=tileX,tileX=0),tileY<0&&(height+=tileY,tileY=0),tileX+width>layer.width&&(width=Math.max(layer.width-tileX,0)),tileY+height>layer.height&&(height=Math.max(layer.height-tileY,0));for(var results=[],ty=tileY;ty<tileY+height;ty++)for(var tx=tileX;tx<tileX+width;tx++){var tile=layer.data[ty][tx];null!==tile&&(isNotEmpty&&-1===tile.index||isColliding&&!tile.collides||hasInterestingFace&&!tile.hasInterestingFace||results.push(tile))}return results},GetTilesWithin$f=GetTilesWithin_1,Engine_1=BuildTilesetIndex_1,pointStart$1=new Engine_1,pointEnd$1=new Engine_1,GetTilesWithinWorldXY_1=function(worldX,worldY,width,xEnd,filteringOptions,yEnd,layer){var worldToTileXY=layer.tilemapLayer.tilemap._convert.WorldToTileXY;worldToTileXY(worldX,worldY,!0,pointStart$1,yEnd,layer);var xStart=pointStart$1.x,yStart=pointStart$1.y;worldToTileXY(worldX+width,worldY+xEnd,!1,pointEnd$1,yEnd,layer);xEnd=Math.ceil(pointEnd$1.x),yEnd=Math.ceil(pointEnd$1.y);return GetTilesWithin$f(xStart,yStart,xEnd-xStart,yEnd-yStart,filteringOptions,layer)},Composite_1=function(tile,sprite){return tile.collisionCallback?!tile.collisionCallback.call(tile.collisionCallbackContext,sprite,tile):!tile.layer.callbacks[tile.index]||!tile.layer.callbacks[tile.index].callback.call(tile.layer.callbacks[tile.index].callbackContext,sprite,tile)},quickselect=MatterWrap_1;function rbush(maxEntries){if(!(this instanceof rbush))return new rbush(maxEntries);this._maxEntries=Math.max(4,maxEntries||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}function calcBBox(node,toBBox){distBBox(node,0,node.children.length,toBBox,node)}function distBBox(node,k,p,toBBox,destNode){(destNode=destNode||createNode(null)).minX=1/0,destNode.minY=1/0,destNode.maxX=-1/0,destNode.maxY=-1/0;for(var child,i=k;i<p;i++)child=node.children[i],extend(destNode,node.leaf?toBBox(child):child);return destNode}function extend(a,b){return a.minX=Math.min(a.minX,b.minX),a.minY=Math.min(a.minY,b.minY),a.maxX=Math.max(a.maxX,b.maxX),a.maxY=Math.max(a.maxY,b.maxY),a}function compareNodeMinX(a,b){return a.minX-b.minX}function compareNodeMinY(a,b){return a.minY-b.minY}function bboxArea(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function bboxMargin(a){return a.maxX-a.minX+(a.maxY-a.minY)}function contains(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function intersects(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function createNode(children){return{children:children,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function multiSelect(arr,left,right,n,compare){for(var mid,stack=[left,right];stack.length;)(right=stack.pop())-(left=stack.pop())<=n||(mid=left+Math.ceil((right-left)/n/2)*n,quickselect(arr,mid,left,right,compare),stack.push(left,mid,mid,right))}rbush.prototype={all:function(){return this._all(this.data,[])},search:function(bbox){var node=this.data,result=[],toBBox=this.toBBox;if(!intersects(bbox,node))return result;for(var i,len,child,childBBox,nodesToSearch=[];node;){for(i=0,len=node.children.length;i<len;i++)child=node.children[i],intersects(bbox,childBBox=node.leaf?toBBox(child):child)&&(node.leaf?result.push(child):contains(bbox,childBBox)?this._all(child,result):nodesToSearch.push(child));node=nodesToSearch.pop()}return result},collides:function(bbox){var node=this.data,toBBox=this.toBBox;if(!intersects(bbox,node))return!1;for(var i,len,child,childBBox,nodesToSearch=[];node;){for(i=0,len=node.children.length;i<len;i++)if(child=node.children[i],intersects(bbox,childBBox=node.leaf?toBBox(child):child)){if(node.leaf||contains(bbox,childBBox))return!0;nodesToSearch.push(child)}node=nodesToSearch.pop()}return!1},load:function(data){if(!data||!data.length)return this;if(data.length<this._minEntries){for(var i=0,len=data.length;i<len;i++)this.insert(data[i]);return this}var tmpNode,node=this._build(data.slice(),0,data.length-1,0);return this.data.children.length?this.data.height===node.height?this._splitRoot(this.data,node):(this.data.height<node.height&&(tmpNode=this.data,this.data=node,node=tmpNode),this._insert(node,this.data.height-node.height-1,!0)):this.data=node,this},insert:function(item){return item&&this._insert(item,this.data.height-1),this},clear:function(){return this.data=createNode([]),this},remove:function(item,equalsFn){if(!item)return this;for(var i,parent,index,goingUp,node=this.data,bbox=this.toBBox(item),path=[],indexes=[];node||path.length;){if(node||(node=path.pop(),parent=path[path.length-1],i=indexes.pop(),goingUp=!0),node.leaf&&-1!==(index=function(item,items,equalsFn){if(!equalsFn)return items.indexOf(item);for(var i=0;i<items.length;i++)if(equalsFn(item,items[i]))return i;return-1}(item,node.children,equalsFn)))return node.children.splice(index,1),path.push(node),this._condense(path),this;goingUp||node.leaf||!contains(node,bbox)?parent?(i++,node=parent.children[i],goingUp=!1):node=null:(path.push(node),indexes.push(i),node=(parent=node).children[i=0])}return this},toBBox:function(item){return item},toBBox:function(a){return{minX:a.left,minY:a.top,maxX:a.right,maxY:a.bottom}},compareMinX:compareNodeMinX,compareMinX:function(a,b){return a.left-b.left},compareMinY:compareNodeMinY,compareMinY:function(a,b){return a.top-b.top},toJSON:function(){return this.data},fromJSON:function(data){return this.data=data,this},_all:function(node,result){for(var nodesToSearch=[];node;)node.leaf?result.push.apply(result,node.children):nodesToSearch.push.apply(nodesToSearch,node.children),node=nodesToSearch.pop();return result},_build:function(items,left,right,height){var node,N=right-left+1,M=this._maxEntries;if(N<=M)return calcBBox(node=createNode(items.slice(left,right+1)),this.toBBox),node;height||(height=Math.ceil(Math.log(N)/Math.log(M)),M=Math.ceil(N/Math.pow(M,height-1))),(node=createNode([])).leaf=!1,node.height=height;var i,j,right2,right3,N2=Math.ceil(N/M),N1=N2*Math.ceil(Math.sqrt(M));for(multiSelect(items,left,right,N1,this.compareMinX),i=left;i<=right;i+=N1)for(multiSelect(items,i,right2=Math.min(i+N1-1,right),N2,this.compareMinY),j=i;j<=right2;j+=N2)right3=Math.min(j+N2-1,right2),node.children.push(this._build(items,j,right3,height-1));return calcBBox(node,this.toBBox),node},_chooseSubtree:function(bbox,node,level,path){for(var i,len,child,targetNode,area,minArea,minEnlargement,enlargement,b;path.push(node),!node.leaf&&path.length-1!==level;){for(minArea=minEnlargement=1/0,i=0,len=node.children.length;i<len;i++)area=bboxArea(child=node.children[i]),enlargement=bbox,b=child,(enlargement=(Math.max(b.maxX,enlargement.maxX)-Math.min(b.minX,enlargement.minX))*(Math.max(b.maxY,enlargement.maxY)-Math.min(b.minY,enlargement.minY))-area)<minEnlargement?(minEnlargement=enlargement,minArea=area<minArea?area:minArea,targetNode=child):enlargement===minEnlargement&&area<minArea&&(minArea=area,targetNode=child);node=targetNode||node.children[0]}return node},_insert:function(item,level,bbox){var node=this.toBBox,bbox=bbox?item:node(item),insertPath=[],node=this._chooseSubtree(bbox,this.data,level,insertPath);for(node.children.push(item),extend(node,bbox);0<=level&&insertPath[level].children.length>this._maxEntries;)this._split(insertPath,level),level--;this._adjustParentBBoxes(bbox,insertPath,level)},_split:function(insertPath,level){var node=insertPath[level],newNode=node.children.length,m=this._minEntries;this._chooseSplitAxis(node,m,newNode);newNode=this._chooseSplitIndex(node,m,newNode),newNode=createNode(node.children.splice(newNode,node.children.length-newNode));newNode.height=node.height,newNode.leaf=node.leaf,calcBBox(node,this.toBBox),calcBBox(newNode,this.toBBox),level?insertPath[level-1].children.push(newNode):this._splitRoot(node,newNode)},_splitRoot:function(node,newNode){this.data=createNode([node,newNode]),this.data.height=node.height+1,this.data.leaf=!1,calcBBox(this.data,this.toBBox)},_chooseSplitIndex:function(node,m,M){for(var bbox1,area,minArea,index,a,maxY,minX,overlap,maxX,minOverlap=minArea=1/0,i=m;i<=M-m;i++)bbox1=distBBox(node,0,i,this.toBBox),area=distBBox(node,i,M,this.toBBox),a=bbox1,maxY=area,maxX=overlap=minX=void 0,minX=Math.max(a.minX,maxY.minX),overlap=Math.max(a.minY,maxY.minY),maxX=Math.min(a.maxX,maxY.maxX),maxY=Math.min(a.maxY,maxY.maxY),overlap=Math.max(0,maxX-minX)*Math.max(0,maxY-overlap),area=bboxArea(bbox1)+bboxArea(area),overlap<minOverlap?(minOverlap=overlap,index=i,minArea=area<minArea?area:minArea):overlap===minOverlap&&area<minArea&&(minArea=area,index=i);return index},_chooseSplitAxis:function(node,m,M){var compareMinX=node.leaf?this.compareMinX:compareNodeMinX,compareMinY=node.leaf?this.compareMinY:compareNodeMinY;this._allDistMargin(node,m,M,compareMinX)<this._allDistMargin(node,m,M,compareMinY)&&node.children.sort(compareMinX)},_allDistMargin:function(node,m,M,compare){node.children.sort(compare);for(var child,toBBox=this.toBBox,leftBBox=distBBox(node,0,m,toBBox),rightBBox=distBBox(node,M-m,M,toBBox),margin=bboxMargin(leftBBox)+bboxMargin(rightBBox),i=m;i<M-m;i++)child=node.children[i],extend(leftBBox,node.leaf?toBBox(child):child),margin+=bboxMargin(leftBBox);for(i=M-m-1;m<=i;i--)child=node.children[i],extend(rightBBox,node.leaf?toBBox(child):child),margin+=bboxMargin(rightBBox);return margin},_adjustParentBBoxes:function(bbox,path,level){for(var i=level;0<=i;i--)extend(path[i],bbox)},_condense:function(path){for(var siblings,i=path.length-1;0<=i;i--)0===path[i].children.length?0<i?(siblings=path[i-1].children).splice(siblings.indexOf(path[i]),1):this.clear():calcBBox(path[i],this.toBBox)}};var body1$1,body2$1,body1Pushable$1,body2Pushable$1,body1MassImpact$1,body2MassImpact$1,body1FullImpact$1,body2FullImpact$1,body1MovingLeft,body1MovingRight,body1Stationary$1,body2MovingLeft,body2MovingRight,body2Stationary$1,body1OnLeft,body2OnLeft,overlap$1,body1,body2,body1Pushable,body2Pushable,body1MassImpact,body2MassImpact,body1FullImpact,body2FullImpact,body1MovingUp,body1MovingDown,body1Stationary,body2MovingUp,body2MovingDown,body2Stationary,body1OnTop,body2OnTop,overlap,GetWorldToTileXFunction_1=rbush,Constraint_1=function(body,x){x<0?(body.blocked.none=!1,body.blocked.left=!0):0<x&&(body.blocked.none=!1,body.blocked.right=!0),body.position.x-=x,0===body.bounce.x?body.velocity.x=0:body.velocity.x=-body.velocity.x*body.bounce.x},ProcessTileSeparationX=Constraint_1,MatterGameObject_1=function(body,collideRight,tileLeft,tileRight,tileBias,isLayer){var ox=0,faceLeft=collideRight.faceLeft,faceRight=collideRight.faceRight,collideLeft=collideRight.collideLeft,collideRight=collideRight.collideRight;return isLayer||(collideRight=collideLeft=faceRight=faceLeft=!0),body.deltaX()<0&&collideRight&&body.checkCollision.left?faceRight&&body.x<tileRight&&(ox=body.x-tileRight)<-tileBias&&(ox=0):0<body.deltaX()&&collideLeft&&body.checkCollision.right&&faceLeft&&body.right>tileLeft&&tileBias<(ox=body.right-tileLeft)&&(ox=0),0!==ox&&(body.customSeparateX?body.overlapX=ox:ProcessTileSeparationX(body,ox)),ox},Composites_1=function(body,y){y<0?(body.blocked.none=!1,body.blocked.up=!0):0<y&&(body.blocked.none=!1,body.blocked.down=!0),body.position.y-=y,0===body.bounce.y?body.velocity.y=0:body.velocity.y=-body.velocity.y*body.bounce.y},ProcessTileSeparationY=Composites_1,MatterImage_1=function(body,collideDown,tileTop,tileBottom,tileBias,isLayer){var oy=0,faceTop=collideDown.faceTop,faceBottom=collideDown.faceBottom,collideUp=collideDown.collideUp,collideDown=collideDown.collideDown;return isLayer||(collideDown=collideUp=faceBottom=faceTop=!0),body.deltaY()<0&&collideDown&&body.checkCollision.up?faceBottom&&body.y<tileBottom&&(oy=body.y-tileBottom)<-tileBias&&(oy=0):0<body.deltaY()&&collideUp&&body.checkCollision.down&&faceTop&&body.bottom>tileTop&&tileBias<(oy=body.bottom-tileTop)&&(oy=0),0!==oy&&(body.customSeparateY?body.overlapY=oy:ProcessTileSeparationY(body,oy)),oy},GetTileAtWorldXY_1=function(tileWorldRect,body){return!(body.right<=tileWorldRect.left||body.bottom<=tileWorldRect.top||body.position.x>=tileWorldRect.right||body.position.y>=tileWorldRect.bottom)},TileCheckX=MatterGameObject_1,TileCheckY=MatterImage_1,TileIntersectsBody$1=GetTileAtWorldXY_1,Svg_1=function(i,body,tile,tileWorldRect,tilemapLayer,tileBias,isLayer){var tileLeft=tileWorldRect.left,tileTop=tileWorldRect.top,tileRight=tileWorldRect.right,tileBottom=tileWorldRect.bottom,faceHorizontal=tile.faceLeft||tile.faceRight,faceVertical=tile.faceTop||tile.faceBottom;if(isLayer||(faceVertical=faceHorizontal=!0),!faceHorizontal&&!faceVertical)return!1;var ox=0,oy=0,minX=0,minY=1;if(body.deltaAbsX()>body.deltaAbsY()?minX=-1:body.deltaAbsX()<body.deltaAbsY()&&(minY=-1),0!==body.deltaX()&&0!==body.deltaY()&&faceHorizontal&&faceVertical&&(minX=Math.min(Math.abs(body.position.x-tileRight),Math.abs(body.right-tileLeft)),minY=Math.min(Math.abs(body.position.y-tileBottom),Math.abs(body.bottom-tileTop))),minX<minY){if(faceHorizontal&&0!==(ox=TileCheckX(body,tile,tileLeft,tileRight,tileBias,isLayer))&&!TileIntersectsBody$1(tileWorldRect,body))return!0;faceVertical&&(oy=TileCheckY(body,tile,tileTop,tileBottom,tileBias,isLayer))}else{if(faceVertical&&0!==(oy=TileCheckY(body,tile,tileTop,tileBottom,tileBias,isLayer))&&!TileIntersectsBody$1(tileWorldRect,body))return!0;faceHorizontal&&(ox=TileCheckX(body,tile,tileLeft,tileRight,tileBias,isLayer))}return 0!==ox||0!==oy},BlockCheck$1=function(){return body1MovingRight&&body1OnLeft&&body2$1.blocked.right?(body1$1.processX(-overlap$1,body1FullImpact$1,!1,!0),1):body1MovingLeft&&body2OnLeft&&body2$1.blocked.left?(body1$1.processX(overlap$1,body1FullImpact$1,!0),1):body2MovingRight&&body2OnLeft&&body1$1.blocked.right?(body2$1.processX(-overlap$1,body2FullImpact$1,!1,!0),2):body2MovingLeft&&body1OnLeft&&body1$1.blocked.left?(body2$1.processX(overlap$1,body2FullImpact$1,!0),2):0},Run$1=function(side){var halfOverlap;return body1Pushable$1&&body2Pushable$1?(overlap$1*=.5,0===side||3===side?(body1$1.processX(overlap$1,body1MassImpact$1),body2$1.processX(-overlap$1,body2MassImpact$1)):(body1$1.processX(-overlap$1,body1MassImpact$1),body2$1.processX(overlap$1,body2MassImpact$1))):body1Pushable$1&&!body2Pushable$1?0===side||3===side?body1$1.processX(overlap$1,body1FullImpact$1,!0):body1$1.processX(-overlap$1,body1FullImpact$1,!1,!0):!body1Pushable$1&&body2Pushable$1?0===side||3===side?body2$1.processX(-overlap$1,body2FullImpact$1,!1,!0):body2$1.processX(overlap$1,body2FullImpact$1,!0):(halfOverlap=.5*overlap$1,0===side?body2Stationary$1?(body1$1.processX(overlap$1,0,!0),body2$1.processX(0,null,!1,!0)):body2MovingRight?(body1$1.processX(halfOverlap,0,!0),body2$1.processX(-halfOverlap,0,!1,!0)):(body1$1.processX(halfOverlap,body2$1.velocity.x,!0),body2$1.processX(-halfOverlap,null,!1,!0)):1===side?body1Stationary$1?(body1$1.processX(0,null,!1,!0),body2$1.processX(overlap$1,0,!0)):body1MovingRight?(body1$1.processX(-halfOverlap,0,!1,!0),body2$1.processX(halfOverlap,0,!0)):(body1$1.processX(-halfOverlap,null,!1,!0),body2$1.processX(halfOverlap,body1$1.velocity.x,!0)):2===side?body2Stationary$1?(body1$1.processX(-overlap$1,0,!1,!0),body2$1.processX(0,null,!0)):body2MovingLeft?(body1$1.processX(-halfOverlap,0,!1,!0),body2$1.processX(halfOverlap,0,!0)):(body1$1.processX(-halfOverlap,body2$1.velocity.x,!1,!0),body2$1.processX(halfOverlap,null,!0)):3===side&&(body1Stationary$1?(body1$1.processX(0,null,!0),body2$1.processX(-overlap$1,0,!1,!0)):body1MovingLeft?(body1$1.processX(halfOverlap,0,!0),body2$1.processX(-halfOverlap,0,!1,!0)):(body1$1.processX(halfOverlap,body2$1.velocity.y,!0),body2$1.processX(-halfOverlap,null,!1,!0)))),!0},GetOverlapX$1=Grid_1,ProcessX={BlockCheck:BlockCheck$1,Check:function(){var avg=body1$1.velocity.x,nv2=body2$1.velocity.x,nv1=Math.sqrt(nv2*nv2*body2$1.mass/body1$1.mass)*(0<nv2?1:-1),nv2=Math.sqrt(avg*avg*body1$1.mass/body2$1.mass)*(0<avg?1:-1),avg=.5*(nv1+nv2);return body1MassImpact$1=avg+(nv1-=avg)*body1$1.bounce.x,body2MassImpact$1=avg+(nv2-=avg)*body2$1.bounce.x,body1MovingLeft&&body2OnLeft?Run$1(0):body2MovingLeft&&body1OnLeft?Run$1(1):body1MovingRight&&body1OnLeft?Run$1(2):!(!body2MovingRight||!body2OnLeft)&&Run$1(3)},Set:function(v2,v1,ov){body2$1=v1;v1=(body1$1=v2).velocity.x,v2=body2$1.velocity.x;return body1Pushable$1=body1$1.pushable,body1MovingLeft=body1$1._dx<0,body1MovingRight=0<body1$1._dx,body1Stationary$1=0===body1$1._dx,body1OnLeft=Math.abs(body1$1.right-body2$1.x)<=Math.abs(body2$1.right-body1$1.x),body1FullImpact$1=v2-v1*body1$1.bounce.x,body2Pushable$1=body2$1.pushable,body2MovingLeft=body2$1._dx<0,body2MovingRight=0<body2$1._dx,body2Stationary$1=0===body2$1._dx,body2OnLeft=!body1OnLeft,body2FullImpact$1=v1-v2*body2$1.bounce.x,overlap$1=Math.abs(ov),BlockCheck$1()},Run:Run$1,RunImmovableBody1:function(blockedState){1===blockedState?body2$1.velocity.x=0:body1OnLeft?body2$1.processX(overlap$1,body2FullImpact$1,!0):body2$1.processX(-overlap$1,body2FullImpact$1,!1,!0),body1$1.moves&&(body2$1.y+=(body1$1.y-body1$1.prev.y)*body1$1.friction.y,body2$1._dy=body2$1.y-body2$1.prev.y)},RunImmovableBody2:function(blockedState){2===blockedState?body1$1.velocity.x=0:body2OnLeft?body1$1.processX(overlap$1,body1FullImpact$1,!0):body1$1.processX(-overlap$1,body1FullImpact$1,!1,!0),body2$1.moves&&(body1$1.y+=(body2$1.y-body2$1.prev.y)*body2$1.friction.y,body1$1._dy=body1$1.y-body1$1.prev.y)}},Query_1=function(body1,body2,overlapOnly,body2Immovable){var blockedState=GetOverlapX$1(body1,body2,overlapOnly,body2Immovable),body1Immovable=body1.immovable,body2Immovable=body2.immovable;if(overlapOnly||0===blockedState||body1Immovable&&body2Immovable||body1.customSeparateX||body2.customSeparateX)return 0!==blockedState||body1.embedded&&body2.embedded;blockedState=ProcessX.Set(body1,body2,blockedState);return body1Immovable||body2Immovable?(body1Immovable?ProcessX.RunImmovableBody1(blockedState):body2Immovable&&ProcessX.RunImmovableBody2(blockedState),!0):0<blockedState||ProcessX.Check()},BlockCheck=function(){return body1MovingDown&&body1OnTop&&body2.blocked.down?(body1.processY(-overlap,body1FullImpact,!1,!0),1):body1MovingUp&&body2OnTop&&body2.blocked.up?(body1.processY(overlap,body1FullImpact,!0),1):body2MovingDown&&body2OnTop&&body1.blocked.down?(body2.processY(-overlap,body2FullImpact,!1,!0),2):body2MovingUp&&body1OnTop&&body1.blocked.up?(body2.processY(overlap,body2FullImpact,!0),2):0},Run=function(side){var halfOverlap;return body1Pushable&&body2Pushable?(overlap*=.5,0===side||3===side?(body1.processY(overlap,body1MassImpact),body2.processY(-overlap,body2MassImpact)):(body1.processY(-overlap,body1MassImpact),body2.processY(overlap,body2MassImpact))):body1Pushable&&!body2Pushable?0===side||3===side?body1.processY(overlap,body1FullImpact,!0):body1.processY(-overlap,body1FullImpact,!1,!0):!body1Pushable&&body2Pushable?0===side||3===side?body2.processY(-overlap,body2FullImpact,!1,!0):body2.processY(overlap,body2FullImpact,!0):(halfOverlap=.5*overlap,0===side?body2Stationary?(body1.processY(overlap,0,!0),body2.processY(0,null,!1,!0)):body2MovingDown?(body1.processY(halfOverlap,0,!0),body2.processY(-halfOverlap,0,!1,!0)):(body1.processY(halfOverlap,body2.velocity.y,!0),body2.processY(-halfOverlap,null,!1,!0)):1===side?body1Stationary?(body1.processY(0,null,!1,!0),body2.processY(overlap,0,!0)):body1MovingDown?(body1.processY(-halfOverlap,0,!1,!0),body2.processY(halfOverlap,0,!0)):(body1.processY(-halfOverlap,null,!1,!0),body2.processY(halfOverlap,body1.velocity.y,!0)):2===side?body2Stationary?(body1.processY(-overlap,0,!1,!0),body2.processY(0,null,!0)):body2MovingUp?(body1.processY(-halfOverlap,0,!1,!0),body2.processY(halfOverlap,0,!0)):(body1.processY(-halfOverlap,body2.velocity.y,!1,!0),body2.processY(halfOverlap,null,!0)):3===side&&(body1Stationary?(body1.processY(0,null,!0),body2.processY(-overlap,0,!1,!0)):body1MovingUp?(body1.processY(halfOverlap,0,!0),body2.processY(-halfOverlap,0,!1,!0)):(body1.processY(halfOverlap,body2.velocity.y,!0),body2.processY(-halfOverlap,null,!1,!0)))),!0},GetOverlapY$1=Pairs_1,ProcessY={BlockCheck:BlockCheck,Check:function(){var avg=body1.velocity.y,nv2=body2.velocity.y,nv1=Math.sqrt(nv2*nv2*body2.mass/body1.mass)*(0<nv2?1:-1),nv2=Math.sqrt(avg*avg*body1.mass/body2.mass)*(0<avg?1:-1),avg=.5*(nv1+nv2);return body1MassImpact=avg+(nv1-=avg)*body1.bounce.y,body2MassImpact=avg+(nv2-=avg)*body2.bounce.y,body1MovingUp&&body2OnTop?Run(0):body2MovingUp&&body1OnTop?Run(1):body1MovingDown&&body1OnTop?Run(2):!(!body2MovingDown||!body2OnTop)&&Run(3)},Set:function(v2,v1,ov){body2=v1;v1=(body1=v2).velocity.y,v2=body2.velocity.y;return body1Pushable=body1.pushable,body1MovingUp=body1._dy<0,body1MovingDown=0<body1._dy,body1Stationary=0===body1._dy,body1OnTop=Math.abs(body1.bottom-body2.y)<=Math.abs(body2.bottom-body1.y),body1FullImpact=v2-v1*body1.bounce.y,body2Pushable=body2.pushable,body2MovingUp=body2._dy<0,body2MovingDown=0<body2._dy,body2Stationary=0===body2._dy,body2OnTop=!body1OnTop,body2FullImpact=v1-v2*body2.bounce.y,overlap=Math.abs(ov),BlockCheck()},Run:Run,RunImmovableBody1:function(blockedState){1===blockedState?body2.velocity.y=0:body1OnTop?body2.processY(overlap,body2FullImpact,!0):body2.processY(-overlap,body2FullImpact,!1,!0),body1.moves&&(body2.x+=(body1.x-body1.prev.x)*body1.friction.x,body2._dx=body2.x-body2.prev.x)},RunImmovableBody2:function(blockedState){2===blockedState?body1.velocity.y=0:body2OnTop?body1.processY(overlap,body1FullImpact,!0):body1.processY(-overlap,body1FullImpact,!1,!0),body2.moves&&(body1.x+=(body2.x-body2.prev.x)*body2.friction.x,body1._dx=body1.x-body1.prev.x)}},physics=function(body1,body2,overlapOnly,body2Immovable){var blockedState=GetOverlapY$1(body1,body2,overlapOnly,body2Immovable),body1Immovable=body1.immovable,body2Immovable=body2.immovable;if(overlapOnly||0===blockedState||body1Immovable&&body2Immovable||body1.customSeparateY||body2.customSeparateY)return 0!==blockedState||body1.embedded&&body2.embedded;blockedState=ProcessY.Set(body1,body2,blockedState);return body1Immovable||body2Immovable?(body1Immovable?ProcessY.RunImmovableBody1(blockedState):body2Immovable&&ProcessY.RunImmovableBody2(blockedState),!0):0<blockedState||ProcessY.Check()},CircleContains=Bounds_1,CONST$n=plugins,RectangleContains=arcade,Vector2$m=BuildTilesetIndex_1,events$1=new Class_1({initialize:function(world,gameObject){var width=gameObject.displayWidth||64,height=gameObject.displayHeight||64;this.world=world,this.gameObject=gameObject,this.debugShowBody=world.defaults.debugShowStaticBody,this.debugBodyColor=world.defaults.staticBodyDebugColor,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new Vector2$m,this.position=new Vector2$m(gameObject.x-width*gameObject.originX,gameObject.y-height*gameObject.originY),this.width=width,this.height=height,this.halfWidth=Math.abs(this.width/2),this.halfHeight=Math.abs(this.height/2),this.center=new Vector2$m(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.velocity=Vector2$m.ZERO,this.allowGravity=!1,this.gravity=Vector2$m.ZERO,this.bounce=Vector2$m.ZERO,this.onWorldBounds=!1,this.onCollide=!1,this.onOverlap=!1,this.mass=1,this.immovable=!0,this.pushable=!1,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision={none:!1,up:!0,down:!0,left:!0,right:!0},this.touching={none:!0,up:!1,down:!1,left:!1,right:!1},this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1},this.blocked={none:!0,up:!1,down:!1,left:!1,right:!1},this.physicsType=CONST$n.STATIC_BODY,this._dx=0,this._dy=0},setGameObject:function(gameObject,update){return gameObject&&gameObject!==this.gameObject&&(this.gameObject.body=null,(gameObject.body=this).gameObject=gameObject),update&&this.updateFromGameObject(),this},updateFromGameObject:function(){this.world.staticTree.remove(this);var gameObject=this.gameObject;return gameObject.getTopLeft(this.position),this.width=gameObject.displayWidth,this.height=gameObject.displayHeight,this.halfWidth=Math.abs(this.width/2),this.halfHeight=Math.abs(this.height/2),this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.world.staticTree.insert(this),this},setOffset:function(x,y){return void 0===y&&(y=x),this.world.staticTree.remove(this),this.position.x-=this.offset.x,this.position.y-=this.offset.y,this.offset.set(x,y),this.position.x+=this.offset.x,this.position.y+=this.offset.y,this.updateCenter(),this.world.staticTree.insert(this),this},setSize:function(width,height,ox){void 0===ox&&(ox=!0);var oy=this.gameObject;return!width&&oy.frame&&(width=oy.frame.realWidth),!height&&oy.frame&&(height=oy.frame.realHeight),this.world.staticTree.remove(this),this.width=width,this.height=height,this.halfWidth=Math.floor(width/2),this.halfHeight=Math.floor(height/2),ox&&oy.getCenter&&(ox=oy.displayWidth/2,oy=oy.displayHeight/2,this.position.x-=this.offset.x,this.position.y-=this.offset.y,this.offset.set(ox-this.halfWidth,oy-this.halfHeight),this.position.x+=this.offset.x,this.position.y+=this.offset.y),this.updateCenter(),this.isCircle=!1,this.radius=0,this.world.staticTree.insert(this),this},setCircle:function(radius,offsetX,offsetY){return void 0===offsetX&&(offsetX=this.offset.x),void 0===offsetY&&(offsetY=this.offset.y),0<radius?(this.world.staticTree.remove(this),this.isCircle=!0,this.radius=radius,this.width=2*radius,this.height=2*radius,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.set(offsetX,offsetY),this.updateCenter(),this.world.staticTree.insert(this)):this.isCircle=!1,this},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},reset:function(x,y){var gameObject=this.gameObject;void 0===x&&(x=gameObject.x),void 0===y&&(y=gameObject.y),this.world.staticTree.remove(this),gameObject.setPosition(x,y),gameObject.getTopLeft(this.position),this.updateCenter(),this.world.staticTree.insert(this)},stop:function(){return this},getBounds:function(obj){return obj.x=this.x,obj.y=this.y,obj.right=this.right,obj.bottom=this.bottom,obj},hitTest:function(x,y){return(this.isCircle?CircleContains:RectangleContains)(this,x,y)},postUpdate:function(){},deltaAbsX:function(){return 0},deltaAbsY:function(){return 0},deltaX:function(){return 0},deltaY:function(){return 0},deltaZ:function(){return 0},destroy:function(){this.enable=!1,this.world.pendingDestroy.set(this)},drawDebug:function(graphic){var pos=this.position,x=pos.x+this.halfWidth,y=pos.y+this.halfHeight;this.debugShowBody&&(graphic.lineStyle(graphic.defaultStrokeWidth,this.debugBodyColor,1),this.isCircle?graphic.strokeCircle(x,y,this.width/2):graphic.strokeRect(pos.x,pos.y,this.width,this.height))},willDrawDebug:function(){return this.debugShowBody},setMass:function(value){return this.mass=value=value<=0?.1:value,this},x:{get:function(){return this.position.x},set:function(value){this.world.staticTree.remove(this),this.position.x=value,this.world.staticTree.insert(this)}},y:{get:function(){return this.position.y},set:function(value){this.world.staticTree.remove(this),this.position.y=value,this.world.staticTree.insert(this)}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}}),AngleBetweenPoints=BodyBounds_1,Body$g=Pair_1,Clamp$2=Character,Common_1=Class_1,Collider=Axes_1,CONST$m=plugins,DistanceBetween$2=DistanceBetween_1,EventEmitter$4=eventemitter3.exports,Events$a=CustomMain,FuzzyEqual=Detector_1,FuzzyGreaterThan=PluginCache$3,FuzzyLessThan=Matter_1,GetOverlapX=Grid_1,GetOverlapY=Pairs_1,GetTilesWithinWorldXY=GetTilesWithinWorldXY_1,GetValue$9=GetValue_1,MATH_CONST$3=Tweens,ProcessQueue=ParseTilesets_1,ProcessTileCallbacks=Composite_1,Rectangle$2=HasTileAtWorldXY_1,RTree=GetWorldToTileXFunction_1,SeparateTile=Svg_1,SeparateX=Query_1,SeparateY=physics,Set=HexagonalWorldToTileXY_1,StaticBody=events$1,TileIntersectsBody=GetTileAtWorldXY_1,TransformMatrix$1=TransformMatrix,Vector2$l=BuildTilesetIndex_1,Wrap=Vector_1,Engine_1=new Common_1({Extends:EventEmitter$4,initialize:function(scene,config){EventEmitter$4.call(this),this.scene=scene,this.bodies=new Set,this.staticBodies=new Set,this.pendingDestroy=new Set,this.colliders=new ProcessQueue,this.gravity=new Vector2$l(GetValue$9(config,"gravity.x",0),GetValue$9(config,"gravity.y",0)),this.bounds=new Rectangle$2(GetValue$9(config,"x",0),GetValue$9(config,"y",0),GetValue$9(config,"width",scene.sys.scale.width),GetValue$9(config,"height",scene.sys.scale.height)),this.checkCollision={up:GetValue$9(config,"checkCollision.up",!0),down:GetValue$9(config,"checkCollision.down",!0),left:GetValue$9(config,"checkCollision.left",!0),right:GetValue$9(config,"checkCollision.right",!0)},this.fps=GetValue$9(config,"fps",60),this.fixedStep=GetValue$9(config,"fixedStep",!0),this._elapsed=0,this._frameTime=1/this.fps,this._frameTimeMS=1e3*this._frameTime,this.stepsLastFrame=0,this.timeScale=GetValue$9(config,"timeScale",1),this.OVERLAP_BIAS=GetValue$9(config,"overlapBias",4),this.TILE_BIAS=GetValue$9(config,"tileBias",16),this.forceX=GetValue$9(config,"forceX",!1),this.isPaused=GetValue$9(config,"isPaused",!1),this._total=0,this.drawDebug=GetValue$9(config,"debug",!1),this.debugGraphic,this.defaults={debugShowBody:GetValue$9(config,"debugShowBody",!0),debugShowStaticBody:GetValue$9(config,"debugShowStaticBody",!0),debugShowVelocity:GetValue$9(config,"debugShowVelocity",!0),bodyDebugColor:GetValue$9(config,"debugBodyColor",16711935),staticBodyDebugColor:GetValue$9(config,"debugStaticBodyColor",255),velocityDebugColor:GetValue$9(config,"debugVelocityColor",65280)},this.maxEntries=GetValue$9(config,"maxEntries",16),this.useTree=GetValue$9(config,"useTree",!0),this.tree=new RTree(this.maxEntries),this.staticTree=new RTree(this.maxEntries),this.treeMinMax={minX:0,minY:0,maxX:0,maxY:0},this._tempMatrix=new TransformMatrix$1,this._tempMatrix2=new TransformMatrix$1,this.drawDebug&&this.createDebugGraphic()},enable:function(object,bodyType){void 0===bodyType&&(bodyType=CONST$m.DYNAMIC_BODY),Array.isArray(object)||(object=[object]);for(var i=0;i<object.length;i++){var entry=object[i];if(entry.isParent)for(var children=entry.getChildren(),c=0;c<children.length;c++){var child=children[c];child.isParent?this.enable(child,bodyType):this.enableBody(child,bodyType)}else this.enableBody(entry,bodyType)}},enableBody:function(object,bodyType){return void 0===bodyType&&(bodyType=CONST$m.DYNAMIC_BODY),object.body||(bodyType===CONST$m.DYNAMIC_BODY?object.body=new Body$g(this,object):bodyType===CONST$m.STATIC_BODY&&(object.body=new StaticBody(this,object))),this.add(object.body),object},add:function(body){return body.physicsType===CONST$m.DYNAMIC_BODY?this.bodies.set(body):body.physicsType===CONST$m.STATIC_BODY&&(this.staticBodies.set(body),this.staticTree.insert(body)),body.enable=!0,body},disable:function(object){Array.isArray(object)||(object=[object]);for(var i=0;i<object.length;i++){var entry=object[i];if(entry.isParent)for(var children=entry.getChildren(),c=0;c<children.length;c++){var child=children[c];child.isParent?this.disable(child):this.disableBody(child.body)}else this.disableBody(entry.body)}},disableBody:function(body){this.remove(body),body.enable=!1},remove:function(body){body.physicsType===CONST$m.DYNAMIC_BODY?(this.tree.remove(body),this.bodies.delete(body)):body.physicsType===CONST$m.STATIC_BODY&&(this.staticBodies.delete(body),this.staticTree.remove(body))},createDebugGraphic:function(){var graphic=this.scene.sys.add.graphics({x:0,y:0});return graphic.setDepth(Number.MAX_VALUE),this.debugGraphic=graphic,this.drawDebug=!0,graphic},setBounds:function(x,y,width,height,checkLeft,checkRight,checkUp,checkDown){return this.bounds.setTo(x,y,width,height),void 0!==checkLeft&&this.setBoundsCollision(checkLeft,checkRight,checkUp,checkDown),this},setBoundsCollision:function(left,right,up,down){return void 0===right&&(right=!0),void 0===up&&(up=!0),void 0===down&&(down=!0),this.checkCollision.left=left=void 0===left?!0:left,this.checkCollision.right=right,this.checkCollision.up=up,this.checkCollision.down=down,this},pause:function(){return this.isPaused=!0,this.emit(Events$a.PAUSE),this},resume:function(){return this.isPaused=!1,this.emit(Events$a.RESUME),this},addCollider:function(object1,object2,collideCallback,processCallback,collider){collider=new Collider(this,!1,object1,object2,collideCallback=void 0===collideCallback?null:collideCallback,processCallback=void 0===processCallback?null:processCallback,collider=void 0===collider?collideCallback:collider);return this.colliders.add(collider),collider},addOverlap:function(object1,object2,collideCallback,processCallback,collider){collider=new Collider(this,!0,object1,object2,collideCallback=void 0===collideCallback?null:collideCallback,processCallback=void 0===processCallback?null:processCallback,collider=void 0===collider?collideCallback:collider);return this.colliders.add(collider),collider},removeCollider:function(collider){return this.colliders.remove(collider),this},setFPS:function(framerate){return this.fps=framerate,this._frameTime=1/this.fps,this._frameTimeMS=1e3*this._frameTime,this},update:function(time,delta){if(!this.isPaused&&0!==this.bodies.size){var body,fixedDelta=this._frameTime,msPerFrame=this._frameTimeMS*this.timeScale;this._elapsed+=delta;var bodies=this.bodies.entries,willStep=this._elapsed>=msPerFrame;for(this.fixedStep||(fixedDelta=.001*delta,willStep=!0,this._elapsed=0),i=0;i<bodies.length;i++)(body=bodies[i]).enable&&body.preUpdate(willStep,fixedDelta);if(willStep){this._elapsed-=msPerFrame,this.stepsLastFrame=1,this.useTree&&(this.tree.clear(),this.tree.load(bodies));for(var colliders=this.colliders.update(),i=0;i<colliders.length;i++){var collider=colliders[i];collider.active&&collider.update()}this.emit(Events$a.WORLD_STEP,fixedDelta)}for(;this._elapsed>=msPerFrame;)this._elapsed-=msPerFrame,this.step(fixedDelta)}},step:function(delta){for(var body,bodies=this.bodies.entries,len=bodies.length,i=0;i<len;i++)(body=bodies[i]).enable&&body.update(delta);this.useTree&&(this.tree.clear(),this.tree.load(bodies));var colliders=this.colliders.update();for(i=0;i<colliders.length;i++){var collider=colliders[i];collider.active&&collider.update()}this.emit(Events$a.WORLD_STEP,delta),this.stepsLastFrame++},postUpdate:function(){var body,len=(bodies=this.bodies.entries).length,dynamic=this.bodies,staticBodies=this.staticBodies;if(this.stepsLastFrame)for(i=this.stepsLastFrame=0;i<len;i++)(body=bodies[i]).enable&&body.postUpdate();if(this.drawDebug){var graphics=this.debugGraphic;for(graphics.clear(),i=0;i<len;i++)(body=bodies[i]).willDrawDebug()&&body.drawDebug(graphics);for(len=(bodies=staticBodies.entries).length,i=0;i<len;i++)(body=bodies[i]).willDrawDebug()&&body.drawDebug(graphics)}var pending=this.pendingDestroy;if(0<pending.size){for(var bodies,dynamicTree=this.tree,staticTree=this.staticTree,len=(bodies=pending.entries).length,i=0;i<len;i++)(body=bodies[i]).physicsType===CONST$m.DYNAMIC_BODY?(dynamicTree.remove(body),dynamic.delete(body)):body.physicsType===CONST$m.STATIC_BODY&&(staticTree.remove(body),staticBodies.delete(body)),body.world=void 0,body.gameObject=void 0;pending.clear()}},updateMotion:function(body,delta){body.allowRotation&&this.computeAngularVelocity(body,delta),this.computeVelocity(body,delta)},computeAngularVelocity:function(body,delta){var velocityDelta=body.angularVelocity,acceleration=body.angularAcceleration,drag=body.angularDrag,max=body.maxAngular;acceleration?velocityDelta+=acceleration*delta:body.allowDrag&&drag&&(FuzzyGreaterThan(velocityDelta-(drag*=delta),0,.1)?velocityDelta-=drag:FuzzyLessThan(velocityDelta+drag,0,.1)?velocityDelta+=drag:velocityDelta=0);velocityDelta=(velocityDelta=Clamp$2(velocityDelta,-max,max))-body.angularVelocity;body.angularVelocity+=velocityDelta,body.rotation+=body.angularVelocity*delta},computeVelocity:function(body,delta){var velocityX=body.velocity.x,accelerationX=body.acceleration.x,dragX=body.drag.x,maxX=body.maxVelocity.x,velocityY=body.velocity.y,accelerationY=body.acceleration.y,dragY=body.drag.y,maxY=body.maxVelocity.y,speed=body.speed,maxSpeed=body.maxSpeed,allowDrag=body.allowDrag,useDamping=body.useDamping;body.allowGravity&&(velocityX+=(this.gravity.x+body.gravity.x)*delta,velocityY+=(this.gravity.y+body.gravity.y)*delta),accelerationX?velocityX+=accelerationX*delta:allowDrag&&dragX&&(useDamping?(velocityX*=dragX=Math.pow(dragX,delta),speed=Math.sqrt(velocityX*velocityX+velocityY*velocityY),FuzzyEqual(speed,0,.001)&&(velocityX=0)):FuzzyGreaterThan(velocityX-(dragX*=delta),0,.01)?velocityX-=dragX:FuzzyLessThan(velocityX+dragX,0,.01)?velocityX+=dragX:velocityX=0),accelerationY?velocityY+=accelerationY*delta:allowDrag&&dragY&&(useDamping?(velocityY*=dragY=Math.pow(dragY,delta),speed=Math.sqrt(velocityX*velocityX+velocityY*velocityY),FuzzyEqual(speed,0,.001)&&(velocityY=0)):FuzzyGreaterThan(velocityY-(dragY*=delta),0,.01)?velocityY-=dragY:FuzzyLessThan(velocityY+dragY,0,.01)?velocityY+=dragY:velocityY=0),velocityX=Clamp$2(velocityX,-maxX,maxX),velocityY=Clamp$2(velocityY,-maxY,maxY),body.velocity.set(velocityX,velocityY),-1<maxSpeed&&maxSpeed<speed&&(body.velocity.normalize().scale(maxSpeed),speed=maxSpeed),body.speed=speed},separate:function(body1,body2,rect_x,rect_y,overlapOnly,rect_bottom){if(!rect_bottom&&!body1.enable||!body2.enable||body1.checkCollision.none||body2.checkCollision.none||!this.intersects(body1,body2))return!1;if(rect_x&&!1===rect_x.call(rect_y,body1.gameObject,body2.gameObject))return!1;if(body1.isCircle&&body2.isCircle)return this.separateCircle(body1,body2,overlapOnly);if(body1.isCircle!==body2.isCircle){var rect_bottom=body1.isCircle?body2:body1,resultX=body1.isCircle?body1:body2,rect_x=rect_bottom.x,rect_y=rect_bottom.y,result=rect_bottom.right,rect_bottom=rect_bottom.bottom,resultX=resultX.center;if((resultX.y<rect_y||resultX.y>rect_bottom)&&(resultX.x<rect_x||resultX.x>result))return this.separateCircle(body1,body2,overlapOnly)}resultX=!1,result=!1;overlapOnly?(resultX=SeparateX(body1,body2,overlapOnly,this.OVERLAP_BIAS),result=SeparateY(body1,body2,overlapOnly,this.OVERLAP_BIAS)):this.forceX||Math.abs(this.gravity.y+body1.gravity.y)<Math.abs(this.gravity.x+body1.gravity.x)?(resultX=SeparateX(body1,body2,overlapOnly,this.OVERLAP_BIAS),this.intersects(body1,body2)&&(result=SeparateY(body1,body2,overlapOnly,this.OVERLAP_BIAS))):(result=SeparateY(body1,body2,overlapOnly,this.OVERLAP_BIAS),this.intersects(body1,body2)&&(resultX=SeparateX(body1,body2,overlapOnly,this.OVERLAP_BIAS)));result=resultX||result;return result&&(overlapOnly?(body1.onOverlap||body2.onOverlap)&&this.emit(Events$a.OVERLAP,body1.gameObject,body2.gameObject,body1,body2):(body1.onCollide||body2.onCollide)&&this.emit(Events$a.COLLIDE,body1.gameObject,body2.gameObject,body1,body2)),result},separateCircle:function(body1,body2,overlapY,overlap){GetOverlapX(body1,body2,!1,overlap),GetOverlapY(body1,body2,!1,overlap);overlap=0;if(body1.isCircle!==body2.isCircle?(nx={x:(body2.isCircle?body1:body2).position.x,y:(body2.isCircle?body1:body2).position.y,right:(body2.isCircle?body1:body2).right,bottom:(body2.isCircle?body1:body2).bottom},(overlapX={x:(body1.isCircle?body1:body2).center.x,y:(body1.isCircle?body1:body2).center.y,radius:(body1.isCircle?body1:body2).halfWidth}).y<nx.y?overlapX.x<nx.x?overlap=DistanceBetween$2(overlapX.x,overlapX.y,nx.x,nx.y)-overlapX.radius:nx.right<overlapX.x&&(overlap=DistanceBetween$2(overlapX.x,overlapX.y,nx.right,nx.y)-overlapX.radius):nx.bottom<overlapX.y&&(overlapX.x<nx.x?overlap=DistanceBetween$2(overlapX.x,overlapX.y,nx.x,nx.bottom)-overlapX.radius:nx.right<overlapX.x&&(overlap=DistanceBetween$2(overlapX.x,overlapX.y,nx.right,nx.bottom)-overlapX.radius)),overlap*=-1):overlap=body1.halfWidth+body2.halfWidth-DistanceBetween$2(body1.center.x,body1.center.y,body2.center.x,body2.center.y),body1.overlapR=overlap,body2.overlapR=overlap,overlapY||0===overlap||body1.immovable&&body2.immovable||body1.customSeparateX||body2.customSeparateX)return 0!==overlap&&(body1.onOverlap||body2.onOverlap)&&this.emit(Events$a.OVERLAP,body1.gameObject,body2.gameObject,body1,body2),0!==overlap;var nx=body1.center.x-body2.center.x,overlapX=body1.center.y-body2.center.y,overlapY=Math.sqrt(Math.pow(nx,2)+Math.pow(overlapX,2)),nx=(body2.center.x-body1.center.x)/overlapY||0,overlapX=(body2.center.y-body1.center.y)/overlapY||0,overlapY=2*(body1.velocity.x*nx+body1.velocity.y*overlapX-body2.velocity.x*nx-body2.velocity.y*overlapX)/(body1.mass+body2.mass);(body1.immovable||body2.immovable)&&(overlapY*=2),body1.immovable||(body1.velocity.x=body1.velocity.x-overlapY/body1.mass*nx,body1.velocity.y=body1.velocity.y-overlapY/body1.mass*overlapX),body2.immovable||(body2.velocity.x=body2.velocity.x+overlapY/body2.mass*nx,body2.velocity.y=body2.velocity.y+overlapY/body2.mass*overlapX),body1.immovable||body2.immovable||(overlap/=2);overlapY=AngleBetweenPoints(body1.center,body2.center),overlapX=(overlap+MATH_CONST$3.EPSILON)*Math.cos(overlapY),overlapY=(overlap+MATH_CONST$3.EPSILON)*Math.sin(overlapY);return body1.immovable||(body1.x-=overlapX,body1.y-=overlapY,body1.updateCenter()),body2.immovable||(body2.x+=overlapX,body2.y+=overlapY,body2.updateCenter()),body1.velocity.x*=body1.bounce.x,body1.velocity.y*=body1.bounce.y,body2.velocity.x*=body2.bounce.x,body2.velocity.y*=body2.bounce.y,(body1.onCollide||body2.onCollide)&&this.emit(Events$a.COLLIDE,body1.gameObject,body2.gameObject,body1,body2),!0},intersects:function(body1,body2){return body1!==body2&&(body1.isCircle||body2.isCircle?body1.isCircle?body2.isCircle?DistanceBetween$2(body1.center.x,body1.center.y,body2.center.x,body2.center.y)<=body1.halfWidth+body2.halfWidth:this.circleBodyIntersects(body1,body2):this.circleBodyIntersects(body2,body1):!(body1.right<=body2.position.x||body1.bottom<=body2.position.y||body1.position.x>=body2.right||body1.position.y>=body2.bottom))},circleBodyIntersects:function(circle,y){var x=Clamp$2(circle.center.x,y.left,y.right),y=Clamp$2(circle.center.y,y.top,y.bottom);return(circle.center.x-x)*(circle.center.x-x)+(circle.center.y-y)*(circle.center.y-y)<=circle.halfWidth*circle.halfWidth},overlap:function(object1,object2,overlapCallback,processCallback,callbackContext){return void 0===overlapCallback&&(overlapCallback=null),void 0===callbackContext&&(callbackContext=overlapCallback),this.collideObjects(object1,object2,overlapCallback,processCallback=void 0===processCallback?null:processCallback,callbackContext,!0)},collide:function(object1,object2,collideCallback,processCallback,callbackContext){return void 0===collideCallback&&(collideCallback=null),void 0===callbackContext&&(callbackContext=collideCallback),this.collideObjects(object1,object2,collideCallback,processCallback=void 0===processCallback?null:processCallback,callbackContext,!1)},collideObjects:function(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly){var i;object1.isParent&&void 0===object1.physicsType&&(object1=object1.children.entries),object2&&object2.isParent&&void 0===object2.physicsType&&(object2=object2.children.entries);var object1isArray=Array.isArray(object1),object2isArray=Array.isArray(object2);if(this._total=0,object1isArray||object2isArray)if(!object1isArray&&object2isArray)for(i=0;i<object2.length;i++)this.collideHandler(object1,object2[i],collideCallback,processCallback,callbackContext,overlapOnly);else if(object1isArray&&!object2isArray)if(object2)for(i=0;i<object1.length;i++)this.collideHandler(object1[i],object2,collideCallback,processCallback,callbackContext,overlapOnly);else for(i=0;i<object1.length;i++)for(var child=object1[i],j=i+1;j<object1.length;j++)i!==j&&this.collideHandler(child,object1[j],collideCallback,processCallback,callbackContext,overlapOnly);else for(i=0;i<object1.length;i++)for(j=0;j<object2.length;j++)this.collideHandler(object1[i],object2[j],collideCallback,processCallback,callbackContext,overlapOnly);else this.collideHandler(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly);return 0<this._total},collideHandler:function(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly){return void 0===object2&&object1.isParent?this.collideGroupVsGroup(object1,object1,collideCallback,processCallback,callbackContext,overlapOnly):!(!object1||!object2)&&(object1.body?object2.body?this.collideSpriteVsSprite(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly):object2.isParent?this.collideSpriteVsGroup(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly):object2.isTilemap?this.collideSpriteVsTilemapLayer(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly):void 0:object1.isParent?object2.body?this.collideSpriteVsGroup(object2,object1,collideCallback,processCallback,callbackContext,overlapOnly):object2.isParent?this.collideGroupVsGroup(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly):object2.isTilemap?this.collideGroupVsTilemapLayer(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly):void 0:object1.isTilemap?object2.body?this.collideSpriteVsTilemapLayer(object2,object1,collideCallback,processCallback,callbackContext,overlapOnly):object2.isParent?this.collideGroupVsTilemapLayer(object2,object1,collideCallback,processCallback,callbackContext,overlapOnly):void 0:void 0)},collideSpriteVsSprite:function(sprite1,sprite2,collideCallback,processCallback,callbackContext,overlapOnly){return!(!sprite1.body||!sprite2.body)&&(this.separate(sprite1.body,sprite2.body,processCallback,callbackContext,overlapOnly)&&(collideCallback&&collideCallback.call(callbackContext,sprite1,sprite2),this._total++),!0)},collideSpriteVsGroup:function(sprite,group,collideCallback,processCallback,callbackContext,overlapOnly){var bodyB,bodyA=sprite.body;if(0!==group.length&&bodyA&&bodyA.enable&&!bodyA.checkCollision.none)if(this.useTree||group.physicsType===CONST$m.STATIC_BODY){var minMax=this.treeMinMax;minMax.minX=bodyA.left,minMax.minY=bodyA.top,minMax.maxX=bodyA.right,minMax.maxY=bodyA.bottom;for(var results=(group.physicsType===CONST$m.DYNAMIC_BODY?this.tree:this.staticTree).search(minMax),len=results.length,i=0;i<len;i++)bodyA!==(bodyB=results[i])&&bodyB.enable&&!bodyB.checkCollision.none&&group.contains(bodyB.gameObject)&&this.separate(bodyA,bodyB,processCallback,callbackContext,overlapOnly,!0)&&(collideCallback&&collideCallback.call(callbackContext,bodyA.gameObject,bodyB.gameObject),this._total++)}else{var children=group.getChildren(),skipIndex=group.children.entries.indexOf(sprite);for(len=children.length,i=0;i<len;i++)(bodyB=children[i].body)&&i!==skipIndex&&bodyB.enable&&this.separate(bodyA,bodyB,processCallback,callbackContext,overlapOnly)&&(collideCallback&&collideCallback.call(callbackContext,bodyA.gameObject,bodyB.gameObject),this._total++)}},collideGroupVsTilemapLayer:function(group,tilemapLayer,collideCallback,processCallback,callbackContext,overlapOnly){var children=group.getChildren();if(0===children.length)return!1;for(var didCollide=!1,i=0;i<children.length;i++)children[i].body&&this.collideSpriteVsTilemapLayer(children[i],tilemapLayer,collideCallback,processCallback,callbackContext,overlapOnly)&&(didCollide=!0);return didCollide},collideTiles:function(sprite,tiles,collideCallback,processCallback,callbackContext){return!(!sprite.body.enable||0===tiles.length)&&this.collideSpriteVsTilesHandler(sprite,tiles,collideCallback,processCallback,callbackContext,!1,!1)},overlapTiles:function(sprite,tiles,collideCallback,processCallback,callbackContext){return!(!sprite.body.enable||0===tiles.length)&&this.collideSpriteVsTilesHandler(sprite,tiles,collideCallback,processCallback,callbackContext,!0,!1)},collideSpriteVsTilemapLayer:function(sprite,mapData,collideCallback,processCallback,callbackContext,overlapOnly){var xDiff=sprite.body;if(!xDiff.enable||xDiff.checkCollision.none)return!1;var x=xDiff.position.x,y=xDiff.position.y,w=xDiff.width,h=xDiff.height,layerData=mapData.layer;layerData.tileWidth>layerData.baseTileWidth&&(x-=xDiff=(layerData.tileWidth-layerData.baseTileWidth)*mapData.scaleX,w+=xDiff),layerData.tileHeight>layerData.baseTileHeight&&(h+=(layerData.tileHeight-layerData.baseTileHeight)*mapData.scaleY);mapData=GetTilesWithinWorldXY(x,y,w,h,null,mapData.scene.cameras.main,mapData.layer);return 0!==mapData.length&&this.collideSpriteVsTilesHandler(sprite,mapData,collideCallback,processCallback,callbackContext,overlapOnly,!0)},collideSpriteVsTilesHandler:function(sprite,tiles,collideCallback,processCallback,callbackContext,overlapOnly,isLayer){for(var body=sprite.body,tileWorldRect={left:0,right:0,top:0,bottom:0},collision=!1,i=0;i<tiles.length;i++){var tile,tilemapLayer,point=(tilemapLayer=(tile=tiles[i]).tilemapLayer).tileToWorldXY(tile.x,tile.y);tileWorldRect.left=point.x,tileWorldRect.top=point.y,tile.baseHeight!==tile.height&&(tileWorldRect.top-=(tile.height-tile.baseHeight)*tilemapLayer.scaleY),tileWorldRect.right=tileWorldRect.left+tile.width*tilemapLayer.scaleX,tileWorldRect.bottom=tileWorldRect.top+tile.height*tilemapLayer.scaleY,TileIntersectsBody(tileWorldRect,body)&&(!processCallback||processCallback.call(callbackContext,sprite,tile))&&ProcessTileCallbacks(tile,sprite)&&(overlapOnly||SeparateTile(i,body,tile,tileWorldRect,tilemapLayer,this.TILE_BIAS,isLayer))&&(this._total++,collision=!0,collideCallback&&collideCallback.call(callbackContext,sprite,tile),overlapOnly&&body.onOverlap?this.emit(Events$a.TILE_OVERLAP,sprite,tile,body):body.onCollide&&this.emit(Events$a.TILE_COLLIDE,sprite,tile,body))}return collision},collideGroupVsGroup:function(group1,group2,collideCallback,processCallback,callbackContext,overlapOnly){if(0!==group1.length&&0!==group2.length)for(var children=group1.getChildren(),i=0;i<children.length;i++)this.collideSpriteVsGroup(children[i],group2,collideCallback,processCallback,callbackContext,overlapOnly)},wrap:function(object,padding){object.body?this.wrapObject(object,padding):object.getChildren?this.wrapArray(object.getChildren(),padding):Array.isArray(object)?this.wrapArray(object,padding):this.wrapObject(object,padding)},wrapArray:function(objects,padding){for(var i=0;i<objects.length;i++)this.wrapObject(objects[i],padding)},wrapObject:function(object,padding){object.x=Wrap(object.x,this.bounds.left-(padding=void 0===padding?0:padding),this.bounds.right+padding),object.y=Wrap(object.y,this.bounds.top-padding,this.bounds.bottom+padding)},shutdown:function(){this.tree.clear(),this.staticTree.clear(),this.bodies.clear(),this.staticBodies.clear(),this.colliders.destroy(),this.removeAllListeners()},destroy:function(){this.shutdown(),this.scene=null}}),DegToRad$1=DegToRad_1,DistanceBetween$1=DistanceBetween_1,DistanceSquared=MatterPhysics,Factory$2=World_1$1,GetFastValue$j=GetFastValue_1,Merge$2=Merge_1,OverlapCirc=SAT_1,OverlapRect=Events_1,MatterWrap_1=PluginCache,SceneEvents$4=events$g,Vector2$k=BuildTilesetIndex_1,World$4=Engine_1,Bounds_1=new Class_1({initialize:function(scene){this.scene=scene,this.systems=scene.sys,this.config=this.getConfig(),this.world,this.add,scene.sys.events.once(SceneEvents$4.BOOT,this.boot,this),scene.sys.events.on(SceneEvents$4.START,this.start,this)},boot:function(){this.world=new World$4(this.scene,this.config),this.add=new Factory$2(this.world),this.systems.events.once(SceneEvents$4.DESTROY,this.destroy,this)},start:function(){this.world||(this.world=new World$4(this.scene,this.config),this.add=new Factory$2(this.world));var eventEmitter=this.systems.events;GetFastValue$j(this.config,"customUpdate",!1)||eventEmitter.on(SceneEvents$4.UPDATE,this.world.update,this.world),eventEmitter.on(SceneEvents$4.POST_UPDATE,this.world.postUpdate,this.world),eventEmitter.once(SceneEvents$4.SHUTDOWN,this.shutdown,this)},enableUpdate:function(){this.systems.events.on(SceneEvents$4.UPDATE,this.world.update,this.world)},disableUpdate:function(){this.systems.events.off(SceneEvents$4.UPDATE,this.world.update,this.world)},getConfig:function(){var gameConfig=this.systems.game.config.physics,sceneConfig=this.systems.settings.physics;return Merge$2(GetFastValue$j(sceneConfig,"arcade",{}),GetFastValue$j(gameConfig,"arcade",{}))},overlap:function(object1,object2,overlapCallback,processCallback,callbackContext){return void 0===overlapCallback&&(overlapCallback=null),void 0===callbackContext&&(callbackContext=overlapCallback),this.world.collideObjects(object1,object2,overlapCallback,processCallback=void 0===processCallback?null:processCallback,callbackContext,!0)},collide:function(object1,object2,collideCallback,processCallback,callbackContext){return void 0===collideCallback&&(collideCallback=null),void 0===callbackContext&&(callbackContext=collideCallback),this.world.collideObjects(object1,object2,collideCallback,processCallback=void 0===processCallback?null:processCallback,callbackContext,!1)},collideTiles:function(sprite,tiles,collideCallback,processCallback,callbackContext){return this.world.collideTiles(sprite,tiles,collideCallback,processCallback,callbackContext)},overlapTiles:function(sprite,tiles,collideCallback,processCallback,callbackContext){return this.world.overlapTiles(sprite,tiles,collideCallback,processCallback,callbackContext)},pause:function(){return this.world.pause()},resume:function(){return this.world.resume()},accelerateTo:function(gameObject,angle,y,speed,xSpeedMax,ySpeedMax){void 0===speed&&(speed=60);angle=Math.atan2(y-gameObject.y,angle-gameObject.x);return gameObject.body.acceleration.setToPolar(angle,speed),void 0!==xSpeedMax&&void 0!==ySpeedMax&&gameObject.body.maxVelocity.set(xSpeedMax,ySpeedMax),angle},accelerateToObject:function(gameObject,destination,speed,xSpeedMax,ySpeedMax){return this.accelerateTo(gameObject,destination.x,destination.y,speed,xSpeedMax,ySpeedMax)},closest:function(source,targets){targets=targets||this.world.bodies.entries;for(var min=Number.MAX_VALUE,closest=null,x=source.x,y=source.y,len=targets.length,i=0;i<len;i++){var target=targets[i],distance=target.body||target;source!==target&&source!==distance&&source!==distance.gameObject&&source!==distance.center&&((distance=DistanceSquared(x,y,distance.center.x,distance.center.y))<min&&(closest=target,min=distance))}return closest},furthest:function(source,targets){targets=targets||this.world.bodies.entries;for(var max=-1,farthest=null,x=source.x,y=source.y,len=targets.length,i=0;i<len;i++){var target=targets[i],distance=target.body||target;source!==target&&source!==distance&&source!==distance.gameObject&&source!==distance.center&&(max<(distance=DistanceSquared(x,y,distance.center.x,distance.center.y))&&(farthest=target,max=distance))}return farthest},moveTo:function(gameObject,x,y,speed,maxTime){void 0===speed&&(speed=60),void 0===maxTime&&(maxTime=0);var angle=Math.atan2(y-gameObject.y,x-gameObject.x);return 0<maxTime&&(speed=DistanceBetween$1(gameObject.x,gameObject.y,x,y)/(maxTime/1e3)),gameObject.body.velocity.setToPolar(angle,speed),angle},moveToObject:function(gameObject,destination,speed,maxTime){return this.moveTo(gameObject,destination.x,destination.y,speed,maxTime)},velocityFromAngle:function(angle,speed,vec2){return void 0===speed&&(speed=60),(vec2=void 0===vec2?new Vector2$k:vec2).setToPolar(DegToRad$1(angle),speed)},velocityFromRotation:function(rotation,speed,vec2){return void 0===speed&&(speed=60),(vec2=void 0===vec2?new Vector2$k:vec2).setToPolar(rotation,speed)},overlapRect:function(x,y,width,height,includeDynamic,includeStatic){return OverlapRect(this.world,x,y,width,height,includeDynamic,includeStatic)},overlapCirc:function(x,y,radius,includeDynamic,includeStatic){return OverlapCirc(this.world,x,y,radius,includeDynamic,includeStatic)},shutdown:function(){var eventEmitter;this.world&&((eventEmitter=this.systems.events).off(SceneEvents$4.UPDATE,this.world.update,this.world),eventEmitter.off(SceneEvents$4.POST_UPDATE,this.world.postUpdate,this.world),eventEmitter.off(SceneEvents$4.SHUTDOWN,this.shutdown,this),this.add.destroy(),this.world.destroy(),this.add=null,this.world=null)},destroy:function(){this.shutdown(),this.scene.sys.events.off(SceneEvents$4.START,this.start,this),this.scene=null,this.systems=null}});MatterWrap_1.register("ArcadePhysics",Bounds_1,"arcadePhysics");var arcade=Extend_1$1(!1,{ArcadePhysics:Bounds_1,Body:Pair_1,Collider:Axes_1,Components:Body_1,Events:CustomMain,Factory:World_1$1,GetOverlapX:Grid_1,GetOverlapY:Pairs_1,SeparateX:Query_1,SeparateY:physics,Group:Bodies_1,Image:GetTargets_1,Sprite:IsInLayerBounds_1,StaticBody:events$1,StaticGroup:components$1,Tilemap:{ProcessTileCallbacks:Composite_1,ProcessTileSeparationX:Constraint_1,ProcessTileSeparationY:Composites_1,SeparateTile:Svg_1,TileCheckX:MatterGameObject_1,TileCheckY:MatterImage_1,TileIntersectsBody:GetTileAtWorldXY_1},World:Engine_1},plugins),Vector2$j=BuildTilesetIndex_1,BodyBounds_1=new Class_1({initialize:function(){this.boundsCenter=new Vector2$j,this.centerDiff=new Vector2$j},parseBody:function(bodyCenterY){if(!(bodyCenterY=bodyCenterY.hasOwnProperty("body")?bodyCenterY.body:bodyCenterY).hasOwnProperty("bounds")||!bodyCenterY.hasOwnProperty("centerOfMass"))return!1;var boundsCenter=this.boundsCenter,centerDiff=this.centerDiff,boundsWidth=bodyCenterY.bounds.max.x-bodyCenterY.bounds.min.x,boundsHeight=bodyCenterY.bounds.max.y-bodyCenterY.bounds.min.y,bodyCenterX=boundsWidth*bodyCenterY.centerOfMass.x,bodyCenterY=boundsHeight*bodyCenterY.centerOfMass.y;return boundsCenter.set(boundsWidth/2,boundsHeight/2),centerDiff.set(bodyCenterX-boundsCenter.x,bodyCenterY-boundsCenter.y),!0},getTopLeft:function(diff,x,y){if(void 0===x&&(x=0),void 0===y&&(y=0),this.parseBody(diff)){var center=this.boundsCenter,diff=this.centerDiff;return new Vector2$j(x+center.x+diff.x,y+center.y+diff.y)}return!1},getTopCenter:function(diff,x,y){if(void 0===x&&(x=0),void 0===y&&(y=0),this.parseBody(diff)){var center=this.boundsCenter,diff=this.centerDiff;return new Vector2$j(x+diff.x,y+center.y+diff.y)}return!1},getTopRight:function(diff,x,y){if(void 0===x&&(x=0),void 0===y&&(y=0),this.parseBody(diff)){var center=this.boundsCenter,diff=this.centerDiff;return new Vector2$j(x-(center.x-diff.x),y+center.y+diff.y)}return!1},getLeftCenter:function(diff,x,y){if(void 0===x&&(x=0),void 0===y&&(y=0),this.parseBody(diff)){var center=this.boundsCenter,diff=this.centerDiff;return new Vector2$j(x+center.x+diff.x,y+diff.y)}return!1},getCenter:function(diff,x,y){if(void 0===x&&(x=0),void 0===y&&(y=0),this.parseBody(diff)){diff=this.centerDiff;return new Vector2$j(x+diff.x,y+diff.y)}return!1},getRightCenter:function(diff,x,y){if(void 0===x&&(x=0),void 0===y&&(y=0),this.parseBody(diff)){var center=this.boundsCenter,diff=this.centerDiff;return new Vector2$j(x-(center.x-diff.x),y+diff.y)}return!1},getBottomLeft:function(diff,x,y){if(void 0===x&&(x=0),void 0===y&&(y=0),this.parseBody(diff)){var center=this.boundsCenter,diff=this.centerDiff;return new Vector2$j(x+center.x+diff.x,y-(center.y-diff.y))}return!1},getBottomCenter:function(diff,x,y){if(void 0===x&&(x=0),void 0===y&&(y=0),this.parseBody(diff)){var center=this.boundsCenter,diff=this.centerDiff;return new Vector2$j(x+diff.x,y-(center.y-diff.y))}return!1},getBottomRight:function(diff,x,y){if(void 0===x&&(x=0),void 0===y&&(y=0),this.parseBody(diff)){var center=this.boundsCenter,diff=this.centerDiff;return new Vector2$j(x-(center.x-diff.x),y-(center.y-diff.y))}return!1}}),PluginCache$3={setBounce:function(value){return this.body.restitution=value,this}},Matter_1={setCollisionCategory:function(value){return this.body.collisionFilter.category=value,this},setCollisionGroup:function(value){return this.body.collisionFilter.group=value,this},setCollidesWith:function(categories){var flags=0;if(Array.isArray(categories))for(var i=0;i<categories.length;i++)flags|=categories[i];else flags=categories;return this.body.collisionFilter.mask=flags,this},setOnCollide:function(callback){return this.body.onCollideCallback=callback,this},setOnCollideEnd:function(callback){return this.body.onCollideEndCallback=callback,this},setOnCollideActive:function(callback){return this.body.onCollideActiveCallback=callback,this},setOnCollideWith:function(body,callback){Array.isArray(body)||(body=[body]);for(var i=0;i<body.length;i++){var src=body[i].hasOwnProperty("body")?body[i].body:body[i];this.body.setOnCollideWith(src,callback)}return this}},Vector$a={},Vector_1=Vector$a;Vector$a.create=function(x,y){return{x:x||0,y:y||0}},Vector$a.clone=function(vector){return{x:vector.x,y:vector.y}},Vector$a.magnitude=function(vector){return Math.sqrt(vector.x*vector.x+vector.y*vector.y)},Vector$a.magnitudeSquared=function(vector){return vector.x*vector.x+vector.y*vector.y},Vector$a.rotate=function(vector,x,output){var cos=Math.cos(x),sin=Math.sin(x),x=vector.x*cos-vector.y*sin;return(output=output||{}).y=vector.x*sin+vector.y*cos,output.x=x,output},Vector$a.rotateAbout=function(vector,x,point,output){var cos=Math.cos(x),sin=Math.sin(x),x=point.x+((vector.x-point.x)*cos-(vector.y-point.y)*sin);return(output=output||{}).y=point.y+((vector.x-point.x)*sin+(vector.y-point.y)*cos),output.x=x,output},Vector$a.normalise=function(vector){var magnitude=Vector$a.magnitude(vector);return 0===magnitude?{x:0,y:0}:{x:vector.x/magnitude,y:vector.y/magnitude}},Vector$a.dot=function(vectorA,vectorB){return vectorA.x*vectorB.x+vectorA.y*vectorB.y},Vector$a.cross=function(vectorA,vectorB){return vectorA.x*vectorB.y-vectorA.y*vectorB.x},Vector$a.cross3=function(vectorA,vectorB,vectorC){return(vectorB.x-vectorA.x)*(vectorC.y-vectorA.y)-(vectorB.y-vectorA.y)*(vectorC.x-vectorA.x)},Vector$a.add=function(vectorA,vectorB,output){return(output=output||{}).x=vectorA.x+vectorB.x,output.y=vectorA.y+vectorB.y,output},Vector$a.sub=function(vectorA,vectorB,output){return(output=output||{}).x=vectorA.x-vectorB.x,output.y=vectorA.y-vectorB.y,output},Vector$a.mult=function(vector,scalar){return{x:vector.x*scalar,y:vector.y*scalar}},Vector$a.div=function(vector,scalar){return{x:vector.x/scalar,y:vector.y/scalar}},Vector$a.perp=function(vector,negate){return{x:(negate=!0===negate?-1:1)*-vector.y,y:negate*vector.x}},Vector$a.neg=function(vector){return{x:-vector.x,y:-vector.y}},Vector$a.angle=function(vectorA,vectorB){return Math.atan2(vectorB.y-vectorA.y,vectorB.x-vectorA.x)},Vector$a._temp=[Vector$a.create(),Vector$a.create(),Vector$a.create(),Vector$a.create(),Vector$a.create(),Vector$a.create()];var Common$j={},Common_1=Common$j;!function(){Common$j._nextId=0,Common$j._seed=0,Common$j._nowStartTime=+new Date,Common$j.extend=function(obj,deep){for(var argsStart,deepClone="boolean"==typeof deep?(argsStart=2,deep):(argsStart=1,!0),i=argsStart;i<arguments.length;i++){var source=arguments[i];if(source)for(var prop in source)!deepClone||!source[prop]||source[prop].constructor!==Object||obj[prop]&&obj[prop].constructor!==Object?obj[prop]=source[prop]:(obj[prop]=obj[prop]||{},Common$j.extend(obj[prop],deepClone,source[prop]))}return obj},Common$j.clone=function(obj,deep){return Common$j.extend({},deep,obj)},Common$j.keys=function(obj){if(Object.keys)return Object.keys(obj);var key,keys=[];for(key in obj)keys.push(key);return keys},Common$j.values=function(obj){var key,values=[];if(Object.keys){for(var keys=Object.keys(obj),i=0;i<keys.length;i++)values.push(obj[keys[i]]);return values}for(key in obj)values.push(obj[key]);return values},Common$j.get=function(obj,path,begin,end){path=path.split(".").slice(begin,end);for(var i=0;i<path.length;i+=1)obj=obj[path[i]];return obj},Common$j.set=function(obj,path,val,begin,parts){parts=path.split(".").slice(begin,parts);return Common$j.get(obj,path,0,-1)[parts[parts.length-1]]=val},Common$j.shuffle=function(array){for(var i=array.length-1;0<i;i--){var j=Math.floor(Common$j.random()*(i+1)),temp=array[i];array[i]=array[j],array[j]=temp}return array},Common$j.choose=function(choices){return choices[Math.floor(Common$j.random()*choices.length)]},Common$j.isElement=function(obj){return"undefined"!=typeof HTMLElement?obj instanceof HTMLElement:!!(obj&&obj.nodeType&&obj.nodeName)},Common$j.isArray=function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},Common$j.isFunction=function(obj){return"function"==typeof obj},Common$j.isPlainObject=function(obj){return"object"==typeof obj&&obj.constructor===Object},Common$j.isString=function(obj){return"[object String]"===Object.prototype.toString.call(obj)},Common$j.clamp=function(value,min,max){return value<min?min:max<value?max:value},Common$j.sign=function(value){return value<0?-1:1},Common$j.now=function(){if("undefined"!=typeof window&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-Common$j._nowStartTime},Common$j.random=function(min,max){return max=void 0!==max?max:1,(min=void 0!==min?min:0)+_seededRandom()*(max-min)};var _seededRandom=function(){return Common$j._seed=(9301*Common$j._seed+49297)%233280,Common$j._seed/233280};Common$j.colorToNumber=function(colorString){return 3==(colorString=colorString.replace("#","")).length&&(colorString=colorString.charAt(0)+colorString.charAt(0)+colorString.charAt(1)+colorString.charAt(1)+colorString.charAt(2)+colorString.charAt(2)),parseInt(colorString,16)},Common$j.logLevel=1,Common$j.log=function(){console&&0<Common$j.logLevel&&Common$j.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},Common$j.info=function(){console&&0<Common$j.logLevel&&Common$j.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},Common$j.warn=function(){console&&0<Common$j.logLevel&&Common$j.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},Common$j.nextId=function(){return Common$j._nextId++},Common$j.indexOf=function(haystack,needle){if(haystack.indexOf)return haystack.indexOf(needle);for(var i=0;i<haystack.length;i++)if(haystack[i]===needle)return i;return-1},Common$j.map=function(list,func){if(list.map)return list.map(func);for(var mapped=[],i=0;i<list.length;i+=1)mapped.push(func(list[i]));return mapped},Common$j.topologicalSort=function(graph){var node,result=[],visited=[],temp=[];for(node in graph)visited[node]||temp[node]||Common$j._topologicalSort(node,visited,temp,graph,result);return result},Common$j._topologicalSort=function(node,visited,temp,graph,result){var neighbors=graph[node]||[];temp[node]=!0;for(var i=0;i<neighbors.length;i+=1){var neighbor=neighbors[i];temp[neighbor]||visited[neighbor]||Common$j._topologicalSort(neighbor,visited,temp,graph,result)}temp[node]=!1,visited[node]=!0,result.push(node)},Common$j.chain=function(){for(var funcs=[],i=0;i<arguments.length;i+=1){var func=arguments[i];func._chained?funcs.push.apply(funcs,func._chained):funcs.push(func)}function chain(){for(var lastResult,args=new Array(arguments.length),i=0,l=arguments.length;i<l;i++)args[i]=arguments[i];for(i=0;i<funcs.length;i+=1){var result=funcs[i].apply(lastResult,args);void 0!==result&&(lastResult=result)}return lastResult}return chain._chained=funcs,chain},Common$j.chainPathBefore=function(base,path,func){return Common$j.set(base,path,Common$j.chain(func,Common$j.get(base,path)))},Common$j.chainPathAfter=function(base,path,func){return Common$j.set(base,path,Common$j.chain(Common$j.get(base,path),func))}}();var Vertices$c={},MatterPhysics=Vertices$c,Vector$9=Vector_1,Common$i=Common_1;Vertices$c.create=function(points,body){for(var vertices=[],i=0;i<points.length;i++){var vertex=points[i],vertex={x:vertex.x,y:vertex.y,index:i,body:body,isInternal:!1,contact:null,offset:null};vertex.contact={vertex:vertex,normalImpulse:0,tangentImpulse:0},vertices.push(vertex)}return vertices},Vertices$c.fromPath=function(path,body){var points=[];return path.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,function(match,x,y){points.push({x:parseFloat(x),y:parseFloat(y)})}),Vertices$c.create(points,body)},Vertices$c.centre=function(vertices){for(var temp,j,area=Vertices$c.area(vertices,!0),centre={x:0,y:0},i=0;i<vertices.length;i++)j=(i+1)%vertices.length,temp=Vector$9.cross(vertices[i],vertices[j]),temp=Vector$9.mult(Vector$9.add(vertices[i],vertices[j]),temp),centre=Vector$9.add(centre,temp);return Vector$9.div(centre,6*area)},Vertices$c.mean=function(vertices){for(var average={x:0,y:0},i=0;i<vertices.length;i++)average.x+=vertices[i].x,average.y+=vertices[i].y;return Vector$9.div(average,vertices.length)},Vertices$c.area=function(vertices,signed){for(var area=0,j=vertices.length-1,i=0;i<vertices.length;i++)area+=(vertices[j].x-vertices[i].x)*(vertices[j].y+vertices[i].y),j=i;return signed?area/2:Math.abs(area)/2},Vertices$c.inertia=function(vertices,mass){for(var cross,j,numerator=0,denominator=0,v=vertices,n=0;n<v.length;n++)j=(n+1)%v.length,numerator+=(cross=Math.abs(Vector$9.cross(v[j],v[n])))*(Vector$9.dot(v[j],v[j])+Vector$9.dot(v[j],v[n])+Vector$9.dot(v[n],v[n])),denominator+=cross;return mass/6*(numerator/denominator)},Vertices$c.translate=function(vertices,vector,scalar){var i;if(scalar)for(i=0;i<vertices.length;i++)vertices[i].x+=vector.x*scalar,vertices[i].y+=vector.y*scalar;else for(i=0;i<vertices.length;i++)vertices[i].x+=vector.x,vertices[i].y+=vector.y;return vertices},Vertices$c.rotate=function(vertices,angle,point){if(0!==angle){for(var cos=Math.cos(angle),sin=Math.sin(angle),i=0;i<vertices.length;i++){var vertice=vertices[i],dx=vertice.x-point.x,dy=vertice.y-point.y;vertice.x=point.x+(dx*cos-dy*sin),vertice.y=point.y+(dx*sin+dy*cos)}return vertices}},Vertices$c.contains=function(vertices,point){for(var i=0;i<vertices.length;i++){var vertice=vertices[i],nextVertice=vertices[(i+1)%vertices.length];if(0<(point.x-vertice.x)*(nextVertice.y-vertice.y)+(point.y-vertice.y)*(vertice.x-nextVertice.x))return!1}return!0},Vertices$c.scale=function(vertices,scaleX,scaleY,point){if(1===scaleX&&1===scaleY)return vertices;var delta;point=point||Vertices$c.centre(vertices);for(var i=0;i<vertices.length;i++)delta=vertices[i],delta=Vector$9.sub(delta,point),vertices[i].x=point.x+delta.x*scaleX,vertices[i].y=point.y+delta.y*scaleY;return vertices},Vertices$c.chamfer=function(vertices,radius,quality,qualityMin,qualityMax){radius="number"==typeof radius?[radius]:radius||[8],quality=void 0!==quality?quality:-1,qualityMin=qualityMin||2,qualityMax=qualityMax||14;for(var newVertices=[],i=0;i<vertices.length;i++){var diagonalRadius=vertices[0<=i-1?i-1:vertices.length-1],vertex=vertices[i],midNormal=vertices[(i+1)%vertices.length],currentRadius=radius[i<radius.length?i:radius.length-1];if(0!==currentRadius){var prevNormal=Vector$9.normalise({x:vertex.y-diagonalRadius.y,y:diagonalRadius.x-vertex.x}),nextNormal=Vector$9.normalise({x:midNormal.y-vertex.y,y:vertex.x-midNormal.x}),diagonalRadius=Math.sqrt(2*Math.pow(currentRadius,2)),radiusVector=Vector$9.mult(Common$i.clone(prevNormal),currentRadius),midNormal=Vector$9.normalise(Vector$9.mult(Vector$9.add(prevNormal,nextNormal),.5)),scaledVertex=Vector$9.sub(vertex,Vector$9.mult(midNormal,diagonalRadius)),precision=quality;-1===quality&&(precision=1.75*Math.pow(currentRadius,.32)),(precision=Common$i.clamp(precision,qualityMin,qualityMax))%2==1&&(precision+=1);for(var theta=Math.acos(Vector$9.dot(prevNormal,nextNormal))/precision,j=0;j<precision;j++)newVertices.push(Vector$9.add(Vector$9.rotate(radiusVector,theta*j),scaledVertex))}else newVertices.push(vertex)}return newVertices},Vertices$c.clockwiseSort=function(vertices){var centre=Vertices$c.mean(vertices);return vertices.sort(function(vertexA,vertexB){return Vector$9.angle(centre,vertexA)-Vector$9.angle(centre,vertexB)}),vertices},Vertices$c.isConvex=function(vertices){var i,j,k,z,flag=0,n=vertices.length;if(n<3)return null;for(i=0;i<n;i++)if(z=(vertices[j=(i+1)%n].x-vertices[i].x)*(vertices[k=(i+2)%n].y-vertices[j].y),(z-=(vertices[j].y-vertices[i].y)*(vertices[k].x-vertices[j].x))<0?flag|=1:0<z&&(flag|=2),3===flag)return!1;return 0!==flag||null},Vertices$c.hull=function(vertices){var vertex,i,upper=[],lower=[];for((vertices=vertices.slice(0)).sort(function(vertexA,vertexB){var dx=vertexA.x-vertexB.x;return 0!=dx?dx:vertexA.y-vertexB.y}),i=0;i<vertices.length;i+=1){for(vertex=vertices[i];2<=lower.length&&Vector$9.cross3(lower[lower.length-2],lower[lower.length-1],vertex)<=0;)lower.pop();lower.push(vertex)}for(i=vertices.length-1;0<=i;--i){for(vertex=vertices[i];2<=upper.length&&Vector$9.cross3(upper[upper.length-2],upper[upper.length-1],vertex)<=0;)upper.pop();upper.push(vertex)}return upper.pop(),lower.pop(),upper.concat(lower)};var SAT_1={},Events_1=SAT_1,Common$h=Common_1;SAT_1.on=function(object,eventNames,callback){for(var name,names=eventNames.split(" "),i=0;i<names.length;i++)name=names[i],object.events=object.events||{},object.events[name]=object.events[name]||[],object.events[name].push(callback);return callback},SAT_1.off=function(object,eventNames,callback){if(eventNames){"function"==typeof eventNames&&(callback=eventNames,eventNames=Common$h.keys(object.events).join(" "));for(var names=eventNames.split(" "),i=0;i<names.length;i++){var callbacks=object.events[names[i]],newCallbacks=[];if(callback&&callbacks)for(var j=0;j<callbacks.length;j++)callbacks[j]!==callback&&newCallbacks.push(callbacks[j]);object.events[names[i]]=newCallbacks}}else object.events={}},SAT_1.trigger=function(object,eventNames,event){var name,callbacks,eventClone,events=object.events;if(events&&0<Common$h.keys(events).length){event=event||{};for(var names=eventNames.split(" "),i=0;i<names.length;i++)if(callbacks=events[name=names[i]]){(eventClone=Common$h.clone(event,!1)).name=name,eventClone.source=object;for(var j=0;j<callbacks.length;j++)callbacks[j].apply(object,[eventClone])}}};var Sleeping$5={},MatterWrap_1=Sleeping$5,Events$8=Events_1;Sleeping$5._motionWakeThreshold=.18,Sleeping$5._motionSleepThreshold=.08,Sleeping$5._minBias=.9,Sleeping$5.update=function(bodies,timeScale){for(var timeFactor=timeScale*timeScale*timeScale,i=0;i<bodies.length;i++){var minMotion,body=bodies[i],maxMotion=body.speed*body.speed+body.angularSpeed*body.angularSpeed;0===body.force.x&&0===body.force.y?(minMotion=Math.min(body.motion,maxMotion),maxMotion=Math.max(body.motion,maxMotion),body.motion=Sleeping$5._minBias*minMotion+(1-Sleeping$5._minBias)*maxMotion,0<body.sleepThreshold&&body.motion<Sleeping$5._motionSleepThreshold*timeFactor?(body.sleepCounter+=1,body.sleepCounter>=body.sleepThreshold&&Sleeping$5.set(body,!0)):0<body.sleepCounter&&--body.sleepCounter):Sleeping$5.set(body,!1)}},Sleeping$5.afterCollisions=function(pairs,timeScale){for(var timeFactor=timeScale*timeScale*timeScale,i=0;i<pairs.length;i++){var bodyA,sleepingBody,bodyB=pairs[i];bodyB.isActive&&(bodyA=(sleepingBody=bodyB.collision).bodyA.parent,bodyB=sleepingBody.bodyB.parent,bodyA.isSleeping&&bodyB.isSleeping||bodyA.isStatic||bodyB.isStatic||!bodyA.isSleeping&&!bodyB.isSleeping||!(sleepingBody=bodyA.isSleeping&&!bodyA.isStatic?bodyA:bodyB).isStatic&&(sleepingBody===bodyA?bodyB:bodyA).motion>Sleeping$5._motionWakeThreshold*timeFactor&&Sleeping$5.set(sleepingBody,!1))}},Sleeping$5.set=function(body,isSleeping){var wasSleeping=body.isSleeping;isSleeping?(body.isSleeping=!0,body.sleepCounter=body.sleepThreshold,body.positionImpulse.x=0,body.positionImpulse.y=0,body.positionPrev.x=body.position.x,body.positionPrev.y=body.position.y,body.anglePrev=body.angle,body.speed=0,body.angularSpeed=0,body.motion=0,wasSleeping||Events$8.trigger(body,"sleepStart")):(body.isSleeping=!1,body.sleepCounter=0,wasSleeping&&Events$8.trigger(body,"sleepEnd"))};var Bounds$9={},Bounds_1=Bounds$9;Bounds$9.create=function(vertices){var bounds={min:{x:0,y:0},max:{x:0,y:0}};return vertices&&Bounds$9.update(bounds,vertices),bounds},Bounds$9.update=function(bounds,vertices,velocity){bounds.min.x=1/0,bounds.max.x=-1/0,bounds.min.y=1/0,bounds.max.y=-1/0;for(var i=0;i<vertices.length;i++){var vertex=vertices[i];vertex.x>bounds.max.x&&(bounds.max.x=vertex.x),vertex.x<bounds.min.x&&(bounds.min.x=vertex.x),vertex.y>bounds.max.y&&(bounds.max.y=vertex.y),vertex.y<bounds.min.y&&(bounds.min.y=vertex.y)}velocity&&(0<velocity.x?bounds.max.x+=velocity.x:bounds.min.x+=velocity.x,0<velocity.y?bounds.max.y+=velocity.y:bounds.min.y+=velocity.y)},Bounds$9.contains=function(bounds,point){return point.x>=bounds.min.x&&point.x<=bounds.max.x&&point.y>=bounds.min.y&&point.y<=bounds.max.y},Bounds$9.overlaps=function(boundsA,boundsB){return boundsA.min.x<=boundsB.max.x&&boundsA.max.x>=boundsB.min.x&&boundsA.max.y>=boundsB.min.y&&boundsA.min.y<=boundsB.max.y},Bounds$9.translate=function(bounds,vector){bounds.min.x+=vector.x,bounds.max.x+=vector.x,bounds.min.y+=vector.y,bounds.max.y+=vector.y},Bounds$9.shift=function(bounds,position){var deltaX=bounds.max.x-bounds.min.x,deltaY=bounds.max.y-bounds.min.y;bounds.min.x=position.x,bounds.max.x=position.x+deltaX,bounds.min.y=position.y,bounds.max.y=position.y+deltaY};var Pair_1={},Axes_1=Pair_1,Vector$8=Vector_1,Common$g=Common_1;Pair_1.fromVertices=function(vertices){for(var axes={},i=0;i<vertices.length;i++){var normal=(i+1)%vertices.length,normal=Vector$8.normalise({x:vertices[normal].y-vertices[i].y,y:vertices[i].x-vertices[normal].x});axes[(0===normal.y?1/0:normal.x/normal.y).toFixed(3).toString()]=normal}return Common$g.values(axes)},Pair_1.rotate=function(axes,angle){if(0!==angle)for(var cos=Math.cos(angle),sin=Math.sin(angle),i=0;i<axes.length;i++){var axis=axes[i],xx=axis.x*cos-axis.y*sin;axis.y=axis.x*sin+axis.y*cos,axis.x=xx}};var Body$f={},Body_1=Body$f,Vertices$b=MatterPhysics,Vector$7=Vector_1,Sleeping$4=MatterWrap_1,Common$f=Common_1,Bounds$8=Bounds_1,Axes$2=Axes_1;!function(){Body$f._inertiaScale=4,Body$f._nextCollidingGroupId=1,Body$f._nextNonCollidingGroupId=-1,Body$f._nextCategory=1,Body$f.create=function(options){var body={id:Common$f.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:null,position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},previousPositionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inverseMass:0,inertia:0,inverseInertia:0,_original:null,render:{visible:!0,opacity:1,sprite:{xOffset:0,yOffset:0},fillColor:null,fillOpacity:null,lineColor:null,lineOpacity:null,lineThickness:null},gameObject:null,scale:{x:1,y:1},centerOfMass:{x:0,y:0},centerOffset:{x:0,y:0},gravityScale:{x:1,y:1},ignoreGravity:!1,ignorePointer:!1,onCollideCallback:null,onCollideEndCallback:null,onCollideActiveCallback:null,onCollideWith:{}};!options.hasOwnProperty("position")&&options.hasOwnProperty("vertices")?options.position=Vertices$b.centre(options.vertices):options.hasOwnProperty("vertices")||(body.vertices=Vertices$b.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"));body=Common$f.extend(body,options);return _initProperties(body,options),body.setOnCollideWith=function(body,callback){return callback?this.onCollideWith[body.id]=callback:delete this.onCollideWith[body.id],this},body},Body$f.nextGroup=function(isNonColliding){return isNonColliding?Body$f._nextNonCollidingGroupId--:Body$f._nextCollidingGroupId++},Body$f.nextCategory=function(){return Body$f._nextCategory=Body$f._nextCategory<<1,Body$f._nextCategory};var _initProperties=function(body,bodyHeight){bodyHeight=bodyHeight||{},Body$f.set(body,{bounds:body.bounds||Bounds$8.create(body.vertices),positionPrev:body.positionPrev||Vector$7.clone(body.position),anglePrev:body.anglePrev||body.angle,vertices:body.vertices,parts:body.parts||[body],isStatic:body.isStatic,isSleeping:body.isSleeping,parent:body.parent||body});var centerOfMass,centerOffset,bodyWidth,bounds=body.bounds;Vertices$b.rotate(body.vertices,body.angle,body.position),Axes$2.rotate(body.axes,body.angle),Bounds$8.update(bounds,body.vertices,body.velocity),Body$f.set(body,{axes:bodyHeight.axes||body.axes,area:bodyHeight.area||body.area,mass:bodyHeight.mass||body.mass,inertia:bodyHeight.inertia||body.inertia}),1===body.parts.length&&(centerOfMass=body.centerOfMass,centerOffset=body.centerOffset,bodyWidth=bounds.max.x-bounds.min.x,bodyHeight=bounds.max.y-bounds.min.y,centerOfMass.x=-(bounds.min.x-body.position.x)/bodyWidth,centerOfMass.y=-(bounds.min.y-body.position.y)/bodyHeight,centerOffset.x=bodyWidth*centerOfMass.x,centerOffset.y=bodyHeight*centerOfMass.y)};Body$f.set=function(body,settings,value){for(var property in"string"==typeof settings&&(property=settings,(settings={})[property]=value),settings)if(Object.prototype.hasOwnProperty.call(settings,property))switch(value=settings[property],property){case"isStatic":Body$f.setStatic(body,value);break;case"isSleeping":Sleeping$4.set(body,value);break;case"mass":Body$f.setMass(body,value);break;case"density":Body$f.setDensity(body,value);break;case"inertia":Body$f.setInertia(body,value);break;case"vertices":Body$f.setVertices(body,value);break;case"position":Body$f.setPosition(body,value);break;case"angle":Body$f.setAngle(body,value);break;case"velocity":Body$f.setVelocity(body,value);break;case"angularVelocity":Body$f.setAngularVelocity(body,value);break;case"parts":Body$f.setParts(body,value);break;case"centre":Body$f.setCentre(body,value);break;default:body[property]=value}},Body$f.setStatic=function(body,isStatic){for(var i=0;i<body.parts.length;i++){var part=body.parts[i];(part.isStatic=isStatic)?(part._original={restitution:part.restitution,friction:part.friction,mass:part.mass,inertia:part.inertia,density:part.density,inverseMass:part.inverseMass,inverseInertia:part.inverseInertia},part.restitution=0,part.friction=1,part.mass=part.inertia=part.density=1/0,part.inverseMass=part.inverseInertia=0,part.positionPrev.x=part.position.x,part.positionPrev.y=part.position.y,part.anglePrev=part.angle,part.angularVelocity=0,part.speed=0,part.angularSpeed=0,part.motion=0):part._original&&(part.restitution=part._original.restitution,part.friction=part._original.friction,part.mass=part._original.mass,part.inertia=part._original.inertia,part.density=part._original.density,part.inverseMass=part._original.inverseMass,part.inverseInertia=part._original.inverseInertia,part._original=null)}},Body$f.setMass=function(body,mass){var moment=body.inertia/(body.mass/6);body.inertia=mass/6*moment,body.inverseInertia=1/body.inertia,body.mass=mass,body.inverseMass=1/body.mass,body.density=body.mass/body.area},Body$f.setDensity=function(body,density){Body$f.setMass(body,density*body.area),body.density=density},Body$f.setInertia=function(body,inertia){body.inertia=inertia,body.inverseInertia=1/body.inertia},Body$f.setVertices=function(body,centre){centre[0].body===body?body.vertices=centre:body.vertices=Vertices$b.create(centre,body),body.axes=Axes$2.fromVertices(body.vertices),body.area=Vertices$b.area(body.vertices),Body$f.setMass(body,body.density*body.area);centre=Vertices$b.centre(body.vertices);Vertices$b.translate(body.vertices,centre,-1),Body$f.setInertia(body,Body$f._inertiaScale*Vertices$b.inertia(body.vertices,body.mass)),Vertices$b.translate(body.vertices,body.position),Bounds$8.update(body.bounds,body.vertices,body.velocity)},Body$f.setParts=function(body,parts,bounds){for(parts=parts.slice(0),body.parts.length=0,body.parts.push(body),body.parent=body,i=0;i<parts.length;i++){var part=parts[i];part!==body&&(part.parent=body).parts.push(part)}if(1!==body.parts.length){if(bounds=void 0===bounds||bounds){for(var vertices=[],i=0;i<parts.length;i++)vertices=vertices.concat(parts[i].vertices);Vertices$b.clockwiseSort(vertices);var centerOfMass=Vertices$b.hull(vertices),centerOffset=Vertices$b.centre(centerOfMass);Body$f.setVertices(body,centerOfMass),Vertices$b.translate(body.vertices,centerOffset)}var total=Body$f._totalProperties(body),cx=total.centre.x,cy=total.centre.y,bounds=body.bounds,centerOfMass=body.centerOfMass,centerOffset=body.centerOffset;Bounds$8.update(bounds,body.vertices,body.velocity),centerOfMass.x=-(bounds.min.x-cx)/(bounds.max.x-bounds.min.x),centerOfMass.y=-(bounds.min.y-cy)/(bounds.max.y-bounds.min.y),centerOffset.x=cx,centerOffset.y=cy,body.area=total.area,(body.parent=body).position.x=cx,body.position.y=cy,body.positionPrev.x=cx,body.positionPrev.y=cy,Body$f.setMass(body,total.mass),Body$f.setInertia(body,total.inertia),Body$f.setPosition(body,total.centre)}},Body$f.setCentre=function(body,centre,relative){relative?(body.positionPrev.x+=centre.x,body.positionPrev.y+=centre.y,body.position.x+=centre.x,body.position.y+=centre.y):(body.positionPrev.x=centre.x-(body.position.x-body.positionPrev.x),body.positionPrev.y=centre.y-(body.position.y-body.positionPrev.y),body.position.x=centre.x,body.position.y=centre.y)},Body$f.setPosition=function(body,position){var delta=Vector$7.sub(position,body.position);body.positionPrev.x+=delta.x,body.positionPrev.y+=delta.y;for(var i=0;i<body.parts.length;i++){var part=body.parts[i];part.position.x+=delta.x,part.position.y+=delta.y,Vertices$b.translate(part.vertices,delta),Bounds$8.update(part.bounds,part.vertices,body.velocity)}},Body$f.setAngle=function(body,angle){var delta=angle-body.angle;body.anglePrev+=delta;for(var i=0;i<body.parts.length;i++){var part=body.parts[i];part.angle+=delta,Vertices$b.rotate(part.vertices,delta,body.position),Axes$2.rotate(part.axes,delta),Bounds$8.update(part.bounds,part.vertices,body.velocity),0<i&&Vector$7.rotateAbout(part.position,delta,body.position,part.position)}},Body$f.setVelocity=function(body,velocity){body.positionPrev.x=body.position.x-velocity.x,body.positionPrev.y=body.position.y-velocity.y,body.velocity.x=velocity.x,body.velocity.y=velocity.y,body.speed=Vector$7.magnitude(body.velocity)},Body$f.setAngularVelocity=function(body,velocity){body.anglePrev=body.angle-velocity,body.angularVelocity=velocity,body.angularSpeed=Math.abs(body.angularVelocity)},Body$f.translate=function(body,translation){Body$f.setPosition(body,Vector$7.add(body.position,translation))},Body$f.rotate=function(body,rotation,point){var cos,sin,dx,dy;point&&(cos=Math.cos(rotation),sin=Math.sin(rotation),dx=body.position.x-point.x,dy=body.position.y-point.y,Body$f.setPosition(body,{x:point.x+(dx*cos-dy*sin),y:point.y+(dx*sin+dy*cos)})),Body$f.setAngle(body,body.angle+rotation)},Body$f.scale=function(body,scaleX,scaleY,point){var totalArea=0,totalInertia=0;point=point||body.position;for(var i=0;i<body.parts.length;i++){var part=body.parts[i];part.scale.x=scaleX,part.scale.y=scaleY,Vertices$b.scale(part.vertices,scaleX,scaleY,point),part.axes=Axes$2.fromVertices(part.vertices),part.area=Vertices$b.area(part.vertices),Body$f.setMass(part,body.density*part.area),Vertices$b.translate(part.vertices,{x:-part.position.x,y:-part.position.y}),Body$f.setInertia(part,Body$f._inertiaScale*Vertices$b.inertia(part.vertices,part.mass)),Vertices$b.translate(part.vertices,{x:part.position.x,y:part.position.y}),0<i&&(totalArea+=part.area,totalInertia+=part.inertia),part.position.x=point.x+(part.position.x-point.x)*scaleX,part.position.y=point.y+(part.position.y-point.y)*scaleY,Bounds$8.update(part.bounds,part.vertices,body.velocity)}1<body.parts.length&&(body.area=totalArea,body.isStatic||(Body$f.setMass(body,body.density*totalArea),Body$f.setInertia(body,totalInertia))),body.circleRadius&&(scaleX===scaleY?body.circleRadius*=scaleX:body.circleRadius=null)},Body$f.update=function(body,velocityPrevX,velocityPrevY,correction){var deltaTimeSquared=Math.pow(velocityPrevX*velocityPrevY*body.timeScale,2),frictionAir=1-body.frictionAir*velocityPrevY*body.timeScale,velocityPrevX=body.position.x-body.positionPrev.x,velocityPrevY=body.position.y-body.positionPrev.y;body.velocity.x=velocityPrevX*frictionAir*correction+body.force.x/body.mass*deltaTimeSquared,body.velocity.y=velocityPrevY*frictionAir*correction+body.force.y/body.mass*deltaTimeSquared,body.positionPrev.x=body.position.x,body.positionPrev.y=body.position.y,body.position.x+=body.velocity.x,body.position.y+=body.velocity.y,body.angularVelocity=(body.angle-body.anglePrev)*frictionAir*correction+body.torque/body.inertia*deltaTimeSquared,body.anglePrev=body.angle,body.angle+=body.angularVelocity,body.speed=Vector$7.magnitude(body.velocity),body.angularSpeed=Math.abs(body.angularVelocity);for(var i=0;i<body.parts.length;i++){var part=body.parts[i];Vertices$b.translate(part.vertices,body.velocity),0<i&&(part.position.x+=body.velocity.x,part.position.y+=body.velocity.y),0!==body.angularVelocity&&(Vertices$b.rotate(part.vertices,body.angularVelocity,body.position),Axes$2.rotate(part.axes,body.angularVelocity),0<i&&Vector$7.rotateAbout(part.position,body.angularVelocity,body.position,part.position)),Bounds$8.update(part.bounds,part.vertices,body.velocity)}},Body$f.applyForce=function(body,offset_y,force){body.force.x+=force.x,body.force.y+=force.y;var offset_x=offset_y.x-body.position.x,offset_y=offset_y.y-body.position.y;body.torque+=offset_x*force.y-offset_y*force.x},Body$f._totalProperties=function(body){for(var properties={mass:0,area:0,inertia:0,centre:{x:0,y:0}},i=1===body.parts.length?0:1;i<body.parts.length;i++){var part=body.parts[i],mass=part.mass!==1/0?part.mass:1;properties.mass+=mass,properties.area+=part.area,properties.inertia+=part.inertia,properties.centre=Vector$7.add(properties.centre,Vector$7.mult(part.position,mass))}return properties.centre=Vector$7.div(properties.centre,properties.mass),properties}}();var Body$e=Body_1,CustomMain={applyForce:function(force){return this._tempVec2.set(this.body.position.x,this.body.position.y),Body$e.applyForce(this.body,this._tempVec2,force),this},applyForceFrom:function(position,force){return Body$e.applyForce(this.body,position,force),this},thrust:function(speed){var angle=this.body.angle;return this._tempVec2.set(speed*Math.cos(angle),speed*Math.sin(angle)),Body$e.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this},thrustLeft:function(speed){var angle=this.body.angle-Math.PI/2;return this._tempVec2.set(speed*Math.cos(angle),speed*Math.sin(angle)),Body$e.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this},thrustRight:function(speed){var angle=this.body.angle+Math.PI/2;return this._tempVec2.set(speed*Math.cos(angle),speed*Math.sin(angle)),Body$e.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this},thrustBack:function(speed){var angle=this.body.angle-Math.PI;return this._tempVec2.set(speed*Math.cos(angle),speed*Math.sin(angle)),Body$e.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this}},World_1$1={setFriction:function(value,air,fstatic){return this.body.friction=value,void 0!==air&&(this.body.frictionAir=air),void 0!==fstatic&&(this.body.frictionStatic=fstatic),this},setFrictionAir:function(value){return this.body.frictionAir=value,this},setFrictionStatic:function(value){return this.body.frictionStatic=value,this}},Grid_1={setIgnoreGravity:function(value){return this.body.ignoreGravity=value,this}},Body$d=Body_1,Vector2$i=BuildTilesetIndex_1,Pairs_1={setMass:function(value){return Body$d.setMass(this.body,value),this},setDensity:function(value){return Body$d.setDensity(this.body,value),this},centerOfMass:{get:function(){return new Vector2$i(this.body.centerOfMass.x,this.body.centerOfMass.y)}}},Query_1={setSensor:function(value){return this.body.isSensor=value,this},isSensor:function(){return this.body.isSensor}},physics={decomp:function(polygon){var edges=function polygonGetCutEdges(polygon){var min=[],tmp1=[],tmp2=[],tmpPoly=[];var nDiags=Number.MAX_VALUE;for(var i=0;i<polygon.length;++i)if(polygonIsReflex(polygon,i))for(var j=0;j<polygon.length;++j)if(polygonCanSee(polygon,i,j)){tmp1=polygonGetCutEdges(polygonCopy(polygon,i,j,tmpPoly)),tmp2=polygonGetCutEdges(polygonCopy(polygon,j,i,tmpPoly));for(var k=0;k<tmp2.length;k++)tmp1.push(tmp2[k]);tmp1.length<nDiags&&(nDiags=(min=tmp1).length,min.push([polygonAt(polygon,i),polygonAt(polygon,j)]))}return min}(polygon);return 0<edges.length?function polygonSlice(polygon,cutEdges){if(0===cutEdges.length)return[polygon];{if(cutEdges instanceof Array&&cutEdges.length&&cutEdges[0]instanceof Array&&2===cutEdges[0].length&&cutEdges[0][0]instanceof Array){for(var polys=[polygon],i=0;i<cutEdges.length;i++)for(var cutEdge=cutEdges[i],j=0;j<polys.length;j++){var result=polys[j],result=polygonSlice(result,cutEdge);if(result){polys.splice(j,1),polys.push(result[0],result[1]);break}}return polys}cutEdge=cutEdges,i=polygon.indexOf(cutEdge[0]),j=polygon.indexOf(cutEdge[1]);return-1!==i&&-1!==j&&[polygonCopy(polygon,i,j),polygonCopy(polygon,j,i)]}}(polygon,edges):[polygon]},quickDecomp:function polygonQuickDecomp(polygon,result,reflexVertices,steinerPoints,delta,maxlevel,level){maxlevel=maxlevel||100;level=level||0;delta=delta||25;result=void 0!==result?result:[];reflexVertices=reflexVertices||[];steinerPoints=steinerPoints||[];var upperInt=[0,0],lowerInt=[0,0],p=[0,0];var upperDist=0,lowerDist=0,d=0,closestDist=0;var upperIndex=0,lowerIndex=0,closestIndex=0;var lowerPoly=[],upperPoly=[];var poly=polygon,v=polygon;if(v.length<3)return result;level++;if(maxlevel<level)return console.warn("quickDecomp: max level ("+maxlevel+") reached."),result;for(var i=0;i<polygon.length;++i)if(polygonIsReflex(poly,i)){reflexVertices.push(poly[i]),upperDist=lowerDist=Number.MAX_VALUE;for(var j=0;j<polygon.length;++j)isLeft(polygonAt(poly,i-1),polygonAt(poly,i),polygonAt(poly,j))&&isRightOn(polygonAt(poly,i-1),polygonAt(poly,i),polygonAt(poly,j-1))&&(p=getIntersectionPoint(polygonAt(poly,i-1),polygonAt(poly,i),polygonAt(poly,j),polygonAt(poly,j-1)),isRight(polygonAt(poly,i+1),polygonAt(poly,i),p)&&(d=sqdist(poly[i],p))<lowerDist&&(lowerDist=d,lowerInt=p,lowerIndex=j)),isLeft(polygonAt(poly,i+1),polygonAt(poly,i),polygonAt(poly,j+1))&&isRightOn(polygonAt(poly,i+1),polygonAt(poly,i),polygonAt(poly,j))&&(p=getIntersectionPoint(polygonAt(poly,i+1),polygonAt(poly,i),polygonAt(poly,j),polygonAt(poly,j+1)),isLeft(polygonAt(poly,i-1),polygonAt(poly,i),p)&&(d=sqdist(poly[i],p))<upperDist&&(upperDist=d,upperInt=p,upperIndex=j));if(lowerIndex===(upperIndex+1)%polygon.length)p[0]=(lowerInt[0]+upperInt[0])/2,p[1]=(lowerInt[1]+upperInt[1])/2,steinerPoints.push(p),i<upperIndex?(polygonAppend(lowerPoly,poly,i,upperIndex+1),lowerPoly.push(p),upperPoly.push(p),0!==lowerIndex&&polygonAppend(upperPoly,poly,lowerIndex,poly.length),polygonAppend(upperPoly,poly,0,i+1)):(0!==i&&polygonAppend(lowerPoly,poly,i,poly.length),polygonAppend(lowerPoly,poly,0,upperIndex+1),lowerPoly.push(p),upperPoly.push(p),polygonAppend(upperPoly,poly,lowerIndex,i+1));else{if(upperIndex<lowerIndex&&(upperIndex+=polygon.length),closestDist=Number.MAX_VALUE,upperIndex<lowerIndex)return result;for(j=lowerIndex;j<=upperIndex;++j)isLeftOn(polygonAt(poly,i-1),polygonAt(poly,i),polygonAt(poly,j))&&isRightOn(polygonAt(poly,i+1),polygonAt(poly,i),polygonAt(poly,j))&&(d=sqdist(polygonAt(poly,i),polygonAt(poly,j)))<closestDist&&polygonCanSee2(poly,i,j)&&(closestDist=d,closestIndex=j%polygon.length);i<closestIndex?(polygonAppend(lowerPoly,poly,i,closestIndex+1),0!==closestIndex&&polygonAppend(upperPoly,poly,closestIndex,v.length),polygonAppend(upperPoly,poly,0,i+1)):(0!==i&&polygonAppend(lowerPoly,poly,i,v.length),polygonAppend(lowerPoly,poly,0,closestIndex+1),polygonAppend(upperPoly,poly,closestIndex,i+1))}return lowerPoly.length<upperPoly.length?(polygonQuickDecomp(lowerPoly,result,reflexVertices,steinerPoints,delta,maxlevel,level),polygonQuickDecomp(upperPoly,result,reflexVertices,steinerPoints,delta,maxlevel,level)):(polygonQuickDecomp(upperPoly,result,reflexVertices,steinerPoints,delta,maxlevel,level),polygonQuickDecomp(lowerPoly,result,reflexVertices,steinerPoints,delta,maxlevel,level)),result}result.push(polygon);return result},isSimple:function(polygon){var i,path=polygon;for(i=0;i<path.length-1;i++)for(var j=0;j<i-1;j++)if(lineSegmentsIntersect(path[i],path[i+1],path[j],path[j+1]))return!1;for(i=1;i<path.length-2;i++)if(lineSegmentsIntersect(path[0],path[path.length-1],path[i],path[i+1]))return!1;return!0},removeCollinearPoints:function(polygon,precision){for(var num=0,i=polygon.length-1;3<polygon.length&&0<=i;--i)!function(a,b,c,thresholdAngle){{if(thresholdAngle){var magA=tmpPoint1,magB=tmpPoint2;magA[0]=b[0]-a[0],magA[1]=b[1]-a[1],magB[0]=c[0]-b[0],magB[1]=c[1]-b[1];var dot=magA[0]*magB[0]+magA[1]*magB[1],magA=Math.sqrt(magA[0]*magA[0]+magA[1]*magA[1]),magB=Math.sqrt(magB[0]*magB[0]+magB[1]*magB[1]);return Math.acos(dot/(magA*magB))<thresholdAngle}return 0===triangleArea(a,b,c)}}(polygonAt(polygon,i-1),polygonAt(polygon,i),polygonAt(polygon,i+1),precision)||(polygon.splice(i%polygon.length,1),num++);return num},removeDuplicatePoints:function(polygon,precision){for(var i=polygon.length-1;1<=i;--i)for(var pi=polygon[i],j=i-1;0<=j;--j)!function(a,b,precision){return scalar_eq(a[0],b[0],precision)&&scalar_eq(a[1],b[1],precision)}(pi,polygon[j],precision)||polygon.splice(i,1)},makeCCW:function(polygon){for(var br=0,v=polygon,i=1;i<polygon.length;++i)(v[i][1]<v[br][1]||v[i][1]===v[br][1]&&v[i][0]>v[br][0])&&(br=i);return!isLeft(polygonAt(polygon,br-1),polygonAt(polygon,br),polygonAt(polygon,br+1))&&(function(polygon){for(var tmp=[],N=polygon.length,i=0;i!==N;i++)tmp.push(polygon.pop());for(i=0;i!==N;i++)polygon[i]=tmp[i]}(polygon),!0)}};function lineSegmentsIntersect(p1,db,q1,s){var dx=db[0]-p1[0],t=db[1]-p1[1],da=s[0]-q1[0],db=s[1]-q1[1];if(da*t-db*dx!=0){s=(dx*(q1[1]-p1[1])+t*(p1[0]-q1[0]))/(da*t-db*dx),t=(da*(p1[1]-q1[1])+db*(q1[0]-p1[0]))/(db*dx-da*t);return 0<=s&&s<=1&&0<=t&&t<=1}}function triangleArea(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(c[0]-a[0])*(b[1]-a[1])}function isLeft(a,b,c){return 0<triangleArea(a,b,c)}function isLeftOn(a,b,c){return 0<=triangleArea(a,b,c)}function isRight(a,b,c){return triangleArea(a,b,c)<0}function isRightOn(a,b,c){return triangleArea(a,b,c)<=0}var tmpPoint1=[],tmpPoint2=[];function sqdist(dy,b){var dx=b[0]-dy[0],dy=b[1]-dy[1];return dx*dx+dy*dy}function polygonAt(polygon,i){var s=polygon.length;return polygon[i<0?i%s+s:i%s]}function polygonAppend(polygon,poly,from,to){for(var i=from;i<to;i++)polygon.push(poly[i])}function polygonIsReflex(polygon,i){return isRight(polygonAt(polygon,i-1),polygonAt(polygon,i),polygonAt(polygon,i+1))}var tmpLine1=[],tmpLine2=[];function polygonCanSee(polygon,a,b){var p,l1=tmpLine1,l2=tmpLine2;if(!isLeftOn(polygonAt(polygon,a+1),polygonAt(polygon,a),polygonAt(polygon,b))||!isRightOn(polygonAt(polygon,a-1),polygonAt(polygon,a),polygonAt(polygon,b))){for(var dist=sqdist(polygonAt(polygon,a),polygonAt(polygon,b)),i=0;i!==polygon.length;++i)if((i+1)%polygon.length!==a&&i!==a&&isLeftOn(polygonAt(polygon,a),polygonAt(polygon,b),polygonAt(polygon,i+1))&&isRightOn(polygonAt(polygon,a),polygonAt(polygon,b),polygonAt(polygon,i))&&(l1[0]=polygonAt(polygon,a),l1[1]=polygonAt(polygon,b),l2[0]=polygonAt(polygon,i),l2[1]=polygonAt(polygon,i+1),p=function(c2,det,precision){var i=[0,0],a1=c2[1][1]-c2[0][1],b1=c2[0][0]-c2[1][0],c1=a1*c2[0][0]+b1*c2[0][1],a2=det[1][1]-det[0][1],b2=det[0][0]-det[1][0],c2=a2*det[0][0]+b2*det[0][1];return scalar_eq(det=a1*b2-a2*b1,0,precision=precision||0)||(i[0]=(b2*c1-b1*c2)/det,i[1]=(a1*c2-a2*c1)/det),i}(l1,l2),sqdist(polygonAt(polygon,a),p)<dist))return;return 1}}function polygonCanSee2(polygon,a,b){for(var i=0;i!==polygon.length;++i)if(i!==a&&i!==b&&(i+1)%polygon.length!==a&&(i+1)%polygon.length!==b&&lineSegmentsIntersect(polygonAt(polygon,a),polygonAt(polygon,b),polygonAt(polygon,i),polygonAt(polygon,i+1)))return;return 1}function polygonCopy(polygon,i,j,targetPoly){var p=targetPoly||[];if(p.length=0,i<j)for(var k=i;k<=j;k++)p.push(polygon[k]);else{for(k=0;k<=j;k++)p.push(polygon[k]);for(k=i;k<polygon.length;k++)p.push(polygon[k])}return p}function getIntersectionPoint(b2,a2,det,c2,delta){var a1=a2[1]-b2[1],b1=b2[0]-a2[0],c1=a1*b2[0]+b1*b2[1],a2=c2[1]-det[1],b2=det[0]-c2[0],c2=a2*det[0]+b2*det[1],det=a1*b2-a2*b1;return scalar_eq(det,0,delta=delta||0)?[0,0]:[(b2*c1-b1*c2)/det,(a1*c2-a2*c1)/det]}function scalar_eq(a,b,precision){return precision=precision||0,Math.abs(a-b)<=precision}var Bodies$9={},Bodies_1=Bodies$9,Vertices$a=MatterPhysics,Common$e=Common_1,Body$c=Body_1,Bounds$7=Bounds_1,Vector$6=Vector_1,decomp=physics;Bodies$9.rectangle=function(x,y,rectangle,chamfer,options){options=options||{};rectangle={label:"Rectangle Body",position:{x:x,y:y},vertices:Vertices$a.fromPath("L 0 0 L "+rectangle+" 0 L "+rectangle+" "+chamfer+" L 0 "+chamfer)};return options.chamfer&&(chamfer=options.chamfer,rectangle.vertices=Vertices$a.chamfer(rectangle.vertices,chamfer.radius,chamfer.quality,chamfer.qualityMin,chamfer.qualityMax),delete options.chamfer),Body$c.create(Common$e.extend({},rectangle,options))},Bodies$9.trapezoid=function(x,trapezoid,chamfer,height,slope,options){options=options||{};var x1=chamfer*(slope*=.5),x2=x1+(1-2*slope)*chamfer,chamfer=x2+x1,chamfer=slope<.5?"L 0 0 L "+x1+" "+-height+" L "+x2+" "+-height+" L "+chamfer+" 0":"L 0 0 L "+x2+" "+-height+" L "+chamfer+" 0",trapezoid={label:"Trapezoid Body",position:{x:x,y:trapezoid},vertices:Vertices$a.fromPath(chamfer)};return options.chamfer&&(chamfer=options.chamfer,trapezoid.vertices=Vertices$a.chamfer(trapezoid.vertices,chamfer.radius,chamfer.quality,chamfer.qualityMin,chamfer.qualityMax),delete options.chamfer),Body$c.create(Common$e.extend({},trapezoid,options))},Bodies$9.circle=function(x,y,radius,options,sides){options=options||{};var circle={label:"Circle Body",circleRadius:radius};sides=sides||25;sides=Math.ceil(Math.max(10,Math.min(sides,radius)));return sides%2==1&&(sides+=1),Bodies$9.polygon(x,y,sides,radius,Common$e.extend({},circle,options))},Bodies$9.polygon=function(polygon,chamfer,sides,radius,options){if(options=options||{},sides<3)return Bodies$9.circle(polygon,chamfer,radius,options);for(var theta=2*Math.PI/sides,path="",offset=.5*theta,i=0;i<sides;i+=1){var yy=offset+i*theta,xx=Math.cos(yy)*radius,yy=Math.sin(yy)*radius;path+="L "+xx.toFixed(3)+" "+yy.toFixed(3)+" "}polygon={label:"Polygon Body",position:{x:polygon,y:chamfer},vertices:Vertices$a.fromPath(path)};return options.chamfer&&(chamfer=options.chamfer,polygon.vertices=Vertices$a.chamfer(polygon.vertices,chamfer.radius,chamfer.quality,chamfer.qualityMin,chamfer.qualityMax),delete options.chamfer),Body$c.create(Common$e.extend({},polygon,options))},Bodies$9.fromVertices=function(x,y,vertexSets,options,body,removeCollinear,minimumArea){var parts,isConvex,v;for(options=options||{},parts=[],body=void 0!==body&&body,removeCollinear=void 0!==removeCollinear?removeCollinear:.01,minimumArea=void 0!==minimumArea?minimumArea:10,decomp||Common$e.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull."),Common$e.isArray(vertexSets[0])||(vertexSets=[vertexSets]),v=0;v<vertexSets.length;v+=1)if(concave=vertexSets[v],(isConvex=Vertices$a.isConvex(concave))||!decomp)concave=isConvex?Vertices$a.clockwiseSort(concave):Vertices$a.hull(concave),parts.push({position:{x:x,y:y},vertices:concave});else{var concave=concave.map(function(vertex){return[vertex.x,vertex.y]});decomp.makeCCW(concave),!1!==removeCollinear&&decomp.removeCollinearPoints(concave,removeCollinear);for(var decomposed=decomp.quickDecomp(concave),i=0;i<decomposed.length;i++){var chunkVertices=decomposed[i].map(function(vertices){return{x:vertices[0],y:vertices[1]}});0<minimumArea&&Vertices$a.area(chunkVertices)<minimumArea||parts.push({position:Vertices$a.centre(chunkVertices),vertices:chunkVertices})}}for(i=0;i<parts.length;i++)parts[i]=Body$c.create(Common$e.extend(parts[i],options));return body&&Bodies$9.flagCoincidentParts(parts,5),1<parts.length?(body=Body$c.create(Common$e.extend({parts:parts.slice(0)},options)),Body$c.setPosition(body,{x:x,y:y}),body):parts[0]},Bodies$9.flagCoincidentParts=function(parts,maxDistance){void 0===maxDistance&&(maxDistance=5);for(var i=0;i<parts.length;i++)for(var partA=parts[i],j=i+1;j<parts.length;j++){var partB=parts[j];if(Bounds$7.overlaps(partA.bounds,partB.bounds))for(var pav=partA.vertices,pbv=partB.vertices,k=0;k<partA.vertices.length;k++)for(var z=0;z<partB.vertices.length;z++){var da=Vector$6.magnitudeSquared(Vector$6.sub(pav[(k+1)%pav.length],pbv[z])),db=Vector$6.magnitudeSquared(Vector$6.sub(pav[k],pbv[(z+1)%pbv.length]));da<maxDistance&&db<maxDistance&&(pav[k].isInternal=!0,pbv[z].isInternal=!0)}}return parts};var Bodies$8=Bodies_1,Body$b=Body_1,Common$d=Common_1,GetFastValue$i=GetFastValue_1,Vertices$9=MatterPhysics,GetTargets_1={parseBody:function(x,y,body,options){void 0===options&&(options={});for(var fixtureConfigs=GetFastValue$i(body,"fixtures",[]),fixtures=[],fc=0;fc<fixtureConfigs.length;fc++)for(var fixtureParts=this.parseFixture(fixtureConfigs[fc]),i=0;i<fixtureParts.length;i++)fixtures.push(fixtureParts[i]);body=Common$d.clone(body,!0);Common$d.extend(body,options,!0),delete body.fixtures,delete body.type;body=Body$b.create(body);return Body$b.setParts(body,fixtures),Body$b.setPosition(body,{x:x,y:y}),body},parseFixture:function(fixtureConfig){var x,y,fixtures,matterConfig=Common$d.extend({},!1,fixtureConfig);return delete matterConfig.circle,delete matterConfig.vertices,fixtureConfig.circle?(x=GetFastValue$i(fixtureConfig.circle,"x"),y=GetFastValue$i(fixtureConfig.circle,"y"),fixtures=GetFastValue$i(fixtureConfig.circle,"radius"),fixtures=[Bodies$8.circle(x,y,fixtures,matterConfig)]):fixtureConfig.vertices&&(fixtures=this.parseVertices(fixtureConfig.vertices,matterConfig)),fixtures},parseVertices:function(vertexSets,options){void 0===options&&(options={});for(var parts=[],v=0;v<vertexSets.length;v++)Vertices$9.clockwiseSort(vertexSets[v]),parts.push(Body$b.create(Common$d.extend({position:Vertices$9.centre(vertexSets[v]),vertices:vertexSets[v]},options)));return Bodies$8.flagCoincidentParts(parts)}},Bodies$7=Bodies_1,Body$a=Body_1,IsInLayerBounds_1={parseBody:function(x,y,config,options){var body;void 0===options&&(options={});var vertexSets=config.vertices;if(1===vertexSets.length)options.vertices=vertexSets[0],body=Body$a.create(options),Bodies$7.flagCoincidentParts(body.parts);else{for(var parts=[],i=0;i<vertexSets.length;i++){var part=Body$a.create({vertices:vertexSets[i]});parts.push(part)}Bodies$7.flagCoincidentParts(parts),options.parts=parts,body=Body$a.create(options)}return body.label=config.label,Body$a.setPosition(body,{x:x,y:y}),body}},Bodies$6=Bodies_1,Body$9=Body_1,FuzzyEquals=Detector_1,GetFastValue$h=GetFastValue_1,PhysicsEditorParser$1=GetTargets_1,PhysicsJSONParser$1=IsInLayerBounds_1,Vertices$8=MatterPhysics,events$1={AFTER_ADD:"afteradd",AFTER_REMOVE:"afterremove",AFTER_UPDATE:"afterupdate",BEFORE_ADD:"beforeadd",BEFORE_REMOVE:"beforeremove",BEFORE_UPDATE:"beforeupdate",COLLISION_ACTIVE:"collisionactive",COLLISION_END:"collisionend",COLLISION_START:"collisionstart",DRAG_END:"dragend",DRAG:"drag",DRAG_START:"dragstart",PAUSE:"pause",RESUME:"resume",SLEEP_END:"sleepend",SLEEP_START:"sleepstart"},Events$7=events$1,Sleeping$3=MatterWrap_1,MatterEvents$1=Events_1,Body$8=Body_1,Body$7=Body_1,MATH_CONST$2=Tweens,WrapAngle=HasTileAt_1,WrapAngleDegrees=Factory_1,Body$6=Body_1,components$1={Bounce:PluginCache$3,Collision:Matter_1,Force:CustomMain,Friction:World_1$1,Gravity:Grid_1,Mass:Pairs_1,Sensor:Query_1,SetBody:{setRectangle:function(width,height,options){return this.setBody({type:"rectangle",width:width,height:height},options)},setCircle:function(radius,options){return this.setBody({type:"circle",radius:radius},options)},setPolygon:function(radius,sides,options){return this.setBody({type:"polygon",sides:sides,radius:radius},options)},setTrapezoid:function(width,height,slope,options){return this.setBody({type:"trapezoid",width:width,height:height,slope:slope},options)},setExistingBody:function(body,cy){void 0===cy&&(cy=!0),this.body&&this.world.remove(this.body,!0),this.body=body;for(var i=0;i<body.parts.length;i++)body.parts[i].gameObject=this;var rx,ry,cx,_this=this;return body.destroy=function(){_this.world.remove(_this.body,!0),_this.body.gameObject=null},cy&&(this.world.has(body)&&this.world.remove(body,!0),this.world.add(body)),this._originComponent&&(rx=body.render.sprite.xOffset,ry=body.render.sprite.yOffset,cx=body.centerOfMass.x,cy=body.centerOfMass.y,FuzzyEquals(cx,.5)&&FuzzyEquals(cy,.5)?this.setOrigin(rx+.5,ry+.5):(cx=body.centerOffset.x,cy=body.centerOffset.y,this.setOrigin(rx+cx/this.displayWidth,ry+cy/this.displayHeight))),this},setBody:function(config,options){if(!config)return this;var shapeType=GetFastValue$h(config="string"==typeof config?{type:config}:config,"type","rectangle"),bodyX=GetFastValue$h(config,"x",this._tempVec2.x),bodyY=GetFastValue$h(config,"y",this._tempVec2.y),bodyWidth=GetFastValue$h(config,"width",this.width),bodyHeight=GetFastValue$h(config,"height",this.height);switch(shapeType){case"rectangle":body=Bodies$6.rectangle(bodyX,bodyY,bodyWidth,bodyHeight,options);break;case"circle":var radius=GetFastValue$h(config,"radius",Math.max(bodyWidth,bodyHeight)/2),verts=GetFastValue$h(config,"maxSides",25),body=Bodies$6.circle(bodyX,bodyY,radius,options,verts);break;case"trapezoid":var flagInternal=GetFastValue$h(config,"slope",.5);body=Bodies$6.trapezoid(bodyX,bodyY,bodyWidth,bodyHeight,flagInternal,options);break;case"polygon":var removeCollinear=GetFastValue$h(config,"sides",5),minimumArea=GetFastValue$h(config,"radius",Math.max(bodyWidth,bodyHeight)/2);body=Bodies$6.polygon(bodyX,bodyY,removeCollinear,minimumArea,options);break;case"fromVertices":case"fromVerts":verts=GetFastValue$h(config,"verts",null);verts&&("string"==typeof verts&&(verts=Vertices$8.fromPath(verts)),body=this.body&&!this.body.hasOwnProperty("temp")?(Body$9.setVertices(this.body,verts),this.body):(flagInternal=GetFastValue$h(config,"flagInternal",!1),removeCollinear=GetFastValue$h(config,"removeCollinear",.01),minimumArea=GetFastValue$h(config,"minimumArea",10),Bodies$6.fromVertices(bodyX,bodyY,verts,options,flagInternal,removeCollinear,minimumArea)));break;case"fromPhysicsEditor":body=PhysicsEditorParser$1.parseBody(bodyX,bodyY,config,options);break;case"fromPhysicsTracer":body=PhysicsJSONParser$1.parseBody(bodyX,bodyY,config,options)}return body&&this.setExistingBody(body,config.addToWorld),this}},Sleep:{setToSleep:function(){return Sleeping$3.set(this.body,!0),this},setAwake:function(){return Sleeping$3.set(this.body,!1),this},setSleepThreshold:function(value){return this.body.sleepThreshold=value=void 0===value?60:value,this},setSleepEvents:function(start,end){return this.setSleepStartEvent(start),this.setSleepEndEvent(end),this},setSleepStartEvent:function(value){var world;return value?(world=this.world,MatterEvents$1.on(this.body,"sleepStart",function(event){world.emit(Events$7.SLEEP_START,event,this)})):MatterEvents$1.off(this.body,"sleepStart"),this},setSleepEndEvent:function(value){var world;return value?(world=this.world,MatterEvents$1.on(this.body,"sleepEnd",function(event){world.emit(Events$7.SLEEP_END,event,this)})):MatterEvents$1.off(this.body,"sleepEnd"),this}},Static:{setStatic:function(value){return Body$8.setStatic(this.body,value),this},isStatic:function(){return this.body.isStatic}},Transform:{x:{get:function(){return this.body.position.x},set:function(value){this._tempVec2.set(value,this.y),Body$7.setPosition(this.body,this._tempVec2)}},y:{get:function(){return this.body.position.y},set:function(value){this._tempVec2.set(this.x,value),Body$7.setPosition(this.body,this._tempVec2)}},scaleX:{get:function(){return this._scaleX},set:function(value){var factorX=1/this._scaleX,factorY=1/this._scaleY;this._scaleX=value,0===this._scaleX?this.renderFlags&=-5:this.renderFlags|=4,Body$7.scale(this.body,factorX,factorY),Body$7.scale(this.body,value,this._scaleY)}},scaleY:{get:function(){return this._scaleY},set:function(value){var factorX=1/this._scaleX,factorY=1/this._scaleY;this._scaleY=value,0===this._scaleY?this.renderFlags&=-5:this.renderFlags|=4,Body$7.scale(this.body,factorX,factorY),Body$7.scale(this.body,this._scaleX,value)}},angle:{get:function(){return WrapAngleDegrees(this.body.angle*MATH_CONST$2.RAD_TO_DEG)},set:function(value){this.rotation=WrapAngleDegrees(value)*MATH_CONST$2.DEG_TO_RAD}},rotation:{get:function(){return this.body.angle},set:function(value){this._rotation=WrapAngle(value),Body$7.setAngle(this.body,this._rotation)}},setPosition:function(x,y){return void 0===x&&(x=0),void 0===y&&(y=x),this._tempVec2.set(x,y),Body$7.setPosition(this.body,this._tempVec2),this},setRotation:function(radians){return this._rotation=WrapAngle(radians=void 0===radians?0:radians),Body$7.setAngle(this.body,radians),this},setFixedRotation:function(){return Body$7.setInertia(this.body,1/0),this},setAngle:function(degrees){return this.angle=degrees=void 0===degrees?0:degrees,Body$7.setAngle(this.body,this.rotation),this},setScale:function(x,y,point){void 0===x&&(x=1),void 0===y&&(y=x);var factorX=1/this._scaleX,factorY=1/this._scaleY;return this._scaleX=x,this._scaleY=y,Body$7.scale(this.body,factorX,factorY,point),Body$7.scale(this.body,x,y,point),this}},Velocity:{setAngularVelocity:function(value){return Body$6.setAngularVelocity(this.body,value),this},setVelocityX:function(x){return this._tempVec2.set(x,this.body.velocity.y),Body$6.setVelocity(this.body,this._tempVec2),this},setVelocityY:function(y){return this._tempVec2.set(this.body.velocity.x,y),Body$6.setVelocity(this.body,this._tempVec2),this},setVelocity:function(x,y){return this._tempVec2.set(x,y),Body$6.setVelocity(this.body,this._tempVec2),this}}},Composite$7={},Composite_1=Composite$7,Events$6=Events_1,Common$c=Common_1,Bounds$6=Bounds_1,Body$5=Body_1;Composite$7.create=function(options){return Common$c.extend({id:Common$c.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},options)},Composite$7.setModified=function(composite,isModified,updateParents,updateChildren){if(Events$6.trigger(composite,"compositeModified",composite),composite.isModified=isModified,updateParents&&composite.parent&&Composite$7.setModified(composite.parent,isModified,updateParents,updateChildren),updateChildren)for(var i=0;i<composite.composites.length;i++){var childComposite=composite.composites[i];Composite$7.setModified(childComposite,isModified,updateParents,updateChildren)}},Composite$7.add=function(composite,object){var objects=[].concat(object);Events$6.trigger(composite,"beforeAdd",{object:object});for(var i=0;i<objects.length;i++){var obj=objects[i];switch(obj.type){case"body":if(obj.parent!==obj){Common$c.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}Composite$7.addBody(composite,obj);break;case"constraint":Composite$7.addConstraint(composite,obj);break;case"composite":Composite$7.addComposite(composite,obj);break;case"mouseConstraint":Composite$7.addConstraint(composite,obj.constraint)}}return Events$6.trigger(composite,"afterAdd",{object:object}),composite},Composite$7.remove=function(composite,object,deep){var objects=[].concat(object);Events$6.trigger(composite,"beforeRemove",{object:object});for(var i=0;i<objects.length;i++){var obj=objects[i];switch(obj.type){case"body":Composite$7.removeBody(composite,obj,deep);break;case"constraint":Composite$7.removeConstraint(composite,obj,deep);break;case"composite":Composite$7.removeComposite(composite,obj,deep);break;case"mouseConstraint":Composite$7.removeConstraint(composite,obj.constraint)}}return Events$6.trigger(composite,"afterRemove",{object:object}),composite},Composite$7.addComposite=function(compositeA,compositeB){return compositeA.composites.push(compositeB),compositeB.parent=compositeA,Composite$7.setModified(compositeA,!0,!0,!1),compositeA},Composite$7.removeComposite=function(compositeA,compositeB,deep){var position=compositeA.composites.indexOf(compositeB);if(-1!==position&&(Composite$7.removeCompositeAt(compositeA,position),Composite$7.setModified(compositeA,!0,!0,!1)),deep)for(var i=0;i<compositeA.composites.length;i++)Composite$7.removeComposite(compositeA.composites[i],compositeB,!0);return compositeA},Composite$7.removeCompositeAt=function(composite,position){return composite.composites.splice(position,1),Composite$7.setModified(composite,!0,!0,!1),composite},Composite$7.addBody=function(composite,body){return composite.bodies.push(body),Composite$7.setModified(composite,!0,!0,!1),composite},Composite$7.removeBody=function(composite,body,deep){var position=composite.bodies.indexOf(body);if(-1!==position&&(Composite$7.removeBodyAt(composite,position),Composite$7.setModified(composite,!0,!0,!1)),deep)for(var i=0;i<composite.composites.length;i++)Composite$7.removeBody(composite.composites[i],body,!0);return composite},Composite$7.removeBodyAt=function(composite,position){return composite.bodies.splice(position,1),Composite$7.setModified(composite,!0,!0,!1),composite},Composite$7.addConstraint=function(composite,constraint){return composite.constraints.push(constraint),Composite$7.setModified(composite,!0,!0,!1),composite},Composite$7.removeConstraint=function(composite,constraint,deep){var position=composite.constraints.indexOf(constraint);if(-1!==position&&Composite$7.removeConstraintAt(composite,position),deep)for(var i=0;i<composite.composites.length;i++)Composite$7.removeConstraint(composite.composites[i],constraint,!0);return composite},Composite$7.removeConstraintAt=function(composite,position){return composite.constraints.splice(position,1),Composite$7.setModified(composite,!0,!0,!1),composite},Composite$7.clear=function(composite,keepStatic,deep){if(deep)for(var i=0;i<composite.composites.length;i++)Composite$7.clear(composite.composites[i],keepStatic,!0);return keepStatic?composite.bodies=composite.bodies.filter(function(body){return body.isStatic}):composite.bodies.length=0,composite.constraints.length=0,composite.composites.length=0,Composite$7.setModified(composite,!0,!0,!1),composite},Composite$7.allBodies=function(composite){for(var bodies=[].concat(composite.bodies),i=0;i<composite.composites.length;i++)bodies=bodies.concat(Composite$7.allBodies(composite.composites[i]));return bodies},Composite$7.allConstraints=function(composite){for(var constraints=[].concat(composite.constraints),i=0;i<composite.composites.length;i++)constraints=constraints.concat(Composite$7.allConstraints(composite.composites[i]));return constraints},Composite$7.allComposites=function(composite){for(var composites=[].concat(composite.composites),i=0;i<composite.composites.length;i++)composites=composites.concat(Composite$7.allComposites(composite.composites[i]));return composites},Composite$7.get=function(composite,id,object){var objects;switch(object){case"body":objects=Composite$7.allBodies(composite);break;case"constraint":objects=Composite$7.allConstraints(composite);break;case"composite":objects=Composite$7.allComposites(composite).concat(composite)}return!objects||0===(object=objects.filter(function(object){return object.id.toString()===id.toString()})).length?null:object[0]},Composite$7.move=function(compositeA,objects,compositeB){return Composite$7.remove(compositeA,objects),Composite$7.add(compositeB,objects),compositeA},Composite$7.rebase=function(composite){for(var objects=Composite$7.allBodies(composite).concat(Composite$7.allConstraints(composite)).concat(Composite$7.allComposites(composite)),i=0;i<objects.length;i++)objects[i].id=Common$c.nextId();return Composite$7.setModified(composite,!0,!0,!1),composite},Composite$7.translate=function(composite,translation,recursive){for(var bodies=recursive?Composite$7.allBodies(composite):composite.bodies,i=0;i<bodies.length;i++)Body$5.translate(bodies[i],translation);return Composite$7.setModified(composite,!0,!0,!1),composite},Composite$7.rotate=function(composite,rotation,point,recursive){for(var cos=Math.cos(rotation),sin=Math.sin(rotation),bodies=recursive?Composite$7.allBodies(composite):composite.bodies,i=0;i<bodies.length;i++){var body=bodies[i],dx=body.position.x-point.x,dy=body.position.y-point.y;Body$5.setPosition(body,{x:point.x+(dx*cos-dy*sin),y:point.y+(dx*sin+dy*cos)}),Body$5.rotate(body,rotation)}return Composite$7.setModified(composite,!0,!0,!1),composite},Composite$7.scale=function(composite,scaleX,scaleY,point,recursive){for(var bodies=recursive?Composite$7.allBodies(composite):composite.bodies,i=0;i<bodies.length;i++){var body=bodies[i],dx=body.position.x-point.x,dy=body.position.y-point.y;Body$5.setPosition(body,{x:point.x+dx*scaleX,y:point.y+dy*scaleY}),Body$5.scale(body,scaleX,scaleY)}return Composite$7.setModified(composite,!0,!0,!1),composite},Composite$7.bounds=function(composite){for(var bodies=Composite$7.allBodies(composite),vertices=[],i=0;i<bodies.length;i+=1){var body=bodies[i];vertices.push(body.bounds.min,body.bounds.max)}return Bounds$6.create(vertices)};var Constraint$5={},Constraint_1=Constraint$5,Vertices$7=MatterPhysics,Vector$5=Vector_1,Sleeping$2=MatterWrap_1,Bounds$5=Bounds_1,Axes$1=Axes_1,Common$b=Common_1;Constraint$5._warming=.4,Constraint$5._torqueDampen=1,Constraint$5._minLength=1e-6,Constraint$5.create=function(render){var constraint=render;constraint.bodyA&&!constraint.pointA&&(constraint.pointA={x:0,y:0}),constraint.bodyB&&!constraint.pointB&&(constraint.pointB={x:0,y:0});var initialPointA=constraint.bodyA?Vector$5.add(constraint.bodyA.position,constraint.pointA):constraint.pointA,render=constraint.bodyB?Vector$5.add(constraint.bodyB.position,constraint.pointB):constraint.pointB,render=Vector$5.magnitude(Vector$5.sub(initialPointA,render));constraint.length=void 0!==constraint.length?constraint.length:render,constraint.id=constraint.id||Common$b.nextId(),constraint.label=constraint.label||"Constraint",constraint.type="constraint",constraint.stiffness=constraint.stiffness||(0<constraint.length?1:.7),constraint.damping=constraint.damping||0,constraint.angularStiffness=constraint.angularStiffness||0,constraint.angleA=constraint.bodyA?constraint.bodyA.angle:constraint.angleA,constraint.angleB=constraint.bodyB?constraint.bodyB.angle:constraint.angleB,constraint.plugin={};render={visible:!0,type:"line",anchors:!0,lineColor:null,lineOpacity:null,lineThickness:null,pinSize:null,anchorColor:null,anchorSize:null};return 0===constraint.length&&.1<constraint.stiffness?(render.type="pin",render.anchors=!1):constraint.stiffness<.9&&(render.type="spring"),constraint.render=Common$b.extend(render,constraint.render),constraint},Constraint$5.preSolveAll=function(bodies){for(var i=0;i<bodies.length;i+=1){var body=bodies[i],impulse=body.constraintImpulse;body.isStatic||0===impulse.x&&0===impulse.y&&0===impulse.angle||(body.position.x+=impulse.x,body.position.y+=impulse.y,body.angle+=impulse.angle)}},Constraint$5.solveAll=function(constraints,timeScale){for(var i=0;i<constraints.length;i+=1){var constraint=constraints[i],fixedA=!constraint.bodyA||constraint.bodyA&&constraint.bodyA.isStatic,fixedB=!constraint.bodyB||constraint.bodyB&&constraint.bodyB.isStatic;(fixedA||fixedB)&&Constraint$5.solve(constraints[i],timeScale)}for(i=0;i<constraints.length;i+=1)fixedA=!(constraint=constraints[i]).bodyA||constraint.bodyA&&constraint.bodyA.isStatic,fixedB=!constraint.bodyB||constraint.bodyB&&constraint.bodyB.isStatic,fixedA||fixedB||Constraint$5.solve(constraints[i],timeScale)},Constraint$5.solve=function(constraint,force){var delta,currentLength,massTotal,resistanceTotal,torque,share,normal,normalVelocity,bodyA=constraint.bodyA,bodyB=constraint.bodyB,pointA=constraint.pointA,pointB=constraint.pointB;(bodyA||bodyB)&&(bodyA&&!bodyA.isStatic&&(Vector$5.rotate(pointA,bodyA.angle-constraint.angleA,pointA),constraint.angleA=bodyA.angle),bodyB&&!bodyB.isStatic&&(Vector$5.rotate(pointB,bodyB.angle-constraint.angleB,pointB),constraint.angleB=bodyB.angle),massTotal=pointA,resistanceTotal=pointB,bodyA&&(massTotal=Vector$5.add(bodyA.position,pointA)),bodyB&&(resistanceTotal=Vector$5.add(bodyB.position,pointB)),massTotal&&resistanceTotal&&(delta=Vector$5.sub(massTotal,resistanceTotal),massTotal=((currentLength=(currentLength=Vector$5.magnitude(delta))<Constraint$5._minLength?Constraint$5._minLength:currentLength)-constraint.length)/currentLength,resistanceTotal=constraint.stiffness<1?constraint.stiffness*force:constraint.stiffness,force=Vector$5.mult(delta,massTotal*resistanceTotal),resistanceTotal=(massTotal=(bodyA?bodyA.inverseMass:0)+(bodyB?bodyB.inverseMass:0))+((bodyA?bodyA.inverseInertia:0)+(bodyB?bodyB.inverseInertia:0)),constraint.damping&&(normalVelocity=Vector$5.create(),normal=Vector$5.div(delta,currentLength),normalVelocity=Vector$5.sub(bodyB&&Vector$5.sub(bodyB.position,bodyB.positionPrev)||normalVelocity,bodyA&&Vector$5.sub(bodyA.position,bodyA.positionPrev)||normalVelocity),normalVelocity=Vector$5.dot(normal,normalVelocity)),bodyA&&!bodyA.isStatic&&(share=bodyA.inverseMass/massTotal,bodyA.constraintImpulse.x-=force.x*share,bodyA.constraintImpulse.y-=force.y*share,bodyA.position.x-=force.x*share,bodyA.position.y-=force.y*share,constraint.damping&&(bodyA.positionPrev.x-=constraint.damping*normal.x*normalVelocity*share,bodyA.positionPrev.y-=constraint.damping*normal.y*normalVelocity*share),torque=Vector$5.cross(pointA,force)/resistanceTotal*Constraint$5._torqueDampen*bodyA.inverseInertia*(1-constraint.angularStiffness),bodyA.constraintImpulse.angle-=torque,bodyA.angle-=torque),bodyB&&!bodyB.isStatic&&(share=bodyB.inverseMass/massTotal,bodyB.constraintImpulse.x+=force.x*share,bodyB.constraintImpulse.y+=force.y*share,bodyB.position.x+=force.x*share,bodyB.position.y+=force.y*share,constraint.damping&&(bodyB.positionPrev.x+=constraint.damping*normal.x*normalVelocity*share,bodyB.positionPrev.y+=constraint.damping*normal.y*normalVelocity*share),torque=Vector$5.cross(pointB,force)/resistanceTotal*Constraint$5._torqueDampen*bodyB.inverseInertia*(1-constraint.angularStiffness),bodyB.constraintImpulse.angle+=torque,bodyB.angle+=torque)))},Constraint$5.postSolveAll=function(bodies){for(var i=0;i<bodies.length;i++){var body=bodies[i],impulse=body.constraintImpulse;if(!(body.isStatic||0===impulse.x&&0===impulse.y&&0===impulse.angle)){Sleeping$2.set(body,!1);for(var j=0;j<body.parts.length;j++){var part=body.parts[j];Vertices$7.translate(part.vertices,impulse),0<j&&(part.position.x+=impulse.x,part.position.y+=impulse.y),0!==impulse.angle&&(Vertices$7.rotate(part.vertices,impulse.angle,body.position),Axes$1.rotate(part.axes,impulse.angle),0<j&&Vector$5.rotateAbout(part.position,impulse.angle,body.position,part.position)),Bounds$5.update(part.bounds,part.vertices,body.velocity)}impulse.angle*=Constraint$5._warming,impulse.x*=Constraint$5._warming,impulse.y*=Constraint$5._warming}}},Constraint$5.pointAWorld=function(constraint){return{x:(constraint.bodyA?constraint.bodyA.position.x:0)+constraint.pointA.x,y:(constraint.bodyA?constraint.bodyA.position.y:0)+constraint.pointA.y}},Constraint$5.pointBWorld=function(constraint){return{x:(constraint.bodyB?constraint.bodyB.position.x:0)+constraint.pointB.x,y:(constraint.bodyB?constraint.bodyB.position.y:0)+constraint.pointB.y}};var Composites$2={},Composites_1=Composites$2,Composite$6=Composite_1,Constraint$4=Constraint_1,Common$a=Common_1,Body$4=Body_1,Bodies$5=Bodies_1;Composites$2.stack=function(xx,yy,columns,rows,columnGap,rowGap,callback){for(var lastBody,stack=Composite$6.create({label:"Stack"}),x=xx,y=yy,i=0,row=0;row<rows;row++){for(var maxHeight=0,column=0;column<columns;column++){var bodyHeight,bodyWidth,body=callback(x,y,column,row,lastBody,i);body?(bodyHeight=body.bounds.max.y-body.bounds.min.y,bodyWidth=body.bounds.max.x-body.bounds.min.x,maxHeight<bodyHeight&&(maxHeight=bodyHeight),Body$4.translate(body,{x:.5*bodyWidth,y:.5*bodyHeight}),x=body.bounds.max.x+columnGap,Composite$6.addBody(stack,body),lastBody=body,i+=1):x+=columnGap}y+=maxHeight+rowGap,x=xx}return stack},Composites$2.chain=function(composite,xOffsetA,yOffsetA,xOffsetB,yOffsetB,options){for(var bodies=composite.bodies,i=1;i<bodies.length;i++){var bodyA=bodies[i-1],bodyB=bodies[i],bodyAHeight=bodyA.bounds.max.y-bodyA.bounds.min.y,bodyAWidth=bodyA.bounds.max.x-bodyA.bounds.min.x,constraint=bodyB.bounds.max.y-bodyB.bounds.min.y,bodyBWidth=bodyB.bounds.max.x-bodyB.bounds.min.x,constraint=Common$a.extend({bodyA:bodyA,pointA:{x:bodyAWidth*xOffsetA,y:bodyAHeight*yOffsetA},bodyB:bodyB,pointB:{x:bodyBWidth*xOffsetB,y:constraint*yOffsetB}},options);Composite$6.addConstraint(composite,Constraint$4.create(constraint))}return composite.label+=" Chain",composite},Composites$2.mesh=function(composite,columns,rows,crossBrace,options){for(var col,bodyA,bodyB,bodyC,bodies=composite.bodies,row=0;row<rows;row++){for(col=1;col<columns;col++)bodyA=bodies[col-1+row*columns],bodyB=bodies[col+row*columns],Composite$6.addConstraint(composite,Constraint$4.create(Common$a.extend({bodyA:bodyA,bodyB:bodyB},options)));if(0<row)for(col=0;col<columns;col++)bodyA=bodies[col+(row-1)*columns],bodyB=bodies[col+row*columns],Composite$6.addConstraint(composite,Constraint$4.create(Common$a.extend({bodyA:bodyA,bodyB:bodyB},options))),crossBrace&&0<col&&(bodyC=bodies[col-1+(row-1)*columns],Composite$6.addConstraint(composite,Constraint$4.create(Common$a.extend({bodyA:bodyC,bodyB:bodyB},options)))),crossBrace&&col<columns-1&&(bodyC=bodies[col+1+(row-1)*columns],Composite$6.addConstraint(composite,Constraint$4.create(Common$a.extend({bodyA:bodyC,bodyB:bodyB},options))))}return composite.label+=" Mesh",composite},Composites$2.pyramid=function(xx,yy,columns,rows,columnGap,rowGap,callback){return Composites$2.stack(xx,yy,columns,rows,columnGap,rowGap,function(x,y,column,row,lastBody,i){var end=Math.min(rows,Math.ceil(columns/2)),lastBodyWidth=lastBody?lastBody.bounds.max.x-lastBody.bounds.min.x:0;if(!(end<row)){var start=row=end-row,end=columns-1-row;if(!(column<start||end<column))return 1===i&&Body$4.translate(lastBody,{x:(column+(columns%2==1?1:-1))*lastBodyWidth,y:0}),callback(xx+(lastBody?column*lastBodyWidth:0)+column*columnGap,y,column,row,lastBody,i)}})},Composites$2.newtonsCradle=function(xx,yy,number,size,length){for(var newtonsCradle=Composite$6.create({label:"Newtons Cradle"}),i=0;i<number;i++){var circle=Bodies$5.circle(xx+i*(1.9*size),yy+length,size,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),constraint=Constraint$4.create({pointA:{x:xx+i*(1.9*size),y:yy},bodyB:circle});Composite$6.addBody(newtonsCradle,circle),Composite$6.addConstraint(newtonsCradle,constraint)}return newtonsCradle},Composites$2.car=function(xx,yy,body,wheelA,wheelSize){var wheelB=Body$4.nextGroup(!0),axelA=.5*-body+20,axelB=.5*body-20,car=Composite$6.create({label:"Car"}),body=Bodies$5.rectangle(xx,yy,body,wheelA,{collisionFilter:{group:wheelB},chamfer:{radius:.5*wheelA},density:2e-4}),wheelA=Bodies$5.circle(xx+axelA,yy+0,wheelSize,{collisionFilter:{group:wheelB},friction:.8}),wheelB=Bodies$5.circle(xx+axelB,yy+0,wheelSize,{collisionFilter:{group:wheelB},friction:.8}),axelA=Constraint$4.create({bodyB:body,pointB:{x:axelA,y:0},bodyA:wheelA,stiffness:1,length:0}),axelB=Constraint$4.create({bodyB:body,pointB:{x:axelB,y:0},bodyA:wheelB,stiffness:1,length:0});return Composite$6.addBody(car,body),Composite$6.addBody(car,wheelA),Composite$6.addBody(car,wheelB),Composite$6.addConstraint(car,axelA),Composite$6.addConstraint(car,axelB),car},Composites$2.softBody=function(xx,yy,columns,rows,columnGap,softBody,crossBrace,particleRadius,particleOptions,constraintOptions){particleOptions=Common$a.extend({inertia:1/0},particleOptions),constraintOptions=Common$a.extend({stiffness:.2,render:{type:"line",anchors:!1}},constraintOptions);softBody=Composites$2.stack(xx,yy,columns,rows,columnGap,softBody,function(x,y){return Bodies$5.circle(x,y,particleRadius,particleOptions)});return Composites$2.mesh(softBody,columns,rows,crossBrace,constraintOptions),softBody.label="Soft Body",softBody};var Svg$2={},Svg_1=Svg$2,Common$9=Common_1;Svg$2.pathToVertices=function(path,sampleLength){"undefined"==typeof window||"SVGPathSeg"in window||Common$9.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var i,il,total,point,segment,segments,segmentsQueue,lastSegment,lastPoint,lx,ly,points=[],length=0,x=0,y=0;sampleLength=sampleLength||15;function addPoint(px,py,point){var isRelative=point%2==1&&1<point;lastPoint&&px==lastPoint.x&&py==lastPoint.y||(ly=lastPoint&&isRelative?(lx=lastPoint.x,lastPoint.y):lx=0,point={x:lx+px,y:ly+py},!isRelative&&lastPoint||(lastPoint=point),points.push(point),x=lx+px,y=ly+py)}function addSegmentPoint(segment){var segType=segment.pathSegTypeAsLetter.toUpperCase();if("Z"!==segType){switch(segType){case"M":case"L":case"T":case"C":case"S":case"Q":x=segment.x,y=segment.y;break;case"H":x=segment.x;break;case"V":y=segment.y}addPoint(x,y,segment.pathSegType)}}for(Svg$2._svgPathToAbsolute(path),total=path.getTotalLength(),segments=[],i=0;i<path.pathSegList.numberOfItems;i+=1)segments.push(path.pathSegList.getItem(i));for(segmentsQueue=segments.concat();length<total;){if((segment=segments[path.getPathSegAtLength(length)])!=lastSegment){for(;segmentsQueue.length&&segmentsQueue[0]!=segment;)addSegmentPoint(segmentsQueue.shift());lastSegment=segment}switch(segment.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":point=path.getPointAtLength(length),addPoint(point.x,point.y,0)}length+=sampleLength}for(i=0,il=segmentsQueue.length;i<il;++i)addSegmentPoint(segmentsQueue[i]);return points},Svg$2._svgPathToAbsolute=function(path){for(var x0,y0,x1,y1,x2,y2,segs=path.pathSegList,x=0,y=0,len=segs.numberOfItems,i=0;i<len;++i){var seg=segs.getItem(i),segType=seg.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(segType))"x"in seg&&(x=seg.x),"y"in seg&&(y=seg.y);else switch("x1"in seg&&(x1=x+seg.x1),"x2"in seg&&(x2=x+seg.x2),"y1"in seg&&(y1=y+seg.y1),"y2"in seg&&(y2=y+seg.y2),"x"in seg&&(x+=seg.x),"y"in seg&&(y+=seg.y),segType){case"m":segs.replaceItem(path.createSVGPathSegMovetoAbs(x,y),i);break;case"l":segs.replaceItem(path.createSVGPathSegLinetoAbs(x,y),i);break;case"h":segs.replaceItem(path.createSVGPathSegLinetoHorizontalAbs(x),i);break;case"v":segs.replaceItem(path.createSVGPathSegLinetoVerticalAbs(y),i);break;case"c":segs.replaceItem(path.createSVGPathSegCurvetoCubicAbs(x,y,x1,y1,x2,y2),i);break;case"s":segs.replaceItem(path.createSVGPathSegCurvetoCubicSmoothAbs(x,y,x2,y2),i);break;case"q":segs.replaceItem(path.createSVGPathSegCurvetoQuadraticAbs(x,y,x1,y1),i);break;case"t":segs.replaceItem(path.createSVGPathSegCurvetoQuadraticSmoothAbs(x,y),i);break;case"a":segs.replaceItem(path.createSVGPathSegArcAbs(x,y,seg.r1,seg.r2,seg.angle,seg.largeArcFlag,seg.sweepFlag),i);break;case"z":case"Z":x=x0,y=y0}"M"!=segType&&"m"!=segType||(x0=x,y0=y)}};var Components$5=components$1,GetFastValue$g=GetFastValue_1,Vector2$h=BuildTilesetIndex_1;var MatterGameObject_1=function(world,gameObject,options,addToWorld){void 0===options&&(options={}),void 0===addToWorld&&(addToWorld=!0);var x=gameObject.x,shape=gameObject.y;return gameObject.body={temp:!0,position:{x:x,y:shape}},[Components$5.Bounce,Components$5.Collision,Components$5.Force,Components$5.Friction,Components$5.Gravity,Components$5.Mass,Components$5.Sensor,Components$5.SetBody,Components$5.Sleep,Components$5.Static,Components$5.Transform,Components$5.Velocity].forEach(function(mixin){for(var key in mixin)(def=mixin[key]).get&&"function"==typeof def.get||def.set&&"function"==typeof def.set?Object.defineProperty(gameObject,key,{get:mixin[key].get,set:mixin[key].set}):Object.defineProperty(gameObject,key,{value:mixin[key]});var def}),gameObject.world=world,gameObject._tempVec2=new Vector2$h(x,shape),options.hasOwnProperty("type")&&"body"===options.type?gameObject.setExistingBody(options,addToWorld):(shape=GetFastValue$g(options,"shape",null)||"rectangle",options.addToWorld=addToWorld,gameObject.setBody(shape,options)),gameObject},GameObject$2=GameObject_1,GetFastValue$f=GetFastValue_1,Vector2$g=BuildTilesetIndex_1,MatterImage_1=new Class_1({Extends:Resolver_1,Mixins:[components$1.Bounce,components$1.Collision,components$1.Force,components$1.Friction,components$1.Gravity,components$1.Mass,components$1.Sensor,components$1.SetBody,components$1.Sleep,components$1.Static,components$1.Transform,components$1.Velocity,MatterCollisionEvents_1],initialize:function(shape,x,y,texture,frame,options){GameObject$2.call(this,shape.scene,"Image"),this._crop=this.resetCropObject(),this.setTexture(texture,frame),this.setSizeToFrame(),this.setOrigin(),this.world=shape,this._tempVec2=new Vector2$g(x,y);shape=GetFastValue$f(options,"shape",null);shape?this.setBody(shape,options):this.setRectangle(this.width,this.height,options),this.setPosition(x,y),this.initPipeline()}}),AnimationState=MatterAttractors_1,GameObject$1=GameObject_1,GetFastValue$e=GetFastValue_1,Vector2$f=BuildTilesetIndex_1,GetTileAtWorldXY_1=new Class_1({Extends:time,Mixins:[components$1.Bounce,components$1.Collision,components$1.Force,components$1.Friction,components$1.Gravity,components$1.Mass,components$1.Sensor,components$1.SetBody,components$1.Sleep,components$1.Static,components$1.Transform,components$1.Velocity,MatterCollisionEvents_1],initialize:function(shape,x,y,texture,frame,options){GameObject$1.call(this,shape.scene,"Sprite"),this._crop=this.resetCropObject(),this.anims=new AnimationState(this),this.setTexture(texture,frame),this.setSizeToFrame(),this.setOrigin(),this.world=shape,this._tempVec2=new Vector2$f(x,y);shape=GetFastValue$e(options,"shape",null);shape?this.setBody(shape,options):this.setRectangle(this.width,this.height,options),this.setPosition(x,y),this.initPipeline()}}),Bodies$4=Bodies_1,Body$3=Body_1,Engine_1=Class_1,EventEmitter$3=eventemitter3.exports,GetFastValue$d=GetFastValue_1,HasValue$2=HasValue_1,Vertices$6=MatterPhysics,plugins=new Engine_1({Extends:EventEmitter$3,Mixins:[components$1.Bounce,components$1.Collision,components$1.Friction,components$1.Gravity,components$1.Mass,components$1.Sensor,components$1.Sleep,components$1.Static],initialize:function(addToWorld,collisionGroup,options){EventEmitter$3.call(this),this.tile=collisionGroup,this.world=addToWorld,collisionGroup.physics.matterBody&&collisionGroup.physics.matterBody.destroy(),collisionGroup.physics.matterBody=this;var body=GetFastValue$d(options,"body",null),addToWorld=GetFastValue$d(options,"addToWorld",!0);body?this.setBody(body,addToWorld):(collisionGroup=collisionGroup.getCollisionGroup(),0<GetFastValue$d(collisionGroup,"objects",[]).length?this.setFromTileCollision(options):this.setFromTileRectangle(options))},setFromTileRectangle:function(options){HasValue$2(options=void 0===options?{}:options,"isStatic")||(options.isStatic=!0),HasValue$2(options,"addToWorld")||(options.addToWorld=!0);var body=this.tile.getBounds(),cx=body.x+body.width/2,cy=body.y+body.height/2,body=Bodies$4.rectangle(cx,cy,body.width,body.height,options);return this.setBody(body,options.addToWorld),this},setFromTileCollision:function(options){HasValue$2(options=void 0===options?{}:options,"isStatic")||(options.isStatic=!0),HasValue$2(options,"addToWorld")||(options.addToWorld=!0);for(var sx=this.tile.tilemapLayer.scaleX,sy=this.tile.tilemapLayer.scaleY,tileX=this.tile.getLeft(),tileY=this.tile.getTop(),collisionGroup=this.tile.getCollisionGroup(),collisionObjects=GetFastValue$d(collisionGroup,"objects",[]),parts=[],i=0;i<collisionObjects.length;i++){var vertices=collisionObjects[i],ox=tileX+vertices.x*sx,oy=tileY+vertices.y*sy,center=vertices.width*sx,oh=vertices.height*sy,body=null;vertices.rectangle?body=Bodies$4.rectangle(ox+center/2,oy+oh/2,center,oh,options):vertices.ellipse?body=Bodies$4.circle(ox+center/2,oy+oh/2,center/2,options):(vertices.polygon||vertices.polyline)&&(center=(vertices.polygon||vertices.polyline).map(function(p){return{x:p.x*sx,y:p.y*sy}}),vertices=Vertices$6.create(center),ox+=(center=Vertices$6.centre(vertices)).x,oy+=center.y,body=Bodies$4.fromVertices(ox,oy,vertices,options)),body&&parts.push(body)}return 1===parts.length?this.setBody(parts[0],options.addToWorld):1<parts.length&&(options.parts=parts,this.setBody(Body$3.create(options),options.addToWorld)),this},setBody:function(body,addToWorld){return void 0===addToWorld&&(addToWorld=!0),this.body&&this.removeBody(),this.body=body,this.body.gameObject=this,addToWorld&&this.world.add(this.body),this},removeBody:function(){return this.body&&(this.world.remove(this.body),this.body.gameObject=void 0,this.body=void 0),this},destroy:function(){this.removeBody(),this.tile.physics.matterBody=void 0,this.removeAllListeners()}}),SAT$3={},SAT_1=SAT$3,Vertices$5=MatterPhysics,Vector$4=Vector_1;SAT$3.collides=function(verticesA,bodyB,previousCollision){var parentA,collision,canReusePrevCol=!1;if(collision=previousCollision?(parentA=verticesA.parent,collision=bodyB.parent,collision=parentA.speed*parentA.speed+parentA.angularSpeed*parentA.angularSpeed+collision.speed*collision.speed+collision.angularSpeed*collision.angularSpeed,canReusePrevCol=previousCollision&&previousCollision.collided&&collision<.2,previousCollision):{collided:!1,bodyA:verticesA,bodyB:bodyB},previousCollision&&canReusePrevCol){var supports=collision.axisBody,overlapAB=[supports.axes[previousCollision.axisNumber]],supports=SAT$3._overlapAxes(supports.vertices,(supports===verticesA?bodyB:verticesA).vertices,overlapAB);if(collision.reused=!0,supports.overlap<=0)return collision.collided=!1,collision}else{if((overlapAB=SAT$3._overlapAxes(verticesA.vertices,bodyB.vertices,verticesA.axes)).overlap<=0)return collision.collided=!1,collision;if((verticesB=SAT$3._overlapAxes(bodyB.vertices,verticesA.vertices,bodyB.axes)).overlap<=0)return collision.collided=!1,collision;overlapAB.overlap<verticesB.overlap?(supports=overlapAB,collision.axisBody=verticesA):(supports=verticesB,collision.axisBody=bodyB),collision.axisNumber=supports.axisNumber}collision.bodyA=verticesA.id<bodyB.id?verticesA:bodyB,collision.bodyB=verticesA.id<bodyB.id?bodyB:verticesA,collision.collided=!0,collision.depth=supports.overlap,collision.parentA=collision.bodyA.parent,collision.parentB=collision.bodyB.parent,verticesA=collision.bodyA,bodyB=collision.bodyB,Vector$4.dot(supports.axis,Vector$4.sub(bodyB.position,verticesA.position))<0?collision.normal={x:supports.axis.x,y:supports.axis.y}:collision.normal={x:-supports.axis.x,y:-supports.axis.y},collision.tangent=Vector$4.perp(collision.normal),collision.penetration=collision.penetration||{},collision.penetration.x=collision.normal.x*collision.depth,collision.penetration.y=collision.normal.y*collision.depth;var verticesB=SAT$3._findSupports(verticesA,bodyB,collision.normal),supports=[];return Vertices$5.contains(verticesA.vertices,verticesB[0])&&supports.push(verticesB[0]),Vertices$5.contains(verticesA.vertices,verticesB[1])&&supports.push(verticesB[1]),supports.length<2&&(verticesA=SAT$3._findSupports(bodyB,verticesA,Vector$4.neg(collision.normal)),Vertices$5.contains(bodyB.vertices,verticesA[0])&&supports.push(verticesA[0]),supports.length<2&&Vertices$5.contains(bodyB.vertices,verticesA[1])&&supports.push(verticesA[1])),supports.length<1&&(supports=[verticesB[0]]),collision.supports=supports,collision},SAT$3._overlapAxes=function(verticesA,verticesB,axes){for(var overlap,axis,projectionA=Vector$4._temp[0],projectionB=Vector$4._temp[1],result={overlap:Number.MAX_VALUE},i=0;i<axes.length;i++){if(axis=axes[i],SAT$3._projectToAxis(projectionA,verticesA,axis),SAT$3._projectToAxis(projectionB,verticesB,axis),(overlap=Math.min(projectionA.max-projectionB.min,projectionB.max-projectionA.min))<=0)return result.overlap=overlap,result;overlap<result.overlap&&(result.overlap=overlap,result.axis=axis,result.axisNumber=i)}return result},SAT$3._projectToAxis=function(projection,vertices,axis){for(var min=Vector$4.dot(vertices[0],axis),max=min,i=1;i<vertices.length;i+=1){var dot=Vector$4.dot(vertices[i],axis);max<dot?max=dot:dot<min&&(min=dot)}projection.min=min,projection.max=max},SAT$3._findSupports=function(vertexB,bodyB,normal){for(var distance,vertexA,nearestDistance=Number.MAX_VALUE,vertexToBody=Vector$4._temp[0],vertices=bodyB.vertices,bodyAPosition=vertexB.position,i=0;i<vertices.length;i++)vertex=vertices[i],vertexToBody.x=vertex.x-bodyAPosition.x,vertexToBody.y=vertex.y-bodyAPosition.y,(distance=-Vector$4.dot(normal,vertexToBody))<nearestDistance&&(nearestDistance=distance,vertexA=vertex);var vertex=vertices[0<=vertexA.index-1?vertexA.index-1:vertices.length-1];vertexToBody.x=vertex.x-bodyAPosition.x,vertexToBody.y=vertex.y-bodyAPosition.y;nearestDistance=-Vector$4.dot(normal,vertexToBody),vertexB=vertex;return vertex=vertices[(vertexA.index+1)%vertices.length],vertexToBody.x=vertex.x-bodyAPosition.x,vertexToBody.y=vertex.y-bodyAPosition.y,[vertexA,vertexB=(distance=-Vector$4.dot(normal,vertexToBody))<nearestDistance?vertex:vertexB]};var Pair$4={},Pair_1=Pair$4;Pair$4.create=function(collision,timestamp){var bodyA=collision.bodyA,pair=collision.bodyB,pair={id:Pair$4.id(bodyA,pair),bodyA:bodyA,bodyB:pair,activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:bodyA.isSensor||pair.isSensor,timeCreated:timestamp,timeUpdated:timestamp,collision:null,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return Pair$4.update(pair,collision,timestamp),pair},Pair$4.update=function(pair,collision,timestamp){if((pair.collision=collision).collided){var supports=collision.supports,activeContacts=pair.activeContacts,parentA=collision.parentA,supportCount=collision.parentB;pair.inverseMass=parentA.inverseMass+supportCount.inverseMass,pair.friction=Math.min(parentA.friction,supportCount.friction),pair.frictionStatic=Math.max(parentA.frictionStatic,supportCount.frictionStatic),pair.restitution=Math.max(parentA.restitution,supportCount.restitution),pair.slop=Math.max(parentA.slop,supportCount.slop);for(var i=0;i<supports.length;i++)activeContacts[i]=supports[i].contact;supportCount=supports.length;supportCount<activeContacts.length&&(activeContacts.length=supportCount),pair.separation=collision.depth,Pair$4.setActive(pair,!0,timestamp)}else!0===pair.isActive&&Pair$4.setActive(pair,!1,timestamp)},Pair$4.setActive=function(pair,isActive,timestamp){isActive?(pair.isActive=!0,pair.timeUpdated=timestamp):(pair.isActive=!1,pair.activeContacts.length=0)},Pair$4.id=function(bodyA,bodyB){return bodyA.id<bodyB.id?"A"+bodyA.id+"B"+bodyB.id:"A"+bodyB.id+"B"+bodyA.id};var Detector$3={},Detector_1=Detector$3,SAT$2=SAT_1,Pair$3=Pair_1,Bounds$4=Bounds_1;Detector$3.collisions=function(broadphasePairs,engine){for(var collisions=[],pairsTable=engine.pairs.table,metrics=engine.metrics,i=0;i<broadphasePairs.length;i++){var bodyA=broadphasePairs[i][0],bodyB=broadphasePairs[i][1];if((!bodyA.isStatic&&!bodyA.isSleeping||!bodyB.isStatic&&!bodyB.isSleeping)&&(Detector$3.canCollide(bodyA.collisionFilter,bodyB.collisionFilter)&&(metrics.midphaseTests+=1,Bounds$4.overlaps(bodyA.bounds,bodyB.bounds))))for(var j=1<bodyA.parts.length?1:0;j<bodyA.parts.length;j++)for(var partA=bodyA.parts[j],k=1<bodyB.parts.length?1:0;k<bodyB.parts.length;k++){var collision,partB=bodyB.parts[k];(partA===bodyA&&partB===bodyB||Bounds$4.overlaps(partA.bounds,partB.bounds))&&(collision=(collision=pairsTable[Pair$3.id(partA,partB)])&&collision.isActive?collision.collision:null,collision=SAT$2.collides(partA,partB,collision),metrics.narrowphaseTests+=1,collision.reused&&(metrics.narrowReuseCount+=1),collision.collided&&(collisions.push(collision),metrics.narrowDetections+=1))}}return collisions},Detector$3.canCollide=function(filterA,filterB){return filterA.group===filterB.group&&0!==filterA.group?0<filterA.group:0!=(filterA.mask&filterB.category)&&0!=(filterB.mask&filterA.category)};var Bounds$3=Bounds_1,Composite$5=Composite_1,Constraint$3=Constraint_1,Detector$2=Detector_1,Events$5=events$1,InputEvents=renderer,Merge$1=Merge_1,Sleeping$1=MatterWrap_1,Vector2$e=BuildTilesetIndex_1,Vertices$4=MatterPhysics,HasTileAt_1=new Class_1({initialize:function(scene,world,options){void 0===options&&(options={});this.scene=scene,this.world=world,this.camera=null,this.pointer=null,this.active=!0,this.position=new Vector2$e,this.body=null,this.part=null,this.constraint=Constraint$3.create(Merge$1(options,{label:"Pointer Constraint",pointA:{x:0,y:0},pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,collisionFilter:{category:1,mask:4294967295,group:0}})),this.world.on(Events$5.BEFORE_UPDATE,this.update,this),scene.sys.input.on(InputEvents.POINTER_DOWN,this.onDown,this),scene.sys.input.on(InputEvents.POINTER_UP,this.onUp,this)},onDown:function(pointer){this.pointer||(this.pointer=pointer,this.camera=pointer.camera)},onUp:function(pointer){pointer===this.pointer&&(this.pointer=null)},getBody:function(pointer){var pos=this.position,constraint=this.constraint;this.camera.getWorldPoint(pointer.x,pointer.y,pos);for(var bodies=Composite$5.allBodies(this.world.localWorld),i=0;i<bodies.length;i++){var body=bodies[i];if(!body.ignorePointer&&Bounds$3.contains(body.bounds,pos)&&Detector$2.canCollide(body.collisionFilter,constraint.collisionFilter)&&this.hitTestBody(body,pos))return this.world.emit(Events$5.DRAG_START,body,this.part,this),!0}return!1},hitTestBody:function(body,position){for(var constraint=this.constraint,partsLength=body.parts.length,i=1<partsLength?1:0;i<partsLength;i++){var part=body.parts[i];if(Vertices$4.contains(part.vertices,position))return constraint.pointA=position,constraint.pointB={x:position.x-body.position.x,y:position.y-body.position.y},constraint.bodyB=body,constraint.angleB=body.angle,Sleeping$1.set(body,!1),this.part=part,this.body=body,!0}return!1},update:function(){var pos,constraint,pointer=this.pointer,body=this.body;this.active&&pointer?!pointer.isDown&&body?this.stopDrag():pointer.isDown&&(body||this.getBody(pointer))&&(body=this.body,pos=this.position,constraint=this.constraint,this.camera.getWorldPoint(pointer.x,pointer.y,pos),constraint.pointA.x=pos.x,constraint.pointA.y=pos.y,Sleeping$1.set(body,!1),this.world.emit(Events$5.DRAG,body,this)):body&&this.stopDrag()},stopDrag:function(){var body=this.body,constraint=this.constraint;constraint.bodyB=null,constraint.pointB=null,this.pointer=null,this.body=null,this.part=null,body&&this.world.emit(Events$5.DRAG_END,body,this)},destroy:function(){this.world.removeConstraint(this.constraint),this.pointer=null,this.constraint=null,this.body=null,this.part=null,this.world.off(Events$5.BEFORE_UPDATE,this.update),this.scene.sys.input.off(InputEvents.POINTER_DOWN,this.onDown,this),this.scene.sys.input.off(InputEvents.POINTER_UP,this.onUp,this)}}),Bodies$3=Bodies_1,Composites$1=Composites_1,Constraint$2=Constraint_1,Svg$1=Svg_1,MatterGameObject=MatterGameObject_1,MatterImage=MatterImage_1,MatterSprite=GetTileAtWorldXY_1,MatterTileBody$1=plugins,PhysicsEditorParser=GetTargets_1,PhysicsJSONParser=IsInLayerBounds_1,PointerConstraint=HasTileAt_1,Vertices$3=MatterPhysics,Factory_1=new Class_1({initialize:function(world){this.world=world,this.scene=world.scene,this.sys=world.scene.sys},rectangle:function(x,y,width,height,body){body=Bodies$3.rectangle(x,y,width,height,body);return this.world.add(body),body},trapezoid:function(x,y,width,height,slope,body){body=Bodies$3.trapezoid(x,y,width,height,slope,body);return this.world.add(body),body},circle:function(x,y,radius,options,body){body=Bodies$3.circle(x,y,radius,options,body);return this.world.add(body),body},polygon:function(x,y,sides,radius,body){body=Bodies$3.polygon(x,y,sides,radius,body);return this.world.add(body),body},fromVertices:function(x,y,vertexSets,options,flagInternal,removeCollinear,body){"string"==typeof vertexSets&&(vertexSets=Vertices$3.fromPath(vertexSets));body=Bodies$3.fromVertices(x,y,vertexSets,options,flagInternal,removeCollinear,body);return this.world.add(body),body},fromPhysicsEditor:function(x,y,config,body,addToWorld){void 0===addToWorld&&(addToWorld=!0);body=PhysicsEditorParser.parseBody(x,y,config,body);return addToWorld&&!this.world.has(body)&&this.world.add(body),body},fromSVG:function(x,y,xml,scale,body,addToWorld){void 0===scale&&(scale=1),void 0===body&&(body={}),void 0===addToWorld&&(addToWorld=!0);for(var path=xml.getElementsByTagName("path"),vertexSets=[],i=0;i<path.length;i++){var points=Svg$1.pathToVertices(path[i],30);1!==scale&&Vertices$3.scale(points,scale,scale),vertexSets.push(points)}body=Bodies$3.fromVertices(x,y,vertexSets,body);return addToWorld&&this.world.add(body),body},fromJSON:function(x,y,config,body,addToWorld){void 0===addToWorld&&(addToWorld=!0);body=PhysicsJSONParser.parseBody(x,y,config,body=void 0===body?{}:body);return body&&addToWorld&&this.world.add(body),body},imageStack:function(key,frame,x,y,columns,rows,columnGap,stack,options){void 0===columnGap&&(columnGap=0),void 0===stack&&(stack=0),void 0===options&&(options={});var world=this.world,displayList=this.sys.displayList;options.addToWorld=!1;stack=Composites$1.stack(x,y,columns,rows,columnGap,stack,function(x,image){image=new MatterImage(world,x,image,key,frame,options);return displayList.add(image),image.body});return world.add(stack),stack},stack:function(x,y,columns,rows,columnGap,rowGap,stack){stack=Composites$1.stack(x,y,columns,rows,columnGap,rowGap,stack);return this.world.add(stack),stack},pyramid:function(x,y,columns,rows,columnGap,rowGap,stack){stack=Composites$1.pyramid(x,y,columns,rows,columnGap,rowGap,stack);return this.world.add(stack),stack},chain:function(composite,xOffsetA,yOffsetA,xOffsetB,yOffsetB,options){return Composites$1.chain(composite,xOffsetA,yOffsetA,xOffsetB,yOffsetB,options)},mesh:function(composite,columns,rows,crossBrace,options){return Composites$1.mesh(composite,columns,rows,crossBrace,options)},newtonsCradle:function(x,y,number,size,composite){composite=Composites$1.newtonsCradle(x,y,number,size,composite);return this.world.add(composite),composite},car:function(x,y,width,height,composite){composite=Composites$1.car(x,y,width,height,composite);return this.world.add(composite),composite},softBody:function(x,y,columns,rows,columnGap,rowGap,crossBrace,particleRadius,particleOptions,composite){composite=Composites$1.softBody(x,y,columns,rows,columnGap,rowGap,crossBrace,particleRadius,particleOptions,composite);return this.world.add(composite),composite},joint:function(bodyA,bodyB,length,stiffness,options){return this.constraint(bodyA,bodyB,length,stiffness,options)},spring:function(bodyA,bodyB,length,stiffness,options){return this.constraint(bodyA,bodyB,length,stiffness,options)},constraint:function(bodyA,bodyB,length,stiffness,constraint){void 0===stiffness&&(stiffness=1),(constraint=void 0===constraint?{}:constraint).bodyA="body"===bodyA.type?bodyA:bodyA.body,constraint.bodyB="body"===bodyB.type?bodyB:bodyB.body,isNaN(length)||(constraint.length=length),constraint.stiffness=stiffness;constraint=Constraint$2.create(constraint);return this.world.add(constraint),constraint},worldConstraint:function(body,length,stiffness,constraint){void 0===stiffness&&(stiffness=1),(constraint=void 0===constraint?{}:constraint).bodyB="body"===body.type?body:body.body,isNaN(length)||(constraint.length=length),constraint.stiffness=stiffness;constraint=Constraint$2.create(constraint);return this.world.add(constraint),constraint},mouseSpring:function(options){return this.pointerConstraint(options)},pointerConstraint:function(pointerConstraint){(pointerConstraint=void 0===pointerConstraint?{}:pointerConstraint).hasOwnProperty("render")||(pointerConstraint.render={visible:!1});pointerConstraint=new PointerConstraint(this.scene,this.world,pointerConstraint);return this.world.add(pointerConstraint.constraint),pointerConstraint},image:function(x,y,key,frame,image){image=new MatterImage(this.world,x,y,key,frame,image);return this.sys.displayList.add(image),image},tileBody:function(tile,options){return new MatterTileBody$1(this.world,tile,options)},sprite:function(x,y,key,frame,sprite){sprite=new MatterSprite(this.world,x,y,key,frame,sprite);return this.sys.displayList.add(sprite),this.sys.updateList.add(sprite),sprite},gameObject:function(gameObject,options,addToWorld){return MatterGameObject(this.world,gameObject,options,addToWorld)},destroy:function(){this.world=null,this.scene=null,this.sys=null}}),Plugin$2={},PluginCache$3=Plugin$2,Common$8=Common_1;Plugin$2._registry={},Plugin$2.register=function(plugin){var registered,pluginVersion,registeredVersion;return Plugin$2.isPlugin(plugin)||Common$8.warn("Plugin.register:",Plugin$2.toString(plugin),"does not implement all required fields."),plugin.name in Plugin$2._registry?(registered=Plugin$2._registry[plugin.name],pluginVersion=Plugin$2.versionParse(plugin.version).number,(registeredVersion=Plugin$2.versionParse(registered.version).number)<pluginVersion?(Common$8.warn("Plugin.register:",Plugin$2.toString(registered),"was upgraded to",Plugin$2.toString(plugin)),Plugin$2._registry[plugin.name]=plugin):pluginVersion<registeredVersion?Common$8.warn("Plugin.register:",Plugin$2.toString(registered),"can not be downgraded to",Plugin$2.toString(plugin)):plugin!==registered&&Common$8.warn("Plugin.register:",Plugin$2.toString(plugin),"is already registered to different plugin object")):Plugin$2._registry[plugin.name]=plugin,plugin},Plugin$2.resolve=function(dependency){return Plugin$2._registry[Plugin$2.dependencyParse(dependency).name]},Plugin$2.toString=function(plugin){return"string"==typeof plugin?plugin:(plugin.name||"anonymous")+"@"+(plugin.version||plugin.range||"0.0.0")},Plugin$2.isPlugin=function(obj){return obj&&obj.name&&obj.version&&obj.install},Plugin$2.isUsed=function(module,name){return-1<module.used.indexOf(name)},Plugin$2.isFor=function(plugin,module){var parsed=plugin.for&&Plugin$2.dependencyParse(plugin.for);return!plugin.for||module.name===parsed.name&&Plugin$2.versionSatisfies(module.version,parsed.range)},Plugin$2.use=function(module,dependencies){if(module.uses=(module.uses||[]).concat(dependencies||[]),0!==module.uses.length){for(var plugin,dependencies=Plugin$2.dependencies(module),sortedDependencies=Common$8.topologicalSort(dependencies),status=[],i=0;i<sortedDependencies.length;i+=1)sortedDependencies[i]!==module.name&&((plugin=Plugin$2.resolve(sortedDependencies[i]))?Plugin$2.isUsed(module,plugin.name)||(Plugin$2.isFor(plugin,module)||(Common$8.warn("Plugin.use:",Plugin$2.toString(plugin),"is for",plugin.for,"but installed on",Plugin$2.toString(module)+"."),plugin._warned=!0),plugin.install?plugin.install(module):(Common$8.warn("Plugin.use:",Plugin$2.toString(plugin),"does not specify an install function."),plugin._warned=!0),plugin._warned?(status.push("🔶 "+Plugin$2.toString(plugin)),delete plugin._warned):status.push("✅ "+Plugin$2.toString(plugin)),module.used.push(plugin.name)):status.push("❌ "+sortedDependencies[i]));0<status.length&&!plugin.silent&&Common$8.info(status.join("  "))}else Common$8.warn("Plugin.use:",Plugin$2.toString(module),"does not specify any dependencies to install.")},Plugin$2.dependencies=function(module,tracked){var parsedBase=Plugin$2.dependencyParse(module),name=parsedBase.name;if(!(name in(tracked=tracked||{}))){module=Plugin$2.resolve(module)||module,tracked[name]=Common$8.map(module.uses||[],function(dependency){Plugin$2.isPlugin(dependency)&&Plugin$2.register(dependency);var parsed=Plugin$2.dependencyParse(dependency),resolved=Plugin$2.resolve(dependency);return resolved&&!Plugin$2.versionSatisfies(resolved.version,parsed.range)?(Common$8.warn("Plugin.dependencies:",Plugin$2.toString(resolved),"does not satisfy",Plugin$2.toString(parsed),"used by",Plugin$2.toString(parsedBase)+"."),resolved._warned=!0,module._warned=!0):resolved||(Common$8.warn("Plugin.dependencies:",Plugin$2.toString(dependency),"used by",Plugin$2.toString(parsedBase),"could not be resolved."),module._warned=!0),parsed.name});for(var i=0;i<tracked[name].length;i+=1)Plugin$2.dependencies(tracked[name][i],tracked);return tracked}},Plugin$2.dependencyParse=function(dependency){if(Common$8.isString(dependency))return/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(dependency)||Common$8.warn("Plugin.dependencyParse:",dependency,"is not a valid dependency string."),{name:dependency.split("@")[0],range:dependency.split("@")[1]||"*"};return{name:dependency.name,range:dependency.range||dependency.version}},Plugin$2.versionParse=function(range){/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/.test(range)||Common$8.warn("Plugin.versionParse:",range,"is not a valid version or range.");var identifiers=range.split("-");range=identifiers[0];var isRange=isNaN(Number(range[0])),version=isRange?range.substr(1):range,parts=Common$8.map(version.split("."),function(part){return Number(part)});return{isRange:isRange,version:version,range:range,operator:isRange?range[0]:"",parts:parts,prerelease:identifiers[1],number:1e8*parts[0]+1e4*parts[1]+parts[2]}},Plugin$2.versionSatisfies=function(version,range){var rangeParsed=Plugin$2.versionParse(range=range||"*"),rangeParts=rangeParsed.parts,versionParsed=Plugin$2.versionParse(version),versionParts=versionParsed.parts;if(rangeParsed.isRange){if("*"===rangeParsed.operator||"*"===version)return!0;if("~"===rangeParsed.operator)return versionParts[0]===rangeParts[0]&&versionParts[1]===rangeParts[1]&&versionParts[2]>=rangeParts[2];if("^"===rangeParsed.operator)return 0<rangeParts[0]?versionParts[0]===rangeParts[0]&&versionParsed.number>=rangeParsed.number:0<rangeParts[1]?versionParts[1]===rangeParts[1]&&versionParts[2]>=rangeParts[2]:versionParts[2]===rangeParts[2]}return version===range||"*"===version};var Matter$3={},Matter_1=Matter$3,Plugin$1=PluginCache$3,Common$7=Common_1;Matter$3.name="matter-js",Matter$3.version="0.14.2",Matter$3.uses=[],Matter$3.used=[],Matter$3.use=function(){Plugin$1.use(Matter$3,Array.prototype.slice.call(arguments))},Matter$3.before=function(path,func){return path=path.replace(/^Matter./,""),Common$7.chainPathBefore(Matter$3,path,func)},Matter$3.after=function(path,func){return path=path.replace(/^Matter./,""),Common$7.chainPathAfter(Matter$3,path,func)};var CustomMain={},World_1$1=CustomMain,Composite$4=Composite_1,Common$6=Common_1;CustomMain.create=function(options){var composite=Composite$4.create();return Common$6.extend(composite,{label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-1/0,y:-1/0},max:{x:1/0,y:1/0}}},options)};var Grid$2={},Grid_1=Grid$2,Pair$2=Pair_1,Detector$1=Detector_1,Common$5=Common_1;Grid$2.create=function(options){var defaults={controller:Grid$2,detector:Detector$1.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return Common$5.extend(defaults,options)},Grid$2.update=function(grid,bodies,engine,forceUpdate){for(var row,world=engine.world,buckets=grid.buckets,gridChanged=!1,metrics=engine.metrics,i=metrics.broadphaseTests=0;i<bodies.length;i++){var body=bodies[i];if((!body.isSleeping||forceUpdate)&&!(body.bounds.max.x<world.bounds.min.x||body.bounds.min.x>world.bounds.max.x||body.bounds.max.y<world.bounds.min.y||body.bounds.min.y>world.bounds.max.y)){var newRegion=Grid$2._getRegion(grid,body);if(!body.region||newRegion.id!==body.region.id||forceUpdate){metrics.broadphaseTests+=1,body.region&&!forceUpdate||(body.region=newRegion);for(var union=Grid$2._regionUnion(newRegion,body.region),col=union.startCol;col<=union.endCol;col++)for(row=union.startRow;row<=union.endRow;row++){var bucketId,bucket=buckets[bucketId=Grid$2._getBucketId(col,row)],isInsideNewRegion=col>=newRegion.startCol&&col<=newRegion.endCol&&row>=newRegion.startRow&&row<=newRegion.endRow,isInsideOldRegion=col>=body.region.startCol&&col<=body.region.endCol&&row>=body.region.startRow&&row<=body.region.endRow;!isInsideNewRegion&&isInsideOldRegion&&isInsideOldRegion&&bucket&&Grid$2._bucketRemoveBody(grid,bucket,body),(body.region===newRegion||isInsideNewRegion&&!isInsideOldRegion||forceUpdate)&&(bucket=bucket||Grid$2._createBucket(buckets,bucketId),Grid$2._bucketAddBody(grid,bucket,body))}body.region=newRegion,gridChanged=!0}}}gridChanged&&(grid.pairsList=Grid$2._createActivePairsList(grid))},Grid$2.clear=function(grid){grid.buckets={},grid.pairs={},grid.pairsList=[]},Grid$2._regionUnion=function(regionA,endRow){var startCol=Math.min(regionA.startCol,endRow.startCol),endCol=Math.max(regionA.endCol,endRow.endCol),startRow=Math.min(regionA.startRow,endRow.startRow),endRow=Math.max(regionA.endRow,endRow.endRow);return Grid$2._createRegion(startCol,endCol,startRow,endRow)},Grid$2._getRegion=function(endRow,startRow){var bounds=startRow.bounds,startCol=Math.floor(bounds.min.x/endRow.bucketWidth),endCol=Math.floor(bounds.max.x/endRow.bucketWidth),startRow=Math.floor(bounds.min.y/endRow.bucketHeight),endRow=Math.floor(bounds.max.y/endRow.bucketHeight);return Grid$2._createRegion(startCol,endCol,startRow,endRow)},Grid$2._createRegion=function(startCol,endCol,startRow,endRow){return{id:startCol+","+endCol+","+startRow+","+endRow,startCol:startCol,endCol:endCol,startRow:startRow,endRow:endRow}},Grid$2._getBucketId=function(column,row){return"C"+column+"R"+row},Grid$2._createBucket=function(buckets,bucketId){return buckets[bucketId]=[]},Grid$2._bucketAddBody=function(grid,bucket,body){for(var i=0;i<bucket.length;i++){var pairId,pair,bodyB=bucket[i];body.id===bodyB.id||body.isStatic&&bodyB.isStatic||(pairId=Pair$2.id(body,bodyB),(pair=grid.pairs[pairId])?pair[2]+=1:grid.pairs[pairId]=[body,bodyB,1])}bucket.push(body)},Grid$2._bucketRemoveBody=function(grid,bucket,body){bucket.splice(bucket.indexOf(body),1);for(var i=0;i<bucket.length;i++){var pair=bucket[i],pair=Pair$2.id(body,pair),pair=grid.pairs[pair];pair&&--pair[2]}},Grid$2._createActivePairsList=function(grid){for(var pair,pairs=[],pairKeys=Common$5.keys(grid.pairs),k=0;k<pairKeys.length;k++)0<(pair=grid.pairs[pairKeys[k]])[2]?pairs.push(pair):delete grid.pairs[pairKeys[k]];return pairs};var Pairs$2={},Pairs_1=Pairs$2,Pair$1=Pair_1,Common$4=Common_1;Pairs$2._pairMaxIdleLife=1e3,Pairs$2.create=function(options){return Common$4.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},options)},Pairs$2.update=function(pairs,collisions,timestamp){var collision,pairId,pair,i,pairsList=pairs.list,pairsTable=pairs.table,collisionStart=pairs.collisionStart,collisionEnd=pairs.collisionEnd,collisionActive=pairs.collisionActive;for(collisionStart.length=0,collisionEnd.length=0,i=collisionActive.length=0;i<pairsList.length;i++)pairsList[i].confirmedActive=!1;for(i=0;i<collisions.length;i++)(collision=collisions[i]).collided&&((pair=pairsTable[pairId=Pair$1.id(collision.bodyA,collision.bodyB)])?((pair.isActive?collisionActive:collisionStart).push(pair),Pair$1.update(pair,collision,timestamp),pair.confirmedActive=!0):(pair=Pair$1.create(collision,timestamp),pairsTable[pairId]=pair,collisionStart.push(pair),pairsList.push(pair)));for(i=0;i<pairsList.length;i++)(pair=pairsList[i]).isActive&&!pair.confirmedActive&&(Pair$1.setActive(pair,!1,timestamp),collisionEnd.push(pair))},Pairs$2.removeOld=function(pairs,timestamp){for(var pair,collision,pairIndex,pairsList=pairs.list,pairsTable=pairs.table,indexesToRemove=[],i=0;i<pairsList.length;i++)(collision=(pair=pairsList[i]).collision).bodyA.isSleeping||collision.bodyB.isSleeping?pair.timeUpdated=timestamp:timestamp-pair.timeUpdated>Pairs$2._pairMaxIdleLife&&indexesToRemove.push(i);for(i=0;i<indexesToRemove.length;i++)delete pairsTable[(pair=pairsList[pairIndex=indexesToRemove[i]-i]).id],pairsList.splice(pairIndex,1)},Pairs$2.clear=function(pairs){return pairs.table={},pairs.list.length=0,pairs.collisionStart.length=0,pairs.collisionActive.length=0,pairs.collisionEnd.length=0,pairs};var Query$1={},Query_1=Query$1,Vector$3=Vector_1,SAT$1=SAT_1,Bounds$2=Bounds_1,Bodies$2=Bodies_1,Vertices$2=MatterPhysics;Query$1.collides=function(body,bodies){for(var collisions=[],i=0;i<bodies.length;i++){var bodyA=bodies[i];if(body!==bodyA&&Bounds$2.overlaps(bodyA.bounds,body.bounds))for(var j=1===bodyA.parts.length?0:1;j<bodyA.parts.length;j++){var collision=bodyA.parts[j];if(Bounds$2.overlaps(collision.bounds,body.bounds)){collision=SAT$1.collides(collision,body);if(collision.collided){collisions.push(collision);break}}}}return collisions},Query$1.ray=function(bodies,rayY,endPoint,rayWidth){rayWidth=rayWidth||1e-100;for(var ray=Vector$3.angle(rayY,endPoint),rayLength=Vector$3.magnitude(Vector$3.sub(rayY,endPoint)),rayX=.5*(endPoint.x+rayY.x),rayY=.5*(endPoint.y+rayY.y),ray=Bodies$2.rectangle(rayX,rayY,rayLength,rayWidth,{angle:ray}),collisions=Query$1.collides(ray,bodies),i=0;i<collisions.length;i+=1){var collision=collisions[i];collision.body=collision.bodyB=collision.bodyA}return collisions},Query$1.region=function(bodies,bounds,outside){for(var result=[],i=0;i<bodies.length;i++){var body=bodies[i],overlaps=Bounds$2.overlaps(body.bounds,bounds);(overlaps&&!outside||!overlaps&&outside)&&result.push(body)}return result},Query$1.point=function(bodies,point){for(var result=[],i=0;i<bodies.length;i++){var body=bodies[i];if(Bounds$2.contains(body.bounds,point))for(var j=1===body.parts.length?0:1;j<body.parts.length;j++){var part=body.parts[j];if(Bounds$2.contains(part.bounds,point)&&Vertices$2.contains(part.vertices,point)){result.push(body);break}}}return result};var Resolver$2={},Resolver_1=Resolver$2,Vertices$1=MatterPhysics,Vector$2=Vector_1,Common$3=Common_1,Bounds$1=Bounds_1;Resolver$2._restingThresh=4,Resolver$2._restingThreshTangent=6,Resolver$2._positionDampen=.9,Resolver$2._positionWarming=.8,Resolver$2._frictionNormalMultiplier=5,Resolver$2.preSolvePosition=function(pairs){for(var pair,activeCount,i=0;i<pairs.length;i++)(pair=pairs[i]).isActive&&(activeCount=pair.activeContacts.length,pair.collision.parentA.totalContacts+=activeCount,pair.collision.parentB.totalContacts+=activeCount)},Resolver$2.solvePosition=function(pairs,bodies,timeScale){for(var bodyA,bodyB,normalY,normalX,positionImpulseB,contactShare,bodyBtoAX,bodyBtoAY,positionImpulse,impulseCoefficient=timeScale*Resolver$2._positionDampen,i=0;i<bodies.length;i++){var body=bodies[i];body.previousPositionImpulse.x=body.positionImpulse.x,body.previousPositionImpulse.y=body.positionImpulse.y}for(i=0;i<pairs.length;i++)(positionImpulse=pairs[i]).isActive&&!positionImpulse.isSensor&&(bodyA=(bodyBtoAX=positionImpulse.collision).parentA,bodyB=bodyBtoAX.parentB,normalY=bodyBtoAX.normal,bodyBtoAY=bodyA.previousPositionImpulse,positionImpulseB=bodyB.previousPositionImpulse,normalX=bodyBtoAX.penetration,bodyBtoAX=positionImpulseB.x-bodyBtoAY.x+normalX.x,bodyBtoAY=positionImpulseB.y-bodyBtoAY.y+normalX.y,normalX=normalY.x,normalY=normalY.y,positionImpulse=((positionImpulse.separation=normalX*bodyBtoAX+normalY*bodyBtoAY)-positionImpulse.slop)*impulseCoefficient,(bodyA.isStatic||bodyB.isStatic)&&(positionImpulse*=2),bodyA.isStatic||bodyA.isSleeping||(contactShare=positionImpulse/bodyA.totalContacts,bodyA.positionImpulse.x+=normalX*contactShare,bodyA.positionImpulse.y+=normalY*contactShare),bodyB.isStatic||bodyB.isSleeping||(contactShare=positionImpulse/bodyB.totalContacts,bodyB.positionImpulse.x-=normalX*contactShare,bodyB.positionImpulse.y-=normalY*contactShare))},Resolver$2.postSolvePosition=function(bodies){for(var i=0;i<bodies.length;i++){var body=bodies[i];if((body.totalContacts=0)!==body.positionImpulse.x||0!==body.positionImpulse.y){for(var j=0;j<body.parts.length;j++){var part=body.parts[j];Vertices$1.translate(part.vertices,body.positionImpulse),Bounds$1.update(part.bounds,part.vertices,body.velocity),part.position.x+=body.positionImpulse.x,part.position.y+=body.positionImpulse.y}body.positionPrev.x+=body.positionImpulse.x,body.positionPrev.y+=body.positionImpulse.y,Vector$2.dot(body.positionImpulse,body.velocity)<0?(body.positionImpulse.x=0,body.positionImpulse.y=0):(body.positionImpulse.x*=Resolver$2._positionWarming,body.positionImpulse.y*=Resolver$2._positionWarming)}}},Resolver$2.preSolveVelocity=function(pairs){for(var j,contacts,collision,bodyA,bodyB,normal,tangent,contactVertex,normalImpulse,tangentImpulse,offset,impulse=Vector$2._temp[0],tempA=Vector$2._temp[1],i=0;i<pairs.length;i++)if((collision=pairs[i]).isActive&&!collision.isSensor)for(contacts=collision.activeContacts,bodyA=(collision=collision.collision).parentA,bodyB=collision.parentB,normal=collision.normal,tangent=collision.tangent,j=0;j<contacts.length;j++)contactVertex=(tangentImpulse=contacts[j]).vertex,normalImpulse=tangentImpulse.normalImpulse,tangentImpulse=tangentImpulse.tangentImpulse,0===normalImpulse&&0===tangentImpulse||(impulse.x=normal.x*normalImpulse+tangent.x*tangentImpulse,impulse.y=normal.y*normalImpulse+tangent.y*tangentImpulse,bodyA.isStatic||bodyA.isSleeping||(offset=Vector$2.sub(contactVertex,bodyA.position,tempA),bodyA.positionPrev.x+=impulse.x*bodyA.inverseMass,bodyA.positionPrev.y+=impulse.y*bodyA.inverseMass,bodyA.anglePrev+=Vector$2.cross(offset,impulse)*bodyA.inverseInertia),bodyB.isStatic||bodyB.isSleeping||(offset=Vector$2.sub(contactVertex,bodyB.position,tempA),bodyB.positionPrev.x-=impulse.x*bodyB.inverseMass,bodyB.positionPrev.y-=impulse.y*bodyB.inverseMass,bodyB.anglePrev-=Vector$2.cross(offset,impulse)*bodyB.inverseInertia))},Resolver$2.solveVelocity=function(pairs,timeScale){for(var timeScaleSquared=timeScale*timeScale,impulse=Vector$2._temp[0],tempA=Vector$2._temp[1],tempB=Vector$2._temp[2],tempC=Vector$2._temp[3],tempD=Vector$2._temp[4],tempE=Vector$2._temp[5],i=0;i<pairs.length;i++){var pair=pairs[i];if(pair.isActive&&!pair.isSensor){var collision=pair.collision,bodyA=collision.parentA,bodyB=collision.parentB,normal=collision.normal,tangent=collision.tangent,contacts=pair.activeContacts,contactShare=1/contacts.length;bodyA.velocity.x=bodyA.position.x-bodyA.positionPrev.x,bodyA.velocity.y=bodyA.position.y-bodyA.positionPrev.y,bodyB.velocity.x=bodyB.position.x-bodyB.positionPrev.x,bodyB.velocity.y=bodyB.position.y-bodyB.positionPrev.y,bodyA.angularVelocity=bodyA.angle-bodyA.anglePrev,bodyB.angularVelocity=bodyB.angle-bodyB.anglePrev;for(var j=0;j<contacts.length;j++){var contact=contacts[j],normalImpulse=contact.vertex,offsetA=Vector$2.sub(normalImpulse,bodyA.position,tempA),offsetB=Vector$2.sub(normalImpulse,bodyB.position,tempB),normalForce=Vector$2.add(bodyA.velocity,Vector$2.mult(Vector$2.perp(offsetA),bodyA.angularVelocity),tempC),tangentImpulse=Vector$2.add(bodyB.velocity,Vector$2.mult(Vector$2.perp(offsetB),bodyB.angularVelocity),tempD),maxFriction=Vector$2.sub(normalForce,tangentImpulse,tempE),contactNormalImpulse=Vector$2.dot(normal,maxFriction),contactTangentImpulse=Vector$2.dot(tangent,maxFriction),share=Math.abs(contactTangentImpulse),oAcN=Common$3.sign(contactTangentImpulse),normalImpulse=(1+pair.restitution)*contactNormalImpulse,normalForce=Common$3.clamp(pair.separation+contactNormalImpulse,0,1)*Resolver$2._frictionNormalMultiplier,tangentImpulse=contactTangentImpulse,maxFriction=1/0;share>pair.friction*pair.frictionStatic*normalForce*timeScaleSquared&&(tangentImpulse=Common$3.clamp(pair.friction*oAcN*timeScaleSquared,-(maxFriction=share),maxFriction));oAcN=Vector$2.cross(offsetA,normal),share=Vector$2.cross(offsetB,normal),share=contactShare/(bodyA.inverseMass+bodyB.inverseMass+bodyA.inverseInertia*oAcN*oAcN+bodyB.inverseInertia*share*share);normalImpulse*=share,tangentImpulse*=share,contactNormalImpulse<0&&contactNormalImpulse*contactNormalImpulse>Resolver$2._restingThresh*timeScaleSquared?contact.normalImpulse=0:(contactNormalImpulse=contact.normalImpulse,contact.normalImpulse=Math.min(contact.normalImpulse+normalImpulse,0),normalImpulse=contact.normalImpulse-contactNormalImpulse),contactTangentImpulse*contactTangentImpulse>Resolver$2._restingThreshTangent*timeScaleSquared?contact.tangentImpulse=0:(contactTangentImpulse=contact.tangentImpulse,contact.tangentImpulse=Common$3.clamp(contact.tangentImpulse+tangentImpulse,-maxFriction,maxFriction),tangentImpulse=contact.tangentImpulse-contactTangentImpulse),impulse.x=normal.x*normalImpulse+tangent.x*tangentImpulse,impulse.y=normal.y*normalImpulse+tangent.y*tangentImpulse,bodyA.isStatic||bodyA.isSleeping||(bodyA.positionPrev.x+=impulse.x*bodyA.inverseMass,bodyA.positionPrev.y+=impulse.y*bodyA.inverseMass,bodyA.anglePrev+=Vector$2.cross(offsetA,impulse)*bodyA.inverseInertia),bodyB.isStatic||bodyB.isSleeping||(bodyB.positionPrev.x-=impulse.x*bodyB.inverseMass,bodyB.positionPrev.y-=impulse.y*bodyB.inverseMass,bodyB.anglePrev-=Vector$2.cross(offsetB,impulse)*bodyB.inverseInertia)}}}};var MatterAttractors_1={},MatterCollisionEvents_1=MatterAttractors_1,Composite$3=Composite_1,Common$2=Common_1;MatterAttractors_1.create=function(options){return Common$2.extend({extended:!1,narrowDetections:0,narrowphaseTests:0,narrowReuse:0,narrowReuseCount:0,midphaseTests:0,broadphaseTests:0,narrowEff:1e-4,midEff:1e-4,broadEff:1e-4,collisions:0,buckets:0,bodies:0,pairs:0},!1,options)},MatterAttractors_1.reset=function(metrics){metrics.extended&&(metrics.narrowDetections=0,metrics.narrowphaseTests=0,metrics.narrowReuse=0,metrics.narrowReuseCount=0,metrics.midphaseTests=0,metrics.broadphaseTests=0,metrics.narrowEff=0,metrics.midEff=0,metrics.broadEff=0,metrics.collisions=0,metrics.buckets=0,metrics.pairs=0,metrics.bodies=0)},MatterAttractors_1.update=function(metrics,engine){var bodies;metrics.extended&&(bodies=engine.world,bodies=Composite$3.allBodies(bodies),metrics.collisions=metrics.narrowDetections,metrics.pairs=engine.pairs.list.length,metrics.bodies=bodies.length,metrics.midEff=(metrics.narrowDetections/(metrics.midphaseTests||1)).toFixed(2),metrics.narrowEff=(metrics.narrowDetections/(metrics.narrowphaseTests||1)).toFixed(2),metrics.broadEff=(1-metrics.broadphaseTests/(bodies.length||1)).toFixed(2),metrics.narrowReuse=(metrics.narrowReuseCount/(metrics.narrowphaseTests||1)).toFixed(2))};var Engine$1={},Engine_1=Engine$1,World$2=World_1$1,Sleeping=MatterWrap_1,Resolver$1=Resolver_1,Pairs$1=Pairs_1,Metrics=MatterCollisionEvents_1,Grid$1=Grid_1,Events$4=Events_1,Composite$2=Composite_1,Constraint$1=Constraint_1,Common$1=Common_1,Body$2=Body_1;Engine$1.create=function(engine,options){options=(options=Common$1.isElement(engine)?options:engine)||{},((engine=Common$1.isElement(engine)?engine:null)||options.render)&&Common$1.warn("Engine.create: engine.render is deprecated (see docs)");engine=Common$1.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:Grid$1}},options);return engine.world=options.world||World$2.create(engine.world),engine.pairs=Pairs$1.create(),engine.broadphase=engine.broadphase.controller.create(engine.broadphase),engine.metrics=engine.metrics||{extended:!1},engine.metrics=Metrics.create(engine.metrics),engine},Engine$1.update=function(engine,delta,correction){correction=correction||1;var i,world=engine.world,timing=engine.timing,collisions=engine.broadphase,timestamp=[];timing.timestamp+=(delta=delta||1e3/60)*timing.timeScale;var event={timestamp:timing.timestamp};Events$4.trigger(engine,"beforeUpdate",event);var allBodies=Composite$2.allBodies(world),allConstraints=Composite$2.allConstraints(world);for(Metrics.reset(engine.metrics),engine.enableSleeping&&Sleeping.update(allBodies,timing.timeScale),Engine$1._bodiesApplyGravity(allBodies,world.gravity),Engine$1._bodiesUpdate(allBodies,delta,timing.timeScale,correction,world.bounds),Constraint$1.preSolveAll(allBodies),i=0;i<engine.constraintIterations;i++)Constraint$1.solveAll(allConstraints,timing.timeScale);Constraint$1.postSolveAll(allBodies),timestamp=collisions.controller?(world.isModified&&collisions.controller.clear(collisions),collisions.controller.update(collisions,allBodies,engine,world.isModified),collisions.pairsList):allBodies,world.isModified&&Composite$2.setModified(world,!1,!1,!0);var collisions=collisions.detector(timestamp,engine),pairs=engine.pairs,timestamp=timing.timestamp;for(Pairs$1.update(pairs,collisions,timestamp),Pairs$1.removeOld(pairs,timestamp),engine.enableSleeping&&Sleeping.afterCollisions(pairs.list,timing.timeScale),0<pairs.collisionStart.length&&Events$4.trigger(engine,"collisionStart",{pairs:pairs.collisionStart}),Resolver$1.preSolvePosition(pairs.list),i=0;i<engine.positionIterations;i++)Resolver$1.solvePosition(pairs.list,allBodies,timing.timeScale);for(Resolver$1.postSolvePosition(allBodies),Constraint$1.preSolveAll(allBodies),i=0;i<engine.constraintIterations;i++)Constraint$1.solveAll(allConstraints,timing.timeScale);for(Constraint$1.postSolveAll(allBodies),Resolver$1.preSolveVelocity(pairs.list),i=0;i<engine.velocityIterations;i++)Resolver$1.solveVelocity(pairs.list,timing.timeScale);return 0<pairs.collisionActive.length&&Events$4.trigger(engine,"collisionActive",{pairs:pairs.collisionActive}),0<pairs.collisionEnd.length&&Events$4.trigger(engine,"collisionEnd",{pairs:pairs.collisionEnd}),Metrics.update(engine.metrics,engine),Engine$1._bodiesClearForces(allBodies),Events$4.trigger(engine,"afterUpdate",event),engine},Engine$1.merge=function(engineA,engineB){if(Common$1.extend(engineA,engineB),engineB.world){engineA.world=engineB.world,Engine$1.clear(engineA);for(var bodies=Composite$2.allBodies(engineA.world),i=0;i<bodies.length;i++){var body=bodies[i];Sleeping.set(body,!1),body.id=Common$1.nextId()}}},Engine$1.clear=function(engine){var bodies=engine.world;Pairs$1.clear(engine.pairs);var broadphase=engine.broadphase;broadphase.controller&&(bodies=Composite$2.allBodies(bodies),broadphase.controller.clear(broadphase),broadphase.controller.update(broadphase,bodies,engine,!0))},Engine$1._bodiesClearForces=function(bodies){for(var i=0;i<bodies.length;i++){var body=bodies[i];body.force.x=0,body.force.y=0,body.torque=0}},Engine$1._bodiesApplyGravity=function(bodies,gravity){var gravityScale=void 0!==gravity.scale?gravity.scale:.001;if((0!==gravity.x||0!==gravity.y)&&0!==gravityScale)for(var i=0;i<bodies.length;i++){var body=bodies[i];body.ignoreGravity||body.isStatic||body.isSleeping||(body.force.x+=body.mass*gravity.x*gravityScale*body.gravityScale.x,body.force.y+=body.mass*gravity.y*gravityScale*body.gravityScale.y)}},Engine$1._bodiesUpdate=function(bodies,deltaTime,timeScale,correction,worldBounds){for(var i=0;i<bodies.length;i++){var body=bodies[i];body.isStatic||body.isSleeping||Body$2.update(body,deltaTime,timeScale,correction)}};renderer=Matter_1;renderer.Body=Body_1,renderer.Composite=Composite_1,renderer.World=World_1$1,renderer.Detector=Detector_1,renderer.Grid=Grid_1,renderer.Pairs=Pairs_1,renderer.Pair=Pair_1,renderer.Query=Query_1,renderer.Resolver=Resolver_1,renderer.SAT=SAT_1,renderer.Constraint=Constraint_1,renderer.Common=Common_1,renderer.Engine=Engine_1,renderer.Events=Events_1,renderer.Sleeping=MatterWrap_1,renderer.Plugin=PluginCache$3,renderer.Bodies=Bodies_1,renderer.Composites=Composites_1,renderer.Axes=Axes_1,renderer.Bounds=Bounds_1,renderer.Svg=Svg_1,renderer.Vector=Vector_1,renderer.Vertices=MatterPhysics,renderer.World.add=renderer.Composite.add,renderer.World.remove=renderer.Composite.remove,renderer.World.addComposite=renderer.Composite.addComposite,renderer.World.addBody=renderer.Composite.addBody,renderer.World.addConstraint=renderer.Composite.addConstraint,renderer.World.clear=renderer.Composite.clear;var CustomMain=renderer,Matter$1=CustomMain,MatterAttractors$1={name:"matter-attractors",version:"0.1.7",for:"matter-js@^0.14.2",silent:!0,install:function(base){base.after("Body.create",function(){MatterAttractors$1.Body.init(this)}),base.before("Engine.update",function(engine){MatterAttractors$1.Engine.update(engine)})},Body:{init:function(body){body.plugin.attractors=body.plugin.attractors||[]}},Engine:{update:function(engine){for(var bodies=Matter$1.Composite.allBodies(engine.world),i=0;i<bodies.length;i++){var bodyA=bodies[i],attractors=bodyA.plugin.attractors;if(attractors&&0<attractors.length)for(var j=0;j<bodies.length;j++){var bodyB=bodies[j];if(i!==j)for(var k=0;k<attractors.length;k++){var attractor=attractors[k],forceVector=attractor;(forceVector=Matter$1.Common.isFunction(attractor)?attractor(bodyA,bodyB):forceVector)&&Matter$1.Body.applyForce(bodyB,bodyB.position,forceVector)}}}}},Attractors:{gravityConstant:.001,gravity:function(bodyA,bodyB){var normal=Matter$1.Vector.sub(bodyB.position,bodyA.position),force=Matter$1.Vector.magnitudeSquared(normal)||1e-4,normal=Matter$1.Vector.normalise(normal),force=-MatterAttractors$1.Attractors.gravityConstant*(bodyA.mass*bodyB.mass/force),force=Matter$1.Vector.mult(normal,force);Matter$1.Body.applyForce(bodyA,bodyA.position,Matter$1.Vector.neg(force)),Matter$1.Body.applyForce(bodyB,bodyB.position,force)}}},MatterAttractors_1=MatterAttractors$1,MatterCollisionEvents_1={name:"matter-collision-events",version:"0.1.6",for:"matter-js@^0.14.2",silent:!0,install:function(matter){matter.after("Engine.create",function(){matter.Events.on(this,"collisionStart",function(event){event.pairs.map(function(pair){var bodyA=pair.bodyA,bodyB=pair.bodyB;bodyA.gameObject&&bodyA.gameObject.emit("collide",bodyA,bodyB,pair),bodyB.gameObject&&bodyB.gameObject.emit("collide",bodyB,bodyA,pair),matter.Events.trigger(bodyA,"onCollide",{pair:pair}),matter.Events.trigger(bodyB,"onCollide",{pair:pair}),bodyA.onCollideCallback&&bodyA.onCollideCallback(pair),bodyB.onCollideCallback&&bodyB.onCollideCallback(pair),bodyA.onCollideWith[bodyB.id]&&bodyA.onCollideWith[bodyB.id](bodyB,pair),bodyB.onCollideWith[bodyA.id]&&bodyB.onCollideWith[bodyA.id](bodyA,pair)})}),matter.Events.on(this,"collisionActive",function(event){event.pairs.map(function(pair){var bodyA=pair.bodyA,bodyB=pair.bodyB;bodyA.gameObject&&bodyA.gameObject.emit("collideActive",bodyA,bodyB,pair),bodyB.gameObject&&bodyB.gameObject.emit("collideActive",bodyB,bodyA,pair),matter.Events.trigger(bodyA,"onCollideActive",{pair:pair}),matter.Events.trigger(bodyB,"onCollideActive",{pair:pair}),bodyA.onCollideActiveCallback&&bodyA.onCollideActiveCallback(pair),bodyB.onCollideActiveCallback&&bodyB.onCollideActiveCallback(pair)})}),matter.Events.on(this,"collisionEnd",function(event){event.pairs.map(function(pair){var bodyA=pair.bodyA,bodyB=pair.bodyB;bodyA.gameObject&&bodyA.gameObject.emit("collideEnd",bodyA,bodyB,pair),bodyB.gameObject&&bodyB.gameObject.emit("collideEnd",bodyB,bodyA,pair),matter.Events.trigger(bodyA,"onCollideEnd",{pair:pair}),matter.Events.trigger(bodyB,"onCollideEnd",{pair:pair}),bodyA.onCollideEndCallback&&bodyA.onCollideEndCallback(pair),bodyB.onCollideEndCallback&&bodyB.onCollideEndCallback(pair)})})})}},Matter=CustomMain,MatterWrap$1={name:"matter-wrap",version:"0.1.4",for:"matter-js@^0.14.2",silent:!0,install:function(base){base.after("Engine.update",function(){MatterWrap$1.Engine.update(this)})},Engine:{update:function(world){for(var world=world.world,bodies=Matter.Composite.allBodies(world),composites=Matter.Composite.allComposites(world),i=0;i<bodies.length;i+=1){var body=bodies[i];body.plugin.wrap&&MatterWrap$1.Body.wrap(body,body.plugin.wrap)}for(i=0;i<composites.length;i+=1){var composite=composites[i];composite.plugin.wrap&&MatterWrap$1.Composite.wrap(composite,composite.plugin.wrap)}}},Bounds:{wrap:function(objectBounds,bounds){var x=null,y=null;if(void 0!==bounds.min.x&&void 0!==bounds.max.x&&(objectBounds.min.x>bounds.max.x?x=bounds.min.x-objectBounds.max.x:objectBounds.max.x<bounds.min.x&&(x=bounds.max.x-objectBounds.min.x)),void 0!==bounds.min.y&&void 0!==bounds.max.y&&(objectBounds.min.y>bounds.max.y?y=bounds.min.y-objectBounds.max.y:objectBounds.max.y<bounds.min.y&&(y=bounds.max.y-objectBounds.min.y)),null!==x||null!==y)return{x:x||0,y:y||0}}},Body:{wrap:function(body,translation){translation=MatterWrap$1.Bounds.wrap(body.bounds,translation);return translation&&Matter.Body.translate(body,translation),translation}},Composite:{bounds:function(composite){for(var bodies=Matter.Composite.allBodies(composite),vertices=[],i=0;i<bodies.length;i+=1){var body=bodies[i];vertices.push(body.bounds.min,body.bounds.max)}return Matter.Bounds.create(vertices)},wrap:function(composite,translation){translation=MatterWrap$1.Bounds.wrap(MatterWrap$1.Composite.bounds(composite),translation);return translation&&Matter.Composite.translate(composite,translation),translation}}},MatterWrap_1=MatterWrap$1,Bodies$1=Bodies_1,Body$1=Body_1,renderer=Class_1,Common=Common_1,Composite$1=Composite_1,Engine=Engine_1,EventEmitter$2=eventemitter3.exports,Events$3=events$1,GetFastValue$c=GetFastValue_1,GetValue$8=GetValue_1,MatterBody=Body_1,MatterEvents=Events_1,MatterTileBody=plugins,MatterWorld=World_1$1,Vector$1=Vector_1,renderer=new renderer({Extends:EventEmitter$2,initialize:function(top,right){EventEmitter$2.call(this),this.scene=top,this.engine=Engine.create(right),this.localWorld=this.engine.world;var left=GetValue$8(right,"gravity",null);left?this.setGravity(left.x,left.y,left.scale):!1===left&&this.setGravity(0,0,0),this.walls={left:null,right:null,top:null,bottom:null},this.enabled=GetValue$8(right,"enabled",!0),this.correction=GetValue$8(right,"correction",1),this.getDelta=GetValue$8(right,"getDelta",this.update60Hz);var y=GetFastValue$c(right,"runner",{}),bottom=GetFastValue$c(y,"fps",!1),x=GetFastValue$c(y,"fps",60),width=GetFastValue$c(y,"delta",1e3/x),height=GetFastValue$c(y,"deltaMin",1e3/x),thickness=GetFastValue$c(y,"deltaMax",1e3/(.5*x));this.runner={fps:x=!bottom?1e3/width:x,correction:GetFastValue$c(y,"correction",1),deltaSampleSize:GetFastValue$c(y,"deltaSampleSize",60),counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:GetFastValue$c(y,"isFixed",!1),delta:width,deltaMin:height,deltaMax:thickness},this.autoUpdate=GetValue$8(right,"autoUpdate",!0);left=GetValue$8(right,"debug",!1);this.drawDebug="object"==typeof left||left,this.debugGraphic,this.debugConfig={showAxes:GetFastValue$c(left,"showAxes",!1),showAngleIndicator:GetFastValue$c(left,"showAngleIndicator",!1),angleColor:GetFastValue$c(left,"angleColor",15208787),showBroadphase:GetFastValue$c(left,"showBroadphase",!1),broadphaseColor:GetFastValue$c(left,"broadphaseColor",16757760),showBounds:GetFastValue$c(left,"showBounds",!1),boundsColor:GetFastValue$c(left,"boundsColor",16777215),showVelocity:GetFastValue$c(left,"showVelocity",!1),velocityColor:GetFastValue$c(left,"velocityColor",44783),showCollisions:GetFastValue$c(left,"showCollisions",!1),collisionColor:GetFastValue$c(left,"collisionColor",16094476),showSeparations:GetFastValue$c(left,"showSeparations",!1),separationColor:GetFastValue$c(left,"separationColor",16753920),showBody:GetFastValue$c(left,"showBody",!0),showStaticBody:GetFastValue$c(left,"showStaticBody",!0),showInternalEdges:GetFastValue$c(left,"showInternalEdges",!1),renderFill:GetFastValue$c(left,"renderFill",!1),renderLine:GetFastValue$c(left,"renderLine",!0),fillColor:GetFastValue$c(left,"fillColor",1075465),fillOpacity:GetFastValue$c(left,"fillOpacity",1),lineColor:GetFastValue$c(left,"lineColor",2678297),lineOpacity:GetFastValue$c(left,"lineOpacity",1),lineThickness:GetFastValue$c(left,"lineThickness",1),staticFillColor:GetFastValue$c(left,"staticFillColor",857979),staticLineColor:GetFastValue$c(left,"staticLineColor",1255396),showSleeping:GetFastValue$c(left,"showSleeping",!1),staticBodySleepOpacity:GetFastValue$c(left,"staticBodySleepOpacity",.7),sleepFillColor:GetFastValue$c(left,"sleepFillColor",4605510),sleepLineColor:GetFastValue$c(left,"sleepLineColor",10066585),showSensors:GetFastValue$c(left,"showSensors",!0),sensorFillColor:GetFastValue$c(left,"sensorFillColor",857979),sensorLineColor:GetFastValue$c(left,"sensorLineColor",1255396),showPositions:GetFastValue$c(left,"showPositions",!0),positionSize:GetFastValue$c(left,"positionSize",4),positionColor:GetFastValue$c(left,"positionColor",14697178),showJoint:GetFastValue$c(left,"showJoint",!0),jointColor:GetFastValue$c(left,"jointColor",14737474),jointLineOpacity:GetFastValue$c(left,"jointLineOpacity",1),jointLineThickness:GetFastValue$c(left,"jointLineThickness",2),pinSize:GetFastValue$c(left,"pinSize",4),pinColor:GetFastValue$c(left,"pinColor",4382944),springColor:GetFastValue$c(left,"springColor",14697184),anchorColor:GetFastValue$c(left,"anchorColor",15724527),anchorSize:GetFastValue$c(left,"anchorSize",4),showConvexHulls:GetFastValue$c(left,"showConvexHulls",!1),hullColor:GetFastValue$c(left,"hullColor",14091216)},this.drawDebug&&this.createDebugGraphic(),this.setEventsProxy(),GetFastValue$c(right,"setBounds",!1)&&("boolean"==typeof(bottom=right.setBounds)?this.setBounds():(x=GetFastValue$c(bottom,"x",0),y=GetFastValue$c(bottom,"y",0),width=GetFastValue$c(bottom,"width",top.sys.scale.width),height=GetFastValue$c(bottom,"height",top.sys.scale.height),thickness=GetFastValue$c(bottom,"thickness",64),left=GetFastValue$c(bottom,"left",!0),right=GetFastValue$c(bottom,"right",!0),top=GetFastValue$c(bottom,"top",!0),bottom=GetFastValue$c(bottom,"bottom",!0),this.setBounds(x,y,width,height,thickness,left,right,top,bottom)))},setCompositeRenderStyle:function(composite){for(var obj,render,bodies=composite.bodies,constraints=composite.constraints,composites=composite.composites,i=0;i<bodies.length;i++)render=(obj=bodies[i]).render,this.setBodyRenderStyle(obj,render.lineColor,render.lineOpacity,render.lineThickness,render.fillColor,render.fillOpacity);for(i=0;i<constraints.length;i++)render=(obj=constraints[i]).render,this.setConstraintRenderStyle(obj,render.lineColor,render.lineOpacity,render.lineThickness,render.pinSize,render.anchorColor,render.anchorSize);for(i=0;i<composites.length;i++)obj=composites[i],this.setCompositeRenderStyle(obj);return this},setBodyRenderStyle:function(body,lineColor,lineOpacity,lineThickness,fillColor,fillOpacity){var render=body.render,config=this.debugConfig;return render&&(null==lineColor&&(lineColor=body.isStatic?config.staticLineColor:config.lineColor),null==lineOpacity&&(lineOpacity=config.lineOpacity),null==lineThickness&&(lineThickness=config.lineThickness),null==fillColor&&(fillColor=body.isStatic?config.staticFillColor:config.fillColor),null==fillOpacity&&(fillOpacity=config.fillOpacity),!1!==lineColor&&(render.lineColor=lineColor),!1!==lineOpacity&&(render.lineOpacity=lineOpacity),!1!==lineThickness&&(render.lineThickness=lineThickness),!1!==fillColor&&(render.fillColor=fillColor),!1!==fillOpacity&&(render.fillOpacity=fillOpacity)),this},setConstraintRenderStyle:function(type,lineColor,lineOpacity,lineThickness,pinSize,anchorColor,anchorSize){var render=type.render,config=this.debugConfig;return render&&(null==lineColor&&("line"===(type=render.type)?lineColor=config.jointColor:"pin"===type?lineColor=config.pinColor:"spring"===type&&(lineColor=config.springColor)),null==lineOpacity&&(lineOpacity=config.jointLineOpacity),null==lineThickness&&(lineThickness=config.jointLineThickness),null==pinSize&&(pinSize=config.pinSize),null==anchorColor&&(anchorColor=config.anchorColor),null==anchorSize&&(anchorSize=config.anchorSize),!1!==lineColor&&(render.lineColor=lineColor),!1!==lineOpacity&&(render.lineOpacity=lineOpacity),!1!==lineThickness&&(render.lineThickness=lineThickness),!1!==pinSize&&(render.pinSize=pinSize),!1!==anchorColor&&(render.anchorColor=anchorColor),!1!==anchorSize&&(render.anchorSize=anchorSize)),this},setEventsProxy:function(){var _this=this,engine=this.engine,world=this.localWorld;this.drawDebug&&(MatterEvents.on(world,"compositeModified",function(composite){_this.setCompositeRenderStyle(composite)}),MatterEvents.on(world,"beforeAdd",function(event){for(var objects=[].concat(event.object),i=0;i<objects.length;i++){var obj=objects[i],render=obj.render;"body"===obj.type?_this.setBodyRenderStyle(obj,render.lineColor,render.lineOpacity,render.lineThickness,render.fillColor,render.fillOpacity):"composite"===obj.type?_this.setCompositeRenderStyle(obj):"constraint"===obj.type&&_this.setConstraintRenderStyle(obj,render.lineColor,render.lineOpacity,render.lineThickness,render.pinSize,render.anchorColor,render.anchorSize)}})),MatterEvents.on(world,"beforeAdd",function(event){_this.emit(Events$3.BEFORE_ADD,event)}),MatterEvents.on(world,"afterAdd",function(event){_this.emit(Events$3.AFTER_ADD,event)}),MatterEvents.on(world,"beforeRemove",function(event){_this.emit(Events$3.BEFORE_REMOVE,event)}),MatterEvents.on(world,"afterRemove",function(event){_this.emit(Events$3.AFTER_REMOVE,event)}),MatterEvents.on(engine,"beforeUpdate",function(event){_this.emit(Events$3.BEFORE_UPDATE,event)}),MatterEvents.on(engine,"afterUpdate",function(event){_this.emit(Events$3.AFTER_UPDATE,event)}),MatterEvents.on(engine,"collisionStart",function(event){var bodyA,bodyB,pairs=event.pairs;0<pairs.length&&(bodyA=pairs[0].bodyA,bodyB=pairs[0].bodyB),_this.emit(Events$3.COLLISION_START,event,bodyA,bodyB)}),MatterEvents.on(engine,"collisionActive",function(event){var bodyA,bodyB,pairs=event.pairs;0<pairs.length&&(bodyA=pairs[0].bodyA,bodyB=pairs[0].bodyB),_this.emit(Events$3.COLLISION_ACTIVE,event,bodyA,bodyB)}),MatterEvents.on(engine,"collisionEnd",function(event){var bodyA,bodyB,pairs=event.pairs;0<pairs.length&&(bodyA=pairs[0].bodyA,bodyB=pairs[0].bodyB),_this.emit(Events$3.COLLISION_END,event,bodyA,bodyB)})},setBounds:function(x,y,width,height,thickness,left,right,top,bottom){return void 0===width&&(width=this.scene.sys.scale.width),void 0===height&&(height=this.scene.sys.scale.height),void 0===right&&(right=!0),void 0===top&&(top=!0),void 0===bottom&&(bottom=!0),this.updateWall(left=void 0===left?!0:left,"left",(x=void 0===x?0:x)-(thickness=void 0===thickness?64:thickness),(y=void 0===y?0:y)-thickness,thickness,height+2*thickness),this.updateWall(right,"right",x+width,y-thickness,thickness,height+2*thickness),this.updateWall(top,"top",x,y-thickness,width,thickness),this.updateWall(bottom,"bottom",x,y+height,width,thickness),this},updateWall:function(add,position,x,y,width,height){var wall=this.walls[position];add?(wall&&MatterWorld.remove(this.localWorld,wall),this.walls[position]=this.create(x+=width/2,y+=height/2,width,height,{isStatic:!0,friction:0,frictionStatic:0})):(wall&&MatterWorld.remove(this.localWorld,wall),this.walls[position]=null)},createDebugGraphic:function(){var graphic=this.scene.sys.add.graphics({x:0,y:0});return graphic.setDepth(Number.MAX_VALUE),this.debugGraphic=graphic,this.drawDebug=!0,graphic},disableGravity:function(){return this.localWorld.gravity.x=0,this.localWorld.gravity.y=0,this.localWorld.gravity.scale=0,this},setGravity:function(x,y,scale){return void 0===y&&(y=1),this.localWorld.gravity.x=x=void 0===x?0:x,this.localWorld.gravity.y=y,void 0!==scale&&(this.localWorld.gravity.scale=scale),this},create:function(x,y,width,height,body){body=Bodies$1.rectangle(x,y,width,height,body);return MatterWorld.add(this.localWorld,body),body},add:function(object){return MatterWorld.add(this.localWorld,object),this},remove:function(object,deep){Array.isArray(object)||(object=[object]);for(var i=0;i<object.length;i++){var body=object[i],body=body.body||body;Composite$1.remove(this.localWorld,body,deep)}return this},removeConstraint:function(constraint,deep){return Composite$1.remove(this.localWorld,constraint,deep),this},convertTilemapLayer:function(tilemapLayer,options){var tiles=tilemapLayer.layer,tiles=tilemapLayer.getTilesWithin(0,0,tiles.width,tiles.height,{isColliding:!0});return this.convertTiles(tiles,options),this},convertTiles:function(tiles,options){if(0===tiles.length)return this;for(var i=0;i<tiles.length;i++)new MatterTileBody(this,tiles[i],options);return this},nextGroup:function(isNonColliding){return MatterBody.nextGroup(isNonColliding)},nextCategory:function(){return MatterBody.nextCategory()},pause:function(){return this.enabled=!1,this.emit(Events$3.PAUSE),this},resume:function(){return this.enabled=!0,this.emit(Events$3.RESUME),this},update:function(time,delta){var engine,runner,timing,correction;this.enabled&&this.autoUpdate&&(engine=this.engine,runner=this.runner,timing=engine.timing,correction=this.correction,runner.isFixed?delta=this.getDelta(time,delta):(delta=time-runner.timePrev||runner.delta,runner.timePrev=time,runner.deltaHistory.push(delta),runner.deltaHistory=runner.deltaHistory.slice(-runner.deltaSampleSize),correction=(delta=(delta=(delta=Math.min.apply(null,runner.deltaHistory))<runner.deltaMin?runner.deltaMin:delta)>runner.deltaMax?runner.deltaMax:delta)/runner.delta,runner.delta=delta),0!==runner.timeScalePrev&&(correction*=timing.timeScale/runner.timeScalePrev),0===timing.timeScale&&(correction=0),runner.timeScalePrev=timing.timeScale,runner.correction=correction,runner.frameCounter+=1,1e3<=time-runner.counterTimestamp&&(runner.fps=runner.frameCounter*((time-runner.counterTimestamp)/1e3),runner.counterTimestamp=time,runner.frameCounter=0),Engine.update(engine,delta,correction))},step:function(delta,correction){Engine.update(this.engine,delta,correction)},update60Hz:function(){return 1e3/60},update30Hz:function(){return 1e3/30},has:function(src){src=src.hasOwnProperty("body")?src.body:src;return null!==Composite$1.get(this.localWorld,src.id,src.type)},getAllBodies:function(){return Composite$1.allBodies(this.localWorld)},getAllConstraints:function(){return Composite$1.allConstraints(this.localWorld)},getAllComposites:function(){return Composite$1.allComposites(this.localWorld)},postUpdate:function(){var config,engine,graphics,bodies;this.drawDebug&&(config=this.debugConfig,engine=this.engine,graphics=this.debugGraphic,bodies=Composite$1.allBodies(this.localWorld),this.debugGraphic.clear(),config.showBroadphase&&engine.broadphase.controller&&this.renderGrid(engine.broadphase,graphics,config.broadphaseColor,.5),config.showBounds&&this.renderBodyBounds(bodies,graphics,config.boundsColor,.5),(config.showBody||config.showStaticBody)&&this.renderBodies(bodies),config.showJoint&&this.renderJoints(),(config.showAxes||config.showAngleIndicator)&&this.renderBodyAxes(bodies,graphics,config.showAxes,config.angleColor,.5),config.showVelocity&&this.renderBodyVelocity(bodies,graphics,config.velocityColor,1,2),config.showSeparations&&this.renderSeparations(engine.pairs.list,graphics,config.separationColor),config.showCollisions&&this.renderCollisions(engine.pairs.list,graphics,config.collisionColor))},renderGrid:function(grid,graphics,lineColor,lineOpacity){graphics.lineStyle(1,lineColor,lineOpacity);for(var bucketKeys=Common.keys(grid.buckets),i=0;i<bucketKeys.length;i++){var region=bucketKeys[i];grid.buckets[region].length<2||(region=region.split(/C|R/),graphics.strokeRect(parseInt(region[1],10)*grid.bucketWidth,parseInt(region[2],10)*grid.bucketHeight,grid.bucketWidth,grid.bucketHeight))}return this},renderSeparations:function(pairs,graphics,lineColor){graphics.lineStyle(1,lineColor,1);for(var i=0;i<pairs.length;i++){var bodyA,bodyB,posA,posB,k,penetration=pairs[i];penetration.isActive&&(bodyA=(k=penetration.collision).bodyA,bodyB=k.bodyB,posA=bodyA.position,posB=bodyB.position,penetration=k.penetration,k=bodyA.isStatic||bodyB.isStatic?1:4,bodyB.isStatic&&(k=0),graphics.lineBetween(posB.x,posB.y,posB.x-penetration.x*k,posB.y-penetration.y*k),k=bodyA.isStatic||bodyB.isStatic?1:4,bodyA.isStatic&&(k=0),graphics.lineBetween(posA.x,posA.y,posA.x-penetration.x*k,posA.y-penetration.y*k))}return this},renderCollisions:function(pairs,graphics,lineColor){var i,collision,contacts,normalPosX,normalPosY,pair;for(graphics.lineStyle(1,lineColor,.5),graphics.fillStyle(lineColor,1),i=0;i<pairs.length;i++)if((pair=pairs[i]).isActive)for(var j=0;j<pair.activeContacts.length;j++){var vertex=pair.activeContacts[j].vertex;graphics.fillRect(vertex.x-2,vertex.y-2,5,5)}for(i=0;i<pairs.length;i++)(pair=pairs[i]).isActive&&(collision=pair.collision,0<(contacts=pair.activeContacts).length&&(normalPosX=contacts[0].vertex.x,normalPosY=contacts[0].vertex.y,2===contacts.length&&(normalPosX=(contacts[0].vertex.x+contacts[1].vertex.x)/2,normalPosY=(contacts[0].vertex.y+contacts[1].vertex.y)/2),collision.bodyB===collision.supports[0].body||collision.bodyA.isStatic?graphics.lineBetween(normalPosX-8*collision.normal.x,normalPosY-8*collision.normal.y,normalPosX,normalPosY):graphics.lineBetween(normalPosX+8*collision.normal.x,normalPosY+8*collision.normal.y,normalPosX,normalPosY)));return this},renderBodyBounds:function(bodies,graphics,lineColor,lineOpacity){graphics.lineStyle(1,lineColor,lineOpacity);for(var i=0;i<bodies.length;i++){var body=bodies[i];if(body.render.visible){var bounds=body.bounds;if(bounds)graphics.strokeRect(bounds.min.x,bounds.min.y,bounds.max.x-bounds.min.x,bounds.max.y-bounds.min.y);else for(var parts=body.parts,j=1<parts.length?1:0;j<parts.length;j++){var part=parts[j];graphics.strokeRect(part.bounds.min.x,part.bounds.min.y,part.bounds.max.x-part.bounds.min.x,part.bounds.max.y-part.bounds.min.y)}}}return this},renderBodyAxes:function(bodies,graphics,showAxes,lineColor,lineOpacity){graphics.lineStyle(1,lineColor,lineOpacity);for(var i=0;i<bodies.length;i++){var part,j,k,body=bodies[i],parts=body.parts;if(body.render.visible)if(showAxes)for(j=1<parts.length?1:0;j<parts.length;j++)for(part=parts[j],k=0;k<part.axes.length;k++){var axis=part.axes[k];graphics.lineBetween(part.position.x,part.position.y,part.position.x+20*axis.x,part.position.y+20*axis.y)}else for(j=1<parts.length?1:0;j<parts.length;j++)for(part=parts[j],k=0;k<part.axes.length;k++)graphics.lineBetween(part.position.x,part.position.y,(part.vertices[0].x+part.vertices[part.vertices.length-1].x)/2,(part.vertices[0].y+part.vertices[part.vertices.length-1].y)/2)}return this},renderBodyVelocity:function(bodies,graphics,lineColor,lineOpacity,lineThickness){graphics.lineStyle(lineThickness,lineColor,lineOpacity);for(var i=0;i<bodies.length;i++){var body=bodies[i];body.render.visible&&graphics.lineBetween(body.position.x,body.position.y,body.position.x+2*(body.position.x-body.positionPrev.x),body.position.y+2*(body.position.y-body.positionPrev.y))}return this},renderBodies:function(bodies){for(var graphics=this.debugGraphic,config=this.debugConfig,showBody=config.showBody,showStaticBody=config.showStaticBody,showSleeping=config.showSleeping,showInternalEdges=config.showInternalEdges,showConvexHulls=config.showConvexHulls,renderFill=config.renderFill,renderLine=config.renderLine,staticBodySleepOpacity=config.staticBodySleepOpacity,sleepFillColor=config.sleepFillColor,sleepLineColor=config.sleepLineColor,hullColor=config.hullColor,i=0;i<bodies.length;i++){var lineColor,lineOpacity,lineThickness,fillColor,partsLength,body=bodies[i];body.render.visible&&(!showStaticBody&&body.isStatic||!showBody&&!body.isStatic||(lineColor=body.render.lineColor,lineOpacity=body.render.lineOpacity,lineThickness=body.render.lineThickness,fillColor=body.render.fillColor,partsLength=body.render.fillOpacity,showSleeping&&body.isSleeping&&(body.isStatic?(lineOpacity*=staticBodySleepOpacity,partsLength*=staticBodySleepOpacity):(lineColor=sleepLineColor,fillColor=sleepFillColor)),this.renderBody(body,graphics,showInternalEdges,lineColor=!renderLine?null:lineColor,lineOpacity,lineThickness,fillColor=!renderFill?null:fillColor,partsLength),partsLength=body.parts.length,showConvexHulls&&1<partsLength&&this.renderConvexHull(body,graphics,hullColor,lineThickness)))}},renderBody:function(hs,graphics,showInternalEdges,lineColor,lineOpacity,lineThickness,fillColor,fillOpacity){void 0===lineColor&&(lineColor=null),void 0===lineOpacity&&(lineOpacity=null),void 0===lineThickness&&(lineThickness=1),void 0===fillColor&&(fillColor=null),void 0===fillOpacity&&(fillOpacity=null);for(var px,py,config=this.debugConfig,sensorFillColor=config.sensorFillColor,sensorLineColor=config.sensorLineColor,parts=hs.parts,partsLength=parts.length,k=1<partsLength?1:0;k<partsLength;k++){var part=parts[k],circleRadius=part.render,opacity=circleRadius.opacity;if(circleRadius.visible&&0!==opacity&&(!part.isSensor||config.showSensors)){circleRadius=part.circleRadius;if(graphics.beginPath(),part.isSensor?(null!==fillColor&&graphics.fillStyle(sensorFillColor,fillOpacity*opacity),null!==lineColor&&graphics.lineStyle(lineThickness,sensorLineColor,lineOpacity*opacity)):(null!==fillColor&&graphics.fillStyle(fillColor,fillOpacity*opacity),null!==lineColor&&graphics.lineStyle(lineThickness,lineColor,lineOpacity*opacity)),circleRadius)graphics.arc(part.position.x,part.position.y,circleRadius,0,2*Math.PI);else{var vertices=part.vertices,vertLength=vertices.length;graphics.moveTo(vertices[0].x,vertices[0].y);for(var j=1;j<vertLength;j++){var nextIndex=vertices[j];!vertices[j-1].isInternal||showInternalEdges?graphics.lineTo(nextIndex.x,nextIndex.y):graphics.moveTo(nextIndex.x,nextIndex.y),j<vertLength&&nextIndex.isInternal&&!showInternalEdges&&graphics.moveTo(vertices[nextIndex=(j+1)%vertLength].x,vertices[nextIndex].y)}graphics.closePath()}null!==fillColor&&graphics.fillPath(),null!==lineColor&&graphics.strokePath()}}return config.showPositions&&!hs.isStatic&&(px=hs.position.x,py=hs.position.y,hs=Math.ceil(config.positionSize/2),graphics.fillStyle(config.positionColor,1),graphics.fillRect(px-hs,py-hs,config.positionSize,config.positionSize)),this},renderConvexHull:function(body,graphics,hullColor,lineThickness){if(void 0===lineThickness&&(lineThickness=1),1<body.parts.length){var verts=body.vertices;graphics.lineStyle(lineThickness,hullColor),graphics.beginPath(),graphics.moveTo(verts[0].x,verts[0].y);for(var v=1;v<verts.length;v++)graphics.lineTo(verts[v].x,verts[v].y);graphics.lineTo(verts[0].x,verts[0].y),graphics.strokePath()}return this},renderJoints:function(){for(var graphics=this.debugGraphic,constraints=Composite$1.allConstraints(this.localWorld),i=0;i<constraints.length;i++){var anchorSize=constraints[i].render,lineColor=anchorSize.lineColor,lineOpacity=anchorSize.lineOpacity,lineThickness=anchorSize.lineThickness,pinSize=anchorSize.pinSize,anchorColor=anchorSize.anchorColor,anchorSize=anchorSize.anchorSize;this.renderConstraint(constraints[i],graphics,lineColor,lineOpacity,lineThickness,pinSize,anchorColor,anchorSize)}},renderConstraint:function(constraint,graphics,bodyA,bodyB,lineThickness,pinSize,anchorColor,anchorSize){var render=constraint.render;if(!render.visible||!constraint.pointA||!constraint.pointB)return this;graphics.lineStyle(lineThickness,bodyA,bodyB);var end,bodyA=constraint.bodyA,bodyB=constraint.bodyB,start=bodyA?Vector$1.add(bodyA.position,constraint.pointA):constraint.pointA;if("pin"===render.type)graphics.strokeCircle(start.x,start.y,pinSize);else{if(end=bodyB?Vector$1.add(bodyB.position,constraint.pointB):constraint.pointB,graphics.beginPath(),graphics.moveTo(start.x,start.y),"spring"===render.type)for(var offset,delta=Vector$1.sub(end,start),normal=Vector$1.perp(Vector$1.normalise(delta)),coils=Math.ceil(Common.clamp(constraint.length/5,12,20)),j=1;j<coils;j+=1)graphics.lineTo(start.x+delta.x*(j/coils)+normal.x*(offset=j%2==0?1:-1)*4,start.y+delta.y*(j/coils)+normal.y*offset*4);graphics.lineTo(end.x,end.y)}return graphics.strokePath(),render.anchors&&0<anchorSize&&(graphics.fillStyle(anchorColor),graphics.fillCircle(start.x,start.y,anchorSize),graphics.fillCircle(end.x,end.y,anchorSize)),this},resetCollisionIDs:function(){return Body$1._nextCollidingGroupId=1,Body$1._nextNonCollidingGroupId=-1,Body$1._nextCategory=1,this},shutdown:function(){MatterEvents.off(this.engine),this.removeAllListeners(),MatterWorld.clear(this.localWorld,!1),Engine.clear(this.engine),this.drawDebug&&this.debugGraphic.destroy()},destroy:function(){this.shutdown()}}),ALIGN_CONST=_const$d,Axes=Axes_1,Bodies=Bodies_1,Body=Body_1,BodyBounds=BodyBounds_1,Bounds=Bounds_1,Composite=Composite_1,Composites=Composites_1,Constraint=Constraint_1,Detector=Detector_1,DistanceBetween=DistanceBetween_1,Factory=Factory_1,GetFastValue$b=GetFastValue_1,GetValue$7=GetValue_1,Grid=Grid_1,MatterAttractors=MatterAttractors_1,MatterCollisionEvents=MatterCollisionEvents_1,MatterLib=Matter_1,MatterWrap=MatterWrap_1,Merge=Merge_1,Pair=Pair_1,Pairs=Pairs_1,Plugin=PluginCache$3,PluginCache$3=PluginCache,Query=Query_1,Resolver=Resolver_1,SAT=SAT_1,SceneEvents$3=events$g,Svg=Svg_1,Vector=Vector_1,Vertices=MatterPhysics,World=renderer,MatterPhysics=new Class_1({initialize:function(scene){this.scene=scene,this.systems=scene.sys,this.config=this.getConfig(),this.world,this.add,this.bodyBounds,this.body=Body,this.composite=Composite,this.detector=Detector,this.grid=Grid,this.pair=Pair,this.pairs=Pairs,this.query=Query,this.resolver=Resolver,this.sat=SAT,this.constraint=Constraint,this.bodies=Bodies,this.composites=Composites,this.axes=Axes,this.bounds=Bounds,this.svg=Svg,this.vector=Vector,this.vertices=Vertices,this.verts=Vertices,this._tempVec2=Vector.create(),GetValue$7(this.config,"plugins.collisionevents",!0)&&this.enableCollisionEventsPlugin(),GetValue$7(this.config,"plugins.attractors",!1)&&this.enableAttractorPlugin(),GetValue$7(this.config,"plugins.wrap",!1)&&this.enableWrapPlugin(),Resolver._restingThresh=GetValue$7(this.config,"restingThresh",4),Resolver._restingThreshTangent=GetValue$7(this.config,"restingThreshTangent",6),Resolver._positionDampen=GetValue$7(this.config,"positionDampen",.9),Resolver._positionWarming=GetValue$7(this.config,"positionWarming",.8),Resolver._frictionNormalMultiplier=GetValue$7(this.config,"frictionNormalMultiplier",5),scene.sys.events.once(SceneEvents$3.BOOT,this.boot,this),scene.sys.events.on(SceneEvents$3.START,this.start,this)},boot:function(){this.world=new World(this.scene,this.config),this.add=new Factory(this.world),this.bodyBounds=new BodyBounds,this.systems.events.once(SceneEvents$3.DESTROY,this.destroy,this)},start:function(){this.world||(this.world=new World(this.scene,this.config),this.add=new Factory(this.world));var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents$3.UPDATE,this.world.update,this.world),eventEmitter.on(SceneEvents$3.POST_UPDATE,this.world.postUpdate,this.world),eventEmitter.once(SceneEvents$3.SHUTDOWN,this.shutdown,this)},getConfig:function(){var gameConfig=this.systems.game.config.physics,sceneConfig=this.systems.settings.physics;return Merge(GetFastValue$b(sceneConfig,"matter",{}),GetFastValue$b(gameConfig,"matter",{}))},enableAttractorPlugin:function(){return Plugin.register(MatterAttractors),Plugin.use(MatterLib,MatterAttractors),this},enableWrapPlugin:function(){return Plugin.register(MatterWrap),Plugin.use(MatterLib,MatterWrap),this},enableCollisionEventsPlugin:function(){return Plugin.register(MatterCollisionEvents),Plugin.use(MatterLib,MatterCollisionEvents),this},pause:function(){return this.world.pause()},resume:function(){return this.world.resume()},set60Hz:function(){return this.world.getDelta=this.world.update60Hz,this.world.autoUpdate=!0,this},set30Hz:function(){return this.world.getDelta=this.world.update30Hz,this.world.autoUpdate=!0,this},step:function(delta,correction){this.world.step(delta,correction)},containsPoint:function(body,x,position){body=this.getMatterBodies(body);position=Vector.create(x,position);return 0<Query.point(body,position).length},intersectPoint:function(x,position,bodies){bodies=this.getMatterBodies(bodies);var position=Vector.create(x,position),output=[];return Query.point(bodies,position).forEach(function(body){-1===output.indexOf(body)&&output.push(body)}),output},intersectRect:function(x,y,width,height,outside,bodies){void 0===outside&&(outside=!1),bodies=this.getMatterBodies(bodies);var output=[];return Query.region(bodies,{min:{x:x,y:y},max:{x:x+width,y:y+height}},outside).forEach(function(body){-1===output.indexOf(body)&&output.push(body)}),output},intersectRay:function(x1,y1,x2,y2,rayWidth,bodies){void 0===rayWidth&&(rayWidth=1),bodies=this.getMatterBodies(bodies);for(var result=[],collisions=Query.ray(bodies,Vector.create(x1,y1),Vector.create(x2,y2),rayWidth),i=0;i<collisions.length;i++)result.push(collisions[i].body);return result},intersectBody:function(body,bodies){bodies=this.getMatterBodies(bodies);for(var result=[],collisions=Query.collides(body,bodies),i=0;i<collisions.length;i++){var pair=collisions[i];pair.bodyA===body?result.push(pair.bodyB):result.push(pair.bodyA)}return result},overlap:function(target,bodies,overlapCallback,processCallback,callbackContext){void 0===overlapCallback&&(overlapCallback=null),void 0===processCallback&&(processCallback=null),void 0===callbackContext&&(callbackContext=overlapCallback),Array.isArray(target)||(target=[target]),target=this.getMatterBodies(target),bodies=this.getMatterBodies(bodies);for(var match=!1,i=0;i<target.length;i++)for(var entry=target[i],collisions=Query.collides(entry,bodies),c=0;c<collisions.length;c++){var info=collisions[c],bodyB=info.bodyA.id===entry.id?info.bodyB:info.bodyA;if(!processCallback||processCallback.call(callbackContext,entry,bodyB,info))if(match=!0,overlapCallback)overlapCallback.call(callbackContext,entry,bodyB,info);else if(!processCallback)return!0}return match},setCollisionCategory:function(bodies,value){return(bodies=this.getMatterBodies(bodies)).forEach(function(body){body.collisionFilter.category=value}),this},setCollisionGroup:function(bodies,value){return(bodies=this.getMatterBodies(bodies)).forEach(function(body){body.collisionFilter.group=value}),this},setCollidesWith:function(bodies,categories){bodies=this.getMatterBodies(bodies);var flags=0;if(Array.isArray(categories))for(var i=0;i<categories.length;i++)flags|=categories[i];else flags=categories;return bodies.forEach(function(body){body.collisionFilter.mask=flags}),this},getMatterBodies:function(bodies){if(!bodies)return this.world.getAllBodies();Array.isArray(bodies)||(bodies=[bodies]);for(var output=[],i=0;i<bodies.length;i++){var body=bodies[i].hasOwnProperty("body")?bodies[i].body:bodies[i];output.push(body)}return output},setVelocity:function(bodies,x,y){bodies=this.getMatterBodies(bodies);var vec2=this._tempVec2;return vec2.x=x,vec2.y=y,bodies.forEach(function(body){Body.setVelocity(body,vec2)}),this},setVelocityX:function(bodies,x){bodies=this.getMatterBodies(bodies);var vec2=this._tempVec2;return vec2.x=x,bodies.forEach(function(body){vec2.y=body.velocity.y,Body.setVelocity(body,vec2)}),this},setVelocityY:function(bodies,y){bodies=this.getMatterBodies(bodies);var vec2=this._tempVec2;return vec2.y=y,bodies.forEach(function(body){vec2.x=body.velocity.x,Body.setVelocity(body,vec2)}),this},setAngularVelocity:function(bodies,value){return(bodies=this.getMatterBodies(bodies)).forEach(function(body){Body.setAngularVelocity(body,value)}),this},applyForce:function(bodies,force){bodies=this.getMatterBodies(bodies);var vec2=this._tempVec2;return bodies.forEach(function(body){vec2.x=body.position.x,vec2.y=body.position.y,Body.applyForce(body,vec2,force)}),this},applyForceFromPosition:function(bodies,position,speed,angle){bodies=this.getMatterBodies(bodies);var vec2=this._tempVec2;return bodies.forEach(function(body){void 0===angle&&(angle=body.angle),vec2.x=speed*Math.cos(angle),vec2.y=speed*Math.sin(angle),Body.applyForce(body,position,vec2)}),this},applyForceFromAngle:function(bodies,speed,angle){bodies=this.getMatterBodies(bodies);var vec2=this._tempVec2;return bodies.forEach(function(body){void 0===angle&&(angle=body.angle),vec2.x=speed*Math.cos(angle),vec2.y=speed*Math.sin(angle),Body.applyForce(body,{x:body.position.x,y:body.position.y},vec2)}),this},getConstraintLength:function(constraint){var aX=constraint.pointA.x,aY=constraint.pointA.y,bX=constraint.pointB.x,bY=constraint.pointB.y;return constraint.bodyA&&(aX+=constraint.bodyA.position.x,aY+=constraint.bodyA.position.y),constraint.bodyB&&(bX+=constraint.bodyB.position.x,bY+=constraint.bodyB.position.y),DistanceBetween(aX,aY,bX,bY)},alignBody:function(body,x,y,align){var pos;switch(body=body.hasOwnProperty("body")?body.body:body,align){case ALIGN_CONST.TOP_LEFT:case ALIGN_CONST.LEFT_TOP:pos=this.bodyBounds.getTopLeft(body,x,y);break;case ALIGN_CONST.TOP_CENTER:pos=this.bodyBounds.getTopCenter(body,x,y);break;case ALIGN_CONST.TOP_RIGHT:case ALIGN_CONST.RIGHT_TOP:pos=this.bodyBounds.getTopRight(body,x,y);break;case ALIGN_CONST.LEFT_CENTER:pos=this.bodyBounds.getLeftCenter(body,x,y);break;case ALIGN_CONST.CENTER:pos=this.bodyBounds.getCenter(body,x,y);break;case ALIGN_CONST.RIGHT_CENTER:pos=this.bodyBounds.getRightCenter(body,x,y);break;case ALIGN_CONST.LEFT_BOTTOM:case ALIGN_CONST.BOTTOM_LEFT:pos=this.bodyBounds.getBottomLeft(body,x,y);break;case ALIGN_CONST.BOTTOM_CENTER:pos=this.bodyBounds.getBottomCenter(body,x,y);break;case ALIGN_CONST.BOTTOM_RIGHT:case ALIGN_CONST.RIGHT_BOTTOM:pos=this.bodyBounds.getBottomRight(body,x,y)}return pos&&Body.setPosition(body,pos),this},shutdown:function(){var eventEmitter=this.systems.events;this.world&&(eventEmitter.off(SceneEvents$3.UPDATE,this.world.update,this.world),eventEmitter.off(SceneEvents$3.POST_UPDATE,this.world.postUpdate,this.world)),eventEmitter.off(SceneEvents$3.SHUTDOWN,this.shutdown,this),this.add&&this.add.destroy(),this.world&&this.world.destroy(),this.add=null,this.world=null},destroy:function(){this.shutdown(),this.scene.sys.events.off(SceneEvents$3.START,this.start,this),this.scene=null,this.systems=null}});PluginCache$3.register("MatterPhysics",MatterPhysics,"matterPhysics");var physics={Arcade:arcade,Matter:{BodyBounds:BodyBounds_1,Components:components$1,Events:events$1,Factory:Factory_1,MatterGameObject:MatterGameObject_1,Image:MatterImage_1,Matter:CustomMain,MatterPhysics:MatterPhysics,PolyDecomp:physics,Sprite:GetTileAtWorldXY_1,TileBody:plugins,PhysicsEditorParser:GetTargets_1,PhysicsJSONParser:IsInLayerBounds_1,PointerConstraint:HasTileAt_1,World:renderer}},GetTileAtWorldXY_1=new Class_1({initialize:function(pluginManager){this.pluginManager=pluginManager,this.game=pluginManager.game},init:function(){},start:function(){},stop:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}}),BasePlugin=GetTileAtWorldXY_1,SceneEvents$2=events$g,plugins={BasePlugin:GetTileAtWorldXY_1,DefaultPlugins:ParseCSV_1,PluginCache:PluginCache,PluginManager:GetTilesWithinShape_1,ScenePlugin:new Class_1({Extends:BasePlugin,initialize:function(scene,pluginManager,pluginKey){BasePlugin.call(this,pluginManager),this.scene=scene,this.systems=scene.sys,this.pluginKey=pluginKey,scene.sys.events.once(SceneEvents$2.BOOT,this.boot,this)},boot:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}})},GetTargets_1={CanvasRenderer:CanvasRenderer_1,GetBlendModes:scale,SetTransform:parsers},IsInLayerBounds_1={Canvas:ParseObjectLayers_1,WebGL:scene},HasTileAt_1=["#define SHADER_NAME PHASER_POSTFX_FS","","precision mediump float;","","uniform sampler2D uMainSampler;","","varying vec2 outTexCoord;","","void main ()","{","    gl_FragColor = texture2D(uMainSampler, outTexCoord);","}",""].join("\n"),ColorMatrix=structs,GetFastValue$a=GetFastValue_1,ShaderSourceFS=HasTileAt_1,ShaderSourceVS=textures,WebGLPipeline=FilterTiles_1,renderer={Canvas:GetTargets_1,Events:events,Snapshot:IsInLayerBounds_1,WebGL:Extend_1$1(!1,{PipelineManager:GetTileAt_1,Pipelines:Extend_1$1(!1,{BitmapMaskPipeline:CalculateFacesAt_1,Events:CalculateFacesWithin_1,GraphicsPipeline:CheckIsoBounds_1,LightPipeline:Copy_1,MultiPipeline:CreateGroupLayer_1,PointLightPipeline:CreateFromTiles_1,PostFXPipeline:new Class_1({Extends:WebGLPipeline,initialize:function(config){config.renderTarget=GetFastValue$a(config,"renderTarget",1),config.fragShader=GetFastValue$a(config,"fragShader",ShaderSourceFS),config.vertShader=GetFastValue$a(config,"vertShader",ShaderSourceVS),config.attributes=GetFastValue$a(config,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2}]),config.batchSize=1,config.vertices=[-1,-1,0,0,-1,1,0,1,1,1,1,1,-1,-1,0,0,1,1,1,1,1,-1,1,0],WebGLPipeline.call(this,config),this.isPostFX=!0,this.gameObject,this.colorMatrix=new ColorMatrix,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2,this.renderer.isBooted&&(this.manager=this.renderer.pipelines,this.boot())},boot:function(){WebGLPipeline.prototype.boot.call(this);var utility=this.manager.UTILITY_PIPELINE;this.fullFrame1=utility.fullFrame1,this.fullFrame2=utility.fullFrame2,this.halfFrame1=utility.halfFrame1,this.halfFrame2=utility.halfFrame2,this.set1i("uMainSampler",0)},onDraw:function(renderTarget){this.bindAndDraw(renderTarget)},copyFrame:function(source,target,brightness,clear,clearAlpha){this.manager.copyFrame(source,target,brightness,clear,clearAlpha)},copyToGame:function(source){this.manager.copyToGame(source)},drawFrame:function(source,target,clearAlpha){this.manager.drawFrame(source,target,clearAlpha,this.colorMatrix)},blendFrames:function(source1,source2,target,strength,clearAlpha){this.manager.blendFrames(source1,source2,target,strength,clearAlpha)},blendFramesAdditive:function(source1,source2,target,strength,clearAlpha){this.manager.blendFramesAdditive(source1,source2,target,strength,clearAlpha)},clearFrame:function(target,clearAlpha){this.manager.clearFrame(target,clearAlpha)},blitFrame:function(source,target,brightness,clear,clearAlpha,eraseMode){this.manager.blitFrame(source,target,brightness,clear,clearAlpha,eraseMode)},copyFrameRect:function(source,target,x,y,width,height,clear,clearAlpha){this.manager.copyFrameRect(source,target,x,y,width,height,clear,clearAlpha)},bindAndDraw:function(source,target,clear,clearAlpha,currentShader){void 0===clear&&(clear=!0),void 0===clearAlpha&&(clearAlpha=!0);var gl=this.gl,renderer=this.renderer;this.bind(currentShader),this.set1i("uMainSampler",0),target?(gl.viewport(0,0,target.width,target.height),gl.bindFramebuffer(gl.FRAMEBUFFER,target.framebuffer),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,target.texture,0),clear&&(clearAlpha?gl.clearColor(0,0,0,0):gl.clearColor(0,0,0,1),gl.clear(gl.COLOR_BUFFER_BIT))):(renderer.popFramebuffer(!1,!1,!1),renderer.currentFramebuffer||gl.viewport(0,0,renderer.width,renderer.height)),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,source.texture),gl.bufferData(gl.ARRAY_BUFFER,this.vertexData,gl.STATIC_DRAW),gl.drawArrays(gl.TRIANGLES,0,6),target?(gl.bindTexture(gl.TEXTURE_2D,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null)):renderer.resetTextures()}}),RopePipeline:CullBounds_1,SinglePipeline:ParseImageLayers_1,UtilityPipeline:CullTiles_1},ParseGID_1),RenderTarget:Fill_1,Utils:GetProps_1,WebGLPipeline:FilterTiles_1,WebGLRenderer:WebGLRenderer_1,WebGLShader:FindByIndex_1},FindTile_1)},GetTileAtWorldXY_1=Extend_1$1,ParseCSV_1=ForEachTile_1,GetTilesWithinShape_1=GetTileAtWorldXY_1(!1,GetTilesWithinShape_1={Center:HexagonalCullBounds_1,Events:HexagonalCullTiles_1,Orientation:components,ScaleManager:ParseObject_1,ScaleModes:TimelineBuilder_1,Zoom:GetCullTilesFunction_1},ParseCSV_1.CENTER);GetTilesWithinShape_1=GetTileAtWorldXY_1(!1,GetTilesWithinShape_1,ParseCSV_1.ORIENTATION),GetTilesWithinShape_1=GetTileAtWorldXY_1(!1,GetTilesWithinShape_1,ParseCSV_1.SCALE_MODE);var scale=GetTilesWithinShape_1=GetTileAtWorldXY_1(!1,GetTilesWithinShape_1,ParseCSV_1.ZOOM),Clamp$1=Character,Events$2=events$g,GetFastValue$9=GetFastValue_1,parsers=PluginCache,ParseObjectLayers_1=new Class_1({initialize:function(scene){this.scene=scene,this.systems=scene.sys,this.settings=scene.sys.settings,this.key=scene.sys.settings.key,this.manager=scene.sys.game.scene,this.transitionProgress=0,this._elapsed=0,this._target=null,this._duration=0,this._onUpdate,this._onUpdateScope,this._willSleep=!1,this._willRemove=!1,scene.sys.events.once(Events$2.BOOT,this.boot,this),scene.sys.events.on(Events$2.START,this.pluginStart,this)},boot:function(){this.systems.events.once(Events$2.DESTROY,this.destroy,this)},pluginStart:function(){this._target=null,this.systems.events.once(Events$2.SHUTDOWN,this.shutdown,this)},start:function(key,data){return void 0===key&&(key=this.key),this.manager.queueOp("stop",this.key),this.manager.queueOp("start",key,data),this},restart:function(data){var key=this.key;return this.manager.queueOp("stop",key),this.manager.queueOp("start",key,data),this},transition:function(config){var key=GetFastValue$9(config=void 0===config?{}:config,"target",!1),target=this.manager.getScene(key);if(!key||!this.checkValidTransition(target))return!1;var duration=GetFastValue$9(config,"duration",1e3);this._elapsed=0,this._target=target,this._duration=duration,this._willSleep=GetFastValue$9(config,"sleep",!1),this._willRemove=GetFastValue$9(config,"remove",!1);var targetSettings=GetFastValue$9(config,"onUpdate",null);targetSettings&&(this._onUpdate=targetSettings,this._onUpdateScope=GetFastValue$9(config,"onUpdateScope",this.scene));var allowInput=GetFastValue$9(config,"allowInput",!1);this.settings.transitionAllowInput=allowInput;targetSettings=target.sys.settings;return targetSettings.isTransition=!0,targetSettings.transitionFrom=this.scene,targetSettings.transitionDuration=duration,targetSettings.transitionAllowInput=allowInput,GetFastValue$9(config,"moveAbove",!1)?this.manager.moveAbove(this.key,key):GetFastValue$9(config,"moveBelow",!1)&&this.manager.moveBelow(this.key,key),target.sys.isSleeping()?target.sys.wake(GetFastValue$9(config,"data")):this.manager.start(key,GetFastValue$9(config,"data")),this.systems.events.emit(Events$2.TRANSITION_OUT,target,duration),this.systems.events.on(Events$2.UPDATE,this.step,this),!0},checkValidTransition:function(target){return!(!target||target.sys.isActive()||target.sys.isTransitioning()||target===this.scene||this.systems.isTransitioning())},step:function(time,delta){this._elapsed+=delta,this.transitionProgress=Clamp$1(this._elapsed/this._duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.transitionProgress),this._elapsed>=this._duration&&this.transitionComplete()},transitionComplete:function(){var targetSys=this._target.sys,targetSettings=this._target.sys.settings;this.systems.events.off(Events$2.UPDATE,this.step,this),targetSys.events.emit(Events$2.TRANSITION_COMPLETE,this.scene),targetSettings.isTransition=!1,targetSettings.transitionFrom=null,this._duration=0,this._target=null,this._onUpdate=null,this._onUpdateScope=null,this._willRemove?this.manager.remove(this.key):this._willSleep?this.systems.sleep():this.manager.stop(this.key)},add:function(key,sceneConfig,autoStart,data){return this.manager.add(key,sceneConfig,autoStart,data)},launch:function(key,data){return key&&key!==this.key&&this.manager.queueOp("start",key,data),this},run:function(key,data){return key&&key!==this.key&&this.manager.queueOp("run",key,data),this},pause:function(key,data){return void 0===key&&(key=this.key),this.manager.queueOp("pause",key,data),this},resume:function(key,data){return void 0===key&&(key=this.key),this.manager.queueOp("resume",key,data),this},sleep:function(key,data){return void 0===key&&(key=this.key),this.manager.queueOp("sleep",key,data),this},wake:function(key,data){return void 0===key&&(key=this.key),this.manager.queueOp("wake",key,data),this},switch:function(key){return key!==this.key&&this.manager.queueOp("switch",this.key,key),this},stop:function(key,data){return void 0===key&&(key=this.key),this.manager.queueOp("stop",key,data),this},setActive:function(value,scene,data){void 0===scene&&(scene=this.key);scene=this.manager.getScene(scene);return scene&&scene.sys.setActive(value,data),this},setVisible:function(value,scene){void 0===scene&&(scene=this.key);scene=this.manager.getScene(scene);return scene&&scene.sys.setVisible(value),this},isSleeping:function(key){return void 0===key&&(key=this.key),this.manager.isSleeping(key)},isActive:function(key){return void 0===key&&(key=this.key),this.manager.isActive(key)},isPaused:function(key){return void 0===key&&(key=this.key),this.manager.isPaused(key)},isVisible:function(key){return void 0===key&&(key=this.key),this.manager.isVisible(key)},swapPosition:function(keyA,keyB){return keyA!==(keyB=void 0===keyB?this.key:keyB)&&this.manager.swapPosition(keyA,keyB),this},moveAbove:function(keyA,keyB){return keyA!==(keyB=void 0===keyB?this.key:keyB)&&this.manager.moveAbove(keyA,keyB),this},moveBelow:function(keyA,keyB){return keyA!==(keyB=void 0===keyB?this.key:keyB)&&this.manager.moveBelow(keyA,keyB),this},remove:function(key){return void 0===key&&(key=this.key),this.manager.remove(key),this},moveUp:function(key){return void 0===key&&(key=this.key),this.manager.moveUp(key),this},moveDown:function(key){return void 0===key&&(key=this.key),this.manager.moveDown(key),this},bringToTop:function(key){return void 0===key&&(key=this.key),this.manager.bringToTop(key),this},sendToBack:function(key){return void 0===key&&(key=this.key),this.manager.sendToBack(key),this},get:function(key){return this.manager.getScene(key)},getIndex:function(key){return void 0===key&&(key=this.key),this.manager.getIndex(key)},shutdown:function(){var eventEmitter=this.systems.events;eventEmitter.off(Events$2.SHUTDOWN,this.shutdown,this),eventEmitter.off(Events$2.POST_UPDATE,this.step,this),eventEmitter.off(Events$2.TRANSITION_OUT)},destroy:function(){this.shutdown(),this.scene.sys.events.off(Events$2.START,this.start,this),this.scene=null,this.systems=null,this.settings=null,this.manager=null}});parsers.register("ScenePlugin",ParseObjectLayers_1,"scenePlugin");function TriangleToRectangle(triangle,rect){return Intersects.RectangleToTriangle(rect,triangle)}function copyPoints(p){return{x:p.x,y:p.y}}var scene=Extend_1$1(!1,{Events:events$g,GetPhysicsPlugins:GetTileToWorldXFunction_1,GetScenePlugins:HexagonalTileToWorldXY_1,SceneManager:FromOrientationString_1,ScenePlugin:ParseObjectLayers_1,Settings:ParseTileLayers_1,Systems:ParseJSONTiled_1},GetTileToWorldXYFunction_1),structs={Events:HexagonalTileToWorldY_1,List:Base64Decode_1,Map:GetTileToWorldYFunction_1,ProcessQueue:ParseTilesets_1,RTree:GetWorldToTileXFunction_1,Set:HexagonalWorldToTileXY_1,Size:GetTweens_1},HasTileAt_1={LINEAR:0,NEAREST:1},textures=Extend_1$1(!1,{CanvasTexture:ParseTileLayers_1$1,Events:TweenData_1,FilterMode:HasTileAt_1,Frame:ParseWeltmeister_1,Parsers:GetWorldToTileXYFunction_1,Texture:HexagonalWorldToTileY_1,TextureManager:NumberTweenBuilder_1,TextureSource:GetWorldToTileYFunction_1},HasTileAt_1),GetTargets_1={ORTHOGONAL:0,ISOMETRIC:1,STAGGERED:2,HEXAGONAL:3},events={ORIENTATION:GetTargets_1},IsInLayerBounds_1=function(tileX,tileY,layer){return 0<=tileX&&tileX<layer.width&&0<=tileY&&tileY<layer.height},IsInLayerBounds$3=IsInLayerBounds_1,GetTileAt_1=function(tile,tileY,nonNull,layer){if(void 0===nonNull&&(nonNull=!1),IsInLayerBounds$3(tile,tileY,layer)){tile=layer.data[tileY][tile]||null;return tile&&(-1!==tile.index||nonNull)?tile:null}return null},GetTileAt$2=GetTileAt_1,CalculateFacesAt_1=function(tileX,right,tileCollides){var tile=GetTileAt$2(tileX,right,!0,tileCollides),above=GetTileAt$2(tileX,right-1,!0,tileCollides),below=GetTileAt$2(tileX,right+1,!0,tileCollides),left=GetTileAt$2(tileX-1,right,!0,tileCollides),right=GetTileAt$2(tileX+1,right,!0,tileCollides),tileCollides=tile&&tile.collides;return tileCollides&&(tile.faceTop=!0,tile.faceBottom=!0,tile.faceLeft=!0,tile.faceRight=!0),above&&above.collides&&(tileCollides&&(tile.faceTop=!1),above.faceBottom=!tileCollides),below&&below.collides&&(tileCollides&&(tile.faceBottom=!1),below.faceTop=!tileCollides),left&&left.collides&&(tileCollides&&(tile.faceLeft=!1),left.faceRight=!tileCollides),right&&right.collides&&(tileCollides&&(tile.faceRight=!1),right.faceLeft=!tileCollides),tile&&!tile.collides&&tile.resetFaces(),tile},GetTileAt$1=GetTileAt_1,GetTilesWithin$e=GetTilesWithin_1,CalculateFacesWithin_1=function(tileX,tileY,width,height,layer){for(var above,below,left,right,tiles=GetTilesWithin$e(tileX,tileY,width,height,null,layer),i=0;i<tiles.length;i++){var tile=tiles[i];tile&&(tile.collides?(above=GetTileAt$1(tile.x,tile.y-1,!0,layer),below=GetTileAt$1(tile.x,tile.y+1,!0,layer),left=GetTileAt$1(tile.x-1,tile.y,!0,layer),right=GetTileAt$1(tile.x+1,tile.y,!0,layer),tile.faceTop=!above||!above.collides,tile.faceBottom=!below||!below.collides,tile.faceLeft=!left||!left.collides,tile.faceRight=!right||!right.collides):tile.resetFaces())}},point$5=new BuildTilesetIndex_1,CheckIsoBounds_1=function(tileX,pos,layer,camera){var tilemapLayer=layer.tilemapLayer,cullPaddingX=tilemapLayer.cullPaddingX,cullPaddingY=tilemapLayer.cullPaddingY,pos=tilemapLayer.tilemap.tileToWorldXY(tileX,pos,point$5,camera,tilemapLayer);return pos.x>camera.worldView.x+tilemapLayer.scaleX*layer.tileWidth*(-cullPaddingX-.5)&&pos.x<camera.worldView.right+tilemapLayer.scaleX*layer.tileWidth*(cullPaddingX-.5)&&pos.y>camera.worldView.y+tilemapLayer.scaleY*layer.tileHeight*(-cullPaddingY-1)&&pos.y<camera.worldView.bottom+tilemapLayer.scaleY*layer.tileHeight*(cullPaddingY-.5)},GetTilesWithin$d=GetTilesWithin_1,CalculateFacesWithin$7=CalculateFacesWithin_1,Copy_1=function(srcTileX,srcTileY,width,height,destTileX,destTileY,recalculateFaces,layer){void 0===recalculateFaces&&(recalculateFaces=!0);for(var srcTiles=GetTilesWithin$d(srcTileX=srcTileX<0?0:srcTileX,srcTileY=srcTileY<0?0:srcTileY,width,height,null,layer),offsetX=destTileX-srcTileX,offsetY=destTileY-srcTileY,i=0;i<srcTiles.length;i++){var tileX=srcTiles[i].x+offsetX,tileY=srcTiles[i].y+offsetY;0<=tileX&&tileX<layer.width&&0<=tileY&&tileY<layer.height&&layer.data[tileY][tileX]&&layer.data[tileY][tileX].copy(srcTiles[i])}recalculateFaces&&CalculateFacesWithin$7(destTileX-1,destTileY-1,width+2,height+2,layer)},GetTilesWithin$c=GetTilesWithin_1,CreateGroupLayer_1=function(findIndex,newIndex,tileX,tileY,width,height,layer){for(var tiles=GetTilesWithin$c(tileX,tileY,width,height,null,layer),i=0;i<tiles.length;i++)tiles[i]&&tiles[i].index===findIndex&&(tiles[i].index=newIndex)},GetTilesWithin$b=GetTilesWithin_1,ReplaceByIndex=CreateGroupLayer_1,CreateFromTiles_1=function(indexes,replacements,spriteConfig,scene,camera,layer){spriteConfig=spriteConfig||{},Array.isArray(indexes)||(indexes=[indexes]);var tilemapLayer=layer.tilemapLayer;scene=scene||tilemapLayer.scene,camera=camera||scene.cameras.main;for(var tiles=GetTilesWithin$b(0,0,layer.width,layer.height,null,layer),sprites=[],i=0;i<tiles.length;i++){var point=tiles[i];-1!==indexes.indexOf(point.index)&&(point=tilemapLayer.tileToWorldXY(point.x,point.y,void 0,camera,layer),spriteConfig.x=point.x,spriteConfig.y=point.y,sprites.push(scene.make.sprite(spriteConfig)))}if("number"==typeof replacements)for(i=0;i<indexes.length;i++)ReplaceByIndex(indexes[i],replacements,0,0,layer.width,layer.height,layer);else if(Array.isArray(replacements))for(i=0;i<indexes.length;i++)ReplaceByIndex(indexes[i],replacements[i],0,0,layer.width,layer.height,layer);return sprites},SnapCeil$2=StaggerBuilder_1,SnapFloor$2=builders,bounds=new HasTileAtWorldXY_1,CullBounds_1=function(boundsLeft,camera){var boundsRight=boundsLeft.tilemapLayer.tilemap,boundsBottom=boundsLeft.tilemapLayer,boundsTop=Math.floor(boundsRight.tileWidth*boundsBottom.scaleX),tileH=Math.floor(boundsRight.tileHeight*boundsBottom.scaleY),boundsLeft=SnapFloor$2(camera.worldView.x-boundsBottom.x,boundsTop,0,!0)-boundsBottom.cullPaddingX,boundsRight=SnapCeil$2(camera.worldView.right-boundsBottom.x,boundsTop,0,!0)+boundsBottom.cullPaddingX,boundsTop=SnapFloor$2(camera.worldView.y-boundsBottom.y,tileH,0,!0)-boundsBottom.cullPaddingY,boundsBottom=SnapCeil$2(camera.worldView.bottom-boundsBottom.y,tileH,0,!0)+boundsBottom.cullPaddingY;return bounds.setTo(boundsLeft,boundsTop,boundsRight-boundsLeft,boundsBottom-boundsTop)},ParseImageLayers_1=function(tilemapLayer,bounds,renderOrder,outputArray){var x,y,tile,mapData=tilemapLayer.data,mapWidth=tilemapLayer.width,mapHeight=tilemapLayer.height,tilemapLayer=tilemapLayer.tilemapLayer,drawLeft=Math.max(0,bounds.left),drawRight=Math.min(mapWidth,bounds.right),drawTop=Math.max(0,bounds.top),drawBottom=Math.min(mapHeight,bounds.bottom);if(0===renderOrder)for(y=drawTop;y<drawBottom;y++)for(x=drawLeft;mapData[y]&&x<drawRight;x++)(tile=mapData[y][x])&&-1!==tile.index&&tile.visible&&0!==tile.alpha&&outputArray.push(tile);else if(1===renderOrder)for(y=drawTop;y<drawBottom;y++)for(x=drawRight;mapData[y]&&drawLeft<=x;x--)(tile=mapData[y][x])&&-1!==tile.index&&tile.visible&&0!==tile.alpha&&outputArray.push(tile);else if(2===renderOrder)for(y=drawBottom;drawTop<=y;y--)for(x=drawLeft;mapData[y]&&x<drawRight;x++)(tile=mapData[y][x])&&-1!==tile.index&&tile.visible&&0!==tile.alpha&&outputArray.push(tile);else if(3===renderOrder)for(y=drawBottom;drawTop<=y;y--)for(x=drawRight;mapData[y]&&drawLeft<=x;x--)(tile=mapData[y][x])&&-1!==tile.index&&tile.visible&&0!==tile.alpha&&outputArray.push(tile);return tilemapLayer.tilesDrawn=outputArray.length,tilemapLayer.tilesTotal=mapWidth*mapHeight,outputArray},CullBounds$2=CullBounds_1,RunCull$2=ParseImageLayers_1,CullTiles_1=function(layer,bounds,outputArray,renderOrder){void 0===renderOrder&&(renderOrder=0),(outputArray=void 0===outputArray?[]:outputArray).length=0;var tilemapLayer=layer.tilemapLayer,bounds=CullBounds$2(layer,bounds);return!tilemapLayer.skipCull&&1===tilemapLayer.scrollFactorX&&1===tilemapLayer.scrollFactorY||(bounds.left=0,bounds.right=layer.width,bounds.top=0,bounds.bottom=layer.height),RunCull$2(layer,bounds,renderOrder,outputArray),outputArray},ParseGID_1=function(tile,collides){collides?tile.setCollision(!0,!0,!0,!0,!1):tile.resetCollision(!1)},GetTilesWithin$a=GetTilesWithin_1,CalculateFacesWithin$6=CalculateFacesWithin_1,SetTileCollision$6=ParseGID_1,Fill_1=function(index,tileX,tileY,width,height,recalculateFaces,layer){for(var doesIndexCollide=-1!==layer.collideIndexes.indexOf(index),tiles=GetTilesWithin$a(tileX,tileY,width,height,null,layer),i=0;i<tiles.length;i++)tiles[i].index=index,SetTileCollision$6(tiles[i],doesIndexCollide);recalculateFaces&&CalculateFacesWithin$6(tileX-1,tileY-1,width+2,height+2,layer)},GetTilesWithin$9=GetTilesWithin_1,FilterTiles_1=function(callback,context,tileX,tileY,width,height,filteringOptions,layer){return GetTilesWithin$9(tileX,tileY,width,height,filteringOptions,layer).filter(callback,context)},FindByIndex_1=function(findIndex,skip,reverse,layer){void 0===skip&&(skip=0);var tx,ty,tile,count=0;if(reverse=void 0===reverse?!1:reverse){for(ty=layer.height-1;0<=ty;ty--)for(tx=layer.width-1;0<=tx;tx--)if((tile=layer.data[ty][tx])&&tile.index===findIndex){if(count===skip)return tile;count+=1}}else for(ty=0;ty<layer.height;ty++)for(tx=0;tx<layer.width;tx++)if((tile=layer.data[ty][tx])&&tile.index===findIndex){if(count===skip)return tile;count+=1}return null},GetTilesWithin$8=GetTilesWithin_1,FindTile_1=function(callback,context,tileX,tileY,width,height,filteringOptions,layer){return GetTilesWithin$8(tileX,tileY,width,height,filteringOptions,layer).find(callback,context)||null},GetTilesWithin$7=GetTilesWithin_1,ForEachTile_1=function(callback,context,tileX,tileY,width,height,filteringOptions,layer){GetTilesWithin$7(tileX,tileY,width,height,filteringOptions,layer).forEach(callback,context)},SnapCeil$1=StaggerBuilder_1,SnapFloor$1=builders,HexagonalCullBounds_1=function(rowH,camera){var tileH=rowH.tilemapLayer.tilemap,tilemapLayer=rowH.tilemapLayer,tileW=Math.floor(tileH.tileWidth*tilemapLayer.scaleX),tileH=Math.floor(tileH.tileHeight*tilemapLayer.scaleY),rowH=rowH.hexSideLength,rowH=(tileH-rowH)/2+rowH;return{left:SnapFloor$1(camera.worldView.x-tilemapLayer.x,tileW,0,!0)-tilemapLayer.cullPaddingX,right:SnapCeil$1(camera.worldView.right-tilemapLayer.x,tileW,0,!0)+tilemapLayer.cullPaddingX,top:SnapFloor$1(camera.worldView.y-tilemapLayer.y,rowH,0,!0)-tilemapLayer.cullPaddingY,bottom:SnapCeil$1(camera.worldView.bottom-tilemapLayer.y,rowH,0,!0)+tilemapLayer.cullPaddingY}},CullBounds$1=HexagonalCullBounds_1,RunCull$1=ParseImageLayers_1,HexagonalCullTiles_1=function(layer,bounds,outputArray,renderOrder){void 0===renderOrder&&(renderOrder=0),(outputArray=void 0===outputArray?[]:outputArray).length=0;var tilemapLayer=layer.tilemapLayer;return tilemapLayer.skipCull||1!==tilemapLayer.scrollFactorX||1!==tilemapLayer.scrollFactorY||(bounds=CullBounds$1(layer,bounds),RunCull$1(layer,bounds,renderOrder,outputArray)),outputArray},CheckIsoBounds=CheckIsoBounds_1,components=function(layer,camera,outputArray,renderOrder){void 0===renderOrder&&(renderOrder=0),(outputArray=void 0===outputArray?[]:outputArray).length=0;var x,y,tile,tilemapLayer=layer.tilemapLayer,mapData=layer.data,mapWidth=layer.width,mapHeight=layer.height,drawRight=mapWidth,drawBottom=mapHeight;if(!tilemapLayer.skipCull)if(0===renderOrder)for(y=0;y<drawBottom;y++)for(x=0;mapData[y]&&x<drawRight;x++)CheckIsoBounds(x,y,layer,camera)&&(tile=mapData[y][x])&&-1!==tile.index&&tile.visible&&0!==tile.alpha&&outputArray.push(tile);else if(1===renderOrder)for(y=0;y<drawBottom;y++)for(x=drawRight;mapData[y]&&0<=x;x--)CheckIsoBounds(x,y,layer,camera)&&(tile=mapData[y][x])&&-1!==tile.index&&tile.visible&&0!==tile.alpha&&outputArray.push(tile);else if(2===renderOrder)for(y=drawBottom;0<=y;y--)for(x=0;mapData[y]&&x<drawRight;x++)CheckIsoBounds(x,y,layer,camera)&&(tile=mapData[y][x])&&-1!==tile.index&&tile.visible&&0!==tile.alpha&&outputArray.push(tile);else if(3===renderOrder)for(y=drawBottom;0<=y;y--)for(x=drawRight;mapData[y]&&0<=x;x--)CheckIsoBounds(x,y,layer,camera)&&(tile=mapData[y][x])&&-1!==tile.index&&tile.visible&&0!==tile.alpha&&outputArray.push(tile);return tilemapLayer.tilesDrawn=outputArray.length,tilemapLayer.tilesTotal=mapWidth*mapHeight,outputArray},SnapCeil=StaggerBuilder_1,SnapFloor=builders,ParseObject_1=function(tileW,camera){var tileH=tileW.tilemapLayer.tilemap,tilemapLayer=tileW.tilemapLayer,tileW=Math.floor(tileH.tileWidth*tilemapLayer.scaleX),tileH=Math.floor(tileH.tileHeight*tilemapLayer.scaleY);return{left:SnapFloor(camera.worldView.x-tilemapLayer.x,tileW,0,!0)-tilemapLayer.cullPaddingX,right:SnapCeil(camera.worldView.right-tilemapLayer.x,tileW,0,!0)+tilemapLayer.cullPaddingX,top:SnapFloor(camera.worldView.y-tilemapLayer.y,tileH/2,0,!0)-tilemapLayer.cullPaddingY,bottom:SnapCeil(camera.worldView.bottom-tilemapLayer.y,tileH/2,0,!0)+tilemapLayer.cullPaddingY}},CullBounds=ParseObject_1,RunCull=ParseImageLayers_1,TimelineBuilder_1=function(layer,bounds,outputArray,renderOrder){void 0===renderOrder&&(renderOrder=0),(outputArray=void 0===outputArray?[]:outputArray).length=0;var tilemapLayer=layer.tilemapLayer;return tilemapLayer.skipCull||1!==tilemapLayer.scrollFactorX||1!==tilemapLayer.scrollFactorY||(bounds=CullBounds(layer,bounds),RunCull(layer,bounds,renderOrder,outputArray)),outputArray},CONST$f=GetTargets_1,CullTiles=CullTiles_1,HexagonalCullTiles=HexagonalCullTiles_1,IsometricCullTiles=components,NOOP$7=gameConfig,StaggeredCullTiles=TimelineBuilder_1,GetCullTilesFunction_1=function(orientation){return orientation===CONST$f.ORTHOGONAL?CullTiles:orientation===CONST$f.HEXAGONAL?HexagonalCullTiles:orientation===CONST$f.STAGGERED?StaggeredCullTiles:orientation===CONST$f.ISOMETRIC?IsometricCullTiles:NOOP$7},GetTileAt=GetTileAt_1,point$4=new BuildTilesetIndex_1,GetTileAtWorldXY_1=function(worldX,worldY,nonNull,camera,layer){return layer.tilemapLayer.worldToTileXY(worldX,worldY,!0,point$4,camera),GetTileAt(point$4.x,point$4.y,nonNull,layer)},Geom=geom,GetTilesWithin$6=GetTilesWithin_1,Intersects=Parse2DArray_1,NOOP$6=gameConfig,ParseCSV_1=BuildTilesetIndex_1,point$3=new ParseCSV_1,pointStart=new ParseCSV_1,pointEnd=new ParseCSV_1,GetTilesWithinShape_1=function(shape,tileHeight,camera,layer){if(void 0===shape)return[];var intersectTest=NOOP$6;shape instanceof Geom.Circle?intersectTest=Intersects.CircleToRectangle:shape instanceof Geom.Rectangle?intersectTest=Intersects.RectangleToRectangle:shape instanceof Geom.Triangle?intersectTest=TriangleToRectangle:shape instanceof Geom.Line&&(intersectTest=Intersects.LineToRectangle),layer.tilemapLayer.worldToTileXY(shape.left,shape.top,!0,pointStart,camera);var xStart=pointStart.x,yStart=pointStart.y;layer.tilemapLayer.worldToTileXY(shape.right,shape.bottom,!0,pointEnd,camera);var width=Math.ceil(pointEnd.x),tileWidth=Math.ceil(pointEnd.y),width=Math.max(width-xStart,1),tileWidth=Math.max(tileWidth-yStart,1),tiles=GetTilesWithin$6(xStart,yStart,width,tileWidth,tileHeight,layer),tileWidth=layer.tileWidth,tileHeight=layer.tileHeight;layer.tilemapLayer&&(tileWidth*=layer.tilemapLayer.scaleX,tileHeight*=layer.tilemapLayer.scaleY);for(var results=[],tileRect=new Geom.Rectangle(0,0,tileWidth,tileHeight),i=0;i<tiles.length;i++){var tile=tiles[i];layer.tilemapLayer.tileToWorldXY(tile.x,tile.y,point$3,camera),tileRect.x=point$3.x,tileRect.y=point$3.y,intersectTest(shape,tileRect)&&results.push(tile)}return results},parsers=function(tileX,camera,layerWorldX){var tileWidth=layerWorldX.baseTileWidth,tilemapLayer=layerWorldX.tilemapLayer,layerWorldX=0;return tilemapLayer&&(camera=camera||tilemapLayer.scene.cameras.main,layerWorldX=tilemapLayer.x+camera.scrollX*(1-tilemapLayer.scrollFactorX),tileWidth*=tilemapLayer.scaleX),layerWorldX+tileX*tileWidth},CONST$e=GetTargets_1,NOOP$5=gameConfig,TileToWorldX$1=parsers,GetTileToWorldXFunction_1=function(orientation){return orientation===CONST$e.ORTHOGONAL?TileToWorldX$1:NOOP$5},Vector2$a=BuildTilesetIndex_1,HexagonalTileToWorldXY_1=function(tileX,tileY,point,camera,len){point=point||new Vector2$a;var tileWidth=len.baseTileWidth,tileHeight=len.baseTileHeight,tilemapLayer=len.tilemapLayer,layerWorldX=0,layerWorldY=0;tilemapLayer&&(camera=camera||tilemapLayer.scene.cameras.main,layerWorldX=tilemapLayer.x+camera.scrollX*(1-tilemapLayer.scrollFactorX),tileWidth*=tilemapLayer.scaleX,layerWorldY=tilemapLayer.y+camera.scrollY*(1-tilemapLayer.scrollFactorY),tileHeight*=tilemapLayer.scaleY);len=len.hexSideLength;return point.set(layerWorldX+tileX*tileWidth+tileY%2*(tileWidth/2),layerWorldY+tileY*((tileHeight-len)/2+len))},Vector2$9=BuildTilesetIndex_1,FromOrientationString_1=function(tileX,tileY,point,camera,layerWorldY){point=point||new Vector2$9;var tileWidth=layerWorldY.baseTileWidth,tileHeight=layerWorldY.baseTileHeight,tilemapLayer=layerWorldY.tilemapLayer,layerWorldX=0,layerWorldY=0;return tilemapLayer&&(camera=camera||tilemapLayer.scene.cameras.main,layerWorldX=tilemapLayer.x+camera.scrollX*(1-tilemapLayer.scrollFactorX),tileWidth*=tilemapLayer.scaleX,layerWorldY=tilemapLayer.y+camera.scrollY*(1-tilemapLayer.scrollFactorY),tileHeight*=tilemapLayer.scaleY),point.set(layerWorldX+tileWidth/2*(tileX-tileY),layerWorldY+(tileX+tileY)*(tileHeight/2))},Vector2$8=BuildTilesetIndex_1,ParseObjectLayers_1=function(tileX,tileY,point,camera,layerWorldY){point=point||new Vector2$8;var tileWidth=layerWorldY.baseTileWidth,tileHeight=layerWorldY.baseTileHeight,tilemapLayer=layerWorldY.tilemapLayer,layerWorldX=0,layerWorldY=0;return tilemapLayer&&(camera=camera||tilemapLayer.scene.cameras.main,layerWorldX=tilemapLayer.x+camera.scrollX*(1-tilemapLayer.scrollFactorX),tileWidth*=tilemapLayer.scaleX,layerWorldY=tilemapLayer.y+camera.scrollY*(1-tilemapLayer.scrollFactorY),tileHeight*=tilemapLayer.scaleY),point.set(layerWorldX+tileX*tileWidth+tileY%2*(tileWidth/2),layerWorldY+tileY*(tileHeight/2))},ParseTileLayers_1=function(tileY,camera,layerWorldY){var tileHeight=layerWorldY.baseTileHeight,tilemapLayer=layerWorldY.tilemapLayer,layerWorldY=0;return tilemapLayer&&(camera=camera||tilemapLayer.scene.cameras.main,layerWorldY=tilemapLayer.y+camera.scrollY*(1-tilemapLayer.scrollFactorY),tileHeight*=tilemapLayer.scaleY),layerWorldY+tileY*tileHeight},TileToWorldX=parsers,TileToWorldY$1=ParseTileLayers_1,Vector2$7=BuildTilesetIndex_1,ParseJSONTiled_1=function(tileX,tileY,point,camera,layer){return(point=point||new Vector2$7(0,0)).x=TileToWorldX(tileX,camera,layer),point.y=TileToWorldY$1(tileY,camera,layer),point},CONST$d=GetTargets_1,HexagonalTileToWorldXY=HexagonalTileToWorldXY_1,IsometricTileToWorldXY=FromOrientationString_1,NOOP$4=gameConfig,StaggeredTileToWorldXY=ParseObjectLayers_1,TileToWorldXY=ParseJSONTiled_1,GetTileToWorldXYFunction_1=function(orientation){return orientation===CONST$d.ORTHOGONAL?TileToWorldXY:orientation===CONST$d.ISOMETRIC?IsometricTileToWorldXY:orientation===CONST$d.HEXAGONAL?HexagonalTileToWorldXY:orientation===CONST$d.STAGGERED?StaggeredTileToWorldXY:NOOP$4},HexagonalTileToWorldY_1=function(tileY,camera,layerWorldY){var tileHeight=layerWorldY.baseTileHeight,len=layerWorldY.tilemapLayer,layerWorldY=0;len&&(void 0===camera&&(camera=len.scene.cameras.main),layerWorldY=len.y+camera.scrollY*(1-len.scrollFactorY),tileHeight*=len.scaleY);len=len.tilemap.hexSideLength;return layerWorldY+tileY*((tileHeight-len)/2+len)},Base64Decode_1=function(tileY,camera,layerWorldY){var tileHeight=layerWorldY.baseTileHeight,tilemapLayer=layerWorldY.tilemapLayer,layerWorldY=0;return tilemapLayer&&(void 0===camera&&(camera=tilemapLayer.scene.cameras.main),layerWorldY=tilemapLayer.y+camera.scrollY*(1-tilemapLayer.scrollFactorY),tileHeight*=tilemapLayer.scaleY),layerWorldY+tileY*(tileHeight/2)},CONST$c=GetTargets_1,HexagonalTileToWorldY=HexagonalTileToWorldY_1,NOOP$3=gameConfig,StaggeredTileToWorldY=Base64Decode_1,TileToWorldY=ParseTileLayers_1,GetTileToWorldYFunction_1=function(orientation){return orientation===CONST$c.ORTHOGONAL?TileToWorldY:orientation===CONST$c.HEXAGONAL?HexagonalTileToWorldY:orientation===CONST$c.STAGGERED?StaggeredTileToWorldY:NOOP$3},ParseTilesets_1=function(worldX,snapToFloor,camera,tilemapLayer){var tileWidth=tilemapLayer.baseTileWidth,tilemapLayer=tilemapLayer.tilemapLayer;return tilemapLayer&&(camera=camera||tilemapLayer.scene.cameras.main,worldX-=tilemapLayer.x+camera.scrollX*(1-tilemapLayer.scrollFactorX),tileWidth*=tilemapLayer.scaleX),(snapToFloor=void 0===snapToFloor?!0:snapToFloor)?Math.floor(worldX/tileWidth):worldX/tileWidth},CONST$b=GetTargets_1,NOOP$2=gameConfig,WorldToTileX$1=ParseTilesets_1,GetWorldToTileXFunction_1=function(orientation){return orientation===CONST$b.ORTHOGONAL?WorldToTileX$1:NOOP$2},Vector2$6=BuildTilesetIndex_1,HexagonalWorldToTileXY_1=function(worldX,worldY,snapToFloor,point,camera,y){point=point||new Vector2$6;var x=y.baseTileWidth,tileHeight=y.baseTileHeight,tilemapLayer=y.tilemapLayer;tilemapLayer&&(camera=camera||tilemapLayer.scene.cameras.main,worldY-=tilemapLayer.y+camera.scrollY*(1-tilemapLayer.scrollFactorY),tileHeight*=tilemapLayer.scaleY,worldX-=tilemapLayer.x+camera.scrollX*(1-tilemapLayer.scrollFactorX),x*=tilemapLayer.scaleX);y=y.hexSideLength,y=(tileHeight-y)/2+y,y=snapToFloor?Math.floor(worldY/y):worldY/y,x=snapToFloor?Math.floor((worldX-y%2*.5*x)/x):(worldX-y%2*.5*x)/x;return point.set(x,y)},Vector2$5=BuildTilesetIndex_1,GetTweens_1=function(worldX,worldY,snapToFloor,point,camera,x){point=point||new Vector2$5;var y=x.baseTileWidth,tileHeight=x.baseTileHeight,x=x.tilemapLayer;x&&(camera=camera||x.scene.cameras.main,worldY-=x.y+camera.scrollY*(1-x.scrollFactorY),tileHeight*=x.scaleY,worldX-=x.x+camera.scrollX*(1-x.scrollFactorX),y*=x.scaleX);x=snapToFloor?Math.floor((worldX/(y/2)+worldY/(tileHeight/2))/2):(worldX/(y/2)+worldY/(tileHeight/2))/2,y=snapToFloor?Math.floor((worldY/(tileHeight/2)-worldX/(y/2))/2):(worldY/(tileHeight/2)-worldX/(y/2))/2;return point.set(x,y)},Vector2$4=BuildTilesetIndex_1,ParseTileLayers_1$1=function(worldX,worldY,snapToFloor,point,camera,tilemapLayer){point=point||new Vector2$4;var x=tilemapLayer.baseTileWidth,y=tilemapLayer.baseTileHeight,tilemapLayer=tilemapLayer.tilemapLayer;tilemapLayer&&(camera=camera||tilemapLayer.scene.cameras.main,worldY-=tilemapLayer.y+camera.scrollY*(1-tilemapLayer.scrollFactorY),y*=tilemapLayer.scaleY,worldX-=tilemapLayer.x+camera.scrollX*(1-tilemapLayer.scrollFactorX),x*=tilemapLayer.scaleX);y=snapToFloor?Math.floor(worldY/(y/2)):worldY/(y/2),x=snapToFloor?Math.floor((worldX+y%2*.5*x)/x):(worldX+y%2*.5*x)/x;return point.set(x,y)},TweenData_1=function(worldY,snapToFloor,camera,tilemapLayer){var tileHeight=tilemapLayer.baseTileHeight,tilemapLayer=tilemapLayer.tilemapLayer;return tilemapLayer&&(camera=camera||tilemapLayer.scene.cameras.main,worldY-=tilemapLayer.y+camera.scrollY*(1-tilemapLayer.scrollFactorY),tileHeight*=tilemapLayer.scaleY),(snapToFloor=void 0===snapToFloor?!0:snapToFloor)?Math.floor(worldY/tileHeight):worldY/tileHeight},WorldToTileX=ParseTilesets_1,WorldToTileY$1=TweenData_1,Vector2$3=BuildTilesetIndex_1,ParseWeltmeister_1=function(worldX,worldY,snapToFloor,point,camera,layer){return void 0===snapToFloor&&(snapToFloor=!0),(point=point||new Vector2$3(0,0)).x=WorldToTileX(worldX,snapToFloor,camera,layer),point.y=WorldToTileY$1(worldY,snapToFloor,camera,layer),point},CONST$a=GetTargets_1,HexagonalWorldToTileXY=HexagonalWorldToTileXY_1,IsometricWorldToTileXY=GetTweens_1,NOOP$1=gameConfig,StaggeredWorldToTileXY=ParseTileLayers_1$1,WorldToTileXY=ParseWeltmeister_1,GetWorldToTileXYFunction_1=function(orientation){return orientation===CONST$a.ORTHOGONAL?WorldToTileXY:orientation===CONST$a.ISOMETRIC?IsometricWorldToTileXY:orientation===CONST$a.HEXAGONAL?HexagonalWorldToTileXY:orientation===CONST$a.STAGGERED?StaggeredWorldToTileXY:NOOP$1},HexagonalWorldToTileY_1=function(worldY,snapToFloor,camera,rowHeight){var tileHeight=rowHeight.baseTileHeight,tilemapLayer=rowHeight.tilemapLayer;tilemapLayer&&(camera=camera||tilemapLayer.scene.cameras.main,worldY-=tilemapLayer.y+camera.scrollY*(1-tilemapLayer.scrollFactorY),tileHeight*=tilemapLayer.scaleY);rowHeight=rowHeight.hexSideLength,rowHeight=(tileHeight-rowHeight)/2+rowHeight;return snapToFloor?Math.floor(worldY/rowHeight):worldY/rowHeight},NumberTweenBuilder_1=function(worldY,snapToFloor,camera,tilemapLayer){var tileHeight=tilemapLayer.baseTileHeight,tilemapLayer=tilemapLayer.tilemapLayer;return tilemapLayer&&(camera=camera||tilemapLayer.scene.cameras.main,worldY-=tilemapLayer.y+camera.scrollY*(1-tilemapLayer.scrollFactorY),tileHeight*=tilemapLayer.scaleY),snapToFloor?Math.floor(worldY/(tileHeight/2)):worldY/(tileHeight/2)},CONST$9=GetTargets_1,HexagonalWorldToTileY=HexagonalWorldToTileY_1,NOOP=gameConfig,StaggeredWorldToTileY=NumberTweenBuilder_1,WorldToTileY=TweenData_1,GetWorldToTileYFunction_1=function(orientation){return orientation===CONST$9.ORTHOGONAL?WorldToTileY:orientation===CONST$9.HEXAGONAL?HexagonalWorldToTileY:orientation===CONST$9.STAGGERED?StaggeredWorldToTileY:NOOP},IsInLayerBounds$2=IsInLayerBounds_1,HasTileAt_1=function(tile,tileY,layer){if(IsInLayerBounds$2(tile,tileY,layer)){tile=layer.data[tileY][tile];return null!==tile&&-1<tile.index}return!1},HasTileAt=HasTileAt_1,point$2=new BuildTilesetIndex_1,HasTileAtWorldXY_1=function(worldX,tileX,tileY,layer){layer.tilemapLayer.worldToTileXY(worldX,tileX,!0,point$2,tileY);tileX=point$2.x,tileY=point$2.y;return HasTileAt(tileX,tileY,layer)},CONST$8=GetTargets_1,Rectangle=AssignTileProperties_1,StaggerBuilder_1=new Class_1({Mixins:[components$3.Alpha,components$3.Flip,components$3.Visible],initialize:function(layer,index,x,y,width,height,baseWidth,baseHeight){this.layer=layer,this.index=index,this.x=x,this.y=y,this.width=width,this.height=height,this.right,this.bottom,this.baseWidth=void 0!==baseWidth?baseWidth:width,this.baseHeight=void 0!==baseHeight?baseHeight:height,this.pixelX=0,this.pixelY=0,this.updatePixelXY(),this.properties={},this.rotation=0,this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceLeft=!1,this.faceRight=!1,this.faceTop=!1,this.faceBottom=!1,this.collisionCallback=void 0,(this.collisionCallbackContext=this).tint=16777215,this.physics={}},containsPoint:function(x,y){return!(x<this.pixelX||y<this.pixelY||x>this.right||y>this.bottom)},copy:function(tile){return this.index=tile.index,this.alpha=tile.alpha,this.properties=tile.properties,this.visible=tile.visible,this.setFlip(tile.flipX,tile.flipY),this.tint=tile.tint,this.rotation=tile.rotation,this.collideUp=tile.collideUp,this.collideDown=tile.collideDown,this.collideLeft=tile.collideLeft,this.collideRight=tile.collideRight,this.collisionCallback=tile.collisionCallback,this.collisionCallbackContext=tile.collisionCallbackContext,this},getCollisionGroup:function(){return this.tileset?this.tileset.getTileCollisionGroup(this.index):null},getTileData:function(){return this.tileset?this.tileset.getTileData(this.index):null},getLeft:function(camera){var tilemapLayer=this.tilemapLayer;return tilemapLayer?tilemapLayer.tileToWorldX(this.x,camera):this.x*this.baseWidth},getRight:function(camera){var tilemapLayer=this.tilemapLayer;return tilemapLayer?this.getLeft(camera)+this.width*tilemapLayer.scaleX:this.getLeft(camera)+this.width},getTop:function(camera){var tilemapLayer=this.tilemapLayer;return tilemapLayer?tilemapLayer.tileToWorldY(this.y,camera)-(this.height-this.baseHeight)*tilemapLayer.scaleY:this.y*this.baseHeight-(this.height-this.baseHeight)},getBottom:function(camera){var tilemapLayer=this.tilemapLayer;return tilemapLayer?this.getTop(camera)+this.height*tilemapLayer.scaleY:this.getTop(camera)+this.height},getBounds:function(camera,output){return(output=void 0===output?new Rectangle:output).x=this.getLeft(),output.y=this.getTop(),output.width=this.getRight()-output.x,output.height=this.getBottom()-output.y,output},getCenterX:function(camera){return(this.getLeft(camera)+this.getRight(camera))/2},getCenterY:function(camera){return(this.getTop(camera)+this.getBottom(camera))/2},intersects:function(x,y,right,bottom){return!(right<=this.pixelX||bottom<=this.pixelY||x>=this.right||y>=this.bottom)},isInteresting:function(collides,faces){return collides&&faces?this.canCollide||this.hasInterestingFace:collides?this.collides:!!faces&&this.hasInterestingFace},resetCollision:function(recalculateFaces){return void 0===recalculateFaces&&(recalculateFaces=!0),this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,recalculateFaces&&this.tilemapLayer&&this.tilemapLayer.calculateFacesAt(this.x,this.y),this},resetFaces:function(){return this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,this},setCollision:function(left,right,up,down,recalculateFaces){return void 0===right&&(right=left),void 0===up&&(up=left),void 0===down&&(down=left),void 0===recalculateFaces&&(recalculateFaces=!0),this.collideLeft=left,this.collideRight=right,this.collideUp=up,this.collideDown=down,this.faceLeft=left,this.faceRight=right,this.faceTop=up,this.faceBottom=down,recalculateFaces&&this.tilemapLayer&&this.tilemapLayer.calculateFacesAt(this.x,this.y),this},setCollisionCallback:function(callback,context){return null===callback?(this.collisionCallback=void 0,this.collisionCallbackContext=void 0):(this.collisionCallback=callback,this.collisionCallbackContext=context),this},setSize:function(tileWidth,tileHeight,baseWidth,baseHeight){return void 0!==tileWidth&&(this.width=tileWidth),void 0!==tileHeight&&(this.height=tileHeight),void 0!==baseWidth&&(this.baseWidth=baseWidth),void 0!==baseHeight&&(this.baseHeight=baseHeight),this.updatePixelXY(),this},updatePixelXY:function(){var rowHeight=this.layer.orientation;return rowHeight===CONST$8.ORTHOGONAL?(this.pixelX=this.x*this.baseWidth,this.pixelY=this.y*this.baseHeight):rowHeight===CONST$8.ISOMETRIC?(this.pixelX=(this.x-this.y)*this.baseWidth*.5,this.pixelY=(this.x+this.y)*this.baseHeight*.5):rowHeight===CONST$8.STAGGERED?(this.pixelX=this.x*this.baseWidth+this.y%2*(this.baseWidth/2),this.pixelY=this.y*(this.baseHeight/2)):rowHeight===CONST$8.HEXAGONAL&&(rowHeight=this.layer.hexSideLength,rowHeight=(this.baseHeight-rowHeight)/2+rowHeight,this.pixelX=this.x*this.baseWidth+this.y%2*(this.baseWidth/2),this.pixelY=this.y*rowHeight),this.right=this.pixelX+this.baseWidth,this.bottom=this.pixelY+this.baseHeight,this},destroy:function(){this.collisionCallback=void 0,this.collisionCallbackContext=void 0,this.properties=void 0},canCollide:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown||void 0!==this.collisionCallback}},collides:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}},hasInterestingFace:{get:function(){return this.faceTop||this.faceBottom||this.faceLeft||this.faceRight}},tileset:{get:function(){var tileset=this.layer.tilemapLayer;if(tileset){tileset=tileset.gidMap[this.index];if(tileset)return tileset}return null}},tilemapLayer:{get:function(){return this.layer.tilemapLayer}},tilemap:{get:function(){var tilemapLayer=this.tilemapLayer;return tilemapLayer?tilemapLayer.tilemap:null}}}),Tile$6=StaggerBuilder_1,IsInLayerBounds$1=IsInLayerBounds_1,CalculateFacesAt$1=CalculateFacesAt_1,SetTileCollision$5=ParseGID_1,builders=function(newTile,tileX,tileY,recalculateFaces,layer){if(void 0===recalculateFaces&&(recalculateFaces=!0),!IsInLayerBounds$1(tileX,tileY,layer))return null;var oldTileCollides=layer.data[tileY][tileX],oldTileCollides=oldTileCollides&&oldTileCollides.collides;newTile instanceof Tile$6?(null===layer.data[tileY][tileX]&&(layer.data[tileY][tileX]=new Tile$6(layer,newTile.index,tileX,tileY,layer.tileWidth,layer.tileHeight)),layer.data[tileY][tileX].copy(newTile)):(collides=newTile,null===layer.data[tileY][tileX]?layer.data[tileY][tileX]=new Tile$6(layer,collides,tileX,tileY,layer.tileWidth,layer.tileHeight):layer.data[tileY][tileX].index=collides);var newTile=layer.data[tileY][tileX],collides=-1!==layer.collideIndexes.indexOf(newTile.index);return SetTileCollision$5(newTile,collides),recalculateFaces&&oldTileCollides!==newTile.collides&&CalculateFacesAt$1(tileX,tileY,layer),newTile},PutTileAt$1=builders,point$1=new BuildTilesetIndex_1,Parse2DArray_1=function(tile,worldX,worldY,recalculateFaces,camera,layer){return layer.tilemapLayer.worldToTileXY(worldX,worldY,!0,point$1,camera,layer),PutTileAt$1(tile,point$1.x,point$1.y,recalculateFaces,layer)},CalculateFacesWithin$5=CalculateFacesWithin_1,PutTileAt=builders,ParseCSV_1=function(tilesArray,tileX,tileY,recalculateFaces,layer){if(void 0===recalculateFaces&&(recalculateFaces=!0),!Array.isArray(tilesArray))return null;for(var height=(tilesArray=!Array.isArray(tilesArray[0])?[tilesArray]:tilesArray).length,width=tilesArray[0].length,ty=0;ty<height;ty++)for(var tx=0;tx<width;tx++){var tile=tilesArray[ty][tx];PutTileAt(tile,tileX+tx,tileY+ty,!1,layer)}recalculateFaces&&CalculateFacesWithin$5(tileX-1,tileY-1,width+2,height+2,layer)},GetTilesWithin$5=GetTilesWithin_1,GetRandom=GetNewValue_1,AssignTileProperties_1=function(tileX,tileY,width,height,indexes,layer){var i,tiles=GetTilesWithin$5(tileX,tileY,width,height,{},layer);if(!indexes)for(indexes=[],i=0;i<tiles.length;i++)-1===indexes.indexOf(tiles[i].index)&&indexes.push(tiles[i].index);for(i=0;i<tiles.length;i++)tiles[i].index=GetRandom(indexes)},Tile$5=StaggerBuilder_1,IsInLayerBounds=IsInLayerBounds_1,CalculateFacesAt=CalculateFacesAt_1,GetNewValue_1=function(tileX,tileY,replaceWithNull,recalculateFaces,layer){if(void 0===replaceWithNull&&(replaceWithNull=!0),void 0===recalculateFaces&&(recalculateFaces=!0),!IsInLayerBounds(tileX,tileY,layer))return null;var tile=layer.data[tileY][tileX];return tile?(layer.data[tileY][tileX]=replaceWithNull?null:new Tile$5(layer,-1,tileX,tileY,layer.tileWidth,layer.tileHeight),recalculateFaces&&tile&&tile.collides&&CalculateFacesAt(tileX,tileY,layer),tile):null},RemoveTileAt=GetNewValue_1,point=new BuildTilesetIndex_1,BuildTilesetIndex_1=function(worldX,worldY,replaceWithNull,recalculateFaces,camera,layer){return layer.tilemapLayer.worldToTileXY(worldX,worldY,!0,point,camera,layer),RemoveTileAt(point.x,point.y,replaceWithNull,recalculateFaces,layer)},GetTilesWithin$4=GetTilesWithin_1,Pick_1=Pick_1,defaultTileColor=new Pick_1(105,210,231,150),defaultCollidingTileColor=new Pick_1(243,134,48,200),defaultFaceColor=new Pick_1(40,39,37,150),Pick_1=function(tileIndex,collides,layer){var loc=layer.collideIndexes.indexOf(tileIndex);collides&&-1===loc?layer.collideIndexes.push(tileIndex):collides||-1===loc||layer.collideIndexes.splice(loc,1)},SetTileCollision$4=ParseGID_1,CalculateFacesWithin$4=CalculateFacesWithin_1,SetLayerCollisionIndex$2=Pick_1,SetTileCollision$3=ParseGID_1,CalculateFacesWithin$3=CalculateFacesWithin_1,SetLayerCollisionIndex$1=Pick_1,SetTileCollision$2=ParseGID_1,CalculateFacesWithin$2=CalculateFacesWithin_1,SetLayerCollisionIndex=Pick_1,SetTileCollision$1=ParseGID_1,CalculateFacesWithin$1=CalculateFacesWithin_1,HasValue$1=HasValue_1,SetTileCollision=ParseGID_1,CalculateFacesWithin=CalculateFacesWithin_1,GetTilesWithin$3=GetTilesWithin_1,GetTilesWithin$2=GetTilesWithin_1,ShuffleArray=Shuffle_1$2,GetTilesWithin$1=GetTilesWithin_1,GetTilesWithin=GetTilesWithin_1,components={CalculateFacesAt:CalculateFacesAt_1,CalculateFacesWithin:CalculateFacesWithin_1,CheckIsoBounds:CheckIsoBounds_1,Copy:Copy_1,CreateFromTiles:CreateFromTiles_1,CullBounds:CullBounds_1,CullTiles:CullTiles_1,Fill:Fill_1,FilterTiles:FilterTiles_1,FindByIndex:FindByIndex_1,FindTile:FindTile_1,ForEachTile:ForEachTile_1,GetCullTilesFunction:GetCullTilesFunction_1,GetTileAt:GetTileAt_1,GetTileAtWorldXY:GetTileAtWorldXY_1,GetTilesWithin:GetTilesWithin_1,GetTilesWithinShape:GetTilesWithinShape_1,GetTilesWithinWorldXY:GetTilesWithinWorldXY_1,GetTileToWorldXFunction:GetTileToWorldXFunction_1,GetTileToWorldXYFunction:GetTileToWorldXYFunction_1,GetTileToWorldYFunction:GetTileToWorldYFunction_1,GetWorldToTileXFunction:GetWorldToTileXFunction_1,GetWorldToTileXYFunction:GetWorldToTileXYFunction_1,GetWorldToTileYFunction:GetWorldToTileYFunction_1,HasTileAt:HasTileAt_1,HasTileAtWorldXY:HasTileAtWorldXY_1,HexagonalCullBounds:HexagonalCullBounds_1,HexagonalCullTiles:HexagonalCullTiles_1,HexagonalTileToWorldXY:HexagonalTileToWorldXY_1,HexagonalTileToWorldY:HexagonalTileToWorldY_1,HexagonalWorldToTileXY:HexagonalWorldToTileXY_1,HexagonalWorldToTileY:HexagonalWorldToTileY_1,IsInLayerBounds:IsInLayerBounds_1,IsometricCullTiles:components,IsometricTileToWorldXY:FromOrientationString_1,IsometricWorldToTileXY:GetTweens_1,PutTileAt:builders,PutTileAtWorldXY:Parse2DArray_1,PutTilesAt:ParseCSV_1,Randomize:AssignTileProperties_1,RemoveTileAt:GetNewValue_1,RemoveTileAtWorldXY:BuildTilesetIndex_1,RenderDebug:function(graphics,styleConfig,layer){var tileColor=void 0!==(styleConfig=void 0===styleConfig?{}:styleConfig).tileColor?styleConfig.tileColor:defaultTileColor,collidingTileColor=void 0!==styleConfig.collidingTileColor?styleConfig.collidingTileColor:defaultCollidingTileColor,faceColor=void 0!==styleConfig.faceColor?styleConfig.faceColor:defaultFaceColor,tiles=GetTilesWithin$4(0,0,layer.width,layer.height,null,layer);graphics.translateCanvas(layer.tilemapLayer.x,layer.tilemapLayer.y),graphics.scaleCanvas(layer.tilemapLayer.scaleX,layer.tilemapLayer.scaleY);for(var i=0;i<tiles.length;i++){var tile=tiles[i],tw=tile.width,th=tile.height,x=tile.pixelX,y=tile.pixelY,color=tile.collides?collidingTileColor:tileColor;null!==color&&(graphics.fillStyle(color.color,color.alpha/255),graphics.fillRect(x,y,tw,th)),x+=1,y+=1,tw-=2,th-=2,null!==faceColor&&(graphics.lineStyle(1,faceColor.color,faceColor.alpha/255),tile.faceTop&&graphics.lineBetween(x,y,x+tw,y),tile.faceRight&&graphics.lineBetween(x+tw,y,x+tw,y+th),tile.faceBottom&&graphics.lineBetween(x,y+th,x+tw,y+th),tile.faceLeft&&graphics.lineBetween(x,y,x,y+th))}},ReplaceByIndex:CreateGroupLayer_1,RunCull:ParseImageLayers_1,SetCollision:function(indexes,collides,recalculateFaces,layer,updateLayer){void 0===collides&&(collides=!0),void 0===recalculateFaces&&(recalculateFaces=!0),void 0===updateLayer&&(updateLayer=!0),Array.isArray(indexes)||(indexes=[indexes]);for(var i=0;i<indexes.length;i++)SetLayerCollisionIndex$2(indexes[i],collides,layer);if(updateLayer)for(var ty=0;ty<layer.height;ty++)for(var tx=0;tx<layer.width;tx++){var tile=layer.data[ty][tx];tile&&-1!==indexes.indexOf(tile.index)&&SetTileCollision$4(tile,collides)}recalculateFaces&&CalculateFacesWithin$4(0,0,layer.width,layer.height,layer)},SetCollisionBetween:function(start,stop,collides,recalculateFaces,layer,updateLayer){if(void 0===collides&&(collides=!0),void 0===recalculateFaces&&(recalculateFaces=!0),void 0===updateLayer&&(updateLayer=!0),!(stop<start)){for(var index=start;index<=stop;index++)SetLayerCollisionIndex$1(index,collides,layer);if(updateLayer)for(var ty=0;ty<layer.height;ty++)for(var tx=0;tx<layer.width;tx++){var tile=layer.data[ty][tx];tile&&tile.index>=start&&tile.index<=stop&&SetTileCollision$3(tile,collides)}recalculateFaces&&CalculateFacesWithin$3(0,0,layer.width,layer.height,layer)}},SetCollisionByExclusion:function(indexes,collides,recalculateFaces,layer){void 0===collides&&(collides=!0),void 0===recalculateFaces&&(recalculateFaces=!0),Array.isArray(indexes)||(indexes=[indexes]);for(var ty=0;ty<layer.height;ty++)for(var tx=0;tx<layer.width;tx++){var tile=layer.data[ty][tx];tile&&-1===indexes.indexOf(tile.index)&&(SetTileCollision$2(tile,collides),SetLayerCollisionIndex(tile.index,collides,layer))}recalculateFaces&&CalculateFacesWithin$2(0,0,layer.width,layer.height,layer)},SetCollisionByProperty:function(properties,collides,recalculateFaces,layer){void 0===collides&&(collides=!0),void 0===recalculateFaces&&(recalculateFaces=!0);for(var ty=0;ty<layer.height;ty++)for(var tx=0;tx<layer.width;tx++){var tile=layer.data[ty][tx];if(tile)for(var property in properties)if(HasValue$1(tile.properties,property)){var values=properties[property];Array.isArray(values)||(values=[values]);for(var i=0;i<values.length;i++)tile.properties[property]===values[i]&&SetTileCollision$1(tile,collides)}}recalculateFaces&&CalculateFacesWithin$1(0,0,layer.width,layer.height,layer)},SetCollisionFromCollisionGroup:function(collides,recalculateFaces,layer){void 0===collides&&(collides=!0),void 0===recalculateFaces&&(recalculateFaces=!0);for(var ty=0;ty<layer.height;ty++)for(var tx=0;tx<layer.width;tx++){var collisionGroup,tile=layer.data[ty][tx];tile&&((collisionGroup=tile.getCollisionGroup())&&collisionGroup.objects&&0<collisionGroup.objects.length&&SetTileCollision(tile,collides))}recalculateFaces&&CalculateFacesWithin(0,0,layer.width,layer.height,layer)},SetLayerCollisionIndex:Pick_1,SetTileCollision:ParseGID_1,SetTileIndexCallback:function(indexes,callback,callbackContext,layer){if("number"==typeof indexes)layer.callbacks[indexes]=null!==callback?{callback:callback,callbackContext:callbackContext}:void 0;else for(var i=0,len=indexes.length;i<len;i++)layer.callbacks[indexes[i]]=null!==callback?{callback:callback,callbackContext:callbackContext}:void 0},SetTileLocationCallback:function(tileX,tileY,width,height,callback,callbackContext,layer){for(var tiles=GetTilesWithin$3(tileX,tileY,width,height,null,layer),i=0;i<tiles.length;i++)tiles[i].setCollisionCallback(callback,callbackContext)},Shuffle:function(tileX,tileY,width,height,layer){var tiles=GetTilesWithin$2(tileX,tileY,width,height,null,layer),indexes=tiles.map(function(tile){return tile.index});ShuffleArray(indexes);for(var i=0;i<tiles.length;i++)tiles[i].index=indexes[i]},StaggeredCullBounds:ParseObject_1,StaggeredCullTiles:TimelineBuilder_1,StaggeredTileToWorldXY:ParseObjectLayers_1,StaggeredTileToWorldY:Base64Decode_1,StaggeredWorldToTileXY:ParseTileLayers_1$1,StaggeredWorldToTileY:NumberTweenBuilder_1,SwapByIndex:function(indexA,indexB,tileX,tileY,width,height,layer){for(var tiles=GetTilesWithin$1(tileX,tileY,width,height,null,layer),i=0;i<tiles.length;i++)tiles[i]&&(tiles[i].index===indexA?tiles[i].index=indexB:tiles[i].index===indexB&&(tiles[i].index=indexA))},TileToWorldX:parsers,TileToWorldXY:ParseJSONTiled_1,TileToWorldY:ParseTileLayers_1,WeightedRandomize:function(tileX,tileY,width,height,weightedIndexes,layer){if(weightedIndexes){for(var tiles=GetTilesWithin(tileX,tileY,width,height,null,layer),weightTotal=0,i=0;i<weightedIndexes.length;i++)weightTotal+=weightedIndexes[i].weight;if(!(weightTotal<=0))for(i=0;i<tiles.length;i++){for(var rand=Math.random()*weightTotal,sum=0,randomIndex=-1,j=0;j<weightedIndexes.length;j++)if(rand<=(sum+=weightedIndexes[j].weight)){var chosen=weightedIndexes[j].index,randomIndex=Array.isArray(chosen)?chosen[Math.floor(Math.random()*chosen.length)]:chosen;break}tiles[i].index=randomIndex}}},WorldToTileX:ParseTilesets_1,WorldToTileXY:ParseWeltmeister_1,WorldToTileY:TweenData_1},CONST$7=GetTargets_1,FromOrientationString_1=function(orientation){return"isometric"===(orientation=orientation.toLowerCase())?CONST$7.ISOMETRIC:"staggered"===orientation?CONST$7.STAGGERED:"hexagonal"===orientation?CONST$7.HEXAGONAL:CONST$7.ORTHOGONAL},CONST$6=GetTargets_1,GetFastValue$8=GetFastValue_1,GetTweens_1=new Class_1({initialize:function(config){this.name=GetFastValue$8(config=void 0===config?{}:config,"name","layer"),this.x=GetFastValue$8(config,"x",0),this.y=GetFastValue$8(config,"y",0),this.width=GetFastValue$8(config,"width",0),this.height=GetFastValue$8(config,"height",0),this.tileWidth=GetFastValue$8(config,"tileWidth",0),this.tileHeight=GetFastValue$8(config,"tileHeight",0),this.baseTileWidth=GetFastValue$8(config,"baseTileWidth",this.tileWidth),this.baseTileHeight=GetFastValue$8(config,"baseTileHeight",this.tileHeight),this.orientation=GetFastValue$8(config,"orientation",CONST$6.ORTHOGONAL),this.widthInPixels=GetFastValue$8(config,"widthInPixels",this.width*this.baseTileWidth),this.heightInPixels=GetFastValue$8(config,"heightInPixels",this.height*this.baseTileHeight),this.alpha=GetFastValue$8(config,"alpha",1),this.visible=GetFastValue$8(config,"visible",!0),this.properties=GetFastValue$8(config,"properties",[]),this.indexes=GetFastValue$8(config,"indexes",[]),this.collideIndexes=GetFastValue$8(config,"collideIndexes",[]),this.callbacks=GetFastValue$8(config,"callbacks",[]),this.bodies=GetFastValue$8(config,"bodies",[]),this.data=GetFastValue$8(config,"data",[]),this.tilemapLayer=GetFastValue$8(config,"tilemapLayer",null),this.hexSideLength=GetFastValue$8(config,"hexSideLength",0)}}),CONST$5=GetTargets_1,GetFastValue$7=GetFastValue_1,builders=new Class_1({initialize:function(config){this.name=GetFastValue$7(config=void 0===config?{}:config,"name","map"),this.width=GetFastValue$7(config,"width",0),this.height=GetFastValue$7(config,"height",0),this.infinite=GetFastValue$7(config,"infinite",!1),this.tileWidth=GetFastValue$7(config,"tileWidth",0),this.tileHeight=GetFastValue$7(config,"tileHeight",0),this.widthInPixels=GetFastValue$7(config,"widthInPixels",this.width*this.tileWidth),this.heightInPixels=GetFastValue$7(config,"heightInPixels",this.height*this.tileHeight),this.format=GetFastValue$7(config,"format",null),this.orientation=GetFastValue$7(config,"orientation",CONST$5.ORTHOGONAL),this.renderOrder=GetFastValue$7(config,"renderOrder","right-down"),this.version=GetFastValue$7(config,"version","1"),this.properties=GetFastValue$7(config,"properties",{}),this.layers=GetFastValue$7(config,"layers",[]),this.images=GetFastValue$7(config,"images",[]),this.objects=GetFastValue$7(config,"objects",{}),this.collision=GetFastValue$7(config,"collision",{}),this.tilesets=GetFastValue$7(config,"tilesets",[]),this.imageCollections=GetFastValue$7(config,"imageCollections",[]),this.tiles=GetFastValue$7(config,"tiles",[]),this.hexSideLength=GetFastValue$7(config,"hexSideLength",0)}}),Formats$6=tilemaps,LayerData$3=GetTweens_1,MapData$3=builders,Tile$4=StaggerBuilder_1,Parse2DArray_1=function(height,data,tileWidth,tileHeight,insertNull){for(var layerData=new LayerData$3({tileWidth:tileWidth,tileHeight:tileHeight}),mapData=new MapData$3({name:height,tileWidth:tileWidth,tileHeight:tileHeight,format:Formats$6.ARRAY_2D,layers:[layerData]}),tiles=[],height=data.length,width=0,y=0;y<data.length;y++){tiles[y]=[];for(var row=data[y],x=0;x<row.length;x++){var tileIndex=parseInt(row[x],10);isNaN(tileIndex)||-1===tileIndex?tiles[y][x]=insertNull?null:new Tile$4(layerData,-1,x,y,tileWidth,tileHeight):tiles[y][x]=new Tile$4(layerData,tileIndex,x,y,tileWidth,tileHeight)}0===width&&(width=row.length)}return mapData.width=layerData.width=width,mapData.height=layerData.height=height,mapData.widthInPixels=layerData.widthInPixels=width*tileWidth,mapData.heightInPixels=layerData.heightInPixels=height*tileHeight,layerData.data=tiles,mapData},Formats$5=tilemaps,Parse2DArray$1=Parse2DArray_1,ParseCSV_1=function(name,array2D,tileWidth,tileHeight,map){array2D=array2D.trim().split("\n").map(function(row){return row.split(",")}),map=Parse2DArray$1(name,array2D,tileWidth,tileHeight,map);return map.format=Formats$5.CSV,map},Extend$3=Extend_1$1,AssignTileProperties_1=function(mapData){for(var tile,sid,i=0;i<mapData.layers.length;i++)for(var set,layerData=mapData.layers[i],j=0;j<layerData.data.length;j++)for(var row=layerData.data[j],k=0;k<row.length;k++)null===(tile=row[k])||tile.index<0||(sid=mapData.tiles[tile.index][2],set=mapData.tilesets[sid],tile.width=set.tileWidth,tile.height=set.tileHeight,set.tileProperties&&set.tileProperties[tile.index-set.firstgid]&&(tile.properties=Extend$3(tile.properties,set.tileProperties[tile.index-set.firstgid])))},GetNewValue_1=new Class_1({initialize:function(name,firstgid,tileWidth,tileHeight,tileMargin,tileSpacing,tileProperties,tileData){(void 0===tileWidth||tileWidth<=0)&&(tileWidth=32),(void 0===tileHeight||tileHeight<=0)&&(tileHeight=32),void 0===tileMargin&&(tileMargin=0),void 0===tileSpacing&&(tileSpacing=0),void 0===tileProperties&&(tileProperties={}),void 0===tileData&&(tileData={}),this.name=name,this.firstgid=firstgid,this.tileWidth=tileWidth,this.tileHeight=tileHeight,this.tileMargin=tileMargin,this.tileSpacing=tileSpacing,this.tileProperties=tileProperties,this.tileData=tileData,this.image=null,this.glTexture=null,this.rows=0,this.columns=0,this.total=0,this.texCoordinates=[]},getTileProperties:function(tileIndex){return this.containsTileIndex(tileIndex)?this.tileProperties[tileIndex-this.firstgid]:null},getTileData:function(tileIndex){return this.containsTileIndex(tileIndex)?this.tileData[tileIndex-this.firstgid]:null},getTileCollisionGroup:function(data){data=this.getTileData(data);return data&&data.objectgroup?data.objectgroup:null},containsTileIndex:function(tileIndex){return tileIndex>=this.firstgid&&tileIndex<this.firstgid+this.total},getTileTextureCoordinates:function(tileIndex){return this.containsTileIndex(tileIndex)?this.texCoordinates[tileIndex-this.firstgid]:null},setImage:function(texture){return this.image=texture,this.glTexture=texture.get().source.glTexture,this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},setTileSize:function(tileWidth,tileHeight){return void 0!==tileWidth&&(this.tileWidth=tileWidth),void 0!==tileHeight&&(this.tileHeight=tileHeight),this.image&&this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},setSpacing:function(margin,spacing){return void 0!==margin&&(this.tileMargin=margin),void 0!==spacing&&(this.tileSpacing=spacing),this.image&&this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},updateTileData:function(colCount,rowCount){rowCount=(rowCount-2*this.tileMargin+this.tileSpacing)/(this.tileHeight+this.tileSpacing),colCount=(colCount-2*this.tileMargin+this.tileSpacing)/(this.tileWidth+this.tileSpacing);rowCount%1==0&&colCount%1==0||console.warn("Image tile area not tile size multiple in: "+this.name),rowCount=Math.floor(rowCount),colCount=Math.floor(colCount),this.rows=rowCount,this.columns=colCount,this.total=rowCount*colCount,this.texCoordinates.length=0;for(var tx=this.tileMargin,ty=this.tileMargin,y=0;y<this.rows;y++){for(var x=0;x<this.columns;x++)this.texCoordinates.push({x:tx,y:ty}),tx+=this.tileWidth+this.tileSpacing;tx=this.tileMargin,ty+=this.tileHeight+this.tileSpacing}return this}}),Tileset$3=GetNewValue_1,BuildTilesetIndex_1=function(mapData){for(var tiles=[],i=0;i<mapData.imageCollections.length;i++)for(var collection=mapData.imageCollections[i],images=collection.images,j=0;j<images.length;j++){var set,image=images[j];(set=new Tileset$3(image.image,image.gid,collection.imageWidth,collection.imageHeight,0,0)).updateTileData(collection.imageWidth,collection.imageHeight),mapData.tilesets.push(set)}for(i=0;i<mapData.tilesets.length;i++)for(var x=(set=mapData.tilesets[i]).tileMargin,y=set.tileMargin,count=0,countX=0,countY=0,t=set.firstgid;t<set.firstgid+set.total&&(tiles[t]=[x,y,i],x+=set.tileWidth+set.tileSpacing,++count!==set.total)&&(++countX!==set.columns||(x=set.tileMargin,y+=set.tileHeight+set.tileSpacing,countX=0,++countY!==set.rows));t++);return tiles},GetFastValue$6=GetFastValue_1,CreateGroupLayer_1=function(layerY,groupl,parentstate){if(!groupl)return{i:0,layers:layerY.layers,name:"",opacity:1,visible:!0,x:0,y:0};var layerX=groupl.x+GetFastValue$6(groupl,"startx",0)*layerY.tilewidth+GetFastValue$6(groupl,"offsetx",0),layerY=groupl.y+GetFastValue$6(groupl,"starty",0)*layerY.tileheight+GetFastValue$6(groupl,"offsety",0);return{i:0,layers:groupl.layers,name:parentstate.name+groupl.name+"/",opacity:parentstate.opacity*groupl.opacity,visible:parentstate.visible&&groupl.visible,x:parentstate.x+layerX,y:parentstate.y+layerY}},GetFastValue$5=GetFastValue_1,CreateGroupLayer$2=CreateGroupLayer_1,ParseImageLayers_1=function(json){for(var images=[],groupStack=[],curGroupState=CreateGroupLayer$2(json);curGroupState.i<curGroupState.layers.length||0<groupStack.length;)if(curGroupState.i>=curGroupState.layers.length){if(groupStack.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}curGroupState=groupStack.pop()}else{var layerOffsetX,layerOffsetY,nextGroupState=curGroupState.layers[curGroupState.i];curGroupState.i++,"imagelayer"===nextGroupState.type?(layerOffsetX=GetFastValue$5(nextGroupState,"offsetx",0)+GetFastValue$5(nextGroupState,"startx",0),layerOffsetY=GetFastValue$5(nextGroupState,"offsety",0)+GetFastValue$5(nextGroupState,"starty",0),images.push({name:curGroupState.name+nextGroupState.name,image:nextGroupState.image,x:curGroupState.x+layerOffsetX+nextGroupState.x,y:curGroupState.y+layerOffsetY+nextGroupState.y,alpha:curGroupState.opacity*nextGroupState.opacity,visible:curGroupState.visible&&nextGroupState.visible,properties:GetFastValue$5(nextGroupState,"properties",{})})):"group"===nextGroupState.type&&(nextGroupState=CreateGroupLayer$2(json,nextGroupState,curGroupState),groupStack.push(curGroupState),curGroupState=nextGroupState)}return images},HasValue=HasValue_1,Pick_1=function(object,keys){for(var obj={},i=0;i<keys.length;i++){var key=keys[i];HasValue(object,key)&&(obj[key]=object[key])}return obj},ParseGID_1=function(gid){var flippedHorizontal=Boolean(2147483648&gid),flippedVertical=Boolean(1073741824&gid),flippedAntiDiagonal=Boolean(536870912&gid);gid&=536870911;var rotation=0,flipped=!1;return flippedHorizontal&&flippedVertical&&flippedAntiDiagonal?(rotation=Math.PI/2,flipped=!0):flippedHorizontal&&flippedVertical&&!flippedAntiDiagonal?(rotation=Math.PI,flipped=!1):flippedHorizontal&&!flippedVertical&&flippedAntiDiagonal?(rotation=Math.PI/2,flipped=!1):!flippedHorizontal||flippedVertical||flippedAntiDiagonal?!flippedHorizontal&&flippedVertical&&flippedAntiDiagonal?(rotation=3*Math.PI/2,flipped=!1):flippedHorizontal||!flippedVertical||flippedAntiDiagonal?flippedHorizontal||flippedVertical||!flippedAntiDiagonal?flippedHorizontal||flippedVertical||flippedAntiDiagonal||(rotation=0,flipped=!1):(rotation=3*Math.PI/2,flipped=!0):(rotation=Math.PI,flipped=!0):flipped=!(rotation=0),{gid:gid,flippedHorizontal:flippedHorizontal,flippedVertical:flippedVertical,flippedAntiDiagonal:flippedAntiDiagonal,rotation:rotation,flipped:flipped}},Pick=Pick_1,ParseGID$1=ParseGID_1,commonObjectProps=["id","name","type","rotation","properties","visible","x","y","width","height"],ParseObject_1=function(tiledObject,offsetX,gidInfo){void 0===offsetX&&(offsetX=0),void 0===gidInfo&&(gidInfo=0);var parsedObject=Pick(tiledObject,commonObjectProps);return parsedObject.x+=offsetX,parsedObject.y+=gidInfo,tiledObject.gid?(gidInfo=ParseGID$1(tiledObject.gid),parsedObject.gid=gidInfo.gid,parsedObject.flippedHorizontal=gidInfo.flippedHorizontal,parsedObject.flippedVertical=gidInfo.flippedVertical,parsedObject.flippedAntiDiagonal=gidInfo.flippedAntiDiagonal):tiledObject.polyline?parsedObject.polyline=tiledObject.polyline.map(copyPoints):tiledObject.polygon?parsedObject.polygon=tiledObject.polygon.map(copyPoints):tiledObject.ellipse?parsedObject.ellipse=tiledObject.ellipse:tiledObject.text?parsedObject.text=tiledObject.text:tiledObject.point?parsedObject.point=!0:parsedObject.rectangle=!0,parsedObject},GetFastValue$4=GetFastValue_1,TimelineBuilder_1=new Class_1({initialize:function(config){this.name=GetFastValue$4(config=void 0===config?{}:config,"name","object layer"),this.opacity=GetFastValue$4(config,"opacity",1),this.properties=GetFastValue$4(config,"properties",{}),this.propertyTypes=GetFastValue$4(config,"propertytypes",{}),this.type=GetFastValue$4(config,"type","objectgroup"),this.visible=GetFastValue$4(config,"visible",!0),this.objects=GetFastValue$4(config,"objects",[])}}),GetFastValue$3=GetFastValue_1,ParseObject$1=ParseObject_1,ObjectLayer=TimelineBuilder_1,CreateGroupLayer$1=CreateGroupLayer_1,ParseObjectLayers_1=function(json){for(var objectLayers=[],groupStack=[],curGroupState=CreateGroupLayer$1(json);curGroupState.i<curGroupState.layers.length||0<groupStack.length;)if(curGroupState.i>=curGroupState.layers.length){if(groupStack.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}curGroupState=groupStack.pop()}else{var curo=curGroupState.layers[curGroupState.i];if(curGroupState.i++,curo.opacity*=curGroupState.opacity,curo.visible=curGroupState.visible&&curo.visible,"objectgroup"===curo.type){curo.name=curGroupState.name+curo.name;for(var offsetX=curGroupState.x+GetFastValue$3(curo,"startx",0)+GetFastValue$3(curo,"offsetx",0),offsetY=curGroupState.y+GetFastValue$3(curo,"starty",0)+GetFastValue$3(curo,"offsety",0),objects=[],j=0;j<curo.objects.length;j++){var parsedObject=ParseObject$1(curo.objects[j],offsetX,offsetY);objects.push(parsedObject)}var nextGroupState=new ObjectLayer(curo);nextGroupState.objects=objects,objectLayers.push(nextGroupState)}else"group"===curo.type&&(nextGroupState=CreateGroupLayer$1(json,curo,curGroupState),groupStack.push(curGroupState),curGroupState=nextGroupState)}return objectLayers},Base64Decode_1=function(data){for(var binaryString=window.atob(data),len=binaryString.length,bytes=new Array(len/4),i=0;i<len;i+=4)bytes[i/4]=(binaryString.charCodeAt(i)|binaryString.charCodeAt(i+1)<<8|binaryString.charCodeAt(i+2)<<16|binaryString.charCodeAt(i+3)<<24)>>>0;return bytes},Base64Decode=Base64Decode_1,CONST$4=GetTargets_1,CreateGroupLayer=CreateGroupLayer_1,FromOrientationString$1=FromOrientationString_1,GetFastValue$2=GetFastValue_1,LayerData$2=GetTweens_1,ParseGID=ParseGID_1,Tile$3=StaggerBuilder_1,ParseTileLayers_1$1=function(json,insertNull){for(var infiniteMap=GetFastValue$2(json,"infinite",!1),tileLayers=[],groupStack=[],curGroupState=CreateGroupLayer(json);curGroupState.i<curGroupState.layers.length||0<groupStack.length;)if(curGroupState.i>=curGroupState.layers.length){if(groupStack.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}curGroupState=groupStack.pop()}else{var nextGroupState,curl=curGroupState.layers[curGroupState.i];if(curGroupState.i++,"tilelayer"===curl.type)if(curl.compression)console.warn("TilemapParser.parseTiledJSON - Layer compression is unsupported, skipping layer '"+curl.name+"'");else{if(curl.encoding&&"base64"===curl.encoding){if(curl.chunks)for(var i=0;i<curl.chunks.length;i++)curl.chunks[i].data=Base64Decode(curl.chunks[i].data);curl.data&&(curl.data=Base64Decode(curl.data)),delete curl.encoding}var tile,blankTile,output=[],x=0;if(infiniteMap){var layerData,layerOffsetX=GetFastValue$2(curl,"startx",0)+curl.x,layerOffsetY=GetFastValue$2(curl,"starty",0)+curl.y;(layerData=new LayerData$2({name:curGroupState.name+curl.name,x:curGroupState.x+GetFastValue$2(curl,"offsetx",0)+layerOffsetX*json.tilewidth,y:curGroupState.y+GetFastValue$2(curl,"offsety",0)+layerOffsetY*json.tileheight,width:curl.width,height:curl.height,tileWidth:json.tilewidth,tileHeight:json.tileheight,alpha:curGroupState.opacity*curl.opacity,visible:curGroupState.visible&&curl.visible,properties:GetFastValue$2(curl,"properties",[]),orientation:FromOrientationString$1(json.orientation)})).orientation===CONST$4.HEXAGONAL&&(layerData.hexSideLength=json.hexsidelength);for(var c=0;c<curl.height;c++){output.push([null]);for(var j=0;j<curl.width;j++)output[c][j]=null}for(c=0,len=curl.chunks.length;c<len;c++)for(var chunk=curl.chunks[c],offsetX=chunk.x-layerOffsetX,offsetY=chunk.y-layerOffsetY,y=0,t=0,len2=chunk.data.length;t<len2;t++){var gidInfo,newOffsetX=x+offsetX,newOffsetY=y+offsetY;0<(gidInfo=ParseGID(chunk.data[t])).gid?((tile=new Tile$3(layerData,gidInfo.gid,newOffsetX,newOffsetY,json.tilewidth,json.tileheight)).rotation=gidInfo.rotation,tile.flipX=gidInfo.flipped,output[newOffsetY][newOffsetX]=tile):(blankTile=insertNull?null:new Tile$3(layerData,-1,newOffsetX,newOffsetY,json.tilewidth,json.tileheight),output[newOffsetY][newOffsetX]=blankTile),++x===chunk.width&&(y++,x=0)}}else{(layerData=new LayerData$2({name:curGroupState.name+curl.name,x:curGroupState.x+GetFastValue$2(curl,"offsetx",0)+curl.x,y:curGroupState.y+GetFastValue$2(curl,"offsety",0)+curl.y,width:curl.width,height:curl.height,tileWidth:json.tilewidth,tileHeight:json.tileheight,alpha:curGroupState.opacity*curl.opacity,visible:curGroupState.visible&&curl.visible,properties:GetFastValue$2(curl,"properties",[]),orientation:FromOrientationString$1(json.orientation)})).orientation===CONST$4.HEXAGONAL&&(layerData.hexSideLength=json.hexsidelength);for(var row=[],k=0,len=curl.data.length;k<len;k++)0<(gidInfo=ParseGID(curl.data[k])).gid?((tile=new Tile$3(layerData,gidInfo.gid,x,output.length,json.tilewidth,json.tileheight)).rotation=gidInfo.rotation,tile.flipX=gidInfo.flipped,row.push(tile)):(blankTile=insertNull?null:new Tile$3(layerData,-1,x,output.length,json.tilewidth,json.tileheight),row.push(blankTile)),++x===curl.width&&(output.push(row),x=0,row=[])}layerData.data=output,tileLayers.push(layerData)}else"group"===curl.type&&(nextGroupState=CreateGroupLayer(json,curl,curGroupState),groupStack.push(curGroupState),curGroupState=nextGroupState)}return tileLayers},NumberTweenBuilder_1=new Class_1({initialize:function(name,firstgid,width,height,margin,spacing,properties){(void 0===width||width<=0)&&(width=32),(void 0===height||height<=0)&&(height=32),void 0===margin&&(margin=0),void 0===spacing&&(spacing=0),this.name=name,this.firstgid=0|firstgid,this.imageWidth=0|width,this.imageHeight=0|height,this.imageMargin=0|margin,this.imageSpacing=0|spacing,this.properties=properties||{},this.images=[],this.total=0},containsImageIndex:function(imageIndex){return imageIndex>=this.firstgid&&imageIndex<this.firstgid+this.total},addImage:function(gid,image){return this.images.push({gid:gid,image:image}),this.total++,this}}),Tileset$2=GetNewValue_1,ImageCollection=NumberTweenBuilder_1,ParseObject=ParseObject_1,ParseWangsets=function(wangsets,datas){for(var w=0;w<wangsets.length;w++){var wangset=wangsets[w],identifier=w;if(wangset.name&&""!==wangset.name&&(identifier=wangset.name),Array.isArray(wangset.wangtiles)&&0<wangset.wangtiles.length){var c,colorIndex,edgeColors={},cornerColors={};if(Array.isArray(wangset.edgecolors))for(c=0;c<wangset.edgecolors.length;c++)colorIndex=1+c,""!==(color=wangset.edgecolors[c]).name&&(edgeColors[colorIndex]=color.name);if(Array.isArray(wangset.cornercolors))for(c=0;c<wangset.cornercolors.length;c++)colorIndex=1+c,""!==(color=wangset.cornercolors[c]).name&&(cornerColors[colorIndex]=color.name);if(Array.isArray(wangset.colors))for(c=0;c<wangset.colors.length;c++)colorIndex=1+c,""!==(color=wangset.colors[c]).name&&(edgeColors[colorIndex]=cornerColors[colorIndex]=color.name);for(var idLayout=[edgeColors,cornerColors,edgeColors,cornerColors,edgeColors,cornerColors,edgeColors,cornerColors],t=0;t<wangset.wangtiles.length;t++){for(var renamed,color,wangtile=wangset.wangtiles[t],obj=(obj=datas[wangtile.tileid]||(datas[wangtile.tileid]={})).wangid||(obj.wangid={}),wangid=[],i=0;i<Math.min(idLayout.length,wangtile.wangid.length);i++)0!==(color=wangtile.wangid[i])?void 0===(renamed=idLayout[i][color])?wangid.push(color):wangid.push(renamed):wangid.push(void 0);obj[identifier]=wangid}}}},parsers=function(json){for(var stringID,tilesets=[],imageCollections=[],lastSet=null,i=0;i<json.tilesets.length;i++){var set=json.tilesets[i];if(set.source)console.warn("External tilesets unsupported. Use Embed Tileset and re-export");else if(set.image){var newSet=new Tileset$2(set.name,set.firstgid,set.tilewidth,set.tileheight,set.margin,set.spacing);if(1<json.version){var datas=void 0,props=void 0;if(Array.isArray(set.tiles))for(var datas=datas||{},props=props||{},t=0;t<set.tiles.length;t++){var newPropData,parsedObjects2,tile=set.tiles[t];tile.properties&&(newPropData={},tile.properties.forEach(function(propData){newPropData[propData.name]=propData.value}),props[tile.id]=newPropData),tile.objectgroup&&((datas[tile.id]||(datas[tile.id]={})).objectgroup=tile.objectgroup,tile.objectgroup.objects&&(parsedObjects2=tile.objectgroup.objects.map(function(obj){return ParseObject(obj)}),datas[tile.id].objectgroup.objects=parsedObjects2)),tile.animation&&((datas[tile.id]||(datas[tile.id]={})).animation=tile.animation),tile.type&&((datas[tile.id]||(datas[tile.id]={})).type=tile.type)}Array.isArray(set.wangsets)&&(props=props||{},ParseWangsets(set.wangsets,datas=datas||{})),datas&&(newSet.tileData=datas,newSet.tileProperties=props)}else if(set.tileproperties&&(newSet.tileProperties=set.tileproperties),set.tiles)for(stringID in newSet.tileData=set.tiles,newSet.tileData){var parsedObjects1=newSet.tileData[stringID].objectgroup;parsedObjects1&&parsedObjects1.objects&&(parsedObjects1=parsedObjects1.objects.map(function(obj){return ParseObject(obj)}),newSet.tileData[stringID].objectgroup.objects=parsedObjects1)}newSet.updateTileData(set.imagewidth,set.imageheight),tilesets.push(newSet)}else{for(var newCollection=new ImageCollection(set.name,set.firstgid,set.tilewidth,set.tileheight,set.margin,set.spacing,set.properties),maxId=0,t=0;t<set.tiles.length;t++){var image=(tile=set.tiles[t]).image,tileId=parseInt(tile.id,10),gid=set.firstgid+tileId;newCollection.addImage(gid,image),maxId=Math.max(tileId,maxId)}newCollection.maxId=maxId,imageCollections.push(newCollection)}lastSet&&(lastSet.lastgid=set.firstgid-1),lastSet=set}return{tilesets:tilesets,imageCollections:imageCollections}},AssignTileProperties=AssignTileProperties_1,BuildTilesetIndex=BuildTilesetIndex_1,CONST$3=GetTargets_1,Formats$4=tilemaps,FromOrientationString=FromOrientationString_1,MapData$2=builders,ParseImageLayers=ParseImageLayers_1,ParseObjectLayers=ParseObjectLayers_1,ParseTileLayers$2=ParseTileLayers_1$1,ParseTilesets$2=parsers,ParseJSONTiled_1=function(mapData,json,sets){mapData=new MapData$2({width:json.width,height:json.height,name:mapData,tileWidth:json.tilewidth,tileHeight:json.tileheight,orientation:FromOrientationString(json.orientation),format:Formats$4.TILED_JSON,version:json.version,properties:json.properties,renderOrder:json.renderorder,infinite:json.infinite});mapData.orientation===CONST$3.HEXAGONAL&&(mapData.hexSideLength=json.hexsidelength),mapData.layers=ParseTileLayers$2(json,sets),mapData.images=ParseImageLayers(json);sets=ParseTilesets$2(json);return mapData.tilesets=sets.tilesets,mapData.imageCollections=sets.imageCollections,mapData.objects=ParseObjectLayers(json),mapData.tiles=BuildTilesetIndex(mapData),AssignTileProperties(mapData),mapData},LayerData$1=GetTweens_1,Tile$2=StaggerBuilder_1,ParseTileLayers_1=function(json,insertNull){for(var tileLayers=[],i=0;i<json.layer.length;i++){for(var layer=json.layer[i],layerData=new LayerData$1({name:layer.name,width:layer.width,height:layer.height,tileWidth:layer.tilesize,tileHeight:layer.tilesize,visible:1===layer.visible}),row=[],tileGrid=[],y=0;y<layer.data.length;y++){for(var x=0;x<layer.data[y].length;x++){var tile=layer.data[y][x]-1,tile=-1<tile?new Tile$2(layerData,tile,x,y,layer.tilesize,layer.tilesize):insertNull?null:new Tile$2(layerData,-1,x,y,layer.tilesize,layer.tilesize);row.push(tile)}tileGrid.push(row),row=[]}layerData.data=tileGrid,tileLayers.push(layerData)}return tileLayers},Tileset$1=GetNewValue_1,ParseTilesets_1=function(json){for(var tilesets=[],tilesetsNames=[],i=0;i<json.layer.length;i++){var layer=json.layer[i],tilesetName=layer.tilesetName;""!==tilesetName&&-1===tilesetsNames.indexOf(tilesetName)&&(tilesetsNames.push(tilesetName),tilesets.push(new Tileset$1(tilesetName,0,layer.tilesize,layer.tilesize,0,0)))}return tilesets},Formats$3=tilemaps,MapData$1=builders,ParseTileLayers=ParseTileLayers_1,ParseTilesets=ParseTilesets_1,ParseWeltmeister_1=function(mapData,json,insertNull){if(0===json.layer.length)return console.warn("No layers found in the Weltmeister map: "+mapData),null;for(var width=0,height=0,i=0;i<json.layer.length;i++)json.layer[i].width>width&&(width=json.layer[i].width),json.layer[i].height>height&&(height=json.layer[i].height);mapData=new MapData$1({width:width,height:height,name:mapData,tileWidth:json.layer[0].tilesize,tileHeight:json.layer[0].tilesize,format:Formats$3.WELTMEISTER});return mapData.layers=ParseTileLayers(json,insertNull),mapData.tilesets=ParseTilesets(json),mapData},Formats$2=tilemaps,Parse2DArray=Parse2DArray_1,ParseCSV=ParseCSV_1,ParseJSONTiled=ParseJSONTiled_1,ParseWeltmeister=ParseWeltmeister_1,TweenData_1=function(name,mapFormat,data,tileWidth,tileHeight,insertNull){var newMap;switch(mapFormat){case Formats$2.ARRAY_2D:newMap=Parse2DArray(name,data,tileWidth,tileHeight,insertNull);break;case Formats$2.CSV:newMap=ParseCSV(name,data,tileWidth,tileHeight,insertNull);break;case Formats$2.TILED_JSON:newMap=ParseJSONTiled(name,data,insertNull);break;case Formats$2.WELTMEISTER:newMap=ParseWeltmeister(name,data,insertNull);break;default:console.warn("Unrecognized tilemap data format: "+mapFormat),newMap=null}return newMap},parsers={FromOrientationString:FromOrientationString_1,Parse:TweenData_1,Parse2DArray:Parse2DArray_1,ParseCSV:ParseCSV_1,Impact:{ParseTileLayers:ParseTileLayers_1,ParseTilesets:ParseTilesets_1,ParseWeltmeister:ParseWeltmeister_1},Tiled:{AssignTileProperties:AssignTileProperties_1,Base64Decode:Base64Decode_1,BuildTilesetIndex:BuildTilesetIndex_1,CreateGroupLayer:CreateGroupLayer_1,ParseGID:ParseGID_1,ParseImageLayers:ParseImageLayers_1,ParseJSONTiled:ParseJSONTiled_1,ParseObject:ParseObject_1,ParseObjectLayers:ParseObjectLayers_1,ParseTileLayers:ParseTileLayers_1$1,ParseTilesets:parsers}},Utils=GetProps_1,GetProps_1=function(renderer,src,camera){var renderTiles=src.cull(camera),tileCount=renderTiles.length,alpha=camera.alpha*src.alpha;if(!(0===tileCount||alpha<=0)){var gidMap=src.gidMap,pipeline=renderer.pipelines.set(src.pipeline,src),getTint=Utils.getTintAppendFloatAlpha,scrollFactorX=src.scrollFactorX,scrollFactorY=src.scrollFactorY,x=src.x,y=src.y,sx=src.scaleX,sy=src.scaleY;renderer.pipelines.preBatch(src);for(var i=0;i<tileCount;i++){var texture,textureUnit,frameWidth,frameHeight,frameX,frameY,tw,th,tile=renderTiles[i],tint=gidMap[tile.index];tint&&(null!==(th=tint.getTileTextureCoordinates(tile.index))&&(texture=tint.glTexture,textureUnit=pipeline.setTexture2D(texture,src),frameWidth=tint.tileWidth,frameHeight=tint.tileHeight,frameX=th.x,frameY=th.y,tw=.5*tint.tileWidth,th=.5*tint.tileHeight,tint=getTint(tile.tint,alpha*tile.alpha),pipeline.batchTexture(src,texture,texture.width,texture.height,x+(tw+tile.pixelX)*sx,y+(th+tile.pixelY)*sy,tile.width,tile.height,sx,sy,tile.rotation,tile.flipX,tile.flipY,scrollFactorX,scrollFactorY,tw,th,frameX,frameY,frameWidth,frameHeight,tint,tint,tint,tint,!1,0,0,camera,null,!0,textureUnit)))}renderer.pipelines.postBatch(src)}},TransformMatrix=TransformMatrix,tempMatrix1=new TransformMatrix,tempMatrix2=new TransformMatrix,tempMatrix3=new TransformMatrix,GameObject=GameObject_1,TilemapComponents$1=components,GetProps_1=new Class_1({Extends:GameObject,Mixins:[components$3.Alpha,components$3.BlendMode,components$3.ComputedSize,components$3.Depth,components$3.Flip,components$3.GetBounds,components$3.Origin,components$3.Pipeline,components$3.Transform,components$3.Visible,components$3.ScrollFactor,{renderWebGL:GetProps_1,renderCanvas:function(renderer,src,camera,parentMatrix){var renderTiles=src.cull(camera),tileCount=renderTiles.length,alpha=camera.alpha*src.alpha;if(!(0===tileCount||alpha<=0)){var camMatrix=tempMatrix1,layerMatrix=tempMatrix2,calcMatrix=tempMatrix3;layerMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY),camMatrix.copyFrom(camera.matrix);var ctx=renderer.currentContext,gidMap=src.gidMap;ctx.save(),parentMatrix?(camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY),layerMatrix.e=src.x,layerMatrix.f=src.y,camMatrix.multiply(layerMatrix,calcMatrix),calcMatrix.copyToContext(ctx)):(layerMatrix.e-=camera.scrollX*src.scrollFactorX,layerMatrix.f-=camera.scrollY*src.scrollFactorY,layerMatrix.copyToContext(ctx)),(!renderer.antialias||1<src.scaleX||1<src.scaleY)&&(ctx.imageSmoothingEnabled=!1);for(var i=0;i<tileCount;i++){var image,tileTexCoords,tileWidth,tileHeight,halfWidth,tile=renderTiles[i],halfHeight=gidMap[tile.index];halfHeight&&(image=halfHeight.image.getSourceImage(),null!==(tileTexCoords=halfHeight.getTileTextureCoordinates(tile.index))&&(halfWidth=.5*(tileWidth=halfHeight.tileWidth),halfHeight=.5*(tileHeight=halfHeight.tileHeight),ctx.save(),ctx.translate(tile.pixelX+halfWidth,tile.pixelY+halfHeight),0!==tile.rotation&&ctx.rotate(tile.rotation),(tile.flipX||tile.flipY)&&ctx.scale(tile.flipX?-1:1,tile.flipY?-1:1),ctx.globalAlpha=alpha*tile.alpha,ctx.drawImage(image,tileTexCoords.x,tileTexCoords.y,tileWidth,tileHeight,-halfWidth,-halfHeight,tileWidth,tileHeight),ctx.restore()))}ctx.restore()}}}],initialize:function(scene,tilemap,layerIndex,tileset,x,y){GameObject.call(this,scene,"TilemapLayer"),this.isTilemap=!0,this.tilemap=tilemap,this.layerIndex=layerIndex,this.layer=tilemap.layers[layerIndex],(this.layer.tilemapLayer=this).tileset=[],this.tilesDrawn=0,this.tilesTotal=this.layer.width*this.layer.height,this.culledTiles=[],this.skipCull=!1,this.cullPaddingX=1,this.cullPaddingY=1,this.cullCallback=TilemapComponents$1.GetCullTilesFunction(this.layer.orientation),this._renderOrder=0,this.gidMap=[],this.setTilesets(tileset),this.setAlpha(this.layer.alpha),this.setPosition(x,y),this.setOrigin(),this.setSize(tilemap.tileWidth*this.layer.width,tilemap.tileHeight*this.layer.height),this.initPipeline()},setTilesets:function(tilesets){var gidMap=[],setList=[],map=this.tilemap;Array.isArray(tilesets)||(tilesets=[tilesets]);for(var i=0;i<tilesets.length;i++){var tileset=tilesets[i];if(tileset="string"==typeof tileset?map.getTileset(tileset):tileset){setList.push(tileset);for(var s=tileset.firstgid,t=0;t<tileset.total;t++)gidMap[s+t]=tileset}}this.gidMap=gidMap,this.tileset=setList},setRenderOrder:function(renderOrder){return 0<=(renderOrder="string"==typeof renderOrder?["right-down","left-down","right-up","left-up"].indexOf(renderOrder):renderOrder)&&renderOrder<4&&(this._renderOrder=renderOrder),this},calculateFacesAt:function(tileX,tileY){return TilemapComponents$1.CalculateFacesAt(tileX,tileY,this.layer),this},calculateFacesWithin:function(tileX,tileY,width,height){return TilemapComponents$1.CalculateFacesWithin(tileX,tileY,width,height,this.layer),this},createFromTiles:function(indexes,replacements,spriteConfig,scene,camera){return TilemapComponents$1.CreateFromTiles(indexes,replacements,spriteConfig,scene,camera,this.layer)},cull:function(camera){return this.cullCallback(this.layer,camera,this.culledTiles,this._renderOrder)},copy:function(srcTileX,srcTileY,width,height,destTileX,destTileY,recalculateFaces){return TilemapComponents$1.Copy(srcTileX,srcTileY,width,height,destTileX,destTileY,recalculateFaces,this.layer),this},fill:function(index,tileX,tileY,width,height,recalculateFaces){return TilemapComponents$1.Fill(index,tileX,tileY,width,height,recalculateFaces,this.layer),this},filterTiles:function(callback,context,tileX,tileY,width,height,filteringOptions){return TilemapComponents$1.FilterTiles(callback,context,tileX,tileY,width,height,filteringOptions,this.layer)},findByIndex:function(findIndex,skip,reverse){return TilemapComponents$1.FindByIndex(findIndex,skip,reverse,this.layer)},findTile:function(callback,context,tileX,tileY,width,height,filteringOptions){return TilemapComponents$1.FindTile(callback,context,tileX,tileY,width,height,filteringOptions,this.layer)},forEachTile:function(callback,context,tileX,tileY,width,height,filteringOptions){return TilemapComponents$1.ForEachTile(callback,context,tileX,tileY,width,height,filteringOptions,this.layer),this},getTileAt:function(tileX,tileY,nonNull){return TilemapComponents$1.GetTileAt(tileX,tileY,nonNull,this.layer)},getTileAtWorldXY:function(worldX,worldY,nonNull,camera){return TilemapComponents$1.GetTileAtWorldXY(worldX,worldY,nonNull,camera,this.layer)},getTilesWithin:function(tileX,tileY,width,height,filteringOptions){return TilemapComponents$1.GetTilesWithin(tileX,tileY,width,height,filteringOptions,this.layer)},getTilesWithinShape:function(shape,filteringOptions,camera){return TilemapComponents$1.GetTilesWithinShape(shape,filteringOptions,camera,this.layer)},getTilesWithinWorldXY:function(worldX,worldY,width,height,filteringOptions,camera){return TilemapComponents$1.GetTilesWithinWorldXY(worldX,worldY,width,height,filteringOptions,camera,this.layer)},hasTileAt:function(tileX,tileY){return TilemapComponents$1.HasTileAt(tileX,tileY,this.layer)},hasTileAtWorldXY:function(worldX,worldY,camera){return TilemapComponents$1.HasTileAtWorldXY(worldX,worldY,camera,this.layer)},putTileAt:function(tile,tileX,tileY,recalculateFaces){return TilemapComponents$1.PutTileAt(tile,tileX,tileY,recalculateFaces,this.layer)},putTileAtWorldXY:function(tile,worldX,worldY,recalculateFaces,camera){return TilemapComponents$1.PutTileAtWorldXY(tile,worldX,worldY,recalculateFaces,camera,this.layer)},putTilesAt:function(tilesArray,tileX,tileY,recalculateFaces){return TilemapComponents$1.PutTilesAt(tilesArray,tileX,tileY,recalculateFaces,this.layer),this},randomize:function(tileX,tileY,width,height,indexes){return TilemapComponents$1.Randomize(tileX,tileY,width,height,indexes,this.layer),this},removeTileAt:function(tileX,tileY,replaceWithNull,recalculateFaces){return TilemapComponents$1.RemoveTileAt(tileX,tileY,replaceWithNull,recalculateFaces,this.layer)},removeTileAtWorldXY:function(worldX,worldY,replaceWithNull,recalculateFaces,camera){return TilemapComponents$1.RemoveTileAtWorldXY(worldX,worldY,replaceWithNull,recalculateFaces,camera,this.layer)},renderDebug:function(graphics,styleConfig){return TilemapComponents$1.RenderDebug(graphics,styleConfig,this.layer),this},replaceByIndex:function(findIndex,newIndex,tileX,tileY,width,height){return TilemapComponents$1.ReplaceByIndex(findIndex,newIndex,tileX,tileY,width,height,this.layer),this},setSkipCull:function(value){return this.skipCull=value=void 0===value?!0:value,this},setCullPadding:function(paddingX,paddingY){return void 0===paddingY&&(paddingY=1),this.cullPaddingX=paddingX=void 0===paddingX?1:paddingX,this.cullPaddingY=paddingY,this},setCollision:function(indexes,collides,recalculateFaces,updateLayer){return TilemapComponents$1.SetCollision(indexes,collides,recalculateFaces,this.layer,updateLayer),this},setCollisionBetween:function(start,stop,collides,recalculateFaces){return TilemapComponents$1.SetCollisionBetween(start,stop,collides,recalculateFaces,this.layer),this},setCollisionByProperty:function(properties,collides,recalculateFaces){return TilemapComponents$1.SetCollisionByProperty(properties,collides,recalculateFaces,this.layer),this},setCollisionByExclusion:function(indexes,collides,recalculateFaces){return TilemapComponents$1.SetCollisionByExclusion(indexes,collides,recalculateFaces,this.layer),this},setCollisionFromCollisionGroup:function(collides,recalculateFaces){return TilemapComponents$1.SetCollisionFromCollisionGroup(collides,recalculateFaces,this.layer),this},setTileIndexCallback:function(indexes,callback,callbackContext){return TilemapComponents$1.SetTileIndexCallback(indexes,callback,callbackContext,this.layer),this},setTileLocationCallback:function(tileX,tileY,width,height,callback,callbackContext){return TilemapComponents$1.SetTileLocationCallback(tileX,tileY,width,height,callback,callbackContext,this.layer),this},shuffle:function(tileX,tileY,width,height){return TilemapComponents$1.Shuffle(tileX,tileY,width,height,this.layer),this},swapByIndex:function(indexA,indexB,tileX,tileY,width,height){return TilemapComponents$1.SwapByIndex(indexA,indexB,tileX,tileY,width,height,this.layer),this},tileToWorldX:function(tileX,camera){return this.tilemap.tileToWorldX(tileX,camera,this)},tileToWorldY:function(tileY,camera){return this.tilemap.tileToWorldY(tileY,camera,this)},tileToWorldXY:function(tileX,tileY,point,camera){return this.tilemap.tileToWorldXY(tileX,tileY,point,camera,this)},weightedRandomize:function(weightedIndexes,tileX,tileY,width,height){return TilemapComponents$1.WeightedRandomize(tileX,tileY,width,height,weightedIndexes,this.layer),this},worldToTileX:function(worldX,snapToFloor,camera){return this.tilemap.worldToTileX(worldX,snapToFloor,camera,this)},worldToTileY:function(worldY,snapToFloor,camera){return this.tilemap.worldToTileY(worldY,snapToFloor,camera,this)},worldToTileXY:function(worldX,worldY,snapToFloor,point,camera){return this.tilemap.worldToTileXY(worldX,worldY,snapToFloor,point,camera,this)},destroy:function(removeFromTilemap){void 0===removeFromTilemap&&(removeFromTilemap=!0),this.tilemap&&(this.layer.tilemapLayer===this&&(this.layer.tilemapLayer=void 0),removeFromTilemap&&this.tilemap.removeLayer(this),this.tilemap=void 0,this.layer=void 0,this.culledTiles.length=0,this.cullCallback=null,this.gidMap=[],this.tileset=[],GameObject.prototype.destroy.call(this))}}),DegToRad=DegToRad_1,Formats$1=tilemaps,GetFastValue$1=GetFastValue_1,LayerData=GetTweens_1,ORIENTATION=GetTargets_1,Rotate=Rotate_1$2,SpliceOne=SpliceOne_1,Sprite=time,Tile$1=StaggerBuilder_1,TilemapComponents=components,TilemapLayer=GetProps_1,Tileset=GetNewValue_1,time=new Class_1({initialize:function(scene,orientation){this.scene=scene,this.tileWidth=orientation.tileWidth,this.tileHeight=orientation.tileHeight,this.width=orientation.width,this.height=orientation.height,this.orientation=orientation.orientation,this.renderOrder=orientation.renderOrder,this.format=orientation.format,this.version=orientation.version,this.properties=orientation.properties,this.widthInPixels=orientation.widthInPixels,this.heightInPixels=orientation.heightInPixels,this.imageCollections=orientation.imageCollections,this.images=orientation.images,this.layers=orientation.layers,this.tilesets=orientation.tilesets,this.objects=orientation.objects,this.currentLayerIndex=0,this.hexSideLength=orientation.hexSideLength;orientation=this.orientation;this._convert={WorldToTileXY:TilemapComponents.GetWorldToTileXYFunction(orientation),WorldToTileX:TilemapComponents.GetWorldToTileXFunction(orientation),WorldToTileY:TilemapComponents.GetWorldToTileYFunction(orientation),TileToWorldXY:TilemapComponents.GetTileToWorldXYFunction(orientation),TileToWorldX:TilemapComponents.GetTileToWorldXFunction(orientation),TileToWorldY:TilemapComponents.GetTileToWorldYFunction(orientation)}},createBlankDynamicLayer:function(name,tileset,x,y,width,height,tileWidth,tileHeight){return console.warn("createBlankDynamicLayer is deprecated. Use createBlankLayer"),this.createBlankLayer(name,tileset,x,y,width,height,tileWidth,tileHeight)},createDynamicLayer:function(layerID,tileset,x,y){return console.warn("createDynamicLayer is deprecated. Use createLayer"),this.createLayer(layerID,tileset,x,y)},createStaticLayer:function(layerID,tileset,x,y){return console.warn("createStaticLayer is deprecated. Use createLayer"),this.createLayer(layerID,tileset,x,y)},setRenderOrder:function(renderOrder){var orders=["right-down","left-down","right-up","left-up"];return"number"==typeof renderOrder&&(renderOrder=orders[renderOrder]),-1<orders.indexOf(renderOrder)&&(this.renderOrder=renderOrder),this},addTilesetImage:function(tilesetName,tileset,tileWidth,tileHeight,tileMargin,tileSpacing,gid){if(void 0===tilesetName)return null;if(!this.scene.sys.textures.exists(tileset=null==tileset?tilesetName:tileset))return console.warn("Invalid Tileset Image: "+tileset),null;var texture=this.scene.sys.textures.get(tileset),tileset=this.getTilesetIndex(tilesetName);if(null===tileset&&this.format===Formats$1.TILED_JSON)return console.warn("No data found for Tileset: "+tilesetName),null;tileset=this.tilesets[tileset];return tileset?(tileset.setTileSize(tileWidth,tileHeight),tileset.setSpacing(tileMargin,tileSpacing),tileset.setImage(texture)):(void 0===tileWidth&&(tileWidth=this.tileWidth),void 0===tileHeight&&(tileHeight=this.tileHeight),(tileset=new Tileset(tilesetName,gid=void 0===gid?0:gid,tileWidth,tileHeight,tileMargin=void 0===tileMargin?0:tileMargin,tileSpacing=void 0===tileSpacing?0:tileSpacing)).setImage(texture),this.tilesets.push(tileset)),tileset},copy:function(srcTileX,srcTileY,width,height,destTileX,destTileY,recalculateFaces,layer){return null!==(layer=this.getLayer(layer))?(TilemapComponents.Copy(srcTileX,srcTileY,width,height,destTileX,destTileY,recalculateFaces,layer),this):null},createBlankLayer:function(name,tileset,x,layer,width,height,tileWidth,tileHeight){if(void 0===x&&(x=0),void 0===layer&&(layer=0),void 0===width&&(width=this.width),void 0===height&&(height=this.height),void 0===tileWidth&&(tileWidth=this.tileWidth),void 0===tileHeight&&(tileHeight=this.tileHeight),null!==this.getLayerIndex(name))return console.warn("Invalid Tilemap Layer ID: "+name),null;for(var layerData=new LayerData({name:name,tileWidth:tileWidth,tileHeight:tileHeight,width:width,height:height,orientation:this.orientation}),tileY=0;tileY<height;tileY++){for(var row=[],tileX=0;tileX<width;tileX++)row.push(new Tile$1(layerData,-1,tileX,tileY,tileWidth,tileHeight,this.tileWidth,this.tileHeight));layerData.data.push(row)}this.layers.push(layerData),this.currentLayerIndex=this.layers.length-1;layer=new TilemapLayer(this.scene,this,this.currentLayerIndex,tileset,x,layer);return layer.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(layer),layer},createLayer:function(layerID,tileset,x,layer){var index=this.getLayerIndex(layerID);if(null===index)return console.warn("Invalid Tilemap Layer ID: "+layerID),"string"==typeof layerID&&console.warn("Valid tilelayer names:\n\t"+this.getTileLayerNames().join(",\n\t")),null;var layerData=this.layers[index];if(layerData.tilemapLayer)return console.warn("Tilemap Layer ID already exists:"+layerID),null;this.currentLayerIndex=index,void 0===x&&(x=layerData.x),void 0===layer&&(layer=layerData.y);layer=new TilemapLayer(this.scene,this,index,tileset,x,layer);return layer.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(layer),layer},createFromObjects:function(objectLayerName,config){var results=[],objectLayer=this.getObjectLayer(objectLayerName);if(!objectLayer)return console.warn("createFromObjects: Invalid objectLayerName given: "+objectLayerName),results;Array.isArray(config)||(config=[config]);for(var objects=objectLayer.objects,c=0;c<config.length;c++){for(var singleConfig=config[c],id=GetFastValue$1(singleConfig,"id",null),gid=GetFastValue$1(singleConfig,"gid",null),name=GetFastValue$1(singleConfig,"name",null),toConvert=[],s=0;s<objects.length;s++)obj=objects[s],(null===id&&null===gid&&null===name||null!==id&&obj.id===id||null!==gid&&obj.gid===gid||null!==name&&obj.name===name)&&toConvert.push(obj);for(var classType=GetFastValue$1(singleConfig,"classType",Sprite),scene=GetFastValue$1(singleConfig,"scene",this.scene),container=GetFastValue$1(singleConfig,"container",null),texture=GetFastValue$1(singleConfig,"key",null),frame=GetFastValue$1(singleConfig,"frame",null),i=0;i<toConvert.length;i++){var obj=toConvert[i],sprite=new classType(scene);sprite.setName(obj.name),sprite.setPosition(obj.x,obj.y),sprite.setTexture(texture,frame),obj.width&&(sprite.displayWidth=obj.width),obj.height&&(sprite.displayHeight=obj.height);var angle,offset={x:sprite.originX*obj.width,y:(sprite.originY-1)*obj.height};if(obj.rotation&&(angle=DegToRad(obj.rotation),Rotate(offset,angle),sprite.rotation=angle),sprite.x+=offset.x,sprite.y+=offset.y,void 0===obj.flippedHorizontal&&void 0===obj.flippedVertical||sprite.setFlip(obj.flippedHorizontal,obj.flippedVertical),obj.visible||(sprite.visible=!1),Array.isArray(obj.properties))obj.properties.forEach(function(propData){var key=propData.name;void 0!==sprite[key]?sprite[key]=propData.value:sprite.setData(key,propData.value)});else for(var key in obj.properties)void 0!==sprite[key]?sprite[key]=obj.properties[key]:sprite.setData(key,obj.properties[key]);container?container.add(sprite):scene.add.existing(sprite),results.push(sprite)}}return results},createFromTiles:function(indexes,replacements,spriteConfig,scene,camera,layer){return null===(layer=this.getLayer(layer))?null:TilemapComponents.CreateFromTiles(indexes,replacements,spriteConfig,scene,camera,layer)},fill:function(index,tileX,tileY,width,height,recalculateFaces,layer){return void 0===recalculateFaces&&(recalculateFaces=!0),null===(layer=this.getLayer(layer))?null:(TilemapComponents.Fill(index,tileX,tileY,width,height,recalculateFaces,layer),this)},filterObjects:function(objectLayer,callback,context){if("string"==typeof objectLayer){var name=objectLayer;if(!(objectLayer=this.getObjectLayer(objectLayer)))return console.warn("No object layer found with the name: "+name),null}return objectLayer.objects.filter(callback,context)},filterTiles:function(callback,context,tileX,tileY,width,height,filteringOptions,layer){return null===(layer=this.getLayer(layer))?null:TilemapComponents.FilterTiles(callback,context,tileX,tileY,width,height,filteringOptions,layer)},findByIndex:function(findIndex,skip,reverse,layer){return null===(layer=this.getLayer(layer))?null:TilemapComponents.FindByIndex(findIndex,skip,reverse,layer)},findObject:function(objectLayer,callback,context){if("string"==typeof objectLayer){var name=objectLayer;if(!(objectLayer=this.getObjectLayer(objectLayer)))return console.warn("No object layer found with the name: "+name),null}return objectLayer.objects.find(callback,context)||null},findTile:function(callback,context,tileX,tileY,width,height,filteringOptions,layer){return null===(layer=this.getLayer(layer))?null:TilemapComponents.FindTile(callback,context,tileX,tileY,width,height,filteringOptions,layer)},forEachTile:function(callback,context,tileX,tileY,width,height,filteringOptions,layer){return null===(layer=this.getLayer(layer))?null:(TilemapComponents.ForEachTile(callback,context,tileX,tileY,width,height,filteringOptions,layer),this)},getImageIndex:function(name){return this.getIndex(this.images,name)},getImageLayerNames:function(){return this.images&&Array.isArray(this.images)?this.images.map(function(image){return image.name}):[]},getIndex:function(location,name){for(var i=0;i<location.length;i++)if(location[i].name===name)return i;return null},getLayer:function(index){index=this.getLayerIndex(index);return null!==index?this.layers[index]:null},getObjectLayer:function(index){index=this.getIndex(this.objects,index);return null!==index?this.objects[index]:null},getObjectLayerNames:function(){return this.objects&&Array.isArray(this.objects)?this.objects.map(function(object){return object.name}):[]},getLayerIndex:function(layer){return void 0===layer?this.currentLayerIndex:"string"==typeof layer?this.getLayerIndexByName(layer):"number"==typeof layer&&layer<this.layers.length?layer:layer instanceof TilemapLayer?layer.layerIndex:null},getLayerIndexByName:function(name){return this.getIndex(this.layers,name)},getTileAt:function(tileX,tileY,nonNull,layer){return null===(layer=this.getLayer(layer))?null:TilemapComponents.GetTileAt(tileX,tileY,nonNull,layer)},getTileAtWorldXY:function(worldX,worldY,nonNull,camera,layer){return null===(layer=this.getLayer(layer))?null:TilemapComponents.GetTileAtWorldXY(worldX,worldY,nonNull,camera,layer)},getTileLayerNames:function(){return this.layers&&Array.isArray(this.layers)?this.layers.map(function(layer){return layer.name}):[]},getTilesWithin:function(tileX,tileY,width,height,filteringOptions,layer){return null===(layer=this.getLayer(layer))?null:TilemapComponents.GetTilesWithin(tileX,tileY,width,height,filteringOptions,layer)},getTilesWithinShape:function(shape,filteringOptions,camera,layer){return null===(layer=this.getLayer(layer))?null:TilemapComponents.GetTilesWithinShape(shape,filteringOptions,camera,layer)},getTilesWithinWorldXY:function(worldX,worldY,width,height,filteringOptions,camera,layer){return null===(layer=this.getLayer(layer))?null:TilemapComponents.GetTilesWithinWorldXY(worldX,worldY,width,height,filteringOptions,camera,layer)},getTileset:function(index){index=this.getIndex(this.tilesets,index);return null!==index?this.tilesets[index]:null},getTilesetIndex:function(name){return this.getIndex(this.tilesets,name)},hasTileAt:function(tileX,tileY,layer){return null===(layer=this.getLayer(layer))?null:TilemapComponents.HasTileAt(tileX,tileY,layer)},hasTileAtWorldXY:function(worldX,worldY,camera,layer){return null===(layer=this.getLayer(layer))?null:TilemapComponents.HasTileAtWorldXY(worldX,worldY,camera,layer)},layer:{get:function(){return this.layers[this.currentLayerIndex]},set:function(layer){this.setLayer(layer)}},putTileAt:function(tile,tileX,tileY,recalculateFaces,layer){return void 0===recalculateFaces&&(recalculateFaces=!0),null===(layer=this.getLayer(layer))?null:TilemapComponents.PutTileAt(tile,tileX,tileY,recalculateFaces,layer)},putTileAtWorldXY:function(tile,worldX,worldY,recalculateFaces,camera,layer){return void 0===recalculateFaces&&(recalculateFaces=!0),null===(layer=this.getLayer(layer))?null:TilemapComponents.PutTileAtWorldXY(tile,worldX,worldY,recalculateFaces,camera,layer)},putTilesAt:function(tilesArray,tileX,tileY,recalculateFaces,layer){return void 0===recalculateFaces&&(recalculateFaces=!0),null===(layer=this.getLayer(layer))?null:(TilemapComponents.PutTilesAt(tilesArray,tileX,tileY,recalculateFaces,layer),this)},randomize:function(tileX,tileY,width,height,indexes,layer){return null===(layer=this.getLayer(layer))?null:(TilemapComponents.Randomize(tileX,tileY,width,height,indexes,layer),this)},calculateFacesAt:function(tileX,tileY,layer){return null===(layer=this.getLayer(layer))?null:(TilemapComponents.CalculateFacesAt(tileX,tileY,layer),this)},calculateFacesWithin:function(tileX,tileY,width,height,layer){return null===(layer=this.getLayer(layer))?null:(TilemapComponents.CalculateFacesWithin(tileX,tileY,width,height,layer),this)},removeLayer:function(index){index=this.getLayerIndex(index);if(null===index)return null;SpliceOne(this.layers,index);for(var i=index;i<this.layers.length;i++)this.layers[i].tilemapLayer&&this.layers[i].tilemapLayer.layerIndex--;return this.currentLayerIndex===index&&(this.currentLayerIndex=0),this},destroyLayer:function(layer){var index=this.getLayerIndex(layer);return null!==index?((layer=this.layers[index]).destroy(),SpliceOne(this.layers,index),this.currentLayerIndex===index&&(this.currentLayerIndex=0),this):null},removeAllLayers:function(){for(var layers=this.layers,i=0;i<layers.length;i++)layers[i].tilemapLayer&&layers[i].tilemapLayer.destroy(!1);return layers.length=0,this.currentLayerIndex=0,this},removeTile:function(tiles,replaceIndex,recalculateFaces){void 0===replaceIndex&&(replaceIndex=-1),void 0===recalculateFaces&&(recalculateFaces=!0);var removed=[];Array.isArray(tiles)||(tiles=[tiles]);for(var i=0;i<tiles.length;i++){var tile=tiles[i];removed.push(this.removeTileAt(tile.x,tile.y,!0,recalculateFaces,tile.tilemapLayer)),-1<replaceIndex&&this.putTileAt(replaceIndex,tile.x,tile.y,recalculateFaces,tile.tilemapLayer)}return removed},removeTileAt:function(tileX,tileY,replaceWithNull,recalculateFaces,layer){return void 0===replaceWithNull&&(replaceWithNull=!0),void 0===recalculateFaces&&(recalculateFaces=!0),null===(layer=this.getLayer(layer))?null:TilemapComponents.RemoveTileAt(tileX,tileY,replaceWithNull,recalculateFaces,layer)},removeTileAtWorldXY:function(worldX,worldY,replaceWithNull,recalculateFaces,camera,layer){return void 0===replaceWithNull&&(replaceWithNull=!0),void 0===recalculateFaces&&(recalculateFaces=!0),null===(layer=this.getLayer(layer))?null:TilemapComponents.RemoveTileAtWorldXY(worldX,worldY,replaceWithNull,recalculateFaces,camera,layer)},renderDebug:function(graphics,styleConfig,layer){return null===(layer=this.getLayer(layer))?null:(this.orientation===ORIENTATION.ORTHOGONAL&&TilemapComponents.RenderDebug(graphics,styleConfig,layer),this)},renderDebugFull:function(graphics,styleConfig){for(var layers=this.layers,i=0;i<layers.length;i++)TilemapComponents.RenderDebug(graphics,styleConfig,layers[i]);return this},replaceByIndex:function(findIndex,newIndex,tileX,tileY,width,height,layer){return null===(layer=this.getLayer(layer))?null:(TilemapComponents.ReplaceByIndex(findIndex,newIndex,tileX,tileY,width,height,layer),this)},setCollision:function(indexes,collides,recalculateFaces,layer,updateLayer){return void 0===collides&&(collides=!0),void 0===recalculateFaces&&(recalculateFaces=!0),void 0===updateLayer&&(updateLayer=!0),null===(layer=this.getLayer(layer))?null:(TilemapComponents.SetCollision(indexes,collides,recalculateFaces,layer,updateLayer),this)},setCollisionBetween:function(start,stop,collides,recalculateFaces,layer){return void 0===collides&&(collides=!0),void 0===recalculateFaces&&(recalculateFaces=!0),null===(layer=this.getLayer(layer))?null:(TilemapComponents.SetCollisionBetween(start,stop,collides,recalculateFaces,layer),this)},setCollisionByProperty:function(properties,collides,recalculateFaces,layer){return void 0===collides&&(collides=!0),void 0===recalculateFaces&&(recalculateFaces=!0),null===(layer=this.getLayer(layer))?null:(TilemapComponents.SetCollisionByProperty(properties,collides,recalculateFaces,layer),this)},setCollisionByExclusion:function(indexes,collides,recalculateFaces,layer){return void 0===collides&&(collides=!0),void 0===recalculateFaces&&(recalculateFaces=!0),null===(layer=this.getLayer(layer))?null:(TilemapComponents.SetCollisionByExclusion(indexes,collides,recalculateFaces,layer),this)},setCollisionFromCollisionGroup:function(collides,recalculateFaces,layer){return void 0===collides&&(collides=!0),void 0===recalculateFaces&&(recalculateFaces=!0),null===(layer=this.getLayer(layer))?null:(TilemapComponents.SetCollisionFromCollisionGroup(collides,recalculateFaces,layer),this)},setTileIndexCallback:function(indexes,callback,callbackContext,layer){return null===(layer=this.getLayer(layer))?null:(TilemapComponents.SetTileIndexCallback(indexes,callback,callbackContext,layer),this)},setTileLocationCallback:function(tileX,tileY,width,height,callback,callbackContext,layer){return null===(layer=this.getLayer(layer))?null:(TilemapComponents.SetTileLocationCallback(tileX,tileY,width,height,callback,callbackContext,layer),this)},setLayer:function(index){index=this.getLayerIndex(index);return null!==index&&(this.currentLayerIndex=index),this},setBaseTileSize:function(tileWidth,tileHeight){this.tileWidth=tileWidth,this.tileHeight=tileHeight,this.widthInPixels=this.width*tileWidth,this.heightInPixels=this.height*tileHeight;for(var i=0;i<this.layers.length;i++){this.layers[i].baseTileWidth=tileWidth,this.layers[i].baseTileHeight=tileHeight;for(var mapData=this.layers[i].data,mapWidth=this.layers[i].width,mapHeight=this.layers[i].height,row=0;row<mapHeight;row++)for(var col=0;col<mapWidth;col++){var tile=mapData[row][col];null!==tile&&tile.setSize(void 0,void 0,tileWidth,tileHeight)}}return this},setLayerTileSize:function(tileWidth,tileHeight,layer){if(null===(layer=this.getLayer(layer)))return this;layer.tileWidth=tileWidth,layer.tileHeight=tileHeight;for(var mapData=layer.data,mapWidth=layer.width,mapHeight=layer.height,row=0;row<mapHeight;row++)for(var col=0;col<mapWidth;col++){var tile=mapData[row][col];null!==tile&&tile.setSize(tileWidth,tileHeight)}return this},shuffle:function(tileX,tileY,width,height,layer){return null===(layer=this.getLayer(layer))?null:(TilemapComponents.Shuffle(tileX,tileY,width,height,layer),this)},swapByIndex:function(indexA,indexB,tileX,tileY,width,height,layer){return null===(layer=this.getLayer(layer))?null:(TilemapComponents.SwapByIndex(indexA,indexB,tileX,tileY,width,height,layer),this)},tileToWorldX:function(tileX,camera,layer){return null===(layer=this.getLayer(layer))?null:this._convert.TileToWorldX(tileX,camera,layer)},tileToWorldY:function(tileX,camera,layer){return null===(layer=this.getLayer(layer))?null:this._convert.TileToWorldY(tileX,camera,layer)},tileToWorldXY:function(tileX,tileY,vec2,camera,layer){return null===(layer=this.getLayer(layer))?null:this._convert.TileToWorldXY(tileX,tileY,vec2,camera,layer)},weightedRandomize:function(weightedIndexes,tileX,tileY,width,height,layer){return null===(layer=this.getLayer(layer))?null:(TilemapComponents.WeightedRandomize(tileX,tileY,width,height,weightedIndexes,layer),this)},worldToTileX:function(worldX,snapToFloor,camera,layer){return null===(layer=this.getLayer(layer))?null:this._convert.WorldToTileX(worldX,snapToFloor,camera,layer)},worldToTileY:function(worldY,snapToFloor,camera,layer){return null===(layer=this.getLayer(layer))?null:this._convert.WorldToTileY(worldY,snapToFloor,camera,layer)},worldToTileXY:function(worldX,worldY,snapToFloor,vec2,camera,layer){return null===(layer=this.getLayer(layer))?null:this._convert.WorldToTileXY(worldX,worldY,snapToFloor,vec2,camera,layer)},destroy:function(){this.removeAllLayers(),this.tilesets.length=0,this.objects.length=0,this.scene=null}}),Formats=tilemaps,MapData=builders,Parse=TweenData_1,Tilemap=time,TweenData_1=function(scene,key,tileWidth,tileHeight,width,height,tilemapData,insertNull){void 0===tileWidth&&(tileWidth=32),void 0===tileHeight&&(tileHeight=32),void 0===width&&(width=10),void 0===height&&(height=10),void 0===insertNull&&(insertNull=!1);var mapData=null;return Array.isArray(tilemapData)?mapData=Parse(void 0!==key?key:"map",Formats.ARRAY_2D,tilemapData,tileWidth,tileHeight,insertNull):void 0!==key&&((tilemapData=scene.cache.tilemap.get(key))?mapData=Parse(key,tilemapData.format,tilemapData.data,tileWidth,tileHeight,insertNull):console.warn("No map data found for key "+key)),null===mapData&&(mapData=new MapData({tileWidth:tileWidth,tileHeight:tileHeight,width:width,height:height})),new Tilemap(scene,mapData)},ParseToTilemap$1=TweenData_1;TweenManager.register("tilemap",function(c){c=void 0!==c?c:{};return ParseToTilemap$1(this.scene,c.key,c.tileWidth,c.tileHeight,c.width,c.height,c.data,c.insertNull)});var ParseToTilemap=TweenData_1;Tween_1.register("tilemap",function(key,tileWidth,tileHeight,width,height,data,insertNull){return ParseToTilemap(this.scene,key=null===key?void 0:key,tileWidth=null===tileWidth?void 0:tileWidth,tileHeight=null===tileHeight?void 0:tileHeight,width=null===width?void 0:width,height=null===height?void 0:height,data,insertNull)});var tilemaps=Extend_1$1(!1,{Components:components,Parsers:parsers,Formats:tilemaps,ImageCollection:NumberTweenBuilder_1,ParseToTilemap:TweenData_1,Tile:StaggerBuilder_1,Tilemap:time,TilemapCreator:{},TilemapFactory:{},Tileset:GetNewValue_1,TilemapLayer:GetProps_1,Orientation:GetTargets_1,LayerData:GetTweens_1,MapData:builders,ObjectLayer:TimelineBuilder_1},events.ORIENTATION),GetFastValue=GetFastValue_1,NumberTweenBuilder_1=new Class_1({initialize:function(config){this.delay=0,this.repeat=0,this.repeatCount=0,this.loop=!1,this.callback,this.callbackScope,this.args,this.timeScale=1,this.startAt=0,this.elapsed=0,this.paused=!1,this.hasDispatched=!1,this.reset(config)},reset:function(config){return this.delay=GetFastValue(config,"delay",0),this.repeat=GetFastValue(config,"repeat",0),this.loop=GetFastValue(config,"loop",!1),this.callback=GetFastValue(config,"callback",void 0),this.callbackScope=GetFastValue(config,"callbackScope",this.callback),this.args=GetFastValue(config,"args",[]),this.timeScale=GetFastValue(config,"timeScale",1),this.startAt=GetFastValue(config,"startAt",0),this.paused=GetFastValue(config,"paused",!1),this.elapsed=this.startAt,this.hasDispatched=!1,this.repeatCount=-1===this.repeat||this.loop?999999999999:this.repeat,this},getProgress:function(){return this.elapsed/this.delay},getOverallProgress:function(){if(0<this.repeat){var totalDuration=this.delay+this.delay*this.repeat;return(this.elapsed+this.delay*(this.repeat-this.repeatCount))/totalDuration}return this.getProgress()},getRepeatCount:function(){return this.repeatCount},getElapsed:function(){return this.elapsed},getElapsedSeconds:function(){return.001*this.elapsed},getRemaining:function(){return this.delay-this.elapsed},getRemainingSeconds:function(){return.001*this.getRemaining()},getOverallRemaining:function(){return this.delay*(1+this.repeatCount)-this.elapsed},getOverallRemainingSeconds:function(){return.001*this.getOverallRemaining()},remove:function(dispatchCallback){void 0===dispatchCallback&&(dispatchCallback=!1),this.elapsed=this.delay,this.hasDispatched=!dispatchCallback,this.repeatCount=0},destroy:function(){this.callback=void 0,this.callbackScope=void 0,this.args=[]}}),TweenData_1=PluginCache,SceneEvents$1=events$g,TimerEvent=NumberTweenBuilder_1,Remove=Remove_1,StaggerBuilder_1=new Class_1({initialize:function(scene){this.scene=scene,this.systems=scene.sys,this.now=0,this.timeScale=1,this.paused=!1,this._active=[],this._pendingInsertion=[],this._pendingRemoval=[],scene.sys.events.once(SceneEvents$1.BOOT,this.boot,this),scene.sys.events.on(SceneEvents$1.START,this.start,this)},boot:function(){this.now=this.systems.game.loop.time,this.systems.events.once(SceneEvents$1.DESTROY,this.destroy,this)},start:function(){var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents$1.PRE_UPDATE,this.preUpdate,this),eventEmitter.on(SceneEvents$1.UPDATE,this.update,this),eventEmitter.once(SceneEvents$1.SHUTDOWN,this.shutdown,this)},addEvent:function(config){var event;return config instanceof TimerEvent?(this.removeEvent(event=config),event.elapsed=event.startAt,event.hasDispatched=!1,event.repeatCount=-1===event.repeat||event.loop?999999999999:event.repeat):event=new TimerEvent(config),this._pendingInsertion.push(event),event},delayedCall:function(delay,callback,args,callbackScope){return this.addEvent({delay:delay,callback:callback,args:args,callbackScope:callbackScope})},clearPendingEvents:function(){return this._pendingInsertion=[],this},removeEvent:function(events){Array.isArray(events)||(events=[events]);for(var i=0;i<events.length;i++){var event=events[i];Remove(this._pendingRemoval,event),Remove(this._pendingInsertion,event),Remove(this._active,event)}return this},removeAllEvents:function(){return this._pendingRemoval=this._pendingRemoval.concat(this._active),this},preUpdate:function(){var toRemove=this._pendingRemoval.length,toInsert=this._pendingInsertion.length;if(0!==toRemove||0!==toInsert){for(var i=0;i<toRemove;i++){var event=this._pendingRemoval[i],index=this._active.indexOf(event);-1<index&&this._active.splice(index,1),event.destroy()}for(i=0;i<toInsert;i++)event=this._pendingInsertion[i],this._active.push(event);this._pendingRemoval.length=0,this._pendingInsertion.length=0}},update:function(time,delta){if(this.now=time,!this.paused){delta*=this.timeScale;for(var i=0;i<this._active.length;i++){var remainder,event=this._active[i];event.paused||(event.elapsed+=delta*event.timeScale,event.elapsed>=event.delay&&(remainder=event.elapsed-event.delay,event.elapsed=event.delay,!event.hasDispatched&&event.callback&&(event.hasDispatched=!0,event.callback.apply(event.callbackScope,event.args)),0<event.repeatCount?(event.repeatCount--,event.elapsed=remainder,event.hasDispatched=!1):this._pendingRemoval.push(event)))}}},shutdown:function(){for(var i=0;i<this._pendingInsertion.length;i++)this._pendingInsertion[i].destroy();for(i=0;i<this._active.length;i++)this._active[i].destroy();for(i=0;i<this._pendingRemoval.length;i++)this._pendingRemoval[i].destroy();this._active.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0;var eventEmitter=this.systems.events;eventEmitter.off(SceneEvents$1.PRE_UPDATE,this.preUpdate,this),eventEmitter.off(SceneEvents$1.UPDATE,this.update,this),eventEmitter.off(SceneEvents$1.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(SceneEvents$1.START,this.start,this),this.scene=null,this.systems=null}});TweenData_1.register("Clock",StaggerBuilder_1,"time");var time={Clock:StaggerBuilder_1,TimerEvent:NumberTweenBuilder_1},GetNewValue_1=function(source,key,defaultValue){return source.hasOwnProperty(key)?"function"==typeof source[key]?function(target,targetKey,value,targetIndex,totalTargets,tween){return source[key](target,targetKey,value,targetIndex,totalTargets,tween)}:function(){return source[key]}:"function"==typeof defaultValue?defaultValue:function(){return defaultValue}},RESERVED=["callbackScope","completeDelay","delay","duration","ease","easeParams","flipX","flipY","hold","loop","loopDelay","offset","onActive","onActiveParams","onActiveScope","onComplete","onCompleteParams","onCompleteScope","onLoop","onLoopParams","onLoopScope","onRepeat","onRepeatParams","onRepeatScope","onStart","onStartParams","onStartScope","onStop","onStopParams","onStopScope","onUpdate","onUpdateParams","onUpdateScope","onYoyo","onYoyoParams","onYoyoScope","paused","props","repeat","repeatDelay","targets","useFrames","yoyo"],GetProps_1=function(config){var key,keys=[];if(config.hasOwnProperty("props"))for(key in config.props)"_"!==key.substr(0,1)&&keys.push({key:key,value:config.props[key]});else for(key in config)-1===RESERVED.indexOf(key)&&"_"!==key.substr(0,1)&&keys.push({key:key,value:config[key]});return keys},GetValue$6=GetValue_1,GetTargets_1=function(targets){targets=GetValue$6(targets,"targets",null);return null===targets?targets:("function"==typeof targets&&(targets=targets.call()),Array.isArray(targets)?targets:[targets])},GetValue$5=GetValue_1,GetTweens_1=function(tweens){tweens=GetValue$5(tweens,"tweens",null);return null===tweens?[]:("function"==typeof tweens&&(tweens=tweens.call()),Array.isArray(tweens)?tweens:[tweens])};function hasGetActive(def){return!!def.getActive&&"function"==typeof def.getActive}function hasGetStart(def){return!!def.getStart&&"function"==typeof def.getStart}function hasGetEnd(def){return!!def.getEnd&&"function"==typeof def.getEnd}var GetValueOp$2=function(fromCallbacks,propertyValue){var callbacks,startCallbacks,getEnd=function(target,key,value){return value},getStart=function(target,key,value){return value},getActive=null,hasFrom=typeof propertyValue;if("number"==hasFrom)getEnd=function(){return propertyValue};else if("string"==hasFrom){var hasTo=propertyValue[0],num=parseFloat(propertyValue.substr(2));switch(hasTo){case"+":getEnd=function(target,key,value){return value+num};break;case"-":getEnd=function(target,key,value){return value-num};break;case"*":getEnd=function(target,key,value){return value*num};break;case"/":getEnd=function(target,key,value){return value/num};break;default:getEnd=function(){return parseFloat(propertyValue)}}}else"function"==hasFrom?getEnd=propertyValue:"object"==hasFrom&&(hasGetStart(startCallbacks=propertyValue)||hasGetEnd(startCallbacks)||hasGetActive(startCallbacks)?(hasGetActive(propertyValue)&&(getActive=propertyValue.getActive),hasGetEnd(propertyValue)&&(getEnd=propertyValue.getEnd),hasGetStart(propertyValue)&&(getStart=propertyValue.getStart)):propertyValue.hasOwnProperty("value")?callbacks=GetValueOp$2(fromCallbacks,propertyValue.value):(hasTo=propertyValue.hasOwnProperty("to"),hasFrom=propertyValue.hasOwnProperty("from"),startCallbacks=propertyValue.hasOwnProperty("start"),hasTo&&(hasFrom||startCallbacks)&&(callbacks=GetValueOp$2(fromCallbacks,propertyValue.to),startCallbacks&&(startCallbacks=GetValueOp$2(fromCallbacks,propertyValue.start),callbacks.getActive=startCallbacks.getEnd),hasFrom&&(fromCallbacks=GetValueOp$2(fromCallbacks,propertyValue.from),callbacks.getStart=fromCallbacks.getEnd))));return callbacks=callbacks||{getActive:getActive,getEnd:getEnd,getStart:getStart}},builders=GetValueOp$2,TimelineBuilder_1={targets:null,delay:0,duration:1e3,ease:"Power0",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!1,flipX:!1,flipY:!1},events={TIMELINE_COMPLETE:"complete",TIMELINE_LOOP:"loop",TIMELINE_PAUSE:"pause",TIMELINE_RESUME:"resume",TIMELINE_START:"start",TIMELINE_UPDATE:"update",TWEEN_ACTIVE:"active",TWEEN_COMPLETE:"complete",TWEEN_LOOP:"loop",TWEEN_REPEAT:"repeat",TWEEN_START:"start",TWEEN_STOP:"stop",TWEEN_UPDATE:"update",TWEEN_YOYO:"yoyo"},TweenData_1=Class_1,EventEmitter$1=eventemitter3.exports,Events$1=events,StaggerBuilder_1=TweenManager,NumberTweenBuilder_1=Tween_1,TWEEN_CONST$2=_const$a,MATH_CONST$1=Tweens,TweenManager=new TweenData_1({Extends:EventEmitter$1,initialize:function(parent,data,targets){EventEmitter$1.call(this),this.parent=parent,this.parentIsTimeline=parent.hasOwnProperty("isTimeline"),this.data=data,this.totalData=data.length,this.targets=targets,this.totalTargets=targets.length,this.useFrames=!1,this.timeScale=1,this.loop=0,this.loopDelay=0,this.loopCounter=0,this.startDelay=0,this.hasStarted=!1,this.isSeeking=!1,this.completeDelay=0,this.countdown=0,this.offset=0,this.calculatedOffset=0,this.state=TWEEN_CONST$2.PENDING_ADD,this._pausedState=TWEEN_CONST$2.INIT,this.paused=!1,this.elapsed=0,this.totalElapsed=0,this.duration=0,this.progress=0,this.totalDuration=0,this.totalProgress=0,this.callbacks={onActive:null,onComplete:null,onLoop:null,onRepeat:null,onStart:null,onStop:null,onUpdate:null,onYoyo:null},this.callbackScope},getValue:function(index){return this.data[index=void 0===index?0:index].current},setTimeScale:function(value){return this.timeScale=value,this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return this.state===TWEEN_CONST$2.ACTIVE},isPaused:function(){return this.state===TWEEN_CONST$2.PAUSED},hasTarget:function(target){return-1!==this.targets.indexOf(target)},updateTo:function(key,value,startToCurrent){void 0===startToCurrent&&(startToCurrent=!1);for(var i=0;i<this.totalData;i++){var tweenData=this.data[i];tweenData.key===key&&(tweenData.end=value,startToCurrent&&(tweenData.start=tweenData.current))}return this},restart:function(){return this.elapsed=0,this.progress=0,this.totalElapsed=0,this.totalProgress=0,this.state===TWEEN_CONST$2.ACTIVE?this.seek(0):this.state===TWEEN_CONST$2.REMOVED?(this.seek(0),this.parent.makeActive(this),this):this.state===TWEEN_CONST$2.PENDING_ADD?this:this.play()},calcDuration:function(){for(var maxDuration=0,minDelay=MATH_CONST$1.MAX_SAFE_INTEGER,data=this.data,i=0;i<this.totalData;i++){var tweenData=data[i];tweenData.t1=tweenData.duration+tweenData.hold,tweenData.yoyo&&(tweenData.t1+=tweenData.duration),tweenData.t2=tweenData.t1+tweenData.repeatDelay,tweenData.totalDuration=tweenData.delay+tweenData.t1,-1===tweenData.repeat?tweenData.totalDuration+=999999999999*tweenData.t2:0<tweenData.repeat&&(tweenData.totalDuration+=tweenData.t2*tweenData.repeat),tweenData.totalDuration>maxDuration&&(maxDuration=tweenData.totalDuration),tweenData.delay<minDelay&&(minDelay=tweenData.delay)}this.duration=Math.max(maxDuration,.001),this.loopCounter=-1===this.loop?999999999999:this.loop,0<this.loopCounter?this.totalDuration=this.duration+this.completeDelay+(this.duration+this.loopDelay)*this.loopCounter:this.totalDuration=this.duration+this.completeDelay,this.startDelay=minDelay},init:function(){if(this.paused&&!this.parentIsTimeline)return this.state=TWEEN_CONST$2.PENDING_ADD,this._pausedState=TWEEN_CONST$2.INIT,!1;for(var data=this.data,totalTargets=this.totalTargets,i=0;i<this.totalData;i++){var tweenData=data[i],target=tweenData.target,gen=tweenData.gen,key=tweenData.key,targetIndex=tweenData.index;tweenData.delay=gen.delay(target,key,0,targetIndex,totalTargets,this),tweenData.duration=Math.max(gen.duration(target,key,0,targetIndex,totalTargets,this),.001),tweenData.hold=gen.hold(target,key,0,targetIndex,totalTargets,this),tweenData.repeat=gen.repeat(target,key,0,targetIndex,totalTargets,this),tweenData.repeatDelay=gen.repeatDelay(target,key,0,targetIndex,totalTargets,this)}return this.calcDuration(),this.progress=0,this.totalProgress=0,this.elapsed=0,this.totalElapsed=0,this.state=TWEEN_CONST$2.INIT,!0},makeActive:function(){this.parent.makeActive(this),this.dispatchTweenEvent(Events$1.TWEEN_ACTIVE,this.callbacks.onActive)},nextState:function(){0<this.loopCounter?(this.elapsed=0,this.progress=0,this.loopCounter--,this.resetTweenData(!0),0<this.loopDelay?(this.countdown=this.loopDelay,this.state=TWEEN_CONST$2.LOOP_DELAY):(this.state=TWEEN_CONST$2.ACTIVE,this.dispatchTweenEvent(Events$1.TWEEN_LOOP,this.callbacks.onLoop))):0<this.completeDelay?(this.state=TWEEN_CONST$2.COMPLETE_DELAY,this.countdown=this.completeDelay):(this.state=TWEEN_CONST$2.PENDING_REMOVE,this.dispatchTweenEvent(Events$1.TWEEN_COMPLETE,this.callbacks.onComplete))},pause:function(){return this.state===TWEEN_CONST$2.PAUSED||(this.paused=!0,this._pausedState=this.state,this.state=TWEEN_CONST$2.PAUSED),this},play:function(resetFromTimeline){void 0===resetFromTimeline&&(resetFromTimeline=!1);var state=this.state;return state!==TWEEN_CONST$2.INIT||this.parentIsTimeline?state===TWEEN_CONST$2.ACTIVE||state===TWEEN_CONST$2.PENDING_ADD&&this._pausedState===TWEEN_CONST$2.PENDING_ADD||(this.parentIsTimeline||state!==TWEEN_CONST$2.PENDING_REMOVE&&state!==TWEEN_CONST$2.REMOVED?this.parentIsTimeline?(this.resetTweenData(resetFromTimeline),0===this.calculatedOffset?this.state=TWEEN_CONST$2.ACTIVE:(this.countdown=this.calculatedOffset,this.state=TWEEN_CONST$2.OFFSET_DELAY)):(this.paused?this.paused=!1:(this.resetTweenData(resetFromTimeline),this.state=TWEEN_CONST$2.ACTIVE),this.makeActive()):(this.seek(0),this.parent.makeActive(this))):(this.resetTweenData(!1),this.state=TWEEN_CONST$2.ACTIVE),this},resetTweenData:function(resetFromLoop){for(var data=this.data,total=this.totalData,totalTargets=this.totalTargets,i=0;i<total;i++){var tweenData=data[i],target=tweenData.target,key=tweenData.key,targetIndex=tweenData.index;tweenData.progress=0,tweenData.elapsed=0,tweenData.repeatCounter=-1===tweenData.repeat?999999999999:tweenData.repeat,resetFromLoop?(tweenData.start=tweenData.getStartValue(target,key,tweenData.start,targetIndex,totalTargets,this),tweenData.end=tweenData.getEndValue(target,key,tweenData.end,targetIndex,totalTargets,this),tweenData.current=tweenData.start,tweenData.state=TWEEN_CONST$2.PLAYING_FORWARD):tweenData.state=TWEEN_CONST$2.PENDING_RENDER,0<tweenData.delay&&(tweenData.elapsed=tweenData.delay,tweenData.state=TWEEN_CONST$2.DELAY),tweenData.getActiveValue&&(target[key]=tweenData.getActiveValue(tweenData.target,tweenData.key,tweenData.start))}},resume:function(){return this.state===TWEEN_CONST$2.PAUSED?(this.paused=!1,this.state=this._pausedState):this.play(),this},seek:function(toPosition,delta){void 0===delta&&(delta=16.6),this.state===TWEEN_CONST$2.REMOVED&&this.makeActive(),this.elapsed=0,this.progress=0,this.totalElapsed=0,this.totalProgress=0;for(var data=this.data,totalTargets=this.totalTargets,i=0;i<this.totalData;i++){var tweenData=data[i],target=tweenData.target,gen=tweenData.gen,key=tweenData.key,targetIndex=tweenData.index;tweenData.progress=0,tweenData.elapsed=0,tweenData.repeatCounter=-1===tweenData.repeat?999999999999:tweenData.repeat,tweenData.delay=gen.delay(target,key,0,targetIndex,totalTargets,this),tweenData.duration=Math.max(gen.duration(target,key,0,targetIndex,totalTargets,this),.001),tweenData.hold=gen.hold(target,key,0,targetIndex,totalTargets,this),tweenData.repeat=gen.repeat(target,key,0,targetIndex,totalTargets,this),tweenData.repeatDelay=gen.repeatDelay(target,key,0,targetIndex,totalTargets,this),tweenData.current=tweenData.start,tweenData.state=TWEEN_CONST$2.PLAYING_FORWARD,this.updateTweenData(this,tweenData,0,targetIndex,totalTargets),0<tweenData.delay&&(tweenData.elapsed=tweenData.delay,tweenData.state=TWEEN_CONST$2.DELAY)}this.calcDuration();var wasPaused=!1;for(this.state===TWEEN_CONST$2.PAUSED&&(wasPaused=!0,this.state=TWEEN_CONST$2.ACTIVE),this.isSeeking=!0;this.update(0,delta),this.totalProgress<toPosition;);return this.isSeeking=!1,wasPaused&&(this.state=TWEEN_CONST$2.PAUSED),this},setCallback:function(type,callback,params,scope){return this.callbacks[type]={func:callback,scope:scope,params:params},this},complete:function(delay){return(delay=void 0===delay?0:delay)?(this.state=TWEEN_CONST$2.COMPLETE_DELAY,this.countdown=delay):(this.state=TWEEN_CONST$2.PENDING_REMOVE,this.dispatchTweenEvent(Events$1.TWEEN_COMPLETE,this.callbacks.onComplete)),this},remove:function(){return this.parent.remove(this),this},stop:function(resetTo){return this.state===TWEEN_CONST$2.ACTIVE&&void 0!==resetTo&&this.seek(resetTo),this.state!==TWEEN_CONST$2.REMOVED&&(this.state!==TWEEN_CONST$2.PAUSED&&this.state!==TWEEN_CONST$2.PENDING_ADD||(this.parentIsTimeline?(this.parent.manager._destroy.push(this),this.parent.manager._toProcess++):(this.parent._destroy.push(this),this.parent._toProcess++)),this.dispatchTweenEvent(Events$1.TWEEN_STOP,this.callbacks.onStop),this.removeAllListeners(),this.state=TWEEN_CONST$2.PENDING_REMOVE),this},update:function(timestamp,delta){if(this.state===TWEEN_CONST$2.PAUSED)return!1;switch(this.useFrames&&(delta=+this.parent.timeScale),delta*=this.timeScale,this.elapsed+=delta,this.progress=Math.min(this.elapsed/this.duration,1),this.totalElapsed+=delta,this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1),this.state){case TWEEN_CONST$2.ACTIVE:this.hasStarted||this.isSeeking||(this.startDelay-=delta,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchTweenEvent(Events$1.TWEEN_START,this.callbacks.onStart)));for(var stillRunning=!1,i=0;i<this.totalData;i++){var tweenData=this.data[i];this.updateTweenData(this,tweenData,delta)&&(stillRunning=!0)}stillRunning||this.nextState();break;case TWEEN_CONST$2.LOOP_DELAY:this.countdown-=delta,this.countdown<=0&&(this.state=TWEEN_CONST$2.ACTIVE,this.dispatchTweenEvent(Events$1.TWEEN_LOOP,this.callbacks.onLoop));break;case TWEEN_CONST$2.OFFSET_DELAY:this.countdown-=delta,this.countdown<=0&&(this.state=TWEEN_CONST$2.ACTIVE);break;case TWEEN_CONST$2.COMPLETE_DELAY:this.countdown-=delta,this.countdown<=0&&(this.state=TWEEN_CONST$2.PENDING_REMOVE,this.dispatchTweenEvent(Events$1.TWEEN_COMPLETE,this.callbacks.onComplete))}return this.state===TWEEN_CONST$2.PENDING_REMOVE},dispatchTweenDataEvent:function(event,callback,tweenData){this.isSeeking||(this.emit(event,this,tweenData.key,tweenData.target,tweenData.current,tweenData.previous),callback&&(callback.params[1]=tweenData.target,callback.func.apply(callback.scope,callback.params)))},dispatchTweenEvent:function(event,callback){this.isSeeking||(this.emit(event,this,this.targets),callback&&(callback.params[1]=this.targets,callback.func.apply(callback.scope,callback.params)))},setStateFromEnd:function(tween,tweenData,diff){return tweenData.yoyo?(tweenData.elapsed=diff,tweenData.progress=diff/tweenData.duration,tweenData.flipX&&tweenData.target.toggleFlipX(),tweenData.flipY&&tweenData.target.toggleFlipY(),this.dispatchTweenDataEvent(Events$1.TWEEN_YOYO,tween.callbacks.onYoyo,tweenData),tweenData.start=tweenData.getStartValue(tweenData.target,tweenData.key,tweenData.start,tweenData.index,tween.totalTargets,tween),TWEEN_CONST$2.PLAYING_BACKWARD):0<tweenData.repeatCounter?(tweenData.repeatCounter--,tweenData.elapsed=diff,tweenData.progress=diff/tweenData.duration,tweenData.flipX&&tweenData.target.toggleFlipX(),tweenData.flipY&&tweenData.target.toggleFlipY(),tweenData.start=tweenData.getStartValue(tweenData.target,tweenData.key,tweenData.start,tweenData.index,tween.totalTargets,tween),tweenData.end=tweenData.getEndValue(tweenData.target,tweenData.key,tweenData.start,tweenData.index,tween.totalTargets,tween),0<tweenData.repeatDelay?(tweenData.elapsed=tweenData.repeatDelay-diff,tweenData.current=tweenData.start,tweenData.target[tweenData.key]=tweenData.current,TWEEN_CONST$2.REPEAT_DELAY):(this.dispatchTweenDataEvent(Events$1.TWEEN_REPEAT,tween.callbacks.onRepeat,tweenData),TWEEN_CONST$2.PLAYING_FORWARD)):TWEEN_CONST$2.COMPLETE},setStateFromStart:function(tween,tweenData,diff){return 0<tweenData.repeatCounter?(tweenData.repeatCounter--,tweenData.elapsed=diff,tweenData.progress=diff/tweenData.duration,tweenData.flipX&&tweenData.target.toggleFlipX(),tweenData.flipY&&tweenData.target.toggleFlipY(),tweenData.end=tweenData.getEndValue(tweenData.target,tweenData.key,tweenData.start,tweenData.index,tween.totalTargets,tween),0<tweenData.repeatDelay?(tweenData.elapsed=tweenData.repeatDelay-diff,tweenData.current=tweenData.start,tweenData.target[tweenData.key]=tweenData.current,TWEEN_CONST$2.REPEAT_DELAY):(this.dispatchTweenDataEvent(Events$1.TWEEN_REPEAT,tween.callbacks.onRepeat,tweenData),TWEEN_CONST$2.PLAYING_FORWARD)):TWEEN_CONST$2.COMPLETE},updateTweenData:function(tween,tweenData,delta){var target=tweenData.target;switch(tweenData.state){case TWEEN_CONST$2.PLAYING_FORWARD:case TWEEN_CONST$2.PLAYING_BACKWARD:if(!target){tweenData.state=TWEEN_CONST$2.COMPLETE;break}var elapsed=tweenData.elapsed,v=tweenData.duration,diff=0;v<(elapsed+=delta)&&(diff=elapsed-v,elapsed=v);var forward=tweenData.state===TWEEN_CONST$2.PLAYING_FORWARD,v=elapsed/v;tweenData.elapsed=elapsed,tweenData.progress=v,tweenData.previous=tweenData.current,1==v?forward?(tweenData.current=tweenData.end,target[tweenData.key]=tweenData.end,0<tweenData.hold?(tweenData.elapsed=tweenData.hold-diff,tweenData.state=TWEEN_CONST$2.HOLD_DELAY):tweenData.state=this.setStateFromEnd(tween,tweenData,diff)):(tweenData.current=tweenData.start,target[tweenData.key]=tweenData.start,tweenData.state=this.setStateFromStart(tween,tweenData,diff)):(v=forward?tweenData.ease(v):tweenData.ease(1-v),tweenData.current=tweenData.start+(tweenData.end-tweenData.start)*v,target[tweenData.key]=tweenData.current),this.dispatchTweenDataEvent(Events$1.TWEEN_UPDATE,tween.callbacks.onUpdate,tweenData);break;case TWEEN_CONST$2.DELAY:tweenData.elapsed-=delta,tweenData.elapsed<=0&&(tweenData.elapsed=Math.abs(tweenData.elapsed),tweenData.state=TWEEN_CONST$2.PENDING_RENDER);break;case TWEEN_CONST$2.REPEAT_DELAY:tweenData.elapsed-=delta,tweenData.elapsed<=0&&(tweenData.elapsed=Math.abs(tweenData.elapsed),tweenData.state=TWEEN_CONST$2.PLAYING_FORWARD,this.dispatchTweenDataEvent(Events$1.TWEEN_REPEAT,tween.callbacks.onRepeat,tweenData));break;case TWEEN_CONST$2.HOLD_DELAY:tweenData.elapsed-=delta,tweenData.elapsed<=0&&(tweenData.state=this.setStateFromEnd(tween,tweenData,Math.abs(tweenData.elapsed)));break;case TWEEN_CONST$2.PENDING_RENDER:target?(tweenData.start=tweenData.getStartValue(target,tweenData.key,target[tweenData.key],tweenData.index,tween.totalTargets,tween),tweenData.end=tweenData.getEndValue(target,tweenData.key,tweenData.start,tweenData.index,tween.totalTargets,tween),tweenData.current=tweenData.start,target[tweenData.key]=tweenData.start,tweenData.state=TWEEN_CONST$2.PLAYING_FORWARD):tweenData.state=TWEEN_CONST$2.COMPLETE}return tweenData.state!==TWEEN_CONST$2.COMPLETE}});TweenManager.TYPES=["onActive","onComplete","onLoop","onRepeat","onStart","onStop","onUpdate","onYoyo"],NumberTweenBuilder_1.register("tween",function(config){return this.scene.sys.tweens.add(config)}),StaggerBuilder_1.register("tween",function(config){return this.scene.sys.tweens.create(config)});var Tween_1=TweenManager,TweenData_1=function(target,index,key,getEnd,getStart,getActive,ease,delay,duration,yoyo,hold,repeat,repeatDelay,flipX,flipY){return{target:target,index:index,key:key,getActiveValue:getActive,getEndValue:getEnd,getStartValue:getStart,ease:ease,duration:0,totalDuration:0,delay:0,yoyo:yoyo,hold:0,repeat:0,repeatDelay:0,flipX:flipX,flipY:flipY,progress:0,elapsed:0,repeatCounter:0,start:0,previous:0,current:0,end:0,t1:0,t2:0,gen:{delay:delay,duration:duration,hold:hold,repeat:repeat,repeatDelay:repeatDelay},state:0}},Defaults$2=TimelineBuilder_1,GetAdvancedValue$2=GetAdvancedValue_1,GetBoolean$2=GetBoolean_1,GetEaseFunction$3=GetEaseFunction_1,GetNewValue$2=GetNewValue_1,GetValue$4=GetValue_1,GetValueOp$1=builders,Tween$1=Tween_1,TweenData$1=TweenData_1,NumberTweenBuilder_1=function(parent,config,ops){void 0===ops&&(ops=Defaults$2);var from=GetValue$4(config,"from",0),to=GetValue$4(config,"to",1),targets=[{value:from}],delay=GetNewValue$2(config,"delay",ops.delay),duration=GetNewValue$2(config,"duration",ops.duration),data=GetValue$4(config,"easeParams",ops.easeParams),ease=GetEaseFunction$3(GetValue$4(config,"ease",ops.ease),data),hold=GetNewValue$2(config,"hold",ops.hold),repeat=GetNewValue$2(config,"repeat",ops.repeat),tweenData=GetNewValue$2(config,"repeatDelay",ops.repeatDelay),yoyo=GetBoolean$2(config,"yoyo",ops.yoyo),data=[],ops=GetValueOp$1("value",to),tweenData=TweenData$1(targets[0],0,"value",ops.getEnd,ops.getStart,ops.getActive,ease,delay,duration,yoyo,hold,repeat,tweenData,!1,!1);tweenData.start=from,tweenData.current=from,tweenData.to=to,data.push(tweenData);var tween=new Tween$1(parent,data,targets);tween.offset=GetAdvancedValue$2(config,"offset",null),tween.completeDelay=GetAdvancedValue$2(config,"completeDelay",0),tween.loop=Math.round(GetAdvancedValue$2(config,"loop",0)),tween.loopDelay=Math.round(GetAdvancedValue$2(config,"loopDelay",0)),tween.paused=GetBoolean$2(config,"paused",!1),tween.useFrames=GetBoolean$2(config,"useFrames",!1);for(var scope=GetValue$4(config,"callbackScope",tween),tweenArray=[tween,null],callbacks=Tween$1.TYPES,i=0;i<callbacks.length;i++){var callbackScope,callbackParams,type=callbacks[i],callback=GetValue$4(config,type,!1);callback&&(callbackScope=GetValue$4(config,type+"Scope",scope),callbackParams=GetValue$4(config,type+"Params",[]),tween.setCallback(type,callback,tweenArray.concat(callbackParams),callbackScope))}return tween},GetEaseFunction$2=GetEaseFunction_1,GetValue$3=GetValue_1,MATH_CONST=Tweens,StaggerBuilder_1=function(value,options){var start=GetValue$3(options=void 0===options?{}:options,"start",0),ease=GetValue$3(options,"ease",null),grid=GetValue$3(options,"grid",null),from=GetValue$3(options,"from",0),fromFirst="first"===from,fromCenter="center"===from,fromLast="last"===from,fromValue="number"==typeof from,isRange=Array.isArray(value),value1=isRange?parseFloat(value[0]):parseFloat(value),value2=isRange?parseFloat(value[1]):0,maxValue=Math.max(value1,value2);if(isRange&&(start+=value1),grid){var gridWidth=grid[0],gridHeight=grid[1],fromX=0,fromY=0,gridValues=[];fromLast?(fromX=gridWidth-1,fromY=gridHeight-1):fromValue?(fromX=from%gridWidth,fromY=Math.floor(from/gridWidth)):fromCenter&&(fromX=(gridWidth-1)/2,fromY=(gridHeight-1)/2);for(var gridMax=MATH_CONST.MIN_SAFE_INTEGER,toY=0;toY<gridHeight;toY++){gridValues[toY]=[];for(var toX=0;toX<gridWidth;toX++){var distanceX=fromX-toX,distanceY=fromY-toY,dist=Math.sqrt(distanceX*distanceX+distanceY*distanceY);gridMax<dist&&(gridMax=dist),gridValues[toY][toX]=dist}}}var easeFunction=ease?GetEaseFunction$2(ease):null;return grid?function(target,key,value,toY){var gridSpace=0,diff=toY%gridWidth,toY=Math.floor(toY/gridWidth);return 0<=diff&&diff<gridWidth&&0<=toY&&toY<gridHeight&&(gridSpace=gridValues[toY][diff]),(isRange?(diff=value2-value1,easeFunction?gridSpace/gridMax*diff*easeFunction(gridSpace/gridMax):gridSpace/gridMax*diff):easeFunction?gridSpace*value1*easeFunction(gridSpace/gridMax):gridSpace*value1)+start}:function(target,key,value,spacing,total){var fromIndex;return total--,fromFirst?fromIndex=spacing:fromCenter?fromIndex=Math.abs(total/2-spacing):fromLast?fromIndex=total-spacing:fromValue&&(fromIndex=Math.abs(from-spacing)),(isRange?(spacing=fromCenter?(value2-value1)/total*(2*fromIndex):(value2-value1)/total*fromIndex,easeFunction?spacing*easeFunction(fromIndex/total):spacing):easeFunction?total*maxValue*easeFunction(fromIndex/total):fromIndex*value1)+start}},Defaults$1=TimelineBuilder_1,GetAdvancedValue$1=GetAdvancedValue_1,GetBoolean$1=GetBoolean_1,GetEaseFunction$1=GetEaseFunction_1,GetNewValue$1=GetNewValue_1,GetProps=GetProps_1,GetTargets$1=GetTargets_1,GetValue$2=GetValue_1,GetValueOp=builders,Tween=Tween_1,TweenData=TweenData_1,TweenManager=function(parent,config,defaults){for(var targets=(defaults=void 0===defaults?Defaults$1:defaults).targets||GetTargets$1(config),props=GetProps(config),delay=GetNewValue$1(config,"delay",defaults.delay),duration=GetNewValue$1(config,"duration",defaults.duration),easeParams=GetValue$2(config,"easeParams",defaults.easeParams),ease=GetEaseFunction$1(GetValue$2(config,"ease",defaults.ease),easeParams),hold=GetNewValue$1(config,"hold",defaults.hold),repeat=GetNewValue$1(config,"repeat",defaults.repeat),repeatDelay=GetNewValue$1(config,"repeatDelay",defaults.repeatDelay),yoyo=GetBoolean$1(config,"yoyo",defaults.yoyo),flipX=GetBoolean$1(config,"flipX",defaults.flipX),flipY=GetBoolean$1(config,"flipY",defaults.flipY),data=[],p=0;p<props.length;p++)for(var key=props[p].key,value=props[p].value,t=0;t<targets.length;t++){var tweenData=GetValueOp(key,value),tweenData=TweenData(targets[t],t,key,tweenData.getEnd,tweenData.getStart,tweenData.getActive,GetEaseFunction$1(GetValue$2(value,"ease",ease),GetValue$2(value,"easeParams",easeParams)),GetNewValue$1(value,"delay",delay),GetNewValue$1(value,"duration",duration),GetBoolean$1(value,"yoyo",yoyo),GetNewValue$1(value,"hold",hold),GetNewValue$1(value,"repeat",repeat),GetNewValue$1(value,"repeatDelay",repeatDelay),GetBoolean$1(value,"flipX",flipX),GetBoolean$1(value,"flipY",flipY));data.push(tweenData)}var tween=new Tween(parent,data,targets);tween.offset=GetAdvancedValue$1(config,"offset",null),tween.completeDelay=GetAdvancedValue$1(config,"completeDelay",0),tween.loop=Math.round(GetAdvancedValue$1(config,"loop",0)),tween.loopDelay=Math.round(GetAdvancedValue$1(config,"loopDelay",0)),tween.paused=GetBoolean$1(config,"paused",!1),tween.useFrames=GetBoolean$1(config,"useFrames",!1);for(var scope=GetValue$2(config,"callbackScope",tween),tweenArray=[tween,null],callbacks=Tween.TYPES,i=0;i<callbacks.length;i++){var callbackScope,callbackParams,type=callbacks[i],callback=GetValue$2(config,type,!1);callback&&(callbackScope=GetValue$2(config,type+"Scope",scope),callbackParams=GetValue$2(config,type+"Params",[]),tween.setCallback(type,callback,tweenArray.concat(callbackParams),callbackScope))}return tween},Tweens=Class_1,EventEmitter=eventemitter3.exports,Events=events,TweenBuilder$2=TweenManager,TWEEN_CONST$1=_const$a,Timeline$1=new Tweens({Extends:EventEmitter,initialize:function(manager){EventEmitter.call(this),this.manager=manager,this.isTimeline=!0,this.data=[],this.totalData=0,this.useFrames=!1,this.timeScale=1,this.loop=0,this.loopDelay=0,this.loopCounter=0,this.completeDelay=0,this.countdown=0,this.state=TWEEN_CONST$1.PENDING_ADD,this._pausedState=TWEEN_CONST$1.PENDING_ADD,this.paused=!1,this.elapsed=0,this.totalElapsed=0,this.duration=0,this.progress=0,this.totalDuration=0,this.totalProgress=0,this.callbacks={onComplete:null,onLoop:null,onStart:null,onUpdate:null,onYoyo:null},this.callbackScope},dispatchTimelineEvent:function(event,callback){this.emit(event,this),callback&&callback.func.apply(callback.scope,callback.params)},setTimeScale:function(value){return this.timeScale=value,this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return this.state===TWEEN_CONST$1.ACTIVE},add:function(config){return this.queue(TweenBuilder$2(this,config))},queue:function(tween){return this.isPlaying()||(tween.parent=this,tween.parentIsTimeline=!0,this.data.push(tween),this.totalData=this.data.length),this},hasOffset:function(tween){return null!==tween.offset},isOffsetAbsolute:function(value){return"number"==typeof value},isOffsetRelative:function(op){if("string"==typeof op){op=op[0];if("-"===op||"+"===op)return!0}return!1},getRelativeOffset:function(value,base){var op=value[0],num=parseFloat(value.substr(2)),result=base;switch(op){case"+":result+=num;break;case"-":result-=num}return Math.max(0,result)},calcDuration:function(){for(var prevEnd=0,totalDuration=0,offsetDuration=0,i=0;i<this.totalData;i++){var tween=this.data[i];tween.init(),this.hasOffset(tween)?this.isOffsetAbsolute(tween.offset)?(tween.calculatedOffset=tween.offset,0===tween.offset&&(offsetDuration=0)):this.isOffsetRelative(tween.offset)&&(tween.calculatedOffset=this.getRelativeOffset(tween.offset,prevEnd)):tween.calculatedOffset=offsetDuration,prevEnd=tween.totalDuration+tween.calculatedOffset,totalDuration+=tween.totalDuration,offsetDuration+=tween.totalDuration}this.duration=totalDuration,this.loopCounter=-1===this.loop?999999999999:this.loop,0<this.loopCounter?this.totalDuration=this.duration+this.completeDelay+(this.duration+this.loopDelay)*this.loopCounter:this.totalDuration=this.duration+this.completeDelay},init:function(){return this.calcDuration(),this.progress=0,this.totalProgress=0,!this.paused||(this.state=TWEEN_CONST$1.PAUSED,!1)},resetTweens:function(resetFromLoop){for(var i=0;i<this.totalData;i++)this.data[i].play(resetFromLoop)},setCallback:function(type,callback,params,scope){return-1!==Timeline$1.TYPES.indexOf(type)&&(this.callbacks[type]={func:callback,scope:scope,params:params}),this},makeActive:function(tween){return this.manager.makeActive(tween)},play:function(){if(this.state!==TWEEN_CONST$1.ACTIVE){if(this.paused)return this.paused=!1,void this.manager.makeActive(this);this.resetTweens(!1),this.state=TWEEN_CONST$1.ACTIVE,this.dispatchTimelineEvent(Events.TIMELINE_START,this.callbacks.onStart)}},nextState:function(){0<this.loopCounter?(this.elapsed=0,this.progress=0,this.loopCounter--,this.resetTweens(!0),0<this.loopDelay?(this.countdown=this.loopDelay,this.state=TWEEN_CONST$1.LOOP_DELAY):(this.state=TWEEN_CONST$1.ACTIVE,this.dispatchTimelineEvent(Events.TIMELINE_LOOP,this.callbacks.onLoop))):0<this.completeDelay?(this.state=TWEEN_CONST$1.COMPLETE_DELAY,this.countdown=this.completeDelay):(this.state=TWEEN_CONST$1.PENDING_REMOVE,this.dispatchTimelineEvent(Events.TIMELINE_COMPLETE,this.callbacks.onComplete))},update:function(timestamp,delta){if(this.state!==TWEEN_CONST$1.PAUSED){switch(this.useFrames&&(delta=+this.manager.timeScale),delta*=this.timeScale,this.elapsed+=delta,this.progress=Math.min(this.elapsed/this.duration,1),this.totalElapsed+=delta,this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1),this.state){case TWEEN_CONST$1.ACTIVE:for(var stillRunning=this.totalData,i=0;i<this.totalData;i++)this.data[i].update(timestamp,delta)&&stillRunning--;this.dispatchTimelineEvent(Events.TIMELINE_UPDATE,this.callbacks.onUpdate),0===stillRunning&&this.nextState();break;case TWEEN_CONST$1.LOOP_DELAY:this.countdown-=delta,this.countdown<=0&&(this.state=TWEEN_CONST$1.ACTIVE,this.dispatchTimelineEvent(Events.TIMELINE_LOOP,this.callbacks.onLoop));break;case TWEEN_CONST$1.COMPLETE_DELAY:this.countdown-=delta,this.countdown<=0&&(this.state=TWEEN_CONST$1.PENDING_REMOVE,this.dispatchTimelineEvent(Events.TIMELINE_COMPLETE,this.callbacks.onComplete))}return this.state===TWEEN_CONST$1.PENDING_REMOVE}},stop:function(){this.state=TWEEN_CONST$1.PENDING_REMOVE},pause:function(){if(this.state!==TWEEN_CONST$1.PAUSED)return this.paused=!0,this._pausedState=this.state,this.state=TWEEN_CONST$1.PAUSED,this.emit(Events.TIMELINE_PAUSE,this),this},resume:function(){return this.state===TWEEN_CONST$1.PAUSED&&(this.paused=!1,this.state=this._pausedState,this.emit(Events.TIMELINE_RESUME,this)),this},hasTarget:function(target){for(var i=0;i<this.data.length;i++)if(this.data[i].hasTarget(target))return!0;return!1},destroy:function(){for(var i=0;i<this.data.length;i++)this.data[i].stop()}});Timeline$1.TYPES=["onStart","onUpdate","onLoop","onComplete","onYoyo"];var Tweens=Timeline$1,Clone$1=Clone_1$7,Defaults=TimelineBuilder_1,GetAdvancedValue=GetAdvancedValue_1,GetBoolean=GetBoolean_1,GetEaseFunction=GetEaseFunction_1,GetNewValue=GetNewValue_1,GetTargets=GetTargets_1,GetTweens=GetTweens_1,GetValue$1=GetValue_1,Timeline=Tweens,TweenBuilder$1=TweenManager,TimelineBuilder_1=function(onStart,config){var timeline=new Timeline(onStart);timeline.completeDelay=GetAdvancedValue(config,"completeDelay",0),timeline.loop=Math.round(GetAdvancedValue(config,"loop",0)),timeline.loopDelay=Math.round(GetAdvancedValue(config,"loopDelay",0)),timeline.paused=GetBoolean(config,"paused",!1),timeline.useFrames=GetBoolean(config,"useFrames",!1);var onCompleteParams=GetValue$1(config,"callbackScope",timeline),timelineArray=[timeline],onStart=GetValue$1(config,"onStart",!1);onStart&&(onUpdateParams=GetValue$1(config,"onStartScope",onCompleteParams),onUpdate=GetValue$1(config,"onStartParams",[]),timeline.setCallback("onStart",onStart,timelineArray.concat(onUpdate),onUpdateParams));var onUpdateParams,onUpdate=GetValue$1(config,"onUpdate",!1);onUpdate&&(onLoop=GetValue$1(config,"onUpdateScope",onCompleteParams),onUpdateParams=GetValue$1(config,"onUpdateParams",[]),timeline.setCallback("onUpdate",onUpdate,timelineArray.concat(onUpdateParams),onLoop));var onLoop=GetValue$1(config,"onLoop",!1);onLoop&&(onYoyoParams=GetValue$1(config,"onLoopScope",onCompleteParams),onYoyo=GetValue$1(config,"onLoopParams",[]),timeline.setCallback("onLoop",onLoop,timelineArray.concat(onYoyo),onYoyoParams));var onYoyoParams,onYoyo=GetValue$1(config,"onYoyo",!1);onYoyo&&(onComplete=GetValue$1(config,"onYoyoScope",onCompleteParams),onYoyoParams=GetValue$1(config,"onYoyoParams",[]),timeline.setCallback("onYoyo",onYoyo,timelineArray.concat(null,onYoyoParams),onComplete));var onComplete=GetValue$1(config,"onComplete",!1);onComplete&&(totalDuration=GetValue$1(config,"onCompleteScope",onCompleteParams),onCompleteParams=GetValue$1(config,"onCompleteParams",[]),timeline.setCallback("onComplete",onComplete,timelineArray.concat(onCompleteParams),totalDuration));var tweens=GetTweens(config);if(0===tweens.length)return timeline.paused=!0,timeline;var defaults=Clone$1(Defaults);defaults.targets=GetTargets(config);var totalDuration=GetAdvancedValue(config,"totalDuration",0);defaults.duration=0<totalDuration?Math.floor(totalDuration/tweens.length):GetNewValue(config,"duration",defaults.duration),defaults.delay=GetNewValue(config,"delay",defaults.delay),defaults.easeParams=GetValue$1(config,"easeParams",defaults.easeParams),defaults.ease=GetEaseFunction(GetValue$1(config,"ease",defaults.ease),defaults.easeParams),defaults.hold=GetNewValue(config,"hold",defaults.hold),defaults.repeat=GetNewValue(config,"repeat",defaults.repeat),defaults.repeatDelay=GetNewValue(config,"repeatDelay",defaults.repeatDelay),defaults.yoyo=GetBoolean(config,"yoyo",defaults.yoyo),defaults.flipX=GetBoolean(config,"flipX",defaults.flipX),defaults.flipY=GetBoolean(config,"flipY",defaults.flipY);for(var i=0;i<tweens.length;i++)timeline.queue(TweenBuilder$1(timeline,tweens[i],defaults));return timeline},builders={GetBoolean:GetBoolean_1,GetEaseFunction:GetEaseFunction_1,GetNewValue:GetNewValue_1,GetProps:GetProps_1,GetTargets:GetTargets_1,GetTweens:GetTweens_1,GetValueOp:builders,NumberTweenBuilder:NumberTweenBuilder_1,StaggerBuilder:StaggerBuilder_1,TimelineBuilder:TimelineBuilder_1,TweenBuilder:TweenManager},ArrayRemove=Remove_1,NumberTweenBuilder=NumberTweenBuilder_1,PluginCache=PluginCache,SceneEvents=events$g,StaggerBuilder=StaggerBuilder_1,TimelineBuilder=TimelineBuilder_1,TWEEN_CONST=_const$a,TweenBuilder=TweenManager,TweenManager=new Class_1({initialize:function(scene){this.scene=scene,this.systems=scene.sys,this.timeScale=1,this._add=[],this._pending=[],this._active=[],this._destroy=[],this._toProcess=0,scene.sys.events.once(SceneEvents.BOOT,this.boot,this),scene.sys.events.on(SceneEvents.START,this.start,this)},boot:function(){this.systems.events.once(SceneEvents.DESTROY,this.destroy,this)},start:function(){var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents.PRE_UPDATE,this.preUpdate,this),eventEmitter.on(SceneEvents.UPDATE,this.update,this),eventEmitter.once(SceneEvents.SHUTDOWN,this.shutdown,this),this.timeScale=1},createTimeline:function(config){return TimelineBuilder(this,config)},timeline:function(timeline){timeline=TimelineBuilder(this,timeline);return timeline.paused||(this._add.push(timeline),this._toProcess++),timeline},create:function(config){return TweenBuilder(this,config)},add:function(tween){tween=TweenBuilder(this,tween);return this._add.push(tween),this._toProcess++,tween},existing:function(tween){return this._add.push(tween),this._toProcess++,this},addCounter:function(tween){tween=NumberTweenBuilder(this,tween);return this._add.push(tween),this._toProcess++,tween},stagger:function(value,options){return StaggerBuilder(value,options)},preUpdate:function(){if(0!==this._toProcess){for(var list=this._destroy,active=this._active,pending=this._pending,i=0;i<list.length;i++){var tween=list[i],idx=active.indexOf(tween);-1===idx?-1<(idx=pending.indexOf(tween))&&(tween.state=TWEEN_CONST.REMOVED,pending.splice(idx,1)):(tween.state=TWEEN_CONST.REMOVED,active.splice(idx,1))}for(list.length=0,list=this._add,i=0;i<list.length;i++)(tween=list[i]).state===TWEEN_CONST.PENDING_ADD&&(tween.init()?(tween.play(),this._active.push(tween)):this._pending.push(tween));list.length=0,this._toProcess=0}},update:function(timestamp,delta){var tween,list=this._active;delta*=this.timeScale;for(var i=0;i<list.length;i++)(tween=list[i]).update(timestamp,delta)&&(this._destroy.push(tween),this._toProcess++)},remove:function(tween){return ArrayRemove(this._add,tween),ArrayRemove(this._pending,tween),ArrayRemove(this._active,tween),ArrayRemove(this._destroy,tween),tween.state=TWEEN_CONST.REMOVED,this},makeActive:function(tween){if(-1!==this._add.indexOf(tween)||-1!==this._active.indexOf(tween))return this;var idx=this._pending.indexOf(tween);return-1!==idx&&this._pending.splice(idx,1),this._add.push(tween),tween.state=TWEEN_CONST.PENDING_ADD,this._toProcess++,this},each:function(callback,scope){for(var texture,args=[null],i=1;i<arguments.length;i++)args.push(arguments[i]);for(texture in this.list)args[0]=this.list[texture],callback.apply(scope,args)},getAllTweens:function(){for(var list=this._active,output=[],i=0;i<list.length;i++)output.push(list[i]);return output},getGlobalTimeScale:function(){return this.timeScale},getTweensOf:function(target,includePending){void 0===includePending&&(includePending=!1);var tween,i,t,list=this._active,output=[];for(Array.isArray(target)||(target=[target]),i=0;i<list.length;i++)for(tween=list[i],t=0;t<target.length;t++)tween.hasTarget(target[t])&&output.push(tween);if(includePending)for(list=this._pending,i=0;i<list.length;i++)for(tween=list[i],t=0;t<target.length;t++)tween.hasTarget(target[t])&&output.push(tween);return output},isTweening:function(target){for(var tween,list=this._active,i=0;i<list.length;i++)if((tween=list[i]).hasTarget(target)&&tween.isPlaying())return!0;return!1},killAll:function(){for(var tweens=this.getAllTweens(),i=0;i<tweens.length;i++)tweens[i].stop();return this},killTweensOf:function(target){for(var tweens=this.getTweensOf(target),i=0;i<tweens.length;i++)tweens[i].stop();return this},pauseAll:function(){for(var list=this._active,i=0;i<list.length;i++)list[i].pause();return this},resumeAll:function(){for(var list=this._active,i=0;i<list.length;i++)list[i].resume();return this},setGlobalTimeScale:function(value){return this.timeScale=value,this},shutdown:function(){this.killAll(),this._add=[],this._pending=[],this._active=[],this._destroy=[],this._toProcess=0;var eventEmitter=this.systems.events;eventEmitter.off(SceneEvents.PRE_UPDATE,this.preUpdate,this),eventEmitter.off(SceneEvents.UPDATE,this.update,this),eventEmitter.off(SceneEvents.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(SceneEvents.START,this.start,this),this.scene=null,this.systems=null}});PluginCache.register("TweenManager",TweenManager,"tweens");var Tweens=Extend_1$1(!1,Tweens={Builders:builders,Events:events,TweenManager:TweenManager,Tween:Tween_1,TweenData:TweenData_1,Timeline:Tweens},_const$a),chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",GetValue=GetValue_1,Clamp=Character,Clone=Clone_1$7,Character=Extend,Extend=Extend_1$1,gameConfig={Actions:actions,Animations:animations,BlendModes:BlendModes$8,Cache:cache,Cameras:cameras,Core:core,Class:Class_1,Create:create,Curves:curves,Data:data,Display:display,DOM:dom,Events:events$9,Game:Game_1,GameObjects:gameobjects,Geom:geom,Input:input,Loader:loader,Math:math,Physics:physics,Plugins:plugins,Renderer:renderer,Scale:scale,ScaleModes:ScaleModes_1,Scene:Scene_1,Scenes:scene,Structs:structs,Textures:textures,Tilemaps:tilemaps,Time:time,Tweens:Tweens,Utils:{Array:array,Base64:{ArrayBufferToBase64:function(arrayBuffer,mediaType){for(var bytes=new Uint8Array(arrayBuffer),len=bytes.length,base64=mediaType?"data:"+mediaType+";base64,":"",i=0;i<len;i+=3)base64+=chars[bytes[i]>>2],base64+=chars[(3&bytes[i])<<4|bytes[i+1]>>4],base64+=chars[(15&bytes[i+1])<<2|bytes[i+2]>>6],base64+=chars[63&bytes[i+2]];return len%3==2?base64=base64.substring(0,base64.length-1)+"=":len%3==1&&(base64=base64.substring(0,base64.length-2)+"=="),base64},Base64ToArrayBuffer:Base64ToArrayBuffer_1},Objects:{Clone:Clone_1$7,DeepCopy:DeepCopy_1,Extend:Extend_1$1,GetAdvancedValue:GetAdvancedValue_1,GetFastValue:GetFastValue_1,GetMinMaxValue:function(source,key,min,max,value){value=GetValue(source,key,value=void 0===value?min:value);return Clamp(value,min,max)},GetValue:GetValue_1,HasAll:function(source,keys){for(var i=0;i<keys.length;i++)if(!source.hasOwnProperty(keys[i]))return!1;return!0},HasAny:HasAny_1,HasValue:HasValue_1,IsPlainObject:IsPlainObject_1,Merge:Merge_1,MergeRight:function(obj1,obj2){var key,clone=Clone(obj1);for(key in obj2)clone.hasOwnProperty(key)&&(clone[key]=obj2[key]);return clone},Pick:Pick_1,SetValue:SetValue_1},String:{Format:function(string,values){return string.replace(/%([0-9]+)/g,function(s,n){return values[Number(n)-1]})},Pad:Pad_1,RemoveAt:function(string,index){return 0===index?string.slice(1):string.slice(0,index-1)+string.slice(index)},Reverse:function(string){return string.split("").reverse().join("")},UppercaseFirst:UppercaseFirst_1,UUID:UUID_1},NOOP:gameConfig}};gameConfig.Sound={SoundManagerCreator:SoundManagerCreator_1,Events:events$6,BaseSound:BaseSound_1,BaseSoundManager:BaseSoundManager_1,WebAudioSound:WebAudioSound_1,WebAudioSoundManager:WebAudioSoundManager_1,HTML5AudioSound:HTML5AudioSound_1,HTML5AudioSoundManager:HTML5AudioSoundManager_1,NoAudioSound:NoAudioSound_1,NoAudioSoundManager:NoAudioSoundManager_1},gameConfig=Extend(!1,gameConfig,Character),Loading.Phaser=gameConfig;var extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)};function __extends(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var EVENTS,WAYS_TO_DIE,ANIMATIONS,Side,Character=function(_super){function Character(scene,x,y,texture,_this){_this=_super.call(this,scene,x,y,texture,_this)||this;return scene.add.existing(_this),scene.physics.add.existing(_this),_this.body.bounce.y=.1,_this}return __extends(Character,_super),Character.prototype.getDamage=function(value){var _this=this;this.scene.tweens.add({targets:this,duration:100,repeat:3,yoyo:!0,alpha:.5,onStart:function(){_this.hp=_this.hp-value},onComplete:function(){_this.setAlpha(1)}})},Character.prototype.flipLeft=function(){this.scaleX=-1,this.setOffset(this.width,0)},Character.prototype.flipRight=function(){this.scaleX=1,this.setOffset(0,0)},Character.prototype.getBody=function(){return this.body},Character}(Phaser.Physics.Arcade.Sprite);!function(EVENTS){EVENTS.shoot="shoot",EVENTS.destroy="destroy",EVENTS.died="died",EVENTS.complete="complete",EVENTS.restart="restart",EVENTS.pause="pause"}(EVENTS=EVENTS||{}),function(WAYS_TO_DIE){WAYS_TO_DIE.fell="fell",WAYS_TO_DIE.backfire="backfire",WAYS_TO_DIE.enemy="enemy",WAYS_TO_DIE.spikes="spikes",WAYS_TO_DIE.crashed="crashed",WAYS_TO_DIE.burned="burned"}(WAYS_TO_DIE=WAYS_TO_DIE||{}),function(ANIMATIONS){ANIMATIONS.playerJump="player-jump",ANIMATIONS.playerRun="player-run",ANIMATIONS.playerDoubleJump="player-djump",ANIMATIONS.playerWallJump="player-wjump",ANIMATIONS.playerIdle="player-idle",ANIMATIONS.playerFall="player-fall",ANIMATIONS.enemyIdle="enemy-idle",ANIMATIONS.enemyRun="enemy-run",ANIMATIONS.collectableIdle="collectable-idle"}(ANIMATIONS=ANIMATIONS||{}),function(Side){Side.up="up",Side.down="down",Side.left="left",Side.right="right"}(Side=Side||{});var ScoreOperations,gameOptions_gravity=900,gameOptions_playerGrip=50,gameOptions_playerSpeed=200,gameOptions_playerJump=400,gameOptions_playerDoubleJump=250,gameOptions_projectileSpeed=1e3,staticGroupSettings={runChildUpdate:!0,immovable:!0,allowGravity:!1},gravityDefyGroupSettings={runChildUpdate:!0,allowGravity:!1},defaultGroupSettings={runChildUpdate:!0},frameSettingsPlayer={frameWidth:32,frameHeight:32},frameSettingsEnemy={frameWidth:52,frameHeight:32},Loading=function(_super){function Loading(){return _super.call(this,"loading-scene")||this}return __extends(Loading,_super),Loading.prototype.loadPlayerAssets=function(){this.load.spritesheet("player","player/Idle.png",frameSettingsPlayer),this.load.spritesheet(ANIMATIONS.playerIdle,"player/Idle.png",frameSettingsPlayer),this.load.spritesheet(ANIMATIONS.playerRun,"player/Run.png",frameSettingsPlayer),this.load.spritesheet(ANIMATIONS.playerJump,"player/Jump.png",frameSettingsPlayer),this.load.spritesheet(ANIMATIONS.playerDoubleJump,"player/DoubleJump.png",frameSettingsPlayer),this.load.spritesheet(ANIMATIONS.playerWallJump,"player/WallJump.png",frameSettingsPlayer),this.load.spritesheet(ANIMATIONS.playerFall,"player/Fall.png",frameSettingsPlayer)},Loading.prototype.loadEnemyAssets=function(){this.load.spritesheet("enemy","enemy/Idle.png",frameSettingsEnemy),this.load.spritesheet(ANIMATIONS.enemyIdle,"enemy/Idle.png",frameSettingsEnemy),this.load.spritesheet(ANIMATIONS.enemyRun,"enemy/Run.png",frameSettingsEnemy)},Loading.prototype.preload=function(){this.load.baseURL="assets/",this.loadPlayerAssets(),this.loadEnemyAssets(),this.load.atlas("terrain","Terrain.png","terrain_atlas.json"),this.load.image("projectile","particle.png"),this.load.image("spikes","spikes.png"),this.load.image("shadow","Shadow.png"),this.load.image("firePlatform","FirePlatform.png"),this.load.spritesheet(ANIMATIONS.collectableIdle,"collectable.png",{frameWidth:32,frameHeight:32})},Loading.prototype.create=function(){this.scene.start("level-1-scene")},Loading}(Phaser.Scene),Enemy=function(_super){function Enemy(scene,x,y,texture,target,frame){var _this=_super.call(this,scene,x,y,texture,frame)||this;return _this.distance=300,_this.target=target,_this.hp=0,_this.initAnimations(),_this.getBody().setSize(frameSettingsEnemy.frameWidth,frameSettingsEnemy.frameHeight),_this.getBody().setOffset(0,0),_this.on("destroy",function(){return _this.removeAllListeners()}),_this}return __extends(Enemy,_super),Enemy.prototype.update=function(){var newVelocity;this.body&&(this.body.gravity.y=gameOptions_gravity,((newVelocity=0<this.target.x-this.x)&&0<this.target.scaleX||!newVelocity&&this.target.scaleX<0)&&this.target.y===this.y&&Phaser.Math.Distance.BetweenPoints({x:this.x,y:this.y},{x:this.target.x,y:this.target.y})<this.distance?(0<(newVelocity=this.target.x-this.x)?this.flipLeft():this.flipRight(),this.getBody().setVelocityX(newVelocity),this.anims.play(ANIMATIONS.enemyRun,!0)):(this.getBody().setVelocity(0),this.anims.play(ANIMATIONS.enemyIdle,!0)))},Enemy.prototype.initAnimations=function(){this.anims.create({key:ANIMATIONS.enemyIdle,frames:this.anims.generateFrameNumbers(ANIMATIONS.enemyIdle,{start:0,end:10}),frameRate:20}),this.anims.create({key:ANIMATIONS.enemyRun,frames:this.anims.generateFrameNumbers(ANIMATIONS.enemyRun,{start:0,end:5}),frameRate:40})},Enemy.prototype.getDamage=function(value){_super.prototype.getDamage.call(this,value),this.hp<=0&&this.disableBody(!0,!0)},Enemy}(Character),gameConfig=function(_super){function Level(levelIndex){return _super.call(this,"level-"+levelIndex+"-scene")||this}return __extends(Level,_super),Level.prototype.initWorld=function(){},Level.prototype.initCamera=function(){this.cameras.main.setSize(this.game.canvas.width,this.game.canvas.height),this.cameras.main.startFollow(this.player,!0,.09,.09),this.cameras.main.setZoom(2)},Level}(Phaser.Scene),Player=function(_super){function Player(scene,x,_this){_this=_super.call(this,scene,x,_this,"player")||this;return _this.hp=0,_this.leftMoveKey=_this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.LEFT),_this.rightMoveKey=_this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.RIGHT),_this.fireKey=_this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.CTRL),_this.jumpKey=_this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE),_this.canJump=!0,_this.canDoubleJump=!1,_this.canWallJump=!1,_this.isOnWall=!1,_this.getBody().setSize(frameSettingsPlayer.frameWidth,frameSettingsPlayer.frameHeight),_this.initAnimations(),_this}return __extends(Player,_super),Player.prototype.handleJump=function(){this.canJump||this.isOnWall?(this.wallSliding=!1,this.body.velocity.y=-gameOptions_playerJump,this.isOnWall&&(0<this.scaleX?this.flipLeft():this.flipRight(),this.wallJumped=!0,this.getBody().setVelocityX(this.scaleX*gameOptions_playerSpeed)),this.isOnWall=!1,this.canJump=!1,this.anims.play(ANIMATIONS.playerJump,!0),this.canDoubleJump=!0):this.canDoubleJump&&(this.anims.play(ANIMATIONS.playerDoubleJump,!0),this.canDoubleJump=!1,this.body.velocity.y=-gameOptions_playerDoubleJump)},Player.prototype.handleWallSlide=function(){var isHittingWallLeft,isHittingWallRight,isPressingLeft,isPressingRight;this.body.touching.down||(isHittingWallLeft=this.body.touching.left,isHittingWallRight=this.body.touching.right,isPressingLeft=this.leftMoveKey.isDown,isPressingRight=this.rightMoveKey.isDown,(isHittingWallLeft&&!isPressingLeft||isHittingWallRight&&!isPressingRight||this.wallSliding)&&(this.wallSliding=!0,this.anims.play(ANIMATIONS.playerWallJump,!0),this.isOnWall=!0,this.body.gravity.y=0,this.body.velocity.y=gameOptions_playerGrip))},Player.prototype.handleMove=function(){var isTouchingDown=this.body.touching.down;this.leftMoveKey.isDown?(this.getBody().setVelocityX(-gameOptions_playerSpeed),this.flipLeft(),this.wallSliding=!1,isTouchingDown&&(this.canJump=!0,this.anims.play(ANIMATIONS.playerRun,!0))):this.rightMoveKey.isDown?(this.getBody().setVelocityX(gameOptions_playerSpeed),this.flipRight(),this.wallSliding=!1,isTouchingDown&&(this.canJump=!0,this.anims.play(ANIMATIONS.playerRun,!0))):isTouchingDown&&(this.wallSliding=!1,this.wallJumped=!1,this.isOnWall=!1,this.canJump=!0,this.anims.play(ANIMATIONS.playerIdle,!0))},Player.prototype.handleWallGrab=function(){var isHittingWallLeft,isHittingWallRight,isPressingLeft,isPressingRight;this.body.touching.down||(isHittingWallLeft=this.body.touching.left,isHittingWallRight=this.body.touching.right,isPressingLeft=this.leftMoveKey.isDown,isPressingRight=this.rightMoveKey.isDown,(isHittingWallLeft&&isPressingLeft||isHittingWallRight&&isPressingRight)&&(this.body.gravity.y=0,this.body.velocity.y=0,this.isOnWall=!0,this.anims.play(ANIMATIONS.playerWallJump,!0)))},Player.prototype.update=function(){this.body.gravity.y=gameOptions_gravity,this.wallJumped||this.getBody().setVelocityX(0),this.canWallJump&&this.handleWallSlide(),this.handleMove(),this.canWallJump&&this.handleWallGrab(),!this.isOnWall&&0<this.body.velocity.y&&this.anims.play(ANIMATIONS.playerFall,!0),Phaser.Input.Keyboard.JustDown(this.fireKey)&&this.scene.game.events.emit(EVENTS.shoot),Phaser.Input.Keyboard.JustDown(this.jumpKey)&&this.handleJump()},Player.prototype.initAnimations=function(){var _this=this;[{type:ANIMATIONS.playerIdle,start:0,end:10,rate:20},{type:ANIMATIONS.playerRun,start:0,end:11,rate:20},{type:ANIMATIONS.playerJump,start:0,end:0,rate:1},{type:ANIMATIONS.playerDoubleJump,start:0,end:5,rate:25},{type:ANIMATIONS.playerFall,start:0,end:0,rate:1},{type:ANIMATIONS.playerWallJump,start:0,end:4,rate:10}].map(function(animSettings){return _this.anims.create({key:animSettings.type,frames:_this.anims.generateFrameNumbers(animSettings.type,{start:animSettings.start,end:animSettings.end}),frameRate:animSettings.rate})})},Player.prototype.getDamage=function(value,wayToDie){_super.prototype.getDamage.call(this,value),this.hp<=0&&this.scene.game.events.emit(EVENTS.died,wayToDie)},Player.prototype.setWallJump=function(flag){this.canWallJump=flag},Player}(Character),Text=function(_super){function Text(scene,x,y,_this){_this=_super.call(this,scene,x,y,_this,{fontSize:"12px",color:"#fff",stroke:"#000",padding:{x:5,y:5}})||this;return _this.setOrigin(0,0),scene.add.existing(_this),_this}return __extends(Text,_super),Text}(Phaser.GameObjects.Text);!function(ScoreOperations){ScoreOperations[ScoreOperations.INCREASE=0]="INCREASE",ScoreOperations[ScoreOperations.DECREASE=1]="DECREASE",ScoreOperations[ScoreOperations.SET_VALUE=2]="SET_VALUE"}(ScoreOperations=ScoreOperations||{});function getPosition(source){var facingLeft=source.scaleX<0;return{x:source.body.position.x+(facingLeft?0:source.body.width),y:source.body.position.y+source.body.height/2}}var Direction,Score=function(_super){function Score(scene,x,y,initScore,descr){var _this=this,descr=descr?descr+":":"";return(_this=_super.call(this,scene,x,y,descr+" "+(initScore=void 0===initScore?0:initScore)+"/"+initScore)||this).descr=descr,scene.add.existing(_this),_this.totalValue=initScore,_this.remainingValue=initScore,_this}return __extends(Score,_super),Score.prototype.changeValue=function(operation,value){switch(operation){case ScoreOperations.INCREASE:this.remainingValue+=value;break;case ScoreOperations.DECREASE:this.remainingValue-=value;break;case ScoreOperations.SET_VALUE:this.remainingValue=value}this.setText(this.descr+" "+this.remainingValue+"/"+this.totalValue)},Score.prototype.getValue=function(){return this.remainingValue},Score}(Text),Tile=function(_super){function Tile(scene,x,y,texture,_this){_this=_super.call(this,scene,x,y,texture,_this)||this;return scene.add.existing(_this),scene.physics.add.existing(_this),_this.setImmovable(!0),_this.getBody().setAllowGravity(!1),_this.setOrigin(1,1),_this}return __extends(Tile,_super),Tile.prototype.getBody=function(){return this.body},Tile}(Phaser.Physics.Arcade.Sprite),Projectile=function(_super){function Projectile(scene,facingLeft){var _this=this,y=getPosition(facingLeft),x=y.x,y=y.y,facingLeft=((_this=_super.call(this,scene,x,y,"projectile")||this).source=facingLeft).scaleX<0;return scene.add.existing(_this),scene.physics.add.existing(_this),_this.speed=facingLeft?-gameOptions_projectileSpeed:gameOptions_projectileSpeed,_this}return __extends(Projectile,_super),Projectile.prototype.update=function(){this.body.velocity.x=this.speed,this.getBody().checkWorldBounds()&&this.disableBody(!0,!0)},Projectile.prototype.enable=function(){var facingLeft=getPosition(this.source),x=facingLeft.x,y=facingLeft.y,facingLeft=this.source.scaleX<0;this.speed=facingLeft?-gameOptions_projectileSpeed:gameOptions_projectileSpeed,this.enableBody(!0,x,y,!0,!0)},Projectile.prototype.recoil=function(){this.speed=-1*this.speed},Projectile.prototype.getBody=function(){return this.body},Projectile}(Phaser.Physics.Arcade.Sprite),Trap=function(_super){function Trap(scene,x,y,texture,_this){_this=_super.call(this,scene,x,y,texture,_this)||this;return scene.add.existing(_this),scene.physics.add.existing(_this),_this.getBody().setAllowGravity(!1),_this.setImmovable(!0),_this}return __extends(Trap,_super),Trap.prototype.getBody=function(){return this.body},Trap}(Phaser.Physics.Arcade.Sprite);!function(Direction){Direction.horizontal="horizontal",Direction.vertical="vertical"}(Direction=Direction||{});var Platform=function(_super){function Platform(scene,x,y,texture,distance,speed,movesOn,_this){_this=_super.call(this,scene,x,y,texture,_this)||this;return _this.distance=distance,_this.startAt=movesOn===Direction.horizontal?x:y,_this.speed=speed,_this.movesOn=movesOn,scene.add.existing(_this),scene.physics.add.existing(_this),_this.setImmovable(!0),_this.setCollideWorldBounds(!0),_this}return __extends(Platform,_super),Platform.prototype.update=function(){var speedDirection;this.distance&&this.speed&&(speedDirection=this.distance<0?-1:1,this.movesOn===Direction.horizontal?this.x>=this.startAt?this.setVelocityX(speedDirection*this.speed):this.x<=this.startAt+this.distance&&this.setVelocityX(-1*speedDirection*this.speed):this.y>=this.startAt?this.setVelocityY(speedDirection*this.speed):this.y<=this.startAt+this.distance&&this.setVelocityY(-1*speedDirection*this.speed))},Platform.prototype.getBody=function(){return this.body},Platform}(Phaser.Physics.Arcade.Sprite),Collectable=function(_super){function Collectable(scene,x,y,texture,_this){_this=_super.call(this,scene,x,y,texture,_this)||this;return scene.add.existing(_this),scene.physics.add.existing(_this),_this.setOrigin(1,1),_this.anims.create({key:ANIMATIONS.collectableIdle,frames:_this.anims.generateFrameNumbers(ANIMATIONS.collectableIdle,{start:0,end:16}),repeat:-1,frameRate:16}),_this.getBody().setSize(16,16),_this.anims.play(ANIMATIONS.collectableIdle),_this}return __extends(Collectable,_super),Collectable.prototype.getBody=function(){return this.body},Collectable}(Phaser.Physics.Arcade.Sprite),Button=function(x,y,label,scene,callback){var button=scene.add.text(x,y,label).setOrigin(.5).setPadding(4).setStyle({backgroundColor:"#111"}).setInteractive({useHandCursor:!0}).on("pointerdown",function(){return callback()}).on("pointerover",function(){return button.setStyle({fill:"#f39c12"})}).on("pointerout",function(){return button.setStyle({fill:"#FFF"})})},RotatingPlatform=function(_super){function RotatingPlatform(scene,x,y,texture,distance,speed,movesOn,rotationInterval,sideWithHazard,_this){_this=_super.call(this,scene,x,y,texture,distance,speed,movesOn,_this)||this;return _this.newAngle=0,_this.sideWithHazard=sideWithHazard,_this.scene.time.addEvent({callback:_this.rotate,callbackScope:_this,delay:rotationInterval,loop:!0}),_this.angle=0,_this}return __extends(RotatingPlatform,_super),RotatingPlatform.prototype.rotate=function(){this.newAngle=180},RotatingPlatform.prototype.update=function(){_super.prototype.update.call(this),0!==this.newAngle?(this.angle+=20,this.newAngle-=20):-180===this.angle?this.isFacingUp=!1:this.isFacingUp=!0},RotatingPlatform.prototype.collisionWithHazard=function(){return this.isFacingUp&&this.sideWithHazard===Side.up&&this.body.touching.up||!this.isFacingUp&&this.sideWithHazard===Side.up&&this.body.touching.down||this.isFacingUp&&this.sideWithHazard===Side.down&&this.body.touching.down||!this.isFacingUp&&this.sideWithHazard===Side.down&&this.body.touching.up},RotatingPlatform.prototype.getBody=function(){return this.body},RotatingPlatform}(Platform),VerticalTile=function(_super){function VerticalTile(scene,x,y,texture,enableCollision,_this){_this=_super.call(this,scene,x,y,texture,_this)||this;return enableCollision!==Side.up&&(_this.getBody().checkCollision.up=!1),enableCollision!==Side.down&&(_this.getBody().checkCollision.down=!1),!1===enableCollision&&(_this.getBody().checkCollision.down=!1,_this.getBody().checkCollision.up=!1),_this}return __extends(VerticalTile,_super),VerticalTile.prototype.getBody=function(){return this.body},VerticalTile}(Tile),HorizontalTile=function(_super){function HorizontalTile(scene,x,y,texture,enableCollision,_this){_this=_super.call(this,scene,x,y,texture,_this)||this;return enableCollision!==Side.left&&(_this.getBody().checkCollision.left=!1),enableCollision!==Side.right&&(_this.getBody().checkCollision.right=!1),!1===enableCollision&&(_this.getBody().checkCollision.left=!1,_this.getBody().checkCollision.right=!1),_this}return __extends(HorizontalTile,_super),HorizontalTile.prototype.getBody=function(){return this.body},HorizontalTile}(Tile),playerStartPosition_x=50,playerStartPosition_y=-80,enemyPosition_x=-300,enemyPosition_y=-60,levelObjectives=[WAYS_TO_DIE.fell,WAYS_TO_DIE.enemy,WAYS_TO_DIE.spikes,WAYS_TO_DIE.crashed,WAYS_TO_DIE.backfire,WAYS_TO_DIE.burned],gameConfig=function(_super){function Level1(){var _this=_super.call(this,1)||this;return _this.waysToDie=levelObjectives,_this.remainingWaysToDie=levelObjectives,_this}return __extends(Level1,_super),Level1.prototype.create=function(){this.initUI(),this.initWorld(),this.setupLevel(),this.initPlayer(),this.initEnemies(),this.initObstacles(),this.initObjectives(this.waysToDie.length),this.setupColliders(),this.setupEvents()},Level1.prototype.update=function(){this.player.update(),this.player.getBody().checkWorldBounds()&&this.player.getDamage(1,WAYS_TO_DIE.fell)},Level1.prototype.setupColliders=function(){var _this=this;this.physics.add.collider(this.player,this.groundLayer,function(){_this.player.setWallJump(!1)}),this.physics.add.collider(this.player,this.wallGroup,function(){_this.player.setWallJump(!0)}),this.physics.add.collider(this.player,this.worldWallsGroup,function(){_this.player.setWallJump(!1)}),this.physics.add.collider(this.player,this.recoilGroup,function(){_this.player.setWallJump(!1)}),this.physics.add.collider(this.player,this.spikes,function(){_this.player.getDamage(1,WAYS_TO_DIE.spikes)}),this.physics.add.overlap(this.player,this.collectables,function(_,collectable){_this.player.setWallJump(!1),collectable.destroy(),_this.collectables.remove(collectable),_this.scoreLeft.changeValue(ScoreOperations.DECREASE,1),_this.collectables.getChildren().length||_this.levelInfo.setText("YOU WIN - the safe way!")}),this.physics.add.collider(this.player,this.enemies,function(_,enemyWasMoving){var hitByEnemyFront=0<enemyWasMoving.scaleX&&enemyWasMoving.body.touching.left||enemyWasMoving.scaleX<0&&enemyWasMoving.body.touching.right,enemyWasMoving=100!==Math.abs(enemyWasMoving.body.velocity.x);hitByEnemyFront&&enemyWasMoving&&_this.player.getDamage(1,WAYS_TO_DIE.enemy)}),this.physics.add.collider(this.groundLayer,this.enemies),this.physics.add.collider(this.player,this.platformGroup,function(player,platform){_this.player.setWallJump(!1),(platform.body.touching.down&&player.body.touching.down||platform.body.touching.up&&player.body.touching.up)&&_this.player.getDamage(1,WAYS_TO_DIE.crashed),platform.collisionWithHazard&&platform.collisionWithHazard()&&_this.player.getDamage(1,WAYS_TO_DIE.burned)}),this.physics.add.overlap(this.player,this.projectilesGroup,function(player,projectile){player.getDamage(1,WAYS_TO_DIE.backfire),projectile.disableBody(!0,!0)}),this.physics.add.overlap(this.enemies,this.projectilesGroup,function(enemy,projectile){enemy.getDamage(1),projectile.disableBody(!0,!0)}),this.physics.add.collider(this.wallGroup,this.projectilesGroup,function(_,projectile){projectile.disableBody(!0,!0)}),this.physics.add.collider(this.worldWallsGroup,this.projectilesGroup,function(_,projectile){projectile.disableBody(!0,!0)}),this.physics.add.collider(this.recoilGroup,this.projectilesGroup,function(_,projectile){projectile.recoil()})},Level1.prototype.setupEvents=function(){var _this=this;this.game.events.on(EVENTS.shoot,function(){var disabledItem=_this.projectilesGroup.getChildren().find(function(p){return!p.active});disabledItem?disabledItem.enable():_this.projectilesGroup.add(new Projectile(_this,_this.player))}),this.game.events.on(EVENTS.died,function(wayPlayerDied){var wayToDie,_a;_this.collectables.clear(!0,!0),_this.remainingWaysToDie.includes(wayPlayerDied)&&(_this.remainingWaysToDie=_this.remainingWaysToDie.filter(function(way){return way!==wayPlayerDied}),_this.scoreRight.changeValue(ScoreOperations.DECREASE,1),_this.remainingWaysToDie.length?(_this.levelInfo.setText("Find all ways to die! Restart to get the fruits"),_this.scoreLeft.destroy()):_this.levelInfo.setText("YOU WIN - with sacrifice!"),new Tile(_this,_this.player.body.position.x,_this.player.body.position.y,"shadow"),new Text(_this,_this.player.body.position.x,_this.player.body.position.y-10,(wayToDie=wayPlayerDied,(_a={})[WAYS_TO_DIE.backfire]="You shot yourself",_a[WAYS_TO_DIE.enemy]="You were killed",_a[WAYS_TO_DIE.fell]="You fell and died",_a[WAYS_TO_DIE.crashed]="You were crashed",_a[WAYS_TO_DIE.spikes]="You took a spike to the knee",_a[WAYS_TO_DIE.burned]="You burned to death",_a[wayToDie]||"You died here"))),_this.player.body.position.x=playerStartPosition_x,_this.player.body.position.y=_this.game.canvas.height+playerStartPosition_y},this)},Level1.prototype.initUI=function(){var _this=this;new Button(this.game.canvas.width-60,60,"Reset",this,function(){_this.scene.restart()})},Level1.prototype.initObstacles=function(){var positionOfTopWall=this.wallGroup.getChildren(),positionOfTopWall=positionOfTopWall[positionOfTopWall.length-1].body;this.spikes=new Trap(this,positionOfTopWall.position.x-8,positionOfTopWall.position.y-24,"spikes")},Level1.prototype.initObjectives=function(total){this.collectables=this.physics.add.group(gravityDefyGroupSettings),this.collectables.add(new Collectable(this,100,300,"collectable")),this.collectables.add(new Collectable(this,700,500,"collectable")),this.collectables.add(new Collectable(this,800,this.game.canvas.height-60,"collectable")),this.collectables.add(new Collectable(this,1100,300,"collectable")),this.levelInfo=new Text(this,20,20,"Find all ways to die or collect all fruits!"),this.scoreRight=new Score(this,this.game.canvas.width-120,20,this.waysToDie.length,"deaths"),this.scoreLeft=new Score(this,this.game.canvas.width-220,20,this.collectables.getChildren().length,"fruits")},Level1.prototype.initPlayer=function(){this.player=new Player(this,playerStartPosition_x,this.game.canvas.height+playerStartPosition_y),this.projectilesGroup=this.physics.add.group(gravityDefyGroupSettings)},Level1.prototype.initEnemies=function(){this.enemies=this.physics.add.group(defaultGroupSettings),this.enemies.add(new Enemy(this,this.game.canvas.width+enemyPosition_x,this.game.canvas.height+enemyPosition_y,"enemy",this.player))},Level1.prototype.setupLevel=function(){var _this=this;this.groundLayer=this.physics.add.group(staticGroupSettings),this.wallGroup=this.physics.add.group(staticGroupSettings),this.worldWallsGroup=this.physics.add.group(staticGroupSettings),this.platformGroup=this.physics.add.group(staticGroupSettings),this.recoilGroup=this.physics.add.group(staticGroupSettings);for(var totalHorizontalWalls=this.game.canvas.width/48+1,totalVerticalWalls=this.game.canvas.height/48+1,tileNo=0;tileNo<totalHorizontalWalls;tileNo++)this.worldWallsGroup.add(new HorizontalTile(this,48*tileNo+48,16,"terrain",!1,"wall-horizontal"));for(tileNo=0;tileNo<totalVerticalWalls;tileNo++)this.worldWallsGroup.add(new VerticalTile(this,16,48*tileNo+48,"terrain",!1,"wall-vertical"));for(var rightWallsToExclude=[8,9],tileNo=0;tileNo<totalVerticalWalls;tileNo++)rightWallsToExclude.includes(tileNo)?this.recoilGroup.add(new VerticalTile(this,this.game.canvas.width,48*tileNo+48,"terrain",!1,"metal-vertical")):this.worldWallsGroup.add(new VerticalTile(this,this.game.canvas.width,48*tileNo+48,"terrain",!1,"wall-vertical"));for(var howManyInScreen=Math.round(this.game.canvas.width/42)+1,positionsToExcludeGround=[7,8,9,10],tileNo=0;tileNo<howManyInScreen;tileNo++)positionsToExcludeGround.includes(tileNo)||this.groundLayer.add(new HorizontalTile(this,42*tileNo+42,this.game.canvas.height,"terrain",6===tileNo?Side.right:11===tileNo&&Side.left,"grass-big"));var leftWallPoints=[2,3,4,5,6,7,8,9,10,11,12,13];leftWallPoints.forEach(function(tile,index){_this.wallGroup.add(new VerticalTile(_this,600,_this.game.canvas.height-(150+32*tile),"terrain",0===index?Side.down:index===leftWallPoints.length-1&&Side.up,"brick-small"))});var rightWallPointsPart1=[0,1,2,3,4,5,6];rightWallPointsPart1.forEach(function(tile,index){_this.wallGroup.add(new VerticalTile(_this,800,_this.game.canvas.height-(150+32*tile),"terrain",0===index?Side.down:index===rightWallPointsPart1.length-1&&Side.up,"brick-small"))});var rightWallPointsPart2=[11,12,13,14];rightWallPointsPart2.forEach(function(tile,index){_this.wallGroup.add(new VerticalTile(_this,800,_this.game.canvas.height-(150+32*tile),"terrain",0===index?Side.down:index===rightWallPointsPart2.length-1&&Side.up,"brick-small"))}),this.platformGroup.add(new Platform(this,200,this.game.canvas.height-70,"terrain",-200,80,Direction.vertical,"platform-horizontal")),this.platformGroup.add(new Platform(this,500,this.game.canvas.height-400,"terrain",-400,100,Direction.horizontal,"platform-horizontal")),this.platformGroup.add(new RotatingPlatform(this,1100,400,"firePlatform",-50,80,Direction.vertical,2e3,Side.up))},Level1}(gameConfig),gameConfig={title:"Death by choice",type:Phaser.AUTO,parent:"game",backgroundColor:"#0472FC",scale:{mode:Phaser.Scale.FIT,parent:"phaser-example",autoCenter:Phaser.Scale.CENTER_BOTH,width:1200,height:800},physics:{default:"arcade",arcade:{gravity:{y:0}}},render:{antialiasGL:!1,pixelArt:!0},callbacks:{postBoot:function(){}},autoFocus:!0,audio:{disableWebAudio:!1},scene:[Loading,gameConfig],winScore:40};return window.sizeChanged=function(){window.game.isBooted&&setTimeout(function(){window.game.scale.resize(window.innerWidth,window.innerHeight),window.game.canvas.setAttribute("style","display: block; width: "+(window.innerWidth-50)+"px; height: "+(window.innerHeight-50)+"px;")},100)},window.game=new Phaser.Game(gameConfig),exports.gameConfig=gameConfig,Object.defineProperty(exports,"__esModule",{value:!0}),exports}({});
